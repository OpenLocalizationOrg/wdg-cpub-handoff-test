{"nodes":[{"pos":[66,292],"content":"The SystemMediaTransportControls class enables your app to use the system media transport controls that are built into Windows and to update the metadata that the controls display about the media your app is currently playing.","needQuote":true,"needEscape":true,"nodes":[{"content":"The SystemMediaTransportControls class enables your app to use the system media transport controls that are built into Windows and to update the metadata that the controls display about the media your app is currently playing.","pos":[0,226]}]},{"pos":[300,331],"content":"System Media Transport Controls","needQuote":true,"needEscape":true,"nodes":[{"content":"System Media Transport Controls","pos":[0,31]}]},{"content":"System Media Transport Controls","pos":[339,370]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[372,410]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[411,506],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"pos":[509,799],"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept> class enables your app to use the system media transport controls that are built into Windows and to update the metadata that the controls display about the media your app is currently playing.","source":"The [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) class enables your app to use the system media transport controls that are built into Windows and to update the metadata that the controls display about the media your app is currently playing."},{"content":"The system transport controls are different than the transport controls on the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MediaElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242926)</ept> object.","pos":[801,964],"source":"The system transport controls are different than the transport controls on the [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) object."},{"content":"The system transport controls are the controls that pop up when hardware media keys are pressed, such as the volume control on a pair of headphones or the media buttons on keyboards.","pos":[965,1147]},{"content":"If the user presses the pause key on a keyboard and your app supports the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept>, your app is notified and you can take the appropriate action.","pos":[1148,1377],"source":" If the user presses the pause key on a keyboard and your app supports the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677), your app is notified and you can take the appropriate action."},{"pos":[1379,1574],"content":"Your app can also update the media info, such as the song title and thumbnail image that the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept> displays.","source":"Your app can also update the media info, such as the song title and thumbnail image that the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) displays."},{"content":"Note","pos":[1578,1582]},{"content":"The <bpt id=\"p1\">[</bpt>System Media Transport Controls UWP sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=619488)</ept> implements the code discussed in this overview.","pos":[1587,1730],"source":"The [System Media Transport Controls UWP sample](http://go.microsoft.com/fwlink/?LinkId=619488) implements the code discussed in this overview."},{"content":"You can download the sample to see the code in context or to use as a starting point for your own app.","pos":[1731,1833]},{"content":"Set up transport controls","pos":[1838,1863]},{"content":"In the page's XAML file, define a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MediaElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242926)</ept> that will be controlled by the system media transport controls.","pos":[1865,2039],"source":"In the page's XAML file, define a [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) that will be controlled by the system media transport controls."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CurrentStateChanged<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227375)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MediaOpened<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br227394)</ept> events are used to update the system media transport controls and will be discussed later in this article.","pos":[2040,2314],"source":" The [**CurrentStateChanged**](https://msdn.microsoft.com/library/windows/apps/br227375) and [**MediaOpened**](https://msdn.microsoft.com/library/windows/apps/br227394) events are used to update the system media transport controls and will be discussed later in this article."},{"pos":[2327,2367],"content":"MediaElementSystemMediaTransportControls"},{"content":"Add a button to the XAML file that allows the user to select a file to play.","pos":[2454,2530]},{"pos":[2543,2553],"content":"OpenButton"},{"content":"In your code behind page, add using directives for the following namespaces.","pos":[2610,2686]},{"pos":[2698,2707],"content":"Namespace"},{"pos":[2766,3056],"content":"Add a button click handler that uses a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FileOpenPicker<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207847)</ept> to allow the user to select a file, then call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SetSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br244338)</ept> to make it the active file for the <bpt id=\"p5\">**</bpt>MediaElement<ept id=\"p5\">**</ept>.","source":"Add a button click handler that uses a [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) to allow the user to select a file, then call [**SetSource**](https://msdn.microsoft.com/library/windows/apps/br244338) to make it the active file for the **MediaElement**."},{"pos":[3068,3081],"content":"OpenMediaFile"},{"pos":[3144,3353],"content":"Get an instance of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept> by calling <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetForCurrentView<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn278708)</ept>.","source":"Get an instance of the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) by calling [**GetForCurrentView**](https://msdn.microsoft.com/library/windows/apps/dn278708)."},{"content":"Enable the buttons that your app will use by setting the corresponding \"is enabled\" property of the <bpt id=\"p1\">**</bpt>SystemMediaTransportControls<ept id=\"p1\">**</ept> object, such as <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>IsPlayEnabled<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn278714)</ept>, <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>IsPauseEnabled<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn278713)</ept>, <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>IsNextEnabled<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn278712)</ept>, and <bpt id=\"p8\">[</bpt><bpt id=\"p9\">**</bpt>IsPreviousEnabled<ept id=\"p9\">**</ept><ept id=\"p8\">](https://msdn.microsoft.com/library/windows/apps/dn278715)</ept>.","pos":[3355,3828],"source":"Enable the buttons that your app will use by setting the corresponding \"is enabled\" property of the **SystemMediaTransportControls** object, such as [**IsPlayEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278714), [**IsPauseEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278713), [**IsNextEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278712), and [**IsPreviousEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278715)."},{"content":"See the <bpt id=\"p1\">**</bpt>SystemMediaTransportControls<ept id=\"p1\">**</ept> reference documentation for a complete list of available controls.","pos":[3829,3936],"source":" See the **SystemMediaTransportControls** reference documentation for a complete list of available controls."},{"pos":[3938,4105],"content":"Register a handler for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ButtonPressed<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278706)</ept> event to receive notifications when the user presses a button.","source":"Register a handler for the [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event to receive notifications when the user presses a button."},{"pos":[4117,4150],"content":"SystemMediaTransportControlsSetup"},{"content":"Handle system media transport controls button presses","pos":[4236,4289]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ButtonPressed<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278706)</ept> event is raised by the system transport controls when one of the enabled buttons is pressed.","pos":[4291,4465],"source":"The [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event is raised by the system transport controls when one of the enabled buttons is pressed."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Button<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278685)</ept> property of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SystemMediaTransportControlsButtonPressedEventArgs<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn278683)</ept> passed into the event handler is a member of the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>SystemMediaTransportControlsButton<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn278681)</ept> enumeration that indicates which of the enabled buttons was pressed.","pos":[4466,4888],"source":" The [**Button**](https://msdn.microsoft.com/library/windows/apps/dn278685) property of the [**SystemMediaTransportControlsButtonPressedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn278683) passed into the event handler is a member of the [**SystemMediaTransportControlsButton**](https://msdn.microsoft.com/library/windows/apps/dn278681) enumeration that indicates which of the enabled buttons was pressed."},{"content":"In order to update objects on the UI thread from the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ButtonPressed<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278706)</ept> event handler, such as a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MediaElement<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242926)</ept> object, you must marshal the calls through the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>CoreDispatcher<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br208211)</ept>.","pos":[4890,5249],"source":"In order to update objects on the UI thread from the [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event handler, such as a [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) object, you must marshal the calls through the [**CoreDispatcher**](https://msdn.microsoft.com/library/windows/apps/br208211)."},{"content":"This is because the <bpt id=\"p1\">**</bpt>ButtonPressed<ept id=\"p1\">**</ept> event handler is not called from the UI thread and therefore an exception will be thrown if you attempt to modify the UI directly.","pos":[5250,5418],"source":" This is because the **ButtonPressed** event handler is not called from the UI thread and therefore an exception will be thrown if you attempt to modify the UI directly."},{"pos":[5430,5471],"content":"SystemMediaTransportControlsButtonPressed"},{"content":"Update the system media transport controls with the current media status","pos":[5565,5637]},{"content":"You should notify the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept> when the state of the media has changed so that the system can update the controls to reflect the current state.","pos":[5639,5866],"source":"You should notify the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) when the state of the media has changed so that the system can update the controls to reflect the current state."},{"content":"To do this, set the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PlaybackStatus<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278719)</ept> property to the appropriate <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MediaPlaybackStatus<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn278665)</ept> value from within the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>CurrentStateChanged<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br227375)</ept> event of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>MediaElement<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/br242926)</ept>, which is raised when the media state changes.","pos":[5867,6320],"source":" To do this, set the [**PlaybackStatus**](https://msdn.microsoft.com/library/windows/apps/dn278719) property to the appropriate [**MediaPlaybackStatus**](https://msdn.microsoft.com/library/windows/apps/dn278665) value from within the [**CurrentStateChanged**](https://msdn.microsoft.com/library/windows/apps/br227375) event of the [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926), which is raised when the media state changes."},{"pos":[6332,6371],"content":"SystemMediaTransportControlsStateChange"},{"content":"Update the system media transport controls with media info and thumbnails","pos":[6463,6536]},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControlsDisplayUpdater<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278686)</ept> class to update the media info that is displayed by the transport controls, such as the song title or the album art for the currently playing media item.","pos":[6538,6806],"source":"Use the [**SystemMediaTransportControlsDisplayUpdater**](https://msdn.microsoft.com/library/windows/apps/dn278686) class to update the media info that is displayed by the transport controls, such as the song title or the album art for the currently playing media item."},{"content":"Get an instance of this class with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls.DisplayUpdater<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278707)</ept> property.","pos":[6807,6963],"source":" Get an instance of this class with the [**SystemMediaTransportControls.DisplayUpdater**](https://msdn.microsoft.com/library/windows/apps/dn278707) property."},{"content":"For typical scenarios, the recommended way to pass the metadata is to call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CopyFromFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278694)</ept>, passing in the currently playing media file.","pos":[6964,7166],"source":" For typical scenarios, the recommended way to pass the metadata is to call [**CopyFromFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn278694), passing in the currently playing media file."},{"content":"The display updater will automatically extract the metadata and thumbnail image from the file.","pos":[7167,7261]},{"pos":[7263,7441],"content":"Call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Update<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278701)</ept> to cause the system media transport controls to update its UI with the new metadata and thumbnail.","source":"Call the [**Update**](https://msdn.microsoft.com/library/windows/apps/dn278701) to cause the system media transport controls to update its UI with the new metadata and thumbnail."},{"pos":[7453,7488],"content":"SystemMediaTransportControlsUpdater"},{"pos":[7573,8071],"content":"If your scenario requires it, you can update the metadata displayed by the system media transport controls manually by setting the values of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MusicProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278696)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ImageProperties<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn278695)</ept>, or <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>VideoProperties<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn278702)</ept> objects exposed by the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>DisplayUpdater<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn278707)</ept> class.","source":"If your scenario requires it, you can update the metadata displayed by the system media transport controls manually by setting the values of the [**MusicProperties**](https://msdn.microsoft.com/library/windows/apps/dn278696), [**ImageProperties**](https://msdn.microsoft.com/library/windows/apps/dn278695), or [**VideoProperties**](https://msdn.microsoft.com/library/windows/apps/dn278702) objects exposed by the [**DisplayUpdater**](https://msdn.microsoft.com/library/windows/apps/dn278707) class."},{"pos":[8083,8124],"content":"SystemMediaTransportControlsUpdaterManual"},{"content":"Update the system media transport controls timeline properties","pos":[8211,8273]},{"content":"The system transport controls display information about the timeline of the currently playing media item, including the current playback position, the start time, and the end time of the media item.","pos":[8275,8473]},{"content":"To update the system transport controls timeline properties, create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControlsTimelineProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt218746)</ept> object.","pos":[8474,8666],"source":" To update the system transport controls timeline properties, create a new [**SystemMediaTransportControlsTimelineProperties**](https://msdn.microsoft.com/library/windows/apps/mt218746) object."},{"content":"Set the properties of the object to reflect the current state of the playing media item.","pos":[8667,8755]},{"content":"Call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls.UpdateTimelineProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt218760)</ept> to cause the controls to update the timeline.","pos":[8756,8924],"source":" Call [**SystemMediaTransportControls.UpdateTimelineProperties**](https://msdn.microsoft.com/library/windows/apps/mt218760) to cause the controls to update the timeline."},{"pos":[8936,8960],"content":"UpdateTimelineProperties"},{"pos":[9038,9372],"content":"You must provide a value for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StartTime<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt218751)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>EndTime<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt218747)</ept> and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Position<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/mt218755)</ept> in order for the system controls to display a timeline for your playing item.","source":"You must provide a value for the [**StartTime**](https://msdn.microsoft.com/library/windows/apps/mt218751), [**EndTime**](https://msdn.microsoft.com/library/windows/apps/mt218747) and [**Position**](https://msdn.microsoft.com/library/windows/apps/mt218755) in order for the system controls to display a timeline for your playing item."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MinSeekTime<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt218749)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MaxSeekTime<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt218748)</ept> allow you to specify the range within the timeline that the user can seek.","pos":[9378,9608],"source":"[**MinSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218749) and [**MaxSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218748) allow you to specify the range within the timeline that the user can seek."},{"content":"A typical scenario for this is to allow content providers to include advertisement breaks in their media.","pos":[9609,9714]},{"pos":[9720,10005],"content":"You must set <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MinSeekTime<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt218749)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MaxSeekTime<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt218748)</ept> in order for the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>PositionChangeRequest<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/mt218755)</ept> to be raised.","source":"You must set [**MinSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218749) and [**MaxSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218748) in order for the [**PositionChangeRequest**](https://msdn.microsoft.com/library/windows/apps/mt218755) to be raised."},{"content":"It is recommended that you keep the system controls in sync with your media playback by updating these properties approximately every 5 seconds during playback and again whenever the state of playback changes, such as pausing or seeking to a new position.","pos":[10011,10266]},{"content":"Respond to player property changes","pos":[10271,10305]},{"content":"There is a set of system transport controls properties that relate to the current state of the media player itself, rather than the state of the playing media item.","pos":[10307,10471]},{"content":"Each of these properties is matched with an event that is raised when the user adjusts the associated control.","pos":[10472,10582]},{"content":"These properties and events include:","pos":[10583,10619]},{"content":"Property","pos":[10623,10631]},{"content":"Event","pos":[10699,10704]},{"content":"AutoRepeatMode","pos":[10994,11008]},{"content":"AutoRepeatModeChangeRequested","pos":[11075,11104]},{"content":"PlaybackRate","pos":[11173,11185]},{"content":"PlaybackRateChangeRequested","pos":[11256,11283]},{"content":"ShuffleEnabled","pos":[11356,11370]},{"content":"ShuffleEnabledChangeRequested","pos":[11437,11466]},{"content":"To handle user interaction with one of these controls, first register a handler for the associated event.","pos":[11533,11638]},{"pos":[11650,11680],"content":"RegisterPlaybackChangedHandler"},{"content":"In the handler for the event, first make sure that the requested value is within a valid and expected range.","pos":[11760,11868]},{"content":"If it is, set the corresponding property on <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MediaElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242926)</ept> and then set the corresponding property on the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SystemMediaTransportControls<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept> object.","pos":[11869,12137],"source":" If it is, set the corresponding property on [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) and then set the corresponding property on the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) object."},{"pos":[12149,12171],"content":"PlaybackChangedHandler"},{"content":"In order for one of these player property events to be raised, you must set an initial value for the property.","pos":[12247,12357]},{"content":"For example, <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PlaybackRateChangeRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt218757)</ept> will not be raised until after you have set a value for the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PlaybackRate<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt218756)</ept> property at least one time.","pos":[12358,12627],"source":" For example, [**PlaybackRateChangeRequested**](https://msdn.microsoft.com/library/windows/apps/mt218757) will not be raised until after you have set a value for the [**PlaybackRate**](https://msdn.microsoft.com/library/windows/apps/mt218756) property at least one time."},{"content":"Use the system media transport controls for background audio","pos":[12632,12692]},{"content":"To use the system media transport controls for background audio, you must enable the play and pause buttons by setting <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IsPlayEnabled<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278714)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IsPauseEnabled<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn278713)</ept> to true.","pos":[12694,12982],"source":"To use the system media transport controls for background audio, you must enable the play and pause buttons by setting [**IsPlayEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278714) and [**IsPauseEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278713) to true."},{"content":"Your app must also handle the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ButtonPressed<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278706)</ept> event.","pos":[12983,13097],"source":" Your app must also handle the [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event."},{"pos":[13099,13539],"content":"To get an instance of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemMediaTransportControls<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278677)</ept> from within your app's background task, you must use <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>BackgroundMediaPlayer.Current.SystemMediaTransportControls<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn926635)</ept> instead of <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>GetForCurrentView<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn278708)</ept>, which can only be used from within your foreground app.","source":"To get an instance of [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) from within your app's background task, you must use [**BackgroundMediaPlayer.Current.SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn926635) instead of [**GetForCurrentView**](https://msdn.microsoft.com/library/windows/apps/dn278708), which can only be used from within your foreground app."},{"pos":[13541,13642],"content":"For more information on playing audio in the background, see <bpt id=\"p1\">[</bpt>Background audio<ept id=\"p1\">](background-audio.md)</ept>.","source":"For more information on playing audio in the background, see [Background audio](background-audio.md)."}],"content":"---\nms.assetid: EFCF84D0-2F4C-454D-97DA-249E9EAA806C\ndescription: The SystemMediaTransportControls class enables your app to use the system media transport controls that are built into Windows and to update the metadata that the controls display about the media your app is currently playing.\ntitle: System Media Transport Controls\n---\n\n# System Media Transport Controls\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nThe [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) class enables your app to use the system media transport controls that are built into Windows and to update the metadata that the controls display about the media your app is currently playing.\n\nThe system transport controls are different than the transport controls on the [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) object. The system transport controls are the controls that pop up when hardware media keys are pressed, such as the volume control on a pair of headphones or the media buttons on keyboards. If the user presses the pause key on a keyboard and your app supports the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677), your app is notified and you can take the appropriate action.\n\nYour app can also update the media info, such as the song title and thumbnail image that the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) displays.\n\n**Note**  \nThe [System Media Transport Controls UWP sample](http://go.microsoft.com/fwlink/?LinkId=619488) implements the code discussed in this overview. You can download the sample to see the code in context or to use as a starting point for your own app.\n\n## Set up transport controls\n\nIn the page's XAML file, define a [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) that will be controlled by the system media transport controls. The [**CurrentStateChanged**](https://msdn.microsoft.com/library/windows/apps/br227375) and [**MediaOpened**](https://msdn.microsoft.com/library/windows/apps/br227394) events are used to update the system media transport controls and will be discussed later in this article.\n\n[!code-xml[MediaElementSystemMediaTransportControls](./code/SMTCWin10/cs/MainPage.xaml#SnippetMediaElementSystemMediaTransportControls)]\n\nAdd a button to the XAML file that allows the user to select a file to play.\n\n[!code-xml[OpenButton](./code/SMTCWin10/cs/MainPage.xaml#SnippetOpenButton)]\n\nIn your code behind page, add using directives for the following namespaces.\n\n[!code-cs[Namespace](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetNamespace)]\n\nAdd a button click handler that uses a [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) to allow the user to select a file, then call [**SetSource**](https://msdn.microsoft.com/library/windows/apps/br244338) to make it the active file for the **MediaElement**.\n\n[!code-cs[OpenMediaFile](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetOpenMediaFile)]\n\nGet an instance of the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) by calling [**GetForCurrentView**](https://msdn.microsoft.com/library/windows/apps/dn278708).\n\nEnable the buttons that your app will use by setting the corresponding \"is enabled\" property of the **SystemMediaTransportControls** object, such as [**IsPlayEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278714), [**IsPauseEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278713), [**IsNextEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278712), and [**IsPreviousEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278715). See the **SystemMediaTransportControls** reference documentation for a complete list of available controls.\n\nRegister a handler for the [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event to receive notifications when the user presses a button.\n\n[!code-cs[SystemMediaTransportControlsSetup](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetSystemMediaTransportControlsSetup)]\n\n## Handle system media transport controls button presses\n\nThe [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event is raised by the system transport controls when one of the enabled buttons is pressed. The [**Button**](https://msdn.microsoft.com/library/windows/apps/dn278685) property of the [**SystemMediaTransportControlsButtonPressedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn278683) passed into the event handler is a member of the [**SystemMediaTransportControlsButton**](https://msdn.microsoft.com/library/windows/apps/dn278681) enumeration that indicates which of the enabled buttons was pressed.\n\nIn order to update objects on the UI thread from the [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event handler, such as a [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) object, you must marshal the calls through the [**CoreDispatcher**](https://msdn.microsoft.com/library/windows/apps/br208211). This is because the **ButtonPressed** event handler is not called from the UI thread and therefore an exception will be thrown if you attempt to modify the UI directly.\n\n[!code-cs[SystemMediaTransportControlsButtonPressed](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetSystemMediaTransportControlsButtonPressed)]\n\n## Update the system media transport controls with the current media status\n\nYou should notify the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) when the state of the media has changed so that the system can update the controls to reflect the current state. To do this, set the [**PlaybackStatus**](https://msdn.microsoft.com/library/windows/apps/dn278719) property to the appropriate [**MediaPlaybackStatus**](https://msdn.microsoft.com/library/windows/apps/dn278665) value from within the [**CurrentStateChanged**](https://msdn.microsoft.com/library/windows/apps/br227375) event of the [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926), which is raised when the media state changes.\n\n[!code-cs[SystemMediaTransportControlsStateChange](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetSystemMediaTransportControlsStateChange)]\n\n## Update the system media transport controls with media info and thumbnails\n\nUse the [**SystemMediaTransportControlsDisplayUpdater**](https://msdn.microsoft.com/library/windows/apps/dn278686) class to update the media info that is displayed by the transport controls, such as the song title or the album art for the currently playing media item. Get an instance of this class with the [**SystemMediaTransportControls.DisplayUpdater**](https://msdn.microsoft.com/library/windows/apps/dn278707) property. For typical scenarios, the recommended way to pass the metadata is to call [**CopyFromFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn278694), passing in the currently playing media file. The display updater will automatically extract the metadata and thumbnail image from the file.\n\nCall the [**Update**](https://msdn.microsoft.com/library/windows/apps/dn278701) to cause the system media transport controls to update its UI with the new metadata and thumbnail.\n\n[!code-cs[SystemMediaTransportControlsUpdater](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetSystemMediaTransportControlsUpdater)]\n\nIf your scenario requires it, you can update the metadata displayed by the system media transport controls manually by setting the values of the [**MusicProperties**](https://msdn.microsoft.com/library/windows/apps/dn278696), [**ImageProperties**](https://msdn.microsoft.com/library/windows/apps/dn278695), or [**VideoProperties**](https://msdn.microsoft.com/library/windows/apps/dn278702) objects exposed by the [**DisplayUpdater**](https://msdn.microsoft.com/library/windows/apps/dn278707) class.\n\n[!code-cs[SystemMediaTransportControlsUpdaterManual](./code/SMTCWin10/cs/MainPage.xaml.cs#SystemMediaTransportControlsUpdaterManual)]\n\n## Update the system media transport controls timeline properties\n\nThe system transport controls display information about the timeline of the currently playing media item, including the current playback position, the start time, and the end time of the media item. To update the system transport controls timeline properties, create a new [**SystemMediaTransportControlsTimelineProperties**](https://msdn.microsoft.com/library/windows/apps/mt218746) object. Set the properties of the object to reflect the current state of the playing media item. Call [**SystemMediaTransportControls.UpdateTimelineProperties**](https://msdn.microsoft.com/library/windows/apps/mt218760) to cause the controls to update the timeline.\n\n[!code-cs[UpdateTimelineProperties](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetUpdateTimelineProperties)]\n\n-   You must provide a value for the [**StartTime**](https://msdn.microsoft.com/library/windows/apps/mt218751), [**EndTime**](https://msdn.microsoft.com/library/windows/apps/mt218747) and [**Position**](https://msdn.microsoft.com/library/windows/apps/mt218755) in order for the system controls to display a timeline for your playing item.\n\n-   [**MinSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218749) and [**MaxSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218748) allow you to specify the range within the timeline that the user can seek. A typical scenario for this is to allow content providers to include advertisement breaks in their media.\n\n    You must set [**MinSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218749) and [**MaxSeekTime**](https://msdn.microsoft.com/library/windows/apps/mt218748) in order for the [**PositionChangeRequest**](https://msdn.microsoft.com/library/windows/apps/mt218755) to be raised.\n\n-   It is recommended that you keep the system controls in sync with your media playback by updating these properties approximately every 5 seconds during playback and again whenever the state of playback changes, such as pausing or seeking to a new position.\n\n## Respond to player property changes\n\nThere is a set of system transport controls properties that relate to the current state of the media player itself, rather than the state of the playing media item. Each of these properties is matched with an event that is raised when the user adjusts the associated control. These properties and events include:\n\n| Property                                                                  | Event                                                                                                   |\n|---------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|\n| [**AutoRepeatMode**](https://msdn.microsoft.com/library/windows/apps/mt218753) | [**AutoRepeatModeChangeRequested**](https://msdn.microsoft.com/library/windows/apps/mt218754) |\n| [**PlaybackRate**](https://msdn.microsoft.com/library/windows/apps/mt218756)     | [**PlaybackRateChangeRequested**](https://msdn.microsoft.com/library/windows/apps/mt218757)     |\n| [**ShuffleEnabled**](https://msdn.microsoft.com/library/windows/apps/mt218758) | [**ShuffleEnabledChangeRequested**](https://msdn.microsoft.com/library/windows/apps/mt218759) |\n\n \nTo handle user interaction with one of these controls, first register a handler for the associated event.\n\n[!code-cs[RegisterPlaybackChangedHandler](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetRegisterPlaybackChangedHandler)]\n\nIn the handler for the event, first make sure that the requested value is within a valid and expected range. If it is, set the corresponding property on [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) and then set the corresponding property on the [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) object.\n\n[!code-cs[PlaybackChangedHandler](./code/SMTCWin10/cs/MainPage.xaml.cs#SnippetPlaybackChangedHandler)]\n\n-   In order for one of these player property events to be raised, you must set an initial value for the property. For example, [**PlaybackRateChangeRequested**](https://msdn.microsoft.com/library/windows/apps/mt218757) will not be raised until after you have set a value for the [**PlaybackRate**](https://msdn.microsoft.com/library/windows/apps/mt218756) property at least one time.\n\n## Use the system media transport controls for background audio\n\nTo use the system media transport controls for background audio, you must enable the play and pause buttons by setting [**IsPlayEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278714) and [**IsPauseEnabled**](https://msdn.microsoft.com/library/windows/apps/dn278713) to true. Your app must also handle the [**ButtonPressed**](https://msdn.microsoft.com/library/windows/apps/dn278706) event.\n\nTo get an instance of [**SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn278677) from within your app's background task, you must use [**BackgroundMediaPlayer.Current.SystemMediaTransportControls**](https://msdn.microsoft.com/library/windows/apps/dn926635) instead of [**GetForCurrentView**](https://msdn.microsoft.com/library/windows/apps/dn278708), which can only be used from within your foreground app.\n\nFor more information on playing audio in the background, see [Background audio](background-audio.md).\n\n \n\n \n\n\n\n\n"}