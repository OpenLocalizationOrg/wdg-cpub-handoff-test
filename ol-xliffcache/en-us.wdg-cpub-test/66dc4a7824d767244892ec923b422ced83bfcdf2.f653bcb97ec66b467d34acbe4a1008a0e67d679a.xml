{"nodes":[{"pos":[60,90],"content":"Customize the print preview UI","needQuote":true,"needEscape":true,"nodes":[{"content":"Customize the print preview UI","pos":[0,30]}]},{"pos":[104,199],"content":"This section describes how to customize the print options and settings in the print preview UI.","needQuote":true,"needEscape":true,"nodes":[{"content":"This section describes how to customize the print options and settings in the print preview UI.","pos":[0,95]}]},{"content":"Customize the print preview UI","pos":[206,236]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[238,276]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[277,372],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[378,392]},{"content":"Windows.Graphics.Printing","pos":[404,429]},{"content":"Windows.UI.Xaml.Printing","pos":[498,522]},{"content":"PrintManager","pos":[591,603]},{"content":"This section describes how to customize the print options and settings in the print preview UI.","pos":[666,761]},{"content":"For more info about printing, see <bpt id=\"p1\">[</bpt>Print from your app<ept id=\"p1\">](print-from-your-app.md)</ept>.","pos":[762,842],"source":" For more info about printing, see [Print from your app](print-from-your-app.md)."},{"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>  Most of the examples in this topic are based on the print sample.","pos":[844,918],"source":"**Tip**  Most of the examples in this topic are based on the print sample."},{"content":"To see the full code, download the <bpt id=\"p1\">[</bpt>Universal Windows Platform (UWP) print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept> from the <bpt id=\"p2\">[</bpt>Windows-universal-samples repo<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=619979)</ept> on GitHub.","pos":[919,1152],"source":" To see the full code, download the [Universal Windows Platform (UWP) print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) from the [Windows-universal-samples repo](http://go.microsoft.com/fwlink/p/?LinkId=619979) on GitHub."},{"content":"Customize print options","pos":[1160,1183]},{"content":"By default, the print preview UI shows the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ColorMode<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226478)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Copies<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR226479)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Orientation<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR226486)</ept> print options.","pos":[1185,1469],"source":"By default, the print preview UI shows the [**ColorMode**](https://msdn.microsoft.com/library/windows/apps/BR226478), [**Copies**](https://msdn.microsoft.com/library/windows/apps/BR226479), and [**Orientation**](https://msdn.microsoft.com/library/windows/apps/BR226486) print options."},{"content":"In addition to those, there are several other common printer options that you can add to the print preview UI:","pos":[1470,1580]},{"content":"Binding","pos":[1589,1596]},{"content":"Collation","pos":[1665,1674]},{"content":"Duplex","pos":[1743,1749]},{"content":"HolePunch","pos":[1818,1827]},{"content":"InputBin","pos":[1896,1904]},{"content":"MediaSize","pos":[1973,1982]},{"content":"MediaType","pos":[2051,2060]},{"content":"NUp","pos":[2129,2132]},{"content":"PrintQuality","pos":[2201,2213]},{"content":"Staple","pos":[2282,2288]},{"content":"These options are defined in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StandardPrintTaskOptions<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226475)</ept> class.","pos":[2351,2479],"source":"These options are defined in the [**StandardPrintTaskOptions**](https://msdn.microsoft.com/library/windows/apps/BR226475) class."},{"content":"You can add to or remove options from the list of options displayed in the print preview UI.","pos":[2480,2572]},{"content":"You can also change the order in which they appear, and set the default settings that are shown to the user.","pos":[2573,2681]},{"content":"However, the modifications that you make by using this method affect only the print preview UI.","pos":[2683,2778]},{"content":"The user can always access all of the options that the printer supports by tapping <bpt id=\"p1\">**</bpt>More settings<ept id=\"p1\">**</ept> in the print preview UI.","pos":[2779,2904],"source":" The user can always access all of the options that the printer supports by tapping **More settings** in the print preview UI."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Although your app can specify any print options to be displayed, only those that are supported by the selected printer are shown in the print preview UI.","pos":[2906,3069],"source":"**Note**  Although your app can specify any print options to be displayed, only those that are supported by the selected printer are shown in the print preview UI."},{"content":"The print UI won't show options that the selected printer doesn't support.","pos":[3070,3144]},{"content":"Define the options to display","pos":[3153,3182]},{"content":"When the app's screen is loaded, it registers for the Print contract.","pos":[3184,3253]},{"content":"Part of that registration includes defining the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintTaskRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br206597)</ept> event handler.","pos":[3254,3399],"source":" Part of that registration includes defining the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler."},{"content":"The code to customize the options displayed in the print preview UI is added to the <bpt id=\"p1\">**</bpt>PrintTaskRequested<ept id=\"p1\">**</ept> event handler.","pos":[3400,3521],"source":" The code to customize the options displayed in the print preview UI is added to the **PrintTaskRequested** event handler."},{"pos":[3523,4065],"content":"Modify the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintTaskRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br206597)</ept> event handler to include the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>printTask.options<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR226469)</ept> instructions that configure the print settings that you want to display in the print preview UI.For the screen in your app for which you want to show a customized list of print options, override the <bpt id=\"p5\">**</bpt>PrintTaskRequested<ept id=\"p5\">**</ept> event handler in the helper class to include code that specifies the options to display when the screen is printed.","source":"Modify the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler to include the [**printTask.options**](https://msdn.microsoft.com/library/windows/apps/BR226469) instructions that configure the print settings that you want to display in the print preview UI.For the screen in your app for which you want to show a customized list of print options, override the **PrintTaskRequested** event handler in the helper class to include code that specifies the options to display when the screen is printed."},{"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>  Calling <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>displayedOptions.clear<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR226453)</ept>() removes all of the print options from the print preview UI, including the <bpt id=\"p4\">**</bpt>More settings<ept id=\"p4\">**</ept> link.","pos":[5828,6037],"source":"**Important**  Calling [**displayedOptions.clear**](https://msdn.microsoft.com/library/windows/apps/BR226453)() removes all of the print options from the print preview UI, including the **More settings** link."},{"content":"Be sure to append the options that you want to show on the print preview UI.","pos":[6038,6114]},{"content":"Specify default options","pos":[6120,6143]},{"content":"You can also set the default values of the options in the print preview UI.","pos":[6145,6220]},{"content":"The following line of code, from the last example, sets the default value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MediaSize<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226483)</ept> option.","pos":[6221,6383],"source":" The following line of code, from the last example, sets the default value of the [**MediaSize**](https://msdn.microsoft.com/library/windows/apps/BR226483) option."},{"content":"Add new print options","pos":[6545,6566]},{"content":"This section shows how to create a new print option, define a list of values that the option supports, and then add the option to the print preview.","pos":[6568,6716]},{"content":"As in the previous section, add the new print option in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintTaskRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br206597)</ept> event handler.","pos":[6717,6874],"source":" As in the previous section, add the new print option in the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler."},{"content":"First, get a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintTaskOptionDetails<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh701256)</ept> object.","pos":[6876,6983],"source":"First, get a [**PrintTaskOptionDetails**](https://msdn.microsoft.com/library/windows/apps/Hh701256) object."},{"content":"This is used to add the new print option to the print preview UI.","pos":[6984,7049]},{"content":"Then clear the list of options that are shown in the print preview UI and add the options that you want to display when the user wants to print from the app.","pos":[7050,7207]},{"content":"After that, create the new print option and initialize the list of option values.","pos":[7208,7289]},{"content":"Finally, add the new option and assign a handler for the <bpt id=\"p1\">**</bpt>OptionChanged<ept id=\"p1\">**</ept> event.","pos":[7290,7371],"source":" Finally, add the new option and assign a handler for the **OptionChanged** event."},{"content":"The options appear in the print preview UI in the same order they are appended, with the first option shown at the top of the window.","pos":[9563,9696]},{"content":"In this example, the custom option is appended last so that it appears at the bottom of the list of options.","pos":[9697,9805]},{"content":"However, you could put it anywhere in the list; custom print options don't need to be added last.","pos":[9806,9903]},{"content":"When the user changes the selected option in your custom option, update the print preview image.","pos":[9905,10001]},{"content":"Call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>InvalidatePreview<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh702146)</ept> method to redraw the image in the print preview UI, as shown below.","pos":[10002,10160],"source":" Call the [**InvalidatePreview**](https://msdn.microsoft.com/library/windows/apps/Hh702146) method to redraw the image in the print preview UI, as shown below."},{"content":"Related topics","pos":[10679,10693]},{"content":"Design guidelines for printing","pos":[10698,10728]},{"content":"//Build 2015 video: Developing apps that print in Windows 10","pos":[10791,10851]},{"content":"UWP print sample","pos":[10906,10922]}],"content":"---\nms.assetid: 88132B6F-FB50-4B03-BC21-233988746230\ntitle: Customize the print preview UI\ndescription: This section describes how to customize the print options and settings in the print preview UI.\n---\n# Customize the print preview UI\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n** Important APIs **\n\n-   [**Windows.Graphics.Printing**](https://msdn.microsoft.com/library/windows/apps/BR226489)\n-   [**Windows.UI.Xaml.Printing**](https://msdn.microsoft.com/library/windows/apps/BR243325)\n-   [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426)\n\nThis section describes how to customize the print options and settings in the print preview UI. For more info about printing, see [Print from your app](print-from-your-app.md).\n\n**Tip**  Most of the examples in this topic are based on the print sample. To see the full code, download the [Universal Windows Platform (UWP) print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) from the [Windows-universal-samples repo](http://go.microsoft.com/fwlink/p/?LinkId=619979) on GitHub.\n\n \n\n## Customize print options\n\nBy default, the print preview UI shows the [**ColorMode**](https://msdn.microsoft.com/library/windows/apps/BR226478), [**Copies**](https://msdn.microsoft.com/library/windows/apps/BR226479), and [**Orientation**](https://msdn.microsoft.com/library/windows/apps/BR226486) print options. In addition to those, there are several other common printer options that you can add to the print preview UI:\n\n-   [**Binding**](https://msdn.microsoft.com/library/windows/apps/BR226476)\n-   [**Collation**](https://msdn.microsoft.com/library/windows/apps/BR226477)\n-   [**Duplex**](https://msdn.microsoft.com/library/windows/apps/BR226480)\n-   [**HolePunch**](https://msdn.microsoft.com/library/windows/apps/BR226481)\n-   [**InputBin**](https://msdn.microsoft.com/library/windows/apps/BR226482)\n-   [**MediaSize**](https://msdn.microsoft.com/library/windows/apps/BR226483)\n-   [**MediaType**](https://msdn.microsoft.com/library/windows/apps/BR226484)\n-   [**NUp**](https://msdn.microsoft.com/library/windows/apps/BR226485)\n-   [**PrintQuality**](https://msdn.microsoft.com/library/windows/apps/BR226487)\n-   [**Staple**](https://msdn.microsoft.com/library/windows/apps/BR226488)\n\nThese options are defined in the [**StandardPrintTaskOptions**](https://msdn.microsoft.com/library/windows/apps/BR226475) class. You can add to or remove options from the list of options displayed in the print preview UI. You can also change the order in which they appear, and set the default settings that are shown to the user.\n\nHowever, the modifications that you make by using this method affect only the print preview UI. The user can always access all of the options that the printer supports by tapping **More settings** in the print preview UI.\n\n**Note**  Although your app can specify any print options to be displayed, only those that are supported by the selected printer are shown in the print preview UI. The print UI won't show options that the selected printer doesn't support.\n\n \n\n### Define the options to display\n\nWhen the app's screen is loaded, it registers for the Print contract. Part of that registration includes defining the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler. The code to customize the options displayed in the print preview UI is added to the **PrintTaskRequested** event handler.\n\nModify the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler to include the [**printTask.options**](https://msdn.microsoft.com/library/windows/apps/BR226469) instructions that configure the print settings that you want to display in the print preview UI.For the screen in your app for which you want to show a customized list of print options, override the **PrintTaskRequested** event handler in the helper class to include code that specifies the options to display when the screen is printed.\n\n``` csharp\nprotected override void PrintTaskRequested(PrintManager sender, PrintTaskRequestedEventArgs e)\n{\n   PrintTask printTask = null;\n   printTask = e.Request.CreatePrintTask(&quot;C# Printing SDK Sample&quot;, sourceRequestedArgs =&gt;\n   {\n         IList&lt;string&gt; displayedOptions = printTask.Options.DisplayedOptions;\n\n         // Choose the printer options to be shown.\n         // The order in which the options are appended determines the order in which they appear in the UI\n         displayedOptions.Clear();\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Copies);\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Orientation);\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.MediaSize);\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Collation);\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Duplex);\n\n         // Preset the default value of the printer option\n         printTask.Options.MediaSize = PrintMediaSize.NorthAmericaLegal;\n\n         // Print Task event handler is invoked when the print job is completed.\n         printTask.Completed += async (s, args) =&gt;\n         {\n            // Notify the user when the print operation fails.\n            if (args.Completion == PrintTaskCompletion.Failed)\n            {\n               await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =&gt;\n               {\n                     MainPage.Current.NotifyUser(&quot;Failed to print.&quot;, NotifyType.ErrorMessage);\n               });\n            }\n         };\n\n         sourceRequestedArgs.SetSource(printDocumentSource);\n   });\n}\n```\n\n**Important**  Calling [**displayedOptions.clear**](https://msdn.microsoft.com/library/windows/apps/BR226453)() removes all of the print options from the print preview UI, including the **More settings** link. Be sure to append the options that you want to show on the print preview UI.\n\n### Specify default options\n\nYou can also set the default values of the options in the print preview UI. The following line of code, from the last example, sets the default value of the [**MediaSize**](https://msdn.microsoft.com/library/windows/apps/BR226483) option.\n\n``` csharp\n         // Preset the default value of the printer option\n         printTask.Options.MediaSize = PrintMediaSize.NorthAmericaLegal;\n```         \n\n## Add new print options\n\nThis section shows how to create a new print option, define a list of values that the option supports, and then add the option to the print preview. As in the previous section, add the new print option in the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler.\n\nFirst, get a [**PrintTaskOptionDetails**](https://msdn.microsoft.com/library/windows/apps/Hh701256) object. This is used to add the new print option to the print preview UI. Then clear the list of options that are shown in the print preview UI and add the options that you want to display when the user wants to print from the app. After that, create the new print option and initialize the list of option values. Finally, add the new option and assign a handler for the **OptionChanged** event.\n\n``` csharp\nprotected override void PrintTaskRequested(PrintManager sender, PrintTaskRequestedEventArgs e)\n{\n   PrintTask printTask = null;\n   printTask = e.Request.CreatePrintTask(&quot;C# Printing SDK Sample&quot;, sourceRequestedArgs =&gt;\n   {\n         PrintTaskOptionDetails printDetailedOptions = PrintTaskOptionDetails.GetFromPrintTaskOptions(printTask.Options);\n         IList&lt;string&gt; displayedOptions = printDetailedOptions.DisplayedOptions;\n\n         // Choose the printer options to be shown.\n         // The order in which the options are appended determines the order in which they appear in the UI\n         displayedOptions.Clear();\n\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Copies);\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Orientation);\n         displayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.ColorMode);\n\n         // Create a new list option\n         PrintCustomItemListOptionDetails pageFormat = printDetailedOptions.CreateItemListOption(&quot;PageContent&quot;, &quot;Pictures&quot;);\n         pageFormat.AddItem(&quot;PicturesText&quot;, &quot;Pictures and text&quot;);\n         pageFormat.AddItem(&quot;PicturesOnly&quot;, &quot;Pictures only&quot;);\n         pageFormat.AddItem(&quot;TextOnly&quot;, &quot;Text only&quot;);\n\n         // Add the custom option to the option list\n         displayedOptions.Add(&quot;PageContent&quot;);\n\n         printDetailedOptions.OptionChanged += printDetailedOptions_OptionChanged;\n\n         // Print Task event handler is invoked when the print job is completed.\n         printTask.Completed += async (s, args) =&gt;\n         {\n            // Notify the user when the print operation fails.\n            if (args.Completion == PrintTaskCompletion.Failed)\n            {\n               await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =&gt;\n               {\n                     MainPage.Current.NotifyUser(&quot;Failed to print.&quot;, NotifyType.ErrorMessage);\n               });\n            }\n         };\n\n         sourceRequestedArgs.SetSource(printDocumentSource);\n   });\n}\n```\n\nThe options appear in the print preview UI in the same order they are appended, with the first option shown at the top of the window. In this example, the custom option is appended last so that it appears at the bottom of the list of options. However, you could put it anywhere in the list; custom print options don't need to be added last.\n\nWhen the user changes the selected option in your custom option, update the print preview image. Call the [**InvalidatePreview**](https://msdn.microsoft.com/library/windows/apps/Hh702146) method to redraw the image in the print preview UI, as shown below.\n\n``` csharp\nasync void printDetailedOptions_OptionChanged(PrintTaskOptionDetails sender, PrintTaskOptionChangedEventArgs args)\n{\n   // Listen for PageContent changes\n   string optionId = args.OptionId as string;\n   if (string.IsNullOrEmpty(optionId))\n   {\n         return;\n   }\n\n   if (optionId == &quot;PageContent&quot;)\n   {\n         await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =&gt;\n         {\n            printDocument.InvalidatePreview();\n         });\n   }\n}\n```\n\n## Related topics\n\n* [Design guidelines for printing](https://msdn.microsoft.com/library/windows/apps/Hh868178)\n* [//Build 2015 video: Developing apps that print in Windows 10](https://channel9.msdn.com/Events/Build/2015/2-94)\n* [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)\n\n"}