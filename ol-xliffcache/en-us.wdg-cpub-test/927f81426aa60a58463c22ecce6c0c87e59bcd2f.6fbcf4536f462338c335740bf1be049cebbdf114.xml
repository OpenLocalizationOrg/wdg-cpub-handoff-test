{"nodes":[{"pos":[11,91],"content":"Deploy Windows 10 to Surface devices with Microsoft Deployment Toolkit (Surface)","needQuote":true,"nodes":[{"content":"Deploy Windows 10 to Surface devices with Microsoft Deployment Toolkit (Surface)","pos":[0,80]}]},{"pos":[105,232],"content":"Walk through the recommended process of how to deploy Windows 10 to your Surface devices with the Microsoft Deployment Toolkit.","needQuote":true,"nodes":[{"content":"Walk through the recommended process of how to deploy Windows 10 to your Surface devices with the Microsoft Deployment Toolkit.","pos":[0,127]}]},{"pos":[243,287],"content":"windows 10 surface, automate, customize, mdt","needQuote":true,"nodes":[{"content":"windows 10 surface, automate, customize, mdt","pos":[0,44]}]},{"content":"Deploy Windows 10 to Surface devices with Microsoft Deployment Toolkit","pos":[388,458]},{"content":"Applies to","pos":[465,475]},{"content":"Surface Pro 4","pos":[478,491]},{"content":"Surface Book","pos":[494,506]},{"content":"Surface 3","pos":[509,518]},{"content":"Windows 10","pos":[521,531]},{"content":"This article walks you through the recommended process to deploy Windows 10 to Surface devices with Microsoft deployment technologies.","pos":[533,667]},{"content":"The process described in this article yields a complete Windows 10 environment including updated firmware and drivers for your Surface device along with applications like Microsoft Office 365 and the Surface app.","pos":[668,880]},{"content":"When the process is complete, the Surface device will be ready for use by the end user.","pos":[881,968]},{"content":"You can customize this process to include your own applications and configuration to meet the needs of your organization.","pos":[969,1090]},{"content":"You can also follow the guidance provided in this article to integrate deployment to Surface devices into existing deployment strategies.","pos":[1091,1228]},{"content":"By following the procedures in this article, you can create an up-to-date reference image and deploy this image to your Surface devices, a process known as <bpt id=\"p1\">*</bpt>reimaging<ept id=\"p1\">*</ept>.","pos":[1230,1398],"source":"By following the procedures in this article, you can create an up-to-date reference image and deploy this image to your Surface devices, a process known as *reimaging*."},{"content":"Reimaging will erase and overwrite the existing environment on your Surface devices.","pos":[1399,1483]},{"content":"This process allows you to rapidly configure your Surface devices with identical environments that can be configured to precisely fit your organization’s requirements.","pos":[1484,1651]},{"content":"An alternative to the reimaging process is an upgrade process.","pos":[1654,1716]},{"content":"The upgrade process is non-destructive and instead of erasing the existing environment on your Surface device, it allows you to install Windows 10 while retaining your user data, applications, and settings.","pos":[1717,1923]},{"content":"You can read about how to manage and automate the upgrade process of Surface devices to Windows 10 at <bpt id=\"p1\">[</bpt>Upgrade Surface devices to Windows 10 with MDT<ept id=\"p1\">](upgrade-surface-devices-to-windows-10-with-mdt.md)</ept>.","pos":[1924,2126],"source":" You can read about how to manage and automate the upgrade process of Surface devices to Windows 10 at [Upgrade Surface devices to Windows 10 with MDT](upgrade-surface-devices-to-windows-10-with-mdt.md)."},{"content":"The goal of the deployment process presented in this article is automation.","pos":[2129,2204]},{"content":"By leveraging the many technologies and tools available from Microsoft, you can create a process that requires only a single touch on the devices being deployed.","pos":[2205,2366]},{"content":"The automation can load the deployment environment; format the device; prepare an updated Windows image with the drivers required for the device; apply that image to the device; configure the Windows environment with licensing, membership in a domain, and user accounts; install applications; apply any Windows updates that were not included in the reference image; and log out.","pos":[2367,2745]},{"content":"By automating each aspect of the deployment process, you not only greatly decrease the effort involved, but you create a process that can be easily repeated and where human error becomes less of a factor.","pos":[2747,2951]},{"content":"Take for example a scenario where you create a reference image for the device manually, but you accidentally install conflicting applications and cause the image to become unstable.","pos":[2952,3133]},{"content":"In this scenario you have no choice but to begin again the manual process of creating your image.","pos":[3134,3231]},{"content":"If in this same scenario you had automated the reference image creation process, you could repair the conflict by simply editing a step in the task sequence and then re-running the task sequence.","pos":[3232,3427]},{"content":"Deployment tools","pos":[3432,3448]},{"content":"The deployment process described in this article leverages a number of Microsoft deployment tools and technologies.","pos":[3450,3565]},{"content":"Some of these tools and technologies are included in Windows client and Windows Server, such as Hyper-V and Windows Deployment Services (WDS), while others are available as free downloads from the <bpt id=\"p1\">[</bpt>Microsoft Download Center<ept id=\"p1\">](https://www.microsoft.com/en-us/download/windows.aspx)</ept>.","pos":[3566,3846],"source":" Some of these tools and technologies are included in Windows client and Windows Server, such as Hyper-V and Windows Deployment Services (WDS), while others are available as free downloads from the [Microsoft Download Center](https://www.microsoft.com/en-us/download/windows.aspx)."},{"content":"Microsoft Deployment Toolkit","pos":[3853,3881]},{"content":"The Microsoft Deployment Toolkit (MDT) is the primary component of a Windows deployment.","pos":[3883,3971]},{"content":"It serves as a unified interface for most of the Microsoft deployment tools and technologies, such as the Windows Assessment and Deployment Kit (Windows ADK), Windows System Image Manager (Windows SIM), Deployment Image Servicing and Management (DISM), User State Migration Tool (USMT), and many other tools and technologies.","pos":[3972,4297]},{"content":"Each of these is discussed throughout this article.","pos":[4298,4349]},{"content":"The unified interface, called the <bpt id=\"p1\">*</bpt>Deployment Workbench<ept id=\"p1\">*</ept>, facilitates automation of the deployment process through a series of stored deployment procedures, known as a <bpt id=\"p2\">*</bpt>task sequence<ept id=\"p2\">*</ept>.","pos":[4350,4534],"source":" The unified interface, called the *Deployment Workbench*, facilitates automation of the deployment process through a series of stored deployment procedures, known as a *task sequence*."},{"content":"Along with these task sequences and the many scripts and tools that MDT provides, the resources for a Windows deployment (driver files, application installation files, and image files) are stored in a network share known as the <bpt id=\"p1\">*</bpt>deployment share<ept id=\"p1\">*</ept>.","pos":[4535,4782],"source":" Along with these task sequences and the many scripts and tools that MDT provides, the resources for a Windows deployment (driver files, application installation files, and image files) are stored in a network share known as the *deployment share*."},{"pos":[4785,4918],"content":"You can download and find out more about MDT at <bpt id=\"p1\">[</bpt>Microsoft Deployment Toolkit<ept id=\"p1\">](https://technet.microsoft.com/en-us/windows/dn475741)</ept>.","source":"You can download and find out more about MDT at [Microsoft Deployment Toolkit](https://technet.microsoft.com/en-us/windows/dn475741)."},{"content":"Windows Assessment and Deployment Kit","pos":[4925,4962]},{"content":"Although MDT is the tool you will interact with most during the deployment process, the deployment tools found in the Windows ADK perform most of the deployment tasks during the deployment process.","pos":[4964,5161]},{"content":"The resources for deployment are held within the MDT deployment share, but it is the collection of tools included in Windows ADK that access the image files, stage drivers and Windows updates, run the deployment experience, provide instructions to Windows Setup, and back up and restore user data.","pos":[5162,5459]},{"pos":[5461,5649],"content":"You can download and find out more about the Windows ADK at <bpt id=\"p1\">[</bpt>Download the Windows ADK<ept id=\"p1\">](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#windowsadk)</ept>.","source":"You can download and find out more about the Windows ADK at [Download the Windows ADK](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#windowsadk)."},{"content":"Windows 10 installation media","pos":[5656,5685]},{"content":"Before you can perform a deployment with MDT, you must first supply a set of operating system installation files and an operating system image.","pos":[5687,5830]},{"content":"These files and image can be found on the physical installation media (DVD) for Windows 10.","pos":[5831,5922]},{"content":"You can also find these files in the disk image (ISO file) for Windows 10, which you can download from the <bpt id=\"p1\">[</bpt>Volume Licensing Service Center (VLSC)<ept id=\"p1\">](https://www.microsoft.com/Licensing/servicecenter/default.aspx)</ept>.","pos":[5923,6135],"source":" You can also find these files in the disk image (ISO file) for Windows 10, which you can download from the [Volume Licensing Service Center (VLSC)](https://www.microsoft.com/Licensing/servicecenter/default.aspx)."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The installation media generated from the <bpt id=\"p2\">[</bpt>Get Windows 10<ept id=\"p2\">](https://www.microsoft.com/en-us/software-download/windows10/)</ept> page differs from physical media or media downloaded from the VLSC, in that it contains an image file in Electronic Software Download (ESD) format rather than in the Windows Imaging (WIM) format.","pos":[6138,6475],"source":"**Note:**&nbsp;&nbsp;The installation media generated from the [Get Windows 10](https://www.microsoft.com/en-us/software-download/windows10/) page differs from physical media or media downloaded from the VLSC, in that it contains an image file in Electronic Software Download (ESD) format rather than in the Windows Imaging (WIM) format."},{"content":"Installation media with an image file in WIM format is required for use with MDT.","pos":[6476,6557]},{"content":"Installation media from the Get Windows 10 page cannot be used for Windows deployment with MDT.","pos":[6558,6653]},{"content":"Windows Server","pos":[6660,6674]},{"content":"Although MDT can be installed on a Windows client, to take full advantage of Windows Deployment Services’ ability to network boot, a full Windows Server environment is recommended.","pos":[6676,6856]},{"content":"To provide network boot for UEFI devices like Surface with WDS, you will need Windows Server 2008 R2 or later.","pos":[6857,6967]},{"pos":[6970,7286],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>To evaluate the deployment process for Surface devices or to test the deployment process described in this article with the upcoming release of Windows Server 2016, you can download evaluation and preview versions from the <bpt id=\"p2\">[</bpt>TechNet Evaluation Center<ept id=\"p2\">](https://www.microsoft.com/en-us/evalcenter)</ept>.","source":"**Note:**&nbsp;&nbsp;To evaluate the deployment process for Surface devices or to test the deployment process described in this article with the upcoming release of Windows Server 2016, you can download evaluation and preview versions from the [TechNet Evaluation Center](https://www.microsoft.com/en-us/evalcenter)."},{"content":"Windows Deployment Services","pos":[7293,7320]},{"content":"Windows Deployment Services (WDS) is leveraged to facilitate network boot capabilities provided by the Preboot Execution Environment (PXE) server.","pos":[7322,7468]},{"content":"The boot media generated by MDT is loaded onto the Surface device simply by pressing Enter at the prompt when the device attempts to boot from the attached network adapter or Surface Dock.","pos":[7469,7657]},{"content":"Hyper-V virtualization platform","pos":[7664,7695]},{"content":"The process of creating a reference image should always be performed in a virtual environment.","pos":[7697,7791]},{"content":"When you use a virtual machine as the platform to build your reference image, you eliminate the need for installation of additional drivers.","pos":[7792,7932]},{"content":"The drivers for a Hyper-V virtual machine are included by default in the factory Windows 10 image.","pos":[7933,8031]},{"content":"When you avoid the installation of additional drivers – especially complex drivers that include application components like control panel applications – you ensure that the image created by your reference image process will be as universally compatible as possible.","pos":[8032,8297]},{"pos":[8300,8441],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A Generation 1 virtual machine is recommended for the preparation of a reference image in a Hyper-V virtual environment.","source":"**Note:**&nbsp;&nbsp;A Generation 1 virtual machine is recommended for the preparation of a reference image in a Hyper-V virtual environment."},{"content":"Because customizations are performed by MDT at the time of deployment, the goal of reference image creation is not to perform customization but to increase performance during deployment by reducing the number of actions that need to occur on each deployed device.","pos":[8443,8706]},{"content":"The biggest action that can slow down an MDT deployment is the installation of Windows updates.","pos":[8707,8802]},{"content":"When MDT performs this step during the deployment process, it downloads the updates on each deployed device and installs them.","pos":[8803,8929]},{"content":"By installing Windows updates in your reference image, the updates are already installed when the image is deployed to the device and the MDT update process only needs to install updates that are new since the image was created or are applicable to products other than Windows (for example, Microsoft Office updates).","pos":[8930,9247]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Hyper-V is available not only on Windows Server, but also on Windows clients, including Professional and Enterprise editions of Windows 8, Windows 8.1, and Windows 10.","pos":[9250,9438],"source":"**Note:**&nbsp;&nbsp;Hyper-V is available not only on Windows Server, but also on Windows clients, including Professional and Enterprise editions of Windows 8, Windows 8.1, and Windows 10."},{"content":"Find out more at <bpt id=\"p1\">[</bpt>Client Hyper-V on Windows 10<ept id=\"p1\">](https://msdn.microsoft.com/virtualization/hyperv_on_windows/windows_welcome)</ept> and <bpt id=\"p2\">[</bpt>Client Hyper-V on Windows 8 and Windows 8.1<ept id=\"p2\">](https://technet.microsoft.com/library/hh857623)</ept> in the TechNet Library.","pos":[9439,9685],"source":" Find out more at [Client Hyper-V on Windows 10](https://msdn.microsoft.com/virtualization/hyperv_on_windows/windows_welcome) and [Client Hyper-V on Windows 8 and Windows 8.1](https://technet.microsoft.com/library/hh857623) in the TechNet Library."},{"content":"Hyper-V is also available as a standalone product, Microsoft Hyper-V Server, at no cost.","pos":[9687,9775]},{"content":"You can download <bpt id=\"p1\">[</bpt>Microsoft Hyper-V Server 2012 R2<ept id=\"p1\">](https://www.microsoft.com/en-us/evalcenter/evaluate-hyper-v-server-2012-r2)</ept> or <bpt id=\"p2\">[</bpt>Microsoft Hyper-V Server 2016 Technical Preview<ept id=\"p2\">](https://www.microsoft.com/en-us/evalcenter/evaluate-hyper-v-server-technical-preview)</ept> from the TechNet Evaluation Center.","pos":[9776,10078],"source":" You can download [Microsoft Hyper-V Server 2012 R2](https://www.microsoft.com/en-us/evalcenter/evaluate-hyper-v-server-2012-r2) or [Microsoft Hyper-V Server 2016 Technical Preview](https://www.microsoft.com/en-us/evalcenter/evaluate-hyper-v-server-technical-preview) from the TechNet Evaluation Center."},{"content":"Surface firmware and drivers","pos":[10085,10113]},{"content":"For your deployed Windows environment to function correctly on your Surface devices, you will need to install the drivers used by Windows to communicate with the components of your device.","pos":[10115,10303]},{"content":"These drivers are available for download in the Microsoft Download Center for each Surface device.","pos":[10304,10402]},{"content":"You can find the correct Microsoft Download Center page for your device at <bpt id=\"p1\">[</bpt>Download the latest firmware and drivers for Surface devices<ept id=\"p1\">](https://technet.microsoft.com/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices)</ept>.","pos":[10403,10645],"source":" You can find the correct Microsoft Download Center page for your device at [Download the latest firmware and drivers for Surface devices](https://technet.microsoft.com/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices)."},{"content":"When you browse to the specific Microsoft Download Center page for your device, you will notice that there are two files available for download.","pos":[10647,10791]},{"content":"One file is a Windows Installer (.msi) file.","pos":[10792,10836]},{"content":"This file is used to update drivers on devices that are already running Windows or that have device management solutions.","pos":[10837,10958]},{"content":"The other file is an archive (.zip) file.","pos":[10959,11000]},{"content":"This file contains the individual driver files that are used during deployment, or for manual installation with Device Manager.","pos":[11001,11128]},{"content":"The file that you will need to download is the .zip archive file.","pos":[11129,11194]},{"content":"You can read more about the difference between the firmware and driver pack file types at <bpt id=\"p1\">[</bpt>Manage Surface driver and firmware updates<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-pro-3-firmware-updates)</ept>.","pos":[11195,11419],"source":" You can read more about the difference between the firmware and driver pack file types at [Manage Surface driver and firmware updates](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-pro-3-firmware-updates)."},{"content":"In addition to the driver files that help Windows communicate with the hardware components of the Surface device, the .zip file you download will also contain firmware updates.","pos":[11422,11598]},{"content":"These firmware updates will update the instructions used by the device hardware to communicate between components and Windows.","pos":[11599,11725]},{"content":"The firmware of Surface device components is updated by installation of specific driver files and thus is installed along with the other drivers during deployment.","pos":[11726,11889]},{"content":"The firmware of an out-of-date Surface device is thus updated when the device reboots during and after the Windows deployment process.","pos":[11890,12024]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Beginning in Windows 10, the drivers for Surface devices are included in the Windows Preinstallation Environment (WinPE).","pos":[12027,12169],"source":"**Note:**&nbsp;&nbsp;Beginning in Windows 10, the drivers for Surface devices are included in the Windows Preinstallation Environment (WinPE)."},{"content":"In earlier versions of Windows, specific drivers (like network drivers) had to be imported and configured in MDT for use in WinPE to successfully deploy to Surface devices.","pos":[12170,12342]},{"content":"Application installation files","pos":[12349,12379]},{"content":"In addition to the drivers that are used by Windows to communicate with the Surface device’s hardware and components, you will also need to provide the installation files for any applications that you want to install on your deployed Surface devices.","pos":[12381,12631]},{"content":"To automate the deployment of an application, you will also need to determine the command-line instructions for that application to perform a silent installation.","pos":[12632,12794]},{"content":"In this article, the Surface app and Microsoft Office 365 will be installed as examples of application installation.","pos":[12795,12911]},{"content":"The application installation process can be used with any application with installation files that can be launched from command line.","pos":[12912,13045]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>If the application files for your application are stored on your organization’s network and will be accessible from your Surface devices during the deployment process, you can deploy that application directly from that network location.","pos":[13048,13305],"source":"**Note:**&nbsp;&nbsp;If the application files for your application are stored on your organization’s network and will be accessible from your Surface devices during the deployment process, you can deploy that application directly from that network location."},{"content":"To use installation files from a network location, use the <bpt id=\"p1\">**</bpt>Install Application Without Source Files or Elsewhere on the Network<ept id=\"p1\">**</ept> option in the MDT New Application Wizard, which is described in the <bpt id=\"p2\">[</bpt>Import applications<ept id=\"p2\">](#import-applications)</ept> section later in this article.","pos":[13306,13580],"source":" To use installation files from a network location, use the **Install Application Without Source Files or Elsewhere on the Network** option in the MDT New Application Wizard, which is described in the [Import applications](#import-applications) section later in this article."},{"content":"Microsoft Surface Deployment Accelerator","pos":[13587,13627]},{"content":"If you want to deploy only to Surface devices or you want an accelerated method to perform deployment to Surface devices, you can use the Microsoft Surface Deployment Accelerator to generate an MDT deployment share complete with Surface device drivers, Surface apps, and pre-configured task sequences to create a reference image and perform deployment to Surface devices.","pos":[13629,14000]},{"content":"Microsoft Surface Deployment Accelerator can automatically import boot images into WDS and prepare WDS for network boot (PXE).","pos":[14001,14127]},{"content":"You can download the Microsoft Surface Deployment Accelerator from the <bpt id=\"p1\">[</bpt>Surface Tools for IT<ept id=\"p1\">](https://www.microsoft.com/en-us/download/details.aspx?id=46703)</ept> page in the Microsoft Download Center.","pos":[14128,14324],"source":" You can download the Microsoft Surface Deployment Accelerator from the [Surface Tools for IT](https://www.microsoft.com/en-us/download/details.aspx?id=46703) page in the Microsoft Download Center."},{"content":"Install the deployment tools","pos":[14330,14358]},{"content":"Before you can configure the deployment environment with Windows images, drivers, and applications, you must first install the deployment tools that will be used throughout the deployment process.","pos":[14360,14556]},{"content":"The three main tools to be installed are WDS, Windows ADK, and MDT.","pos":[14557,14624]},{"content":"WDS provides the capacity for network boot, Windows ADK provides several deployment tools that perform specific deployment tasks, and MDT provides automation and a central interface from which to manage and control the deployment process.","pos":[14625,14863]},{"content":"To boot from the network with either your reference virtual machines or your Surface devices, your deployment environment must include a Windows Server environment.","pos":[14865,15029]},{"content":"The Windows Server environment is required to install WDS and the WDS PXE server.","pos":[15030,15111]},{"content":"Without PXE support, you will be required to create physical boot media, such as a USB stick to perform your deployment – MDT and Windows ADK will still be required, but Windows Server is not required.","pos":[15112,15313]},{"content":"Both MDT and Windows ADK can be installed on a Windows client and perform a Windows deployment.","pos":[15314,15409]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>To download deployment tools directly to Windows Server, you must disable <bpt id=\"p2\">[</bpt>Internet Explorer Enhanced Security Configuration<ept id=\"p2\">](https://technet.microsoft.com/library/dd883248)</ept>.","pos":[15412,15607],"source":"**Note:**&nbsp;&nbsp;To download deployment tools directly to Windows Server, you must disable [Internet Explorer Enhanced Security Configuration](https://technet.microsoft.com/library/dd883248)."},{"content":"On Windows Server 2012 R2, this can be performed directly through the <bpt id=\"p1\">**</bpt>Server Manager<ept id=\"p1\">**</ept> option on the <bpt id=\"p2\">**</bpt>Local Server<ept id=\"p2\">**</ept> tab.","pos":[15608,15732],"source":" On Windows Server 2012 R2, this can be performed directly through the **Server Manager** option on the **Local Server** tab."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> section, <bpt id=\"p2\">**</bpt>IE Enhanced Security Configuration<ept id=\"p2\">**</ept> can be found on the right side.","pos":[15733,15834],"source":" In the **Properties** section, **IE Enhanced Security Configuration** can be found on the right side."},{"content":"You may also need to enable the <bpt id=\"p1\">**</bpt>File Download<ept id=\"p1\">**</ept> option for the <bpt id=\"p2\">**</bpt>Internet<ept id=\"p2\">**</ept> zone through the <bpt id=\"p3\">**</bpt>Security<ept id=\"p3\">**</ept> tab of <bpt id=\"p4\">**</bpt>Internet Options<ept id=\"p4\">**</ept>.","pos":[15835,15971],"source":" You may also need to enable the **File Download** option for the **Internet** zone through the **Security** tab of **Internet Options**."},{"content":"Install Windows Deployment Services","pos":[15978,16013]},{"content":"Windows Deployment Services (WDS) is a Windows Server role.","pos":[16015,16074]},{"content":"To add the WDS role to a Windows Server 2012 R2 environment, use the Add Roles and Features Wizard, as shown in Figure 1.","pos":[16075,16196]},{"content":"Start the Add Roles and Features Wizard from the <bpt id=\"p1\">**</bpt>Manage<ept id=\"p1\">**</ept> button of <bpt id=\"p2\">**</bpt>Server Manager<ept id=\"p2\">**</ept>.","pos":[16197,16286],"source":" Start the Add Roles and Features Wizard from the **Manage** button of **Server Manager**."},{"content":"Install both the Deployment Server and Transport Server role services.","pos":[16287,16357]},{"content":"Install the Windows Deployment Services role","pos":[16361,16405]},{"content":"Figure 1.","pos":[16491,16500]},{"content":"Install the Windows Deployment Services server role","pos":[16501,16552]},{"content":"After the WDS role is installed, you need to configure WDS.","pos":[16555,16614]},{"content":"You can begin the configuration process from the WDS node of Server Manager by right-clicking your server’s name and then clicking <bpt id=\"p1\">**</bpt>Windows Deployment Services Management Console<ept id=\"p1\">**</ept>.","pos":[16615,16797],"source":" You can begin the configuration process from the WDS node of Server Manager by right-clicking your server’s name and then clicking **Windows Deployment Services Management Console**."},{"content":"In the <bpt id=\"p1\">**</bpt>Windows Deployment Services<ept id=\"p1\">**</ept> window, expand the <bpt id=\"p2\">**</bpt>Servers<ept id=\"p2\">**</ept> node to find your server, right-click your server, and then click <bpt id=\"p3\">**</bpt>Configure<ept id=\"p3\">**</ept> in the menu to start the Windows Deployment Services Configuration Wizard, as shown in Figure 2.","pos":[16798,17044],"source":" In the **Windows Deployment Services** window, expand the **Servers** node to find your server, right-click your server, and then click **Configure** in the menu to start the Windows Deployment Services Configuration Wizard, as shown in Figure 2."},{"content":"Configure PXE response for Windows Deployment Services","pos":[17048,17102]},{"content":"Figure 2.","pos":[17198,17207]},{"content":"Configure PXE response for Windows Deployment Services","pos":[17208,17262]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Before you configure WDS make sure you have a local NTFS volume that is not your system drive (C:) available for use with WDS.","pos":[17266,17413],"source":"**Note:**&nbsp;&nbsp;Before you configure WDS make sure you have a local NTFS volume that is not your system drive (C:) available for use with WDS."},{"content":"This volume is used to store WDS boot images, deployment images, and configuration.","pos":[17414,17497]},{"content":"Using the Windows Deployment Services Configuration Wizard, configure WDS to fit the needs of your organization.","pos":[17499,17611]},{"content":"You can find detailed instructions for the installation and configuration of WDS at <bpt id=\"p1\">[</bpt>Windows Deployment Services Getting Started Guide for Windows Server 2012<ept id=\"p1\">](https://technet.microsoft.com/library/jj648426)</ept>.","pos":[17612,17820],"source":" You can find detailed instructions for the installation and configuration of WDS at [Windows Deployment Services Getting Started Guide for Windows Server 2012](https://technet.microsoft.com/library/jj648426)."},{"content":"On the <bpt id=\"p1\">**</bpt>PXE Server Initial Settings<ept id=\"p1\">**</ept> page, be sure to configure WDS so that it will respond to your Surface devices when they attempt to boot from the network.","pos":[17821,17982],"source":" On the **PXE Server Initial Settings** page, be sure to configure WDS so that it will respond to your Surface devices when they attempt to boot from the network."},{"content":"If you have already installed WDS or need to change your PXE server response settings, you can do so on the <bpt id=\"p1\">**</bpt>PXE Response<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> of your server in the Windows Deployment Services Management Console.","pos":[17983,18203],"source":" If you have already installed WDS or need to change your PXE server response settings, you can do so on the **PXE Response** tab of the **Properties** of your server in the Windows Deployment Services Management Console."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You will add boot images to WDS when you update your boot images in MDT.","pos":[18206,18299],"source":"**Note:**&nbsp;&nbsp;You will add boot images to WDS when you update your boot images in MDT."},{"content":"You do not need to add boot images or Windows images to WDS when you configure the role.","pos":[18300,18388]},{"content":"Install Windows Assessment and Deployment Kit","pos":[18395,18440]},{"content":"To install Windows ADK, run the Adksetup.exe file that you downloaded from <bpt id=\"p1\">[</bpt>Download the Windows ADK<ept id=\"p1\">](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#adkwin10)</ept>.","pos":[18442,18643],"source":"To install Windows ADK, run the Adksetup.exe file that you downloaded from [Download the Windows ADK](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#adkwin10)."},{"content":"Windows ADK must be installed before MDT.","pos":[18644,18685]},{"content":"You should always download and use the most recent version of Windows ADK.","pos":[18686,18760]},{"content":"A new version is usually released corresponding with each new version of Windows.","pos":[18761,18842]},{"pos":[18845,18985],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You can also use the Adksetup.exe file to download the Windows ADK installation files locally for use on other devices.","source":"**Note:**&nbsp;&nbsp;You can also use the Adksetup.exe file to download the Windows ADK installation files locally for use on other devices."},{"pos":[18987,19228],"content":"When you get to the <bpt id=\"p1\">**</bpt>Select the features you want to install<ept id=\"p1\">**</ept> page, you only need to select the <bpt id=\"p2\">**</bpt>Deployment Tools<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Windows Preinstallation Environment (Windows PE)<ept id=\"p3\">**</ept> check boxes to deploy Windows 10 using MDT, as shown in Figure 3.","source":"When you get to the **Select the features you want to install** page, you only need to select the **Deployment Tools** and **Windows Preinstallation Environment (Windows PE)** check boxes to deploy Windows 10 using MDT, as shown in Figure 3."},{"content":"Required options for deployment with MDT","pos":[19233,19273]},{"content":"Figure 3.","pos":[19355,19364]},{"content":"Only Deployment Tools and Windows PE options are required for deployment with MDT","pos":[19365,19446]},{"content":"Install Microsoft Deployment Toolkit","pos":[19454,19490]},{"content":"After the Windows ADK installation completes successfully, you can install MDT.","pos":[19492,19571]},{"content":"When you download MDT, ensure that you download the version that matches the architecture of your deployment server environment.","pos":[19572,19700]},{"content":"For Windows Server the architecture is 64-bit.","pos":[19701,19747]},{"content":"Download the MDT installation file that ends in <bpt id=\"p1\">**</bpt>x64<ept id=\"p1\">**</ept>.","pos":[19748,19804],"source":" Download the MDT installation file that ends in **x64**."},{"content":"When MDT is installed you can use the default options during the installation wizard, as shown in Figure 4.","pos":[19805,19912]},{"content":"MDT installation with default options","pos":[19916,19953]},{"content":"Figure 4.","pos":[20032,20041]},{"content":"Install the Microsoft Deployment Toolkit with default options","pos":[20042,20103]},{"content":"Before you can open the MDT Deployment Workbench, you must enable execution of scripts in PowerShell.","pos":[20106,20207]},{"content":"If you do not do this, the following error message may be displayed: <bpt id=\"p1\">*</bpt>\"Initialization Error PowerShell is required to use the Deployment Workbench.  Please install PowerShell then relaunch Deployment Workbench.\"<ept id=\"p1\">*</ept>","pos":[20208,20420],"source":" If you do not do this, the following error message may be displayed: *\"Initialization Error PowerShell is required to use the Deployment Workbench.  Please install PowerShell then relaunch Deployment Workbench.\"*"},{"content":"To enable the execution of scripts, run the following cmdlet in PowerShell as an Administrator:","pos":[20422,20517]},{"content":"Create a reference image","pos":[20580,20604]},{"content":"Now that you have installed the required tools, you can begin the first step of customizing your deployment environment to your needs – create a reference image.","pos":[20606,20767]},{"content":"Because the reference image should be created in a virtual machine where there is no need for drivers to be installed, and because the reference image will not include applications, you can use the MDT deployment environment almost entirely with default settings.","pos":[20768,21031]},{"content":"Create a deployment share","pos":[21037,21062]},{"content":"Now that you have the tools installed, the next step is to configure MDT for the creation of a reference image.","pos":[21064,21175]},{"content":"Before you can perform the process of creating a reference image, MDT needs to be set up with a repository for scripts, images, and other deployment resources.","pos":[21176,21335]},{"content":"This repository is known as the <bpt id=\"p1\">*</bpt>deployment share<ept id=\"p1\">*</ept>.","pos":[21336,21387],"source":" This repository is known as the *deployment share*."},{"content":"After the deployment share is created, you must supply MDT with a complete set of Windows 10 installation files, the last set of tools required before MDT can perform reference image creation.","pos":[21388,21580]},{"content":"To create the deployment share, follow these steps:","pos":[21582,21633]},{"content":"Open the Deployment Workbench from your Start menu or Start screen, as shown in Figure 5.","pos":[21638,21727]},{"content":"The MDT Deployment Workbench","pos":[21734,21762]},{"content":"Figure 5.","pos":[21835,21844]},{"content":"The MDT Deployment Workbench","pos":[21845,21873]},{"pos":[21879,22028],"content":"Right-click the <bpt id=\"p1\">**</bpt>Deployment Shares<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>New Deployment Share<ept id=\"p2\">**</ept> to start the New Deployment Share Wizard, as shown in Figure 6.","source":"Right-click the **Deployment Shares** folder, and then click **New Deployment Share** to start the New Deployment Share Wizard, as shown in Figure 6."},{"content":"Summary page of the New Deployment Share Wizard","pos":[22035,22082]},{"content":"Figure 6.","pos":[22174,22183]},{"content":"The Summary page of the New Deployment Share Wizard","pos":[22184,22235]},{"content":"Create a new deployment share with New Deployment Share Wizard with the following steps:","pos":[22241,22329]},{"pos":[22335,22433],"content":"<bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> – Specify a local folder where the deployment share will reside, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Path** – Specify a local folder where the deployment share will reside, and then click **Next**."},{"pos":[22442,22596],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Like the WDS remote installation folder, it is recommended that you put this folder on an NTFS volume that is not your system volume.","source":"**Note:**&nbsp;&nbsp;Like the WDS remote installation folder, it is recommended that you put this folder on an NTFS volume that is not your system volume."},{"pos":[22602,22751],"content":"<bpt id=\"p1\">**</bpt>Share<ept id=\"p1\">**</ept> – Specify a name for the network share under which the local folder specified on the <bpt id=\"p2\">**</bpt>Path<ept id=\"p2\">**</ept> page will be shared, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Share** – Specify a name for the network share under which the local folder specified on the **Path** page will be shared, and then click **Next**."},{"pos":[22760,22818],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The share name cannot contain spaces.","source":"**Note:**&nbsp;&nbsp;The share name cannot contain spaces."},{"pos":[22827,23020],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You can use a Dollar Sign (<bpt id=\"p2\">**</bpt><ph id=\"ph2\">$</ph><ept id=\"p2\">**</ept>) to hide your network share so that it will not be displayed when users browse the available network shares on the server in File Explorer.","source":"**Note:**&nbsp;&nbsp;You can use a Dollar Sign (**$**) to hide your network share so that it will not be displayed when users browse the available network shares on the server in File Explorer."},{"content":"<bpt id=\"p1\">**</bpt>Descriptive Name<ept id=\"p1\">**</ept> – Enter a descriptive name for the network share (this descriptive name can contain spaces), and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[23026,23164],"source":"**Descriptive Name** – Enter a descriptive name for the network share (this descriptive name can contain spaces), and then click **Next**."},{"content":"The descriptive name will be the name of the folder as it appears in the Deployment Workbench.","pos":[23165,23259]},{"content":"<bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> – You can accept the default options on this page.","pos":[23264,23326],"source":"**Options** – You can accept the default options on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[23327,23342],"source":" Click **Next**."},{"pos":[23347,23477],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin creation of the deployment share.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the deployment share."},{"pos":[23482,23647],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the deployment share is being created, a progress bar is displayed on this page to indicate the status of the deployment share creation process.","source":"**Progress** – While the deployment share is being created, a progress bar is displayed on this page to indicate the status of the deployment share creation process."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the deployment share creation process completes, the success of the process is displayed on this page.","pos":[23652,23778],"source":"**Confirmation** – When the deployment share creation process completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the New Deployment Share Wizard.","pos":[23779,23840],"source":" Click **Finish** to complete the New Deployment Share Wizard."},{"content":"When the New Deployment Share Wizard is complete, you can expand the Deployment Shares folder to find your newly created deployment share.","pos":[23845,23983]},{"content":"You can expand your deployment share, where you will find several folders for the resources, scripts, and components of your MDT deployment environment are stored.","pos":[23987,24150]},{"content":"To secure the deployment share and prevent unauthorized access to the deployment resources, you can create a local user on the deployment share host and configure permissions for that user to have read-only access to the deployment share only.","pos":[24152,24395]},{"content":"It is especially important to secure access to the deployment share if you intend to automate the logon to the deployment share during the deployment boot process.","pos":[24396,24559]},{"content":"By automating the logon to the deployment share during the boot of deployment media, the credentials for that logon are stored in plaintext in the bootstrap.ini file on the boot media.","pos":[24560,24744]},{"pos":[24747,24938],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>If you intend to capture images (such as the reference image) with this user, the user must also have write permission on the Captures folder in the MDT deployment share.","source":"**Note:**&nbsp;&nbsp;If you intend to capture images (such as the reference image) with this user, the user must also have write permission on the Captures folder in the MDT deployment share."},{"content":"You now have an empty deployment share that is ready for you to add the resources that will be required for reference image creation and deployment to Surface devices.","pos":[24940,25107]},{"content":"Import Windows installation files","pos":[25113,25146]},{"content":"The first resources that are required to perform a deployment of Windows are the installation files from Windows 10 installation media.","pos":[25148,25283]},{"content":"Even if you have an already prepared reference image, you still need to supply the unaltered installation files from your installation media.","pos":[25284,25425]},{"content":"The source of these files can be a physical disk, or it can be an ISO file like the download from the Volume Licensing Service Center (VLSC).","pos":[25426,25567]},{"pos":[25570,25710],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A 64-bit operating system is required for compatibility with Surface Pro 4, Surface Book, Surface Pro 3, and Surface 3.","source":"**Note:**&nbsp;&nbsp;A 64-bit operating system is required for compatibility with Surface Pro 4, Surface Book, Surface Pro 3, and Surface 3."},{"content":"To import Windows 10 installation files, follow these steps:","pos":[25712,25772]},{"pos":[25777,25963],"content":"Right-click the <bpt id=\"p1\">**</bpt>Operating Systems<ept id=\"p1\">**</ept> folder under your deployment share in the Deployment Workbench, and then click <bpt id=\"p2\">**</bpt>New Folder<ept id=\"p2\">**</ept> to open the <bpt id=\"p3\">**</bpt>New Folder<ept id=\"p3\">**</ept> page, as shown in Figure 7.","source":"Right-click the **Operating Systems** folder under your deployment share in the Deployment Workbench, and then click **New Folder** to open the **New Folder** page, as shown in Figure 7."},{"content":"Create a new folder on the New Folder page","pos":[25970,26012]},{"content":"Figure 7.","pos":[26102,26111]},{"content":"Create a new folder on the New Folder page","pos":[26112,26154]},{"pos":[26160,26230],"content":"On the <bpt id=\"p1\">**</bpt>New Folder<ept id=\"p1\">**</ept> page a series of steps is displayed, as follows:","source":"On the **New Folder** page a series of steps is displayed, as follows:"},{"pos":[26235,26430],"content":"<bpt id=\"p1\">**</bpt>General Settings<ept id=\"p1\">**</ept> – Enter a name for the folder in the <bpt id=\"p2\">**</bpt>Folder Name<ept id=\"p2\">**</ept> field (for example, Windows 10 Enterprise), add any comments you want in the <bpt id=\"p3\">**</bpt>Comments<ept id=\"p3\">**</ept> field, and then click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>.","source":"**General Settings** – Enter a name for the folder in the **Folder Name** field (for example, Windows 10 Enterprise), add any comments you want in the **Comments** field, and then click **Next**."},{"pos":[26435,26540],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration of the new folder on this page, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Summary** – Review the specified configuration of the new folder on this page, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – A progress bar will be displayed on this page while the folder is created.","pos":[26545,26634],"source":"**Progress** – A progress bar will be displayed on this page while the folder is created."},{"content":"This page will likely pass very quickly.","pos":[26635,26675]},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the new folder has been created, a <bpt id=\"p2\">**</bpt>Confirmation<ept id=\"p2\">**</ept> page displays the success of the operation.","pos":[26680,26799],"source":"**Confirmation** – When the new folder has been created, a **Confirmation** page displays the success of the operation."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>New Folder<ept id=\"p2\">**</ept> page.","pos":[26800,26850],"source":" Click **Finish** to close the **New Folder** page."},{"content":"Expand the Operating Systems folder to see the newly created folder.","pos":[26854,26922]},{"pos":[26926,27074],"content":"Right-click the newly created folder, and then click <bpt id=\"p1\">**</bpt>Import Operating System<ept id=\"p1\">**</ept> to launch the Import Operating System Wizard, as shown in Figure 8.","source":"Right-click the newly created folder, and then click **Import Operating System** to launch the Import Operating System Wizard, as shown in Figure 8."},{"content":"Import source files with the Import Operating System Wizard","pos":[27081,27140]},{"content":"Figure 8.","pos":[27244,27253]},{"content":"Import source files with the Import Operating System Wizard","pos":[27254,27313]},{"content":"The Import Operating System Wizard walks you through the import of your operating system files, as follows:","pos":[27319,27426]},{"pos":[27431,27588],"content":"<bpt id=\"p1\">**</bpt>OS Type<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Full Set of Source Files<ept id=\"p2\">**</ept> to specify that you are importing the Windows source files from installation media, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**OS Type** – Click **Full Set of Source Files** to specify that you are importing the Windows source files from installation media, and then click **Next**."},{"pos":[27593,27728],"content":"<bpt id=\"p1\">**</bpt>Source<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>, move to and select the folder or drive where your installation files are found, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Source** – Click **Browse**, move to and select the folder or drive where your installation files are found, and then click **Next**."},{"pos":[27733,27860],"content":"<bpt id=\"p1\">**</bpt>Destination<ept id=\"p1\">**</ept> – Enter a name for the new folder that will be created to hold the installation files, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Destination** – Enter a name for the new folder that will be created to hold the installation files, and then click **Next**."},{"pos":[27865,27981],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin the import process.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin the import process."},{"pos":[27986,28085],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the installation files are imported, a progress bar is displayed on this page.","source":"**Progress** – While the installation files are imported, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the operating system import process completes, the success of the process is displayed on this page.","pos":[28090,28214],"source":"**Confirmation** – When the operating system import process completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete Import Operating System Wizard.","pos":[28215,28275],"source":" Click **Finish** to complete Import Operating System Wizard."},{"content":"Expand the folder you created in Step 1 to see the entry for your newly imported installation files for Windows 10.","pos":[28280,28395]},{"content":"Now that you’ve imported the installation files from the installation media, you have the files that MDT needs to create the reference image and you are ready to instruct MDT how to create the reference image to your specifications.","pos":[28397,28629]},{"content":"Create reference image task sequence","pos":[28635,28671]},{"content":"As described in the <bpt id=\"p1\">[</bpt>Deployment tools<ept id=\"p1\">](#deployment-tools)</ept> section of this article, the goal of creating a reference image is to keep the Windows environment as simple as possible while performing tasks that would be common to all devices being deployed.","pos":[28673,28926],"source":"As described in the [Deployment tools](#deployment-tools) section of this article, the goal of creating a reference image is to keep the Windows environment as simple as possible while performing tasks that would be common to all devices being deployed."},{"content":"You should now have a basic MDT deployment share configured with default options and a set of unaltered, factory installation files for Windows 10.","pos":[28927,29074]},{"content":"This simple configuration is perfect for reference image creation because the deployment share contains no applications or drivers to interfere with the process.","pos":[29075,29236]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For some organizations keeping a simple deployment share without applications or drivers is the simplest solution for creation of reference images.","pos":[29239,29407],"source":"**Note:**&nbsp;&nbsp;For some organizations keeping a simple deployment share without applications or drivers is the simplest solution for creation of reference images."},{"content":"You can easily connect to more than one deployment share from a single Deployment Workbench and copy images from a simple, reference-image-only deployment share to a production deployment share complete with drivers and applications.","pos":[29408,29641]},{"content":"To create the reference image task sequence, follow these steps:","pos":[29643,29707]},{"pos":[29712,29908],"content":"Right-click the <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> folder under your deployment share in the Deployment Workbench, and then click <bpt id=\"p2\">**</bpt>New Task Sequence<ept id=\"p2\">**</ept> to start the New Task Sequence Wizard, as shown in Figure 9.","source":"Right-click the **Task Sequences** folder under your deployment share in the Deployment Workbench, and then click **New Task Sequence** to start the New Task Sequence Wizard, as shown in Figure 9."},{"content":"Create new task sequence to deploy and update a Windows 10 reference environment","pos":[29915,29995]},{"content":"Figure 9.","pos":[30120,30129]},{"content":"Create a new task sequence to deploy and update a Windows 10 reference environment","pos":[30130,30212]},{"content":"The New Task Sequence Wizard presents a series of steps, as follows:","pos":[30218,30286]},{"pos":[30291,30609],"content":"<bpt id=\"p1\">**</bpt>General Settings<ept id=\"p1\">**</ept> – Enter an identifier for the reference image task sequence in the <bpt id=\"p2\">**</bpt>Task Sequence ID<ept id=\"p2\">**</ept> field, a name for the reference image task sequence in the <bpt id=\"p3\">**</bpt>Task Sequence Name<ept id=\"p3\">**</ept> field, and any comments for the reference image task sequence in the <bpt id=\"p4\">**</bpt>Task Sequence Comments<ept id=\"p4\">**</ept> field, and then click <bpt id=\"p5\">**</bpt>Next<ept id=\"p5\">**</ept>.","source":"**General Settings** – Enter an identifier for the reference image task sequence in the **Task Sequence ID** field, a name for the reference image task sequence in the **Task Sequence Name** field, and any comments for the reference image task sequence in the **Task Sequence Comments** field, and then click **Next**."},{"pos":[30613,30725],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The <bpt id=\"p2\">**</bpt>Task Sequence ID<ept id=\"p2\">**</ept> field cannot contain spaces and can be a maximum of 16 characters.","source":"**Note:**&nbsp;&nbsp;The **Task Sequence ID** field cannot contain spaces and can be a maximum of 16 characters."},{"pos":[30730,30842],"content":"<bpt id=\"p1\">**</bpt>Select Template<ept id=\"p1\">**</ept> – Select <bpt id=\"p2\">**</bpt>Standard Client Task Sequence<ept id=\"p2\">**</ept> from the drop-down menu, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Select Template** – Select **Standard Client Task Sequence** from the drop-down menu, and then click **Next**."},{"pos":[30847,30984],"content":"<bpt id=\"p1\">**</bpt>Select OS<ept id=\"p1\">**</ept> – Navigate to and select the Windows 10 image you imported with the Windows 10 installation files, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Select OS** – Navigate to and select the Windows 10 image you imported with the Windows 10 installation files, and then click **Next**."},{"pos":[30989,31092],"content":"<bpt id=\"p1\">**</bpt>Specify Product Key<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Do Not Specify a Product Key at This Time<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Specify Product Key** – Click **Do Not Specify a Product Key at This Time**, and then click **Next**."},{"pos":[31097,31269],"content":"<bpt id=\"p1\">**</bpt>OS Settings<ept id=\"p1\">**</ept> – Enter a name, organization, and home page URL in the <bpt id=\"p2\">**</bpt>Full Name<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Organization<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Internet Explorer Home Page<ept id=\"p4\">**</ept> fields, and then click <bpt id=\"p5\">**</bpt>Next<ept id=\"p5\">**</ept>.","source":"**OS Settings** – Enter a name, organization, and home page URL in the **Full Name**, **Organization**, and **Internet Explorer Home Page** fields, and then click **Next**."},{"pos":[31274,31417],"content":"<bpt id=\"p1\">**</bpt>Admin Password<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Use the Specified Local Administrator Password<ept id=\"p2\">**</ept>, enter a password in the provided field, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Admin Password** – Click **Use the Specified Local Administrator Password**, enter a password in the provided field, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>During creation of a reference image, any specified Administrator password will be automatically removed when the image is prepared for capture with Sysprep.","pos":[31421,31599],"source":"**Note:**&nbsp;&nbsp;During creation of a reference image, any specified Administrator password will be automatically removed when the image is prepared for capture with Sysprep."},{"content":"During reference image creation, a password is not necessary, but is recommended to remain in line with best practices for production deployment environments.","pos":[31600,31758]},{"pos":[31763,31890],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin creation of the task sequence.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the task sequence."},{"pos":[31895,31987],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the task sequence is created, a progress bar is displayed on this page.","source":"**Progress** – While the task sequence is created, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the task sequence creation completes, the success of the process is displayed on this page.","pos":[31992,32107],"source":"**Confirmation** – When the task sequence creation completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the New Task Sequence Wizard.","pos":[32108,32166],"source":" Click **Finish** to complete the New Task Sequence Wizard."},{"pos":[32170,32285],"content":"Select the <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> folder, right-click the new task sequence you created, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"Select the **Task Sequences** folder, right-click the new task sequence you created, and then click **Properties**."},{"pos":[32289,32427],"content":"Select the <bpt id=\"p1\">**</bpt>Task Sequence<ept id=\"p1\">**</ept> tab to view the steps that are included in the Standard Client Task Sequence template, as shown in Figure 10.","source":"Select the **Task Sequence** tab to view the steps that are included in the Standard Client Task Sequence template, as shown in Figure 10."},{"content":"Enable Windows Update in the reference image task sequence","pos":[32434,32492]},{"content":"Figure 10.","pos":[32596,32606]},{"content":"Enable Windows Update in the reference image task sequence","pos":[32607,32665]},{"pos":[32671,32783],"content":"Select the <bpt id=\"p1\">**</bpt>Windows Update (Pre-Application Installation)<ept id=\"p1\">**</ept> option, located under the <bpt id=\"p2\">**</bpt>State Restore<ept id=\"p2\">**</ept> folder.","source":"Select the **Windows Update (Pre-Application Installation)** option, located under the **State Restore** folder."},{"pos":[32787,32865],"content":"Click the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> tab, and then clear the <bpt id=\"p2\">**</bpt>Disable This Step<ept id=\"p2\">**</ept> check box.","source":"Click the **Options** tab, and then clear the **Disable This Step** check box."},{"pos":[32869,32960],"content":"Repeat Step 4 and Step 5 for the <bpt id=\"p1\">**</bpt>Windows Update (Post-Application Installation)<ept id=\"p1\">**</ept> option.","source":"Repeat Step 4 and Step 5 for the **Windows Update (Post-Application Installation)** option."},{"pos":[32964,33067],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply changes to the task sequence, and then close the task sequence properties window.","source":"Click **OK** to apply changes to the task sequence, and then close the task sequence properties window."},{"content":"Generate and import MDT boot media","pos":[33073,33107]},{"content":"To boot the reference virtual machine from the network, the MDT deployment share first must be updated to generate boot media with the resources that have been added in the previous sections.","pos":[33109,33300]},{"content":"To update the MDT boot media, follow these steps:","pos":[33302,33351]},{"pos":[33356,33528],"content":"Right-click the deployment share in the Deployment Workbench, and then click <bpt id=\"p1\">**</bpt>Update Deployment Share<ept id=\"p1\">**</ept> to start the Update Deployment Share Wizard, as shown in Figure 11.","source":"Right-click the deployment share in the Deployment Workbench, and then click **Update Deployment Share** to start the Update Deployment Share Wizard, as shown in Figure 11."},{"content":"Generate boot images with the Update Deployment Share Wizard","pos":[33535,33595]},{"content":"Figure 11.","pos":[33701,33711]},{"content":"Generate boot images with the Update Deployment Share Wizard","pos":[33712,33772]},{"content":"Use the Update Deployment Share Wizard to create boot images with the following process:","pos":[33778,33866]},{"pos":[33871,33958],"content":"<bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Completely Regenerate the Boot Images<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Options** – Click **Completely Regenerate the Boot Images**, and then click **Next**."},{"pos":[33962,34163],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Because this is the first time the newly created deployment share has been updated, new boot images will be generated regardless of which option you select on the <bpt id=\"p2\">**</bpt>Options<ept id=\"p2\">**</ept> page.","source":"**Note:**&nbsp;&nbsp;Because this is the first time the newly created deployment share has been updated, new boot images will be generated regardless of which option you select on the **Options** page."},{"pos":[34168,34285],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified options on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin generation of boot images.","source":"**Summary** – Review the specified options on this page before you click **Next** to begin generation of boot images."},{"pos":[34290,34389],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the boot images are being generated, a progress bar is displayed on this page.","source":"**Progress** – While the boot images are being generated, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the boot images have been generated, the success of the process is displayed on this page.","pos":[34394,34508],"source":"**Confirmation** – When the boot images have been generated, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the Update Deployment Share Wizard.","pos":[34509,34573],"source":" Click **Finish** to complete the Update Deployment Share Wizard."},{"content":"Confirm that boot images have been generated by navigating to the deployment share in File Explorer and opening the Boot folder.","pos":[34577,34705]},{"content":"The following files should be displayed, as shown in Figure 12:","pos":[34706,34769]},{"content":"LiteTouchPE_x86.iso","pos":[34776,34795]},{"content":"LiteTouchPE_x86.wim","pos":[34804,34823]},{"content":"LiteTouchPE_x64.iso","pos":[34832,34851]},{"content":"LiteTouchPE_x64.wim","pos":[34860,34879]},{"content":"Boot images in the Boot folder after Update Deployment Share Wizard completes","pos":[34889,34966]},{"content":"Figure 12.","pos":[35089,35099]},{"content":"Boot images displayed in the Boot folder after completion of the Update Deployment Share Wizard","pos":[35100,35195]},{"content":"To import the MDT boot media into WDS for PXE boot, follow these steps:","pos":[35198,35269]},{"content":"Open Windows Deployment Services from the Start menu or Start screen.","pos":[35274,35343]},{"pos":[35347,35393],"content":"Expand <bpt id=\"p1\">**</bpt>Servers<ept id=\"p1\">**</ept> and your deployment server.","source":"Expand **Servers** and your deployment server."},{"pos":[35397,35453],"content":"Click the <bpt id=\"p1\">**</bpt>Boot Images<ept id=\"p1\">**</ept> folder, as shown in Figure 13.","source":"Click the **Boot Images** folder, as shown in Figure 13."},{"content":"Start the Add Image Wizard from the Boot Images folder","pos":[35460,35514]},{"content":"Figure 13.","pos":[35614,35624]},{"content":"Start the Add Image Wizard from the Boot Images folder","pos":[35625,35679]},{"pos":[35685,35811],"content":"Right-click the <bpt id=\"p1\">**</bpt>Boot Images<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>Add Boot Image<ept id=\"p2\">**</ept> to open the Add Image Wizard, as shown in Figure 14.","source":"Right-click the **Boot Images** folder, and then click **Add Boot Image** to open the Add Image Wizard, as shown in Figure 14."},{"content":"Import the LiteTouchPE_x86.wim MDT boot image","pos":[35818,35863]},{"content":"Figure 14.","pos":[35954,35964]},{"content":"Import the LiteTouchPE_x86.wim MDT boot image","pos":[35965,36010]},{"content":"The Add Image Wizard displays a series of steps, as follows:","pos":[36016,36076]},{"pos":[36081,36248],"content":"<bpt id=\"p1\">**</bpt>Image File<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> and navigate to the <bpt id=\"p3\">**</bpt>Boot<ept id=\"p3\">**</ept> folder in your deployment share, click <bpt id=\"p4\">**</bpt>LiteTouchPE_x86.wim<ept id=\"p4\">**</ept>, click <bpt id=\"p5\">**</bpt>Open<ept id=\"p5\">**</ept>, and then click <bpt id=\"p6\">**</bpt>Next<ept id=\"p6\">**</ept>.","source":"**Image File** – Click **Browse** and navigate to the **Boot** folder in your deployment share, click **LiteTouchPE_x86.wim**, click **Open**, and then click **Next**."},{"pos":[36253,36375],"content":"<bpt id=\"p1\">**</bpt>Image Metadata<ept id=\"p1\">**</ept> – Enter a name and description for the MDT boot media, or click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to accept the default options.","source":"**Image Metadata** – Enter a name and description for the MDT boot media, or click **Next** to accept the default options."},{"pos":[36380,36474],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review your selections to import a boot image into WDS, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Summary** – Review your selections to import a boot image into WDS, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Task Progress<ept id=\"p1\">**</ept> – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder.","pos":[36479,36604],"source":"**Task Progress** – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> when the task is complete to close the Add Image Wizard.","pos":[36605,36678],"source":" Click **Finish** when the task is complete to close the Add Image Wizard."},{"pos":[36681,36873],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Only the 32-bit boot image, LiteTouchPE_x86.wim, is required to boot from BIOS devices, including Generation 1 Hyper-V virtual machines like the reference virtual machine.","source":"**Note:**&nbsp;&nbsp;Only the 32-bit boot image, LiteTouchPE_x86.wim, is required to boot from BIOS devices, including Generation 1 Hyper-V virtual machines like the reference virtual machine."},{"content":"If your WDS configuration is properly set up to respond to PXE clients, you should now be able to boot from the network with any device with a network adapter properly configured for network boot (PXE).","pos":[36875,37077]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>If your WDS server resides on the same server as DHCP or in a different subnet than the devices you are attempting to boot, additional configuration may be required.","pos":[37080,37266],"source":"**Note:**&nbsp;&nbsp;If your WDS server resides on the same server as DHCP or in a different subnet than the devices you are attempting to boot, additional configuration may be required."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Managing Network Boot Programs<ept id=\"p1\">](https://technet.microsoft.com/library/cc732351)</ept>.","pos":[37267,37374],"source":" For more information, see [Managing Network Boot Programs](https://technet.microsoft.com/library/cc732351)."},{"content":"Deploy and capture a reference image","pos":[37380,37416]},{"content":"Your deployment environment is now set up to create a reference image for Windows 10 complete with Windows Updates.","pos":[37418,37533]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You cannot install version updates (such as Windows 10, Version 1511) in a reference image.","pos":[37536,37648],"source":"**Note:**&nbsp;&nbsp;You cannot install version updates (such as Windows 10, Version 1511) in a reference image."},{"content":"To create a reference image with a new version of Windows, you must use installation files from that version of Windows.","pos":[37649,37769]},{"content":"When  you install a version update in Windows, it effectively performs an upgrade to a new version of Windows, and upgraded installations of Windows cannot be prepared for deployment with Sysprep.","pos":[37770,37966]},{"content":"By using a fully automated task sequence in an MDT deployment share dedicated to reference image creation, you can greatly reduce the time and effort required to create new reference images and it is the best way to ensure that your organization is ready for feature updates and new versions of Windows 10.","pos":[37977,38283],"source":"\nBy using a fully automated task sequence in an MDT deployment share dedicated to reference image creation, you can greatly reduce the time and effort required to create new reference images and it is the best way to ensure that your organization is ready for feature updates and new versions of Windows 10."},{"content":"You can now boot from the network with a virtual machine to run the prepared task sequence and generate a reference image.","pos":[38285,38407]},{"content":"When you prepare your virtual machine in Hyper-V for reference image creation, consider the following:","pos":[38408,38510]},{"content":"Use a Generation 1 virtual machine for the simplicity of drivers and to ensure maximum compatibility with both BIOS and UEFI devices.","pos":[38514,38647]},{"content":"Ensure your virtual machine has at least 1 GB of system memory at boot.","pos":[38650,38721]},{"content":"You can ensure that the virtual machine has at least 1 GB of memory at boot but allow the memory to adjust after boot by using Dynamic Memory.","pos":[38722,38864]},{"content":"You can read more about Dynamic Memory in the <bpt id=\"p1\">[</bpt>Hyper-V Dynamic Memory Overview<ept id=\"p1\">](https://technet.microsoft.com/library/hh831766)</ept>.","pos":[38865,38993],"source":" You can read more about Dynamic Memory in the [Hyper-V Dynamic Memory Overview](https://technet.microsoft.com/library/hh831766)."},{"content":"Ensure your virtual machine uses a legacy network adapter to support network boot (PXE); that network adapter should be connected to the same network as your deployment server, and that network adapter should receive an IP address automatically via DHCP.","pos":[38996,39250]},{"content":"Configure your boot order such that PXE Boot is the first option.","pos":[39253,39318]},{"content":"When your virtual machine (VM) is properly configured and ready, start or boot the VM and be prepared to press the F12 key when prompted to boot via PXE from the WDS server.","pos":[39320,39493]},{"content":"Perform the reference image deployment and capture using the following steps:","pos":[39495,39572]},{"content":"Start your virtual machine and press the F12 key when prompted to boot to the WDS server via PXE, as shown in Figure 15.","pos":[39577,39697]},{"content":"Start network boot by pressing the F12 key","pos":[39704,39746]},{"content":"Figure 15.","pos":[39834,39844]},{"content":"Start network boot by pressing the F12 key","pos":[39845,39887]},{"pos":[39893,39999],"content":"Click <bpt id=\"p1\">**</bpt>Run the Deployment Wizard to Install a New Operating System<ept id=\"p1\">**</ept> to begin the MDT deployment process.","source":"Click **Run the Deployment Wizard to Install a New Operating System** to begin the MDT deployment process."},{"content":"Enter your MDT username and password, a user with rights to access the MDT deployment share over the network and with rights to write to the Captures folder in the deployment share.","pos":[40003,40184]},{"content":"After your credentials are validated, the Windows Deployment Wizard will start and process the boot and deployment share rules.","pos":[40188,40315]},{"content":"The Windows Deployment Wizard displays a series of steps, as follows:","pos":[40319,40388]},{"pos":[40393,40552],"content":"<bpt id=\"p1\">**</bpt>Task Sequence<ept id=\"p1\">**</ept> – Select the task sequence you created for reference image creation (it should be the only task sequence available), and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Task Sequence** – Select the task sequence you created for reference image creation (it should be the only task sequence available), and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Computer Details<ept id=\"p1\">**</ept> – Leave the default computer name, workgroup name, and the <bpt id=\"p2\">**</bpt>Join a Workgroup<ept id=\"p2\">**</ept> option selected, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","pos":[40557,40699],"source":"**Computer Details** – Leave the default computer name, workgroup name, and the **Join a Workgroup** option selected, and then click **Next**."},{"content":"The computer name and workgroup will be reset when the image is prepared by Sysprep and captured.","pos":[40700,40797]},{"pos":[40802,40932],"content":"<bpt id=\"p1\">**</bpt>Move Data and Settings<ept id=\"p1\">**</ept> – Leave the default option of <bpt id=\"p2\">**</bpt>Do Not Move User Data and Settings<ept id=\"p2\">**</ept> selected, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Move Data and Settings** – Leave the default option of **Do Not Move User Data and Settings** selected, and then click **Next**."},{"pos":[40937,41067],"content":"<bpt id=\"p1\">**</bpt>User Data (Restore)<ept id=\"p1\">**</ept> – Leave the default option of <bpt id=\"p2\">**</bpt>Do Not Restore User Data and Settings<ept id=\"p2\">**</ept> selected, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**User Data (Restore)** – Leave the default option of **Do Not Restore User Data and Settings** selected, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Locale and Time<ept id=\"p1\">**</ept> – Leave the default options for language and time settings selected.","pos":[41072,41160],"source":"**Locale and Time** – Leave the default options for language and time settings selected."},{"content":"The locale and time settings will be specified during deployment of the image to other devices.","pos":[41161,41256]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[41257,41272],"source":" Click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Capture Image<ept id=\"p1\">**</ept> – Click the <bpt id=\"p2\">**</bpt>Capture an Image of this Reference Computer<ept id=\"p2\">**</ept> option, as shown in Figure 16.","pos":[41277,41385],"source":"**Capture Image** – Click the **Capture an Image of this Reference Computer** option, as shown in Figure 16."},{"content":"In the <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> field, keep the default location of the Captures folder.","pos":[41386,41462],"source":" In the **Location** field, keep the default location of the Captures folder."},{"content":"You can keep or change the name of the image file in the <bpt id=\"p1\">**</bpt>File Name<ept id=\"p1\">**</ept> field.","pos":[41463,41540],"source":" You can keep or change the name of the image file in the **File Name** field."},{"content":"When you are finished, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[41541,41579],"source":" When you are finished, click **Next**."},{"content":"Capture an image of the reference machine","pos":[41587,41628]},{"content":"Figure 16.","pos":[41718,41728]},{"content":"Use the Capture Image page to capture an image of the reference machine after deployment","pos":[41729,41817]},{"content":"<bpt id=\"p1\">**</bpt>Ready<ept id=\"p1\">**</ept> – You can review your selections by expanding <bpt id=\"p2\">**</bpt>Details<ept id=\"p2\">**</ept> on the <bpt id=\"p3\">**</bpt>Ready<ept id=\"p3\">**</ept> page.","pos":[41824,41914],"source":"**Ready** – You can review your selections by expanding **Details** on the **Ready** page."},{"content":"Click <bpt id=\"p1\">**</bpt>Begin<ept id=\"p1\">**</ept> when you are ready to perform the deployment and capture of your reference image.","pos":[41915,42012],"source":" Click **Begin** when you are ready to perform the deployment and capture of your reference image."},{"content":"Your reference task sequence will run with the specified options.","pos":[42017,42082]},{"content":"As the task sequence processes the deployment, it will automatically perform the following tasks:","pos":[42084,42181]},{"content":"Install the Windows 10 image from the installation files you supplied","pos":[42184,42253]},{"content":"Reboot into Windows 10","pos":[42256,42278]},{"content":"Run Windows updates until all Windows updates have been installed and the Windows environment is fully up to date","pos":[42281,42394]},{"content":"Run Sysprep and prepare the Windows 10 environment for deployment","pos":[42397,42462]},{"content":"Reboot into WinPE","pos":[42465,42482]},{"content":"Capture an image of the Windows 10 environment and store it in the Captures folder in the MDT deployment share","pos":[42485,42595]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The Windows Update process can take some time to complete as it searches the Internet for updates, downloads those updates, and then installs them.","pos":[42598,42766],"source":"**Note:**&nbsp;&nbsp;The Windows Update process can take some time to complete as it searches the Internet for updates, downloads those updates, and then installs them."},{"content":"By performing this process now, in the reference environment, you eliminate the need to perform these tasks on each deployed device and significantly reduce the amount of time and bandwidth required to perform your deployment.","pos":[42767,42993]},{"content":"When the task sequence completes, your virtual machine will be off and a new reference image complete with updates will be ready in your MDT deployment share for you to import it and prepare your deployment environment for deployment to Surface devices.","pos":[42996,43249]},{"content":"Deploy Windows 10 to Surface devices","pos":[43254,43290]},{"content":"With a freshly prepared reference image, you are now ready to configure the deployment process for deployment to the Surface devices.","pos":[43292,43425]},{"content":"Use the steps detailed in this section to produce a deployment process that requires minimal effort on each Surface device to produce a complete and ready-to-use Windows 10 environment.","pos":[43426,43611]},{"content":"Import reference image","pos":[43617,43639]},{"content":"After the reference image has been created and stored in the Captures folder, you need to add it to your MDT deployment share as an image for deployment.","pos":[43641,43794]},{"content":"You perform this task by using the same process that you used to import the installation files for Windows 10.","pos":[43795,43905]},{"content":"To import the reference image for deployment, use the following steps:","pos":[43907,43977]},{"pos":[43982,44248],"content":"Right-click the <bpt id=\"p1\">**</bpt>Operating Systems<ept id=\"p1\">**</ept> folder under your deployment share in the Deployment Workbench or the folder you created in when you imported Windows 10 installation files, and then click <bpt id=\"p2\">**</bpt>Import Operating System<ept id=\"p2\">**</ept> to start the Import Operating System Wizard.","source":"Right-click the **Operating Systems** folder under your deployment share in the Deployment Workbench or the folder you created in when you imported Windows 10 installation files, and then click **Import Operating System** to start the Import Operating System Wizard."},{"content":"Import the custom image with the Import Operating System Wizard by using the following steps:","pos":[44253,44346]},{"pos":[44351,44498],"content":"<bpt id=\"p1\">**</bpt>OS Type<ept id=\"p1\">**</ept> – Select Custom Image File to specify that you are importing the Windows source files from installation media, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**OS Type** – Select Custom Image File to specify that you are importing the Windows source files from installation media, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Image<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>, and then navigate to and select the image file in the <bpt id=\"p3\">**</bpt>Captures<ept id=\"p3\">**</ept> folder in your deployment share.","pos":[44503,44632],"source":"**Image** – Click **Browse**, and then navigate to and select the image file in the **Captures** folder in your deployment share."},{"content":"Select the <bpt id=\"p1\">**</bpt>Move the Files to the Deployment Share Instead of Copying Them<ept id=\"p1\">**</ept> checkbox if desired.","pos":[44633,44731],"source":" Select the **Move the Files to the Deployment Share Instead of Copying Them** checkbox if desired."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[44732,44747],"source":" Click **Next**."},{"pos":[44753,44828],"content":"<bpt id=\"p1\">**</bpt>Setup<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Setup Files are not Neededf<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Setup** – Click **Setup Files are not Neededf**, and then click **Next**."},{"pos":[44833,44952],"content":"<bpt id=\"p1\">**</bpt>Destination<ept id=\"p1\">**</ept> – Enter a name for the new folder that will be created to hold the image file, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Destination** – Enter a name for the new folder that will be created to hold the image file, and then click **Next**."},{"pos":[44957,45073],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin the import process.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin the import process."},{"pos":[45078,45163],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the image is imported, a progress bar is displayed on this page.","source":"**Progress** – While the image is imported, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the import process completes, the success of the process is displayed on this page.","pos":[45168,45275],"source":"**Confirmation** – When the import process completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the Import Operating System Wizard.","pos":[45276,45340],"source":" Click **Finish** to complete the Import Operating System Wizard."},{"content":"Expand the folder in which you imported the image to verify that the import completed successfully.","pos":[45345,45444]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You can import the reference image into the same deployment share that you used to create your reference image, or you could import the reference image into a new deployment share for deployment to your Surface devices.","pos":[45447,45687],"source":"**Note:**&nbsp;&nbsp;You can import the reference image into the same deployment share that you used to create your reference image, or you could import the reference image into a new deployment share for deployment to your Surface devices."},{"content":"If you chose to create a new deployment share for deployment of your reference image, remember that you still need to import a full set of installation files from installation media.","pos":[45688,45870]},{"content":"Now that your updated reference image is imported, it is time to prepare your deployment environment for deployment to Surface devices complete with drivers, applications, and automation.","pos":[45872,46059]},{"content":"Import Surface drivers","pos":[46065,46087]},{"content":"Before you can deploy your updated reference image to Surface devices, or any physical environment, you need to supply MDT with the drivers that Windows will use to communicate with that physical environment.","pos":[46089,46297]},{"content":"For Surface devices you can download all of the drivers required by Windows in a single archive (.zip) file in a format that is ready for deployment.","pos":[46298,46447]},{"content":"In addition to the drivers that are used by Windows to communicate with the hardware and components, Surface firmware and driver packs also include updates for the firmware of those components.","pos":[46448,46641]},{"content":"By installing the Surface firmware and driver pack, you will also bring your device’s firmware up to date.","pos":[46642,46748]},{"content":"If you have not done so already, download the drivers for your Surface device listed at <bpt id=\"p1\">[</bpt>Download the latest firmware and drivers for Surface devices<ept id=\"p1\">](https://technet.microsoft.com/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices)</ept>.","pos":[46749,47004],"source":" If you have not done so already, download the drivers for your Surface device listed at [Download the latest firmware and drivers for Surface devices](https://technet.microsoft.com/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices)."},{"content":"Many devices require that you import drivers specifically for WinPE in order for the MDT boot media to communicate with the deployment share and to boot properly on that device.","pos":[47006,47183]},{"content":"Even Surface Pro 3 required that network drivers be imported specifically for WinPE for deployment of Windows 8.1.","pos":[47184,47298]},{"content":"Fortunately, for Windows 10 deployments to Surface devices, all of the required drivers for operation of WinPE are contained within the out-of-box drivers that are built into Windows 10.","pos":[47299,47485]},{"content":"It is still a good idea to prepare your environment with folder structure and selection profiles that allow you to specify drivers for use in WinPE.","pos":[47486,47634]},{"content":"You can read more about that folder structure in <bpt id=\"p1\">**</bpt>Step 5: Prepare the drivers repository<ept id=\"p1\">**</ept> in <bpt id=\"p2\">[</bpt>Deploy a Windows 10 image using MDT 2013 Update 2<ept id=\"p2\">](https://technet.microsoft.com/en-us/itpro/windows/deploy/deploy-a-windows-10-image-using-mdt/#sec05)</ept>.","pos":[47635,47883],"source":" You can read more about that folder structure in **Step 5: Prepare the drivers repository** in [Deploy a Windows 10 image using MDT 2013 Update 2](https://technet.microsoft.com/en-us/itpro/windows/deploy/deploy-a-windows-10-image-using-mdt/#sec05)."},{"content":"To import the Surface drivers (in this example, Surface Pro 4) into MDT, follow these steps:","pos":[47885,47977]},{"content":"Extract the downloaded archive (.zip) file to a folder that you can easily locate.","pos":[47982,48064]},{"content":"Keep the driver files separate from other drivers or files.","pos":[48065,48124]},{"content":"Open the Deployment Workbench and expand the Deployment Shares node and your deployment share.","pos":[48128,48222]},{"content":"If you have not already created a folder structure by operating system version, you should do so now and create under the Windows 10 x64 folder a new folder for Surface Pro 4 drivers named Surface Pro 4.","pos":[48227,48430]},{"content":"Your Out-of-Box Drivers folder should resemble the following structure, as shown in Figure 17:","pos":[48431,48525]},{"content":"WinPE x86","pos":[48531,48540]},{"content":"WinPE x64","pos":[48546,48555]},{"content":"Windows 10 x64","pos":[48561,48575]},{"content":"Microsoft Corporation","pos":[48583,48604]},{"content":"Surface Pro 4","pos":[48614,48627]},{"content":"Recommended folder structure for drivers","pos":[48634,48674]},{"content":"Figure 17.","pos":[48760,48770]},{"content":"The recommended folder structure for drivers","pos":[48771,48815]},{"pos":[48821,48955],"content":"Right-click the <bpt id=\"p1\">**</bpt>Surface Pro 4<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>Import Drivers<ept id=\"p2\">**</ept> to start the Import Drivers Wizard, as shown in Figure 18.","source":"Right-click the **Surface Pro 4** folder, and then click **Import Drivers** to start the Import Drivers Wizard, as shown in Figure 18."},{"content":"Progress page during drivers import","pos":[48962,48997]},{"content":"Figure 18.","pos":[49078,49088]},{"content":"The Progress page during drivers import","pos":[49089,49128]},{"content":"The Import Driver Wizard displays a series of steps, as follows:","pos":[49134,49198]},{"pos":[49203,49340],"content":"<bpt id=\"p1\">**</bpt>Specify Directory<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> and navigate to the folder where you extracted the Surface Pro 4 firmware and drivers in Step 1.","source":"**Specify Directory** – Click **Browse** and navigate to the folder where you extracted the Surface Pro 4 firmware and drivers in Step 1."},{"pos":[49345,49461],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin the import process.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin the import process."},{"pos":[49466,49554],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the drivers are imported, a progress bar is displayed on this page.","source":"**Progress** – While the drivers are imported, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the import process completes, the success of the process is displayed on this page.","pos":[49559,49666],"source":"**Confirmation** – When the import process completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the Import Drivers Wizard.","pos":[49667,49722],"source":" Click **Finish** to complete the Import Drivers Wizard."},{"pos":[49727,49856],"content":"Click the <bpt id=\"p1\">**</bpt>Surface Pro 4<ept id=\"p1\">**</ept> folder and verify that the folder now contains the drivers that were imported, as shown in Figure 19.","source":"Click the **Surface Pro 4** folder and verify that the folder now contains the drivers that were imported, as shown in Figure 19."},{"content":"Drivers for Surface Pro 4 imported and organized in the MDT deployment share","pos":[49863,49939]},{"content":"Figure 19.","pos":[50061,50071]},{"content":"Drivers for Surface Pro 4 imported and organized in the MDT deployment share","pos":[50072,50148]},{"content":"Import applications","pos":[50155,50174]},{"content":"You can import any number of applications into MDT for installation on your devices during the deployment process.","pos":[50176,50290]},{"content":"You can configure your applications and task sequences to prompt you during deployment to pick and choose which applications are installed, or you can use your task sequence to explicitly define which applications are installed.","pos":[50291,50519]},{"content":"For more information, see <bpt id=\"p1\">**</bpt>Step 4: Add an application<ept id=\"p1\">**</ept> in <bpt id=\"p2\">[</bpt>Deploy a Windows 10 image using MDT 2013 Update 2<ept id=\"p2\">](https://technet.microsoft.com/en-us/itpro/windows/deploy/deploy-a-windows-10-image-using-mdt/#sec04)</ept>.","pos":[50520,50733],"source":" For more information, see **Step 4: Add an application** in [Deploy a Windows 10 image using MDT 2013 Update 2](https://technet.microsoft.com/en-us/itpro/windows/deploy/deploy-a-windows-10-image-using-mdt/#sec04)."},{"content":"Import Microsoft Office 365 Installer","pos":[50740,50777]},{"content":"The Office Deployment Tool is a free download available in the Microsoft Download Center that allows IT professionals and system administrators to download and prepare Office installation packages for Office Click-to-Run.","pos":[50779,51000]},{"content":"You can find the Office Deployment Tool and instructions to download Click-to-Run for Office 365 installation source files at <bpt id=\"p1\">[</bpt>Download Click-to-Run for Office 365 products by using the Office Deployment Tool<ept id=\"p1\">](https://technet.microsoft.com/library/jj219424)</ept>.","pos":[51001,51259],"source":" You can find the Office Deployment Tool and instructions to download Click-to-Run for Office 365 installation source files at [Download Click-to-Run for Office 365 products by using the Office Deployment Tool](https://technet.microsoft.com/library/jj219424)."},{"content":"Download and install the version of Office Deployment Tool (ODT), for Office 2013 or Office 2016, that fits your organization’s needs and use the steps provided by that page to download the Office installation files for use with MDT.","pos":[51261,51494]},{"content":"After you have downloaded the source files for your version of Office Click-to-Run, you need to edit the Configuration.xml file with instructions to install Office Click-to-Run silently.","pos":[51496,51682]},{"content":"To configure the Office Deployment Tool for silent installation, follow these steps:","pos":[51683,51767]},{"pos":[51772,51849],"content":"Right-click the existing <bpt id=\"p1\">**</bpt>Configuration.xml<ept id=\"p1\">**</ept> file, and then click <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept>.","source":"Right-click the existing **Configuration.xml** file, and then click **Edit**."},{"content":"This action opens the file in Notepad.","pos":[51853,51891]},{"content":"Replace the existing text with the following:","pos":[51892,51937]},{"content":"Save the file.","pos":[52176,52190]},{"content":"The default behavior of Setup.exe is to look for the source files in the path that contains <bpt id=\"p1\">**</bpt>Setup.exe<ept id=\"p1\">**</ept>.","pos":[52192,52298],"source":"The default behavior of Setup.exe is to look for the source files in the path that contains **Setup.exe**."},{"content":"If the installation files are not found in this folder, the Office Deployment Tool will default to online source files from an Internet connection.","pos":[52299,52446]},{"content":"For MDT to perform an automated installation of office, it is important to configure the <bpt id=\"p1\">**</bpt>Display Level<ept id=\"p1\">**</ept> option to a value of <bpt id=\"p2\">**</bpt>None<ept id=\"p2\">**</ept>.","pos":[52448,52585],"source":"For MDT to perform an automated installation of office, it is important to configure the **Display Level** option to a value of **None**."},{"content":"This setting is used to suppress the installation dialog box for silent installation.","pos":[52586,52671]},{"content":"It is required that the <bpt id=\"p1\">**</bpt>AcceptEULA<ept id=\"p1\">**</ept> option is set to <bpt id=\"p2\">**</bpt>True<ept id=\"p2\">**</ept> to accept the license agreement when the <bpt id=\"p3\">**</bpt>Display Level<ept id=\"p3\">**</ept> option is set to <bpt id=\"p4\">**</bpt>None<ept id=\"p4\">**</ept>.","pos":[52672,52822],"source":" It is required that the **AcceptEULA** option is set to **True** to accept the license agreement when the **Display Level** option is set to **None**."},{"content":"With both of these options configured, the installation of Office will occur without the display of dialog boxes which could potentially cause the installation to pause until a user can address an open dialog box.","pos":[52823,53036]},{"content":"Now that the installation and configuration files are prepared, the application can be imported into the deployment share by following these steps:","pos":[53038,53185]},{"content":"Open the Deployment Workbench.","pos":[53190,53220]},{"pos":[53225,53389],"content":"Expand the deployment share, right-click the <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>New Application<ept id=\"p2\">**</ept> to start the New Application Wizard, as shown in Figure 20.","source":"Expand the deployment share, right-click the **Applications** folder, and then click **New Application** to start the New Application Wizard, as shown in Figure 20."},{"content":"Enter the command and directory for Office 2016 Click-to-Run","pos":[53396,53456]},{"content":"Figure 20.","pos":[53562,53572]},{"content":"Enter the command and directory for Office 2016 Click-to-Run","pos":[53573,53633]},{"content":"The New Application Wizard walks you through importing the Office 2016 Click-to-Run files, as follows:","pos":[53639,53741]},{"pos":[53746,53834],"content":"<bpt id=\"p1\">**</bpt>Application Type<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Application with Source Files<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Application Type** – Click **Application with Source Files**, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Details<ept id=\"p1\">**</ept> – Enter a name for the application (for example, Office 2016 Click-to-Run) in the <bpt id=\"p2\">**</bpt>Application Name<ept id=\"p2\">**</ept> field.","pos":[53839,53960],"source":"**Details** – Enter a name for the application (for example, Office 2016 Click-to-Run) in the **Application Name** field."},{"content":"Enter publisher, version, and language information in the <bpt id=\"p1\">**</bpt>Publisher<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Version<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Language<ept id=\"p3\">**</ept> fields if desired.","pos":[53961,54082],"source":" Enter publisher, version, and language information in the **Publisher**, **Version**, and **Language** fields if desired."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[54083,54098],"source":" Click **Next**."},{"pos":[54103,54278],"content":"<bpt id=\"p1\">**</bpt>Source<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to navigate to and select the folder where you downloaded the Office installation files with the Office Deployment Tool, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Source** – Click **Browse** to navigate to and select the folder where you downloaded the Office installation files with the Office Deployment Tool, and then click **Next**."},{"pos":[54283,54491],"content":"<bpt id=\"p1\">**</bpt>Destination<ept id=\"p1\">**</ept> – Enter a name for the folder where the application files will be stored in the <bpt id=\"p2\">**</bpt>Specify the Name of the Directory that Should Be Created<ept id=\"p2\">**</ept> field or click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept> to accept the default name.","source":"**Destination** – Enter a name for the folder where the application files will be stored in the **Specify the Name of the Directory that Should Be Created** field or click **Next** to accept the default name."},{"pos":[54496,54577],"content":"<bpt id=\"p1\">**</bpt>Command Details<ept id=\"p1\">**</ept> – Enter the Office Deployment Tool installation command line:","source":"**Command Details** – Enter the Office Deployment Tool installation command line:"},{"pos":[54630,54746],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin the import process.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin the import process."},{"pos":[54751,54850],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the installation files are imported, a progress bar is displayed on this page.","source":"**Progress** – While the installation files are imported, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the import process completes, the success of the process is displayed on this page.","pos":[54855,54962],"source":"**Confirmation** – When the import process completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the New Application Wizard.","pos":[54963,55019],"source":" Click **Finish** to complete the New Application Wizard."},{"pos":[55024,55143],"content":"You should now see the <bpt id=\"p1\">**</bpt>Office 2016 Click-to-Run<ept id=\"p1\">**</ept> item under the <bpt id=\"p2\">**</bpt>Applications<ept id=\"p2\">**</ept> folder in the Deployment Workbench.","source":"You should now see the **Office 2016 Click-to-Run** item under the **Applications** folder in the Deployment Workbench."},{"content":"Import Surface app installer","pos":[55150,55178]},{"content":"The Surface app is a Windows Store app that provides the user with greater control over specific Surface device functions and capabilities (for example, control over the sensitivity of the Surface Pen).","pos":[55180,55382]},{"content":"It is a highly recommended app for Surface devices to provide end users with the best experience and greatest control over their device.","pos":[55383,55519]},{"content":"Find out more about the Surface app at <bpt id=\"p1\">[</bpt>Install and use the Surface app<ept id=\"p1\">](https://www.microsoft.com/surface/en-us/support/apps-and-windows-store/surface-app?os=windows-10)</ept>.","pos":[55520,55691],"source":" Find out more about the Surface app at [Install and use the Surface app](https://www.microsoft.com/surface/en-us/support/apps-and-windows-store/surface-app?os=windows-10)."},{"content":"To perform a deployment of the Surface app, you will need to download the app files through Windows Store for Business.","pos":[55693,55812]},{"content":"You can find detailed instructions on how to download the Surface app through Windows Store for Business at <bpt id=\"p1\">[</bpt>Deploy Surface app with Windows Store for Business<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/deploy-surface-app-with-windows-store-for-business)</ept>.","pos":[55813,56076],"source":" You can find detailed instructions on how to download the Surface app through Windows Store for Business at [Deploy Surface app with Windows Store for Business](https://technet.microsoft.com/en-us/itpro/surface/deploy-surface-app-with-windows-store-for-business)."},{"content":"After you have downloaded the installation files for Surface app, including the AppxBundle and license files, you can import these files into the deployment share through the same process as a desktop application like Microsoft Office.","pos":[56078,56313]},{"content":"Both the AppxBundle and license files must be together in the same folder for the import process to complete successfully.","pos":[56314,56436]},{"content":"Use the following command on the <bpt id=\"p1\">**</bpt>Command Details<ept id=\"p1\">**</ept> page to install the Surface app:","pos":[56437,56522],"source":" Use the following command on the **Command Details** page to install the Surface app:"},{"content":"Create deployment task sequence","pos":[56758,56789]},{"content":"The next step in the process is to create the deployment task sequence.","pos":[56791,56862]},{"content":"This task sequence will be configured to completely automate the deployment process and will work along with customized deployment share rules to reduce the need for user interaction down to a single touch.","pos":[56863,57069]},{"content":"Before you can make  customizations to include all of this automation, the new task sequence has to be created from a template.","pos":[57070,57197]},{"content":"To create the deployment task sequence, follow these steps:","pos":[57199,57258]},{"pos":[57262,57438],"content":"In the Deployment Workbench, under your Deployment Share, right-click the <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>New Task Sequence<ept id=\"p2\">**</ept> to start the New Task Sequence Wizard.","source":"In the Deployment Workbench, under your Deployment Share, right-click the **Task Sequences** folder, and then click **New Task Sequence** to start the New Task Sequence Wizard."},{"content":"Use these steps to create the deployment task sequence with the New Task Sequence Wizard:","pos":[57442,57531]},{"pos":[57536,57835],"content":"<bpt id=\"p1\">**</bpt>General Settings<ept id=\"p1\">**</ept> – Enter an identifier for the deployment task sequence in the <bpt id=\"p2\">**</bpt>Task Sequence ID<ept id=\"p2\">**</ept> field, a name for the deployment task sequence in the <bpt id=\"p3\">**</bpt>Task Sequence Name<ept id=\"p3\">**</ept> field, and any comments for the deployment task sequence in the <bpt id=\"p4\">**</bpt>Task Sequence Comments<ept id=\"p4\">**</ept> field, then click <bpt id=\"p5\">**</bpt>Next<ept id=\"p5\">**</ept>.","source":"**General Settings** – Enter an identifier for the deployment task sequence in the **Task Sequence ID** field, a name for the deployment task sequence in the **Task Sequence Name** field, and any comments for the deployment task sequence in the **Task Sequence Comments** field, then click **Next**."},{"pos":[57839,57951],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The <bpt id=\"p2\">**</bpt>Task Sequence ID<ept id=\"p2\">**</ept> field cannot contain spaces and can be a maximum of 16 characters.","source":"**Note:**&nbsp;&nbsp;The **Task Sequence ID** field cannot contain spaces and can be a maximum of 16 characters."},{"pos":[57956,58067],"content":"<bpt id=\"p1\">**</bpt>Select Template<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Standard Client Task Sequence<ept id=\"p2\">**</ept> from the drop-down menu, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Select Template** – Click **Standard Client Task Sequence** from the drop-down menu, and then click **Next**."},{"pos":[58072,58174],"content":"<bpt id=\"p1\">**</bpt>Select OS<ept id=\"p1\">**</ept> – Navigate to and select the reference image that you imported, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Select OS** – Navigate to and select the reference image that you imported, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Specify Product Key<ept id=\"p1\">**</ept> – Select the product key entry that fits your organization's licensing system.","pos":[58179,58281],"source":"**Specify Product Key** – Select the product key entry that fits your organization's licensing system."},{"content":"The <bpt id=\"p1\">**</bpt>Do Not Specify a Product Key at This Time<ept id=\"p1\">**</ept> option can be used for systems that will be activated via Key Management Services (KMS) or Active Directory Based Activation (ADBA).","pos":[58282,58464],"source":" The **Do Not Specify a Product Key at This Time** option can be used for systems that will be activated via Key Management Services (KMS) or Active Directory Based Activation (ADBA)."},{"content":"A product key can be specified specifically if your organization uses Multiple Activation Keys (MAK).","pos":[58465,58566]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[58567,58582],"source":" Click **Next**."},{"pos":[58587,58832],"content":"<bpt id=\"p1\">**</bpt>OS Settings<ept id=\"p1\">**</ept> – Enter a name and organization for registration of Windows, and a home page URL for users when they browse the Internet in the <bpt id=\"p2\">**</bpt>Full Name<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Organization<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Internet Explorer Home Page<ept id=\"p4\">**</ept> fields, and then click <bpt id=\"p5\">**</bpt>Next<ept id=\"p5\">**</ept>.","source":"**OS Settings** – Enter a name and organization for registration of Windows, and a home page URL for users when they browse the Internet in the **Full Name**, **Organization**, and **Internet Explorer Home Page** fields, and then click **Next**."},{"pos":[58837,58980],"content":"<bpt id=\"p1\">**</bpt>Admin Password<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Use the Specified Local Administrator Password<ept id=\"p2\">**</ept>, enter a password in the provided field, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Admin Password** – Click **Use the Specified Local Administrator Password**, enter a password in the provided field, and then click **Next**."},{"pos":[58985,59112],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin creation of the task sequence.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the task sequence."},{"pos":[59117,59215],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the task sequence is being created, a progress bar is displayed on this page.","source":"**Progress** – While the task sequence is being created, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the task sequence creation completes, the success of the process is displayed on this page.","pos":[59220,59335],"source":"**Confirmation** – When the task sequence creation completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the New Task Sequence Wizard.","pos":[59336,59394],"source":" Click **Finish** to complete the New Task Sequence Wizard."},{"content":"After the task sequence is created it can be modified for increased automation, such as the installation of applications without user interaction, the selection of drivers, and the installation of Windows updates.","pos":[59396,59609]},{"pos":[59614,59728],"content":"Click the <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> folder, right-click the new task sequence you created, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"Click the **Task Sequences** folder, right-click the new task sequence you created, and then click **Properties**."},{"pos":[59732,59825],"content":"Click the <bpt id=\"p1\">**</bpt>Task Sequence<ept id=\"p1\">**</ept> tab to view the steps that are included in the new task sequence.","source":"Click the **Task Sequence** tab to view the steps that are included in the new task sequence."},{"pos":[59829,59938],"content":"Click the <bpt id=\"p1\">**</bpt>Windows Update (Pre-Application Installation)<ept id=\"p1\">**</ept> step, located under the <bpt id=\"p2\">**</bpt>State Restore<ept id=\"p2\">**</ept> folder.","source":"Click the **Windows Update (Pre-Application Installation)** step, located under the **State Restore** folder."},{"pos":[59942,60020],"content":"Click the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> tab, and then clear the <bpt id=\"p2\">**</bpt>Disable This Step<ept id=\"p2\">**</ept> check box.","source":"Click the **Options** tab, and then clear the **Disable This Step** check box."},{"pos":[60024,60115],"content":"Repeat Step 4 and Step 5 for the <bpt id=\"p1\">**</bpt>Windows Update (Post-Application Installation)<ept id=\"p1\">**</ept> option.","source":"Repeat Step 4 and Step 5 for the **Windows Update (Post-Application Installation)** option."},{"content":"Between the two <bpt id=\"p1\">**</bpt>Windows Update<ept id=\"p1\">**</ept> steps is the <bpt id=\"p2\">**</bpt>Install Applications<ept id=\"p2\">**</ept> step.","pos":[60119,60197],"source":"Between the two **Windows Update** steps is the **Install Applications** step."},{"content":"Click the <bpt id=\"p1\">**</bpt>Install Applications<ept id=\"p1\">**</ept> step, and then click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","pos":[60198,60262],"source":" Click the **Install Applications** step, and then click **Add**."},{"content":"Hover the mouse over <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> under the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> menu, and then click <bpt id=\"p3\">**</bpt>Install Application<ept id=\"p3\">**</ept>.","pos":[60266,60362],"source":"Hover the mouse over **General** under the **Add** menu, and then click **Install Application**."},{"content":"This will add a new step after the selected step for the installation of a specific application as shown in Figure 21.","pos":[60363,60481]},{"content":"A new Install Application step in the deployment task sequence","pos":[60488,60550]},{"content":"Figure 21.","pos":[60658,60668]},{"content":"A new Install Application step in the deployment task sequence","pos":[60669,60731]},{"pos":[60737,60879],"content":"On the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> tab of the new <bpt id=\"p2\">**</bpt>Install Application<ept id=\"p2\">**</ept> step, enter <bpt id=\"p3\">**</bpt>Install Microsoft Office 2016 Click-to-Run<ept id=\"p3\">**</ept> in the <bpt id=\"p4\">**</bpt>Name<ept id=\"p4\">**</ept> field.","source":"On the **Properties** tab of the new **Install Application** step, enter **Install Microsoft Office 2016 Click-to-Run** in the **Name** field."},{"pos":[60883,61030],"content":"Click <bpt id=\"p1\">**</bpt>Install a Single Application<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to view available applications that have been imported into the deployment share.","source":"Click **Install a Single Application**, and then click **Browse** to view available applications that have been imported into the deployment share."},{"pos":[61035,61120],"content":"Select Office 2016 Click-to-Run from the list of applications, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Select Office 2016 Click-to-Run from the list of applications, and then click **OK**."},{"content":"Repeat Steps 6 through 10 for the Surface app.","pos":[61125,61171]},{"pos":[61176,61265],"content":"Expand the <bpt id=\"p1\">**</bpt>Preinstall<ept id=\"p1\">**</ept> folder, and then click the <bpt id=\"p2\">**</bpt>Enable BitLocker (Offline)<ept id=\"p2\">**</ept> step.","source":"Expand the **Preinstall** folder, and then click the **Enable BitLocker (Offline)** step."},{"pos":[61270,61372],"content":"Open the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> menu again and choose <bpt id=\"p2\">**</bpt>Set Task Sequence Variable<ept id=\"p2\">**</ept> from under the <bpt id=\"p3\">**</bpt>General<ept id=\"p3\">**</ept> menu.","source":"Open the **Add** menu again and choose **Set Task Sequence Variable** from under the **General** menu."},{"pos":[61377,61507],"content":"On the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> tab of the new <bpt id=\"p2\">**</bpt>Set Task Sequence Variable<ept id=\"p2\">**</ept> step (as shown in Figure 22), configure the following options:","source":"On the **Properties** tab of the new **Set Task Sequence Variable** step (as shown in Figure 22), configure the following options:"},{"pos":[61512,61541],"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> – Set DriverGroup001","source":"**Name** – Set DriverGroup001"},{"pos":[61546,61589],"content":"<bpt id=\"p1\">**</bpt>Task Sequence Variable<ept id=\"p1\">**</ept> – DriverGroup001","source":"**Task Sequence Variable** – DriverGroup001"},{"pos":[61594,61635],"content":"<bpt id=\"p1\">**</bpt>Value<ept id=\"p1\">**</ept> – Windows 10 x64\\%Make%\\%Model%","source":"**Value** – Windows 10 x64\\%Make%\\%Model%"},{"content":"Configure a new Set Task Sequence Variable step in the deployment task sequence","pos":[61642,61721]},{"content":"Figure 22.","pos":[61845,61855]},{"content":"Configure a new Set Task Sequence Variable step in the deployment task sequence","pos":[61856,61935]},{"pos":[61941,62012],"content":"Select the <bpt id=\"p1\">**</bpt>Inject Drivers<ept id=\"p1\">**</ept> step, the next step in the task sequence.","source":"Select the **Inject Drivers** step, the next step in the task sequence."},{"pos":[62017,62131],"content":"On the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Inject Drivers<ept id=\"p2\">**</ept> step (as shown in Figure 23), configure the following options:","source":"On the **Properties** tab of the **Inject Drivers** step (as shown in Figure 23), configure the following options:"},{"pos":[62136,62209],"content":"In the <bpt id=\"p1\">**</bpt>Choose a selection profile<ept id=\"p1\">**</ept> drop-down menu, select <bpt id=\"p2\">**</bpt>Nothing<ept id=\"p2\">**</ept>.","source":"In the **Choose a selection profile** drop-down menu, select **Nothing**."},{"pos":[62214,62282],"content":"Click the <bpt id=\"p1\">**</bpt>Install all drivers from the selection profile<ept id=\"p1\">**</ept> button.","source":"Click the **Install all drivers from the selection profile** button."},{"content":"Configure deployment task sequence not to choose the drivers to inject into Windows","pos":[62289,62372]},{"content":"Figure 23.","pos":[62501,62511]},{"content":"Configure the deployment task sequence not to choose the drivers to inject into Windows","pos":[62512,62599]},{"pos":[62606,62703],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply changes to the task sequence and close the task sequence properties window.","source":"Click **OK** to apply changes to the task sequence and close the task sequence properties window."},{"content":"Configure deployment share rules","pos":[62709,62741]},{"content":"The experience of users during a Windows deployment is largely governed by a set of rules that control how the MDT and Windows Deployment Wizard experience should proceed.","pos":[62743,62914]},{"content":"These rules are stored in two configuration files.","pos":[62915,62965]},{"content":"Boot media rules are stored in the Bootstrap.ini file that is processed when the MDT boot media is first run.","pos":[62966,63075]},{"content":"Deployment share rules are stored in the Customsettings.ini file and tell the Windows Deployment Wizard how to operate (for example, what screens to show and what questions to ask).","pos":[63076,63257]},{"content":"By using these the rules stored in these two files, you can completely automate the process of deployment to where you will not be asked to supply the answer to any questions during deployment and the deployment will perform all tasks completely on its own.","pos":[63258,63515]},{"content":"Configure Bootstrap.ini","pos":[63522,63545]},{"content":"Bootstrap.ini is the simpler of the two rule files.","pos":[63547,63598]},{"content":"The purpose it serves is to provide instructions from when the MDT boot media starts on a device until the Windows Deployment Wizard is started.","pos":[63599,63743]},{"content":"The primary use of this file is to provide the credentials that will be used to log on to the deployment share and start the Windows Deployment Wizard.","pos":[63744,63895]},{"content":"To automate the boot media rules, follow these steps:","pos":[63897,63950]},{"pos":[63955,64048],"content":"Right-click your deployment share in the Deployment Workbench, and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"Right-click your deployment share in the Deployment Workbench, and then click **Properties**."},{"pos":[64052,64148],"content":"Click the <bpt id=\"p1\">**</bpt>Rules<ept id=\"p1\">**</ept> tab, and then click <bpt id=\"p2\">**</bpt>Edit Bootstrap.ini<ept id=\"p2\">**</ept> to open Bootstrap.ini in Notepad.","source":"Click the **Rules** tab, and then click **Edit Bootstrap.ini** to open Bootstrap.ini in Notepad."},{"content":"Replace the text of the Bootstrap.ini file with the following text:","pos":[64152,64219]},{"content":"Press Ctrl+S to save Bootstrap.ini, and then close Notepad.","pos":[64500,64559]},{"content":"You can use a number of variables in both boot media and deployment share rules to apply rules only when certain conditions are met.","pos":[64561,64693]},{"content":"For example, you can use MAC addresses to identify specific machines where MDT will run fully automated, but will run with required user interaction on all other devices.","pos":[64694,64864]},{"content":"You can also use the model of the device to instruct the MDT boot media to perform different actions based on computer model, much as the way <bpt id=\"p1\">**</bpt>[Surface Pro 4]<ept id=\"p1\">**</ept> is listed in Step 3.","pos":[64865,65047],"source":" You can also use the model of the device to instruct the MDT boot media to perform different actions based on computer model, much as the way **[Surface Pro 4]** is listed in Step 3."},{"content":"You can use the following cmdlet in a PowerShell session to see what the Model variable would be on a device:","pos":[65048,65157]},{"content":"Rules used in the text shown in Step 3 include:","pos":[65193,65240]},{"pos":[65244,65338],"content":"<bpt id=\"p1\">**</bpt>DeployRoot<ept id=\"p1\">**</ept> – Used to specify the deployment share that the MDT boot media will connect to.","source":"**DeployRoot** – Used to specify the deployment share that the MDT boot media will connect to."},{"pos":[65341,65435],"content":"<bpt id=\"p1\">**</bpt>UserDomain<ept id=\"p1\">**</ept> – Used to specify the domain or computer where the MDT user account is located.","source":"**UserDomain** – Used to specify the domain or computer where the MDT user account is located."},{"pos":[65438,65532],"content":"<bpt id=\"p1\">**</bpt>UserID<ept id=\"p1\">**</ept> – Used to specify the MDT user account for automatic logon to the deployment share.","source":"**UserID** – Used to specify the MDT user account for automatic logon to the deployment share."},{"pos":[65535,65636],"content":"<bpt id=\"p1\">**</bpt>UserPassword<ept id=\"p1\">**</ept> – Used to specify the MDT user password for automatic logon to the deployment share.","source":"**UserPassword** – Used to specify the MDT user password for automatic logon to the deployment share."},{"pos":[65639,65798],"content":"<bpt id=\"p1\">**</bpt>SkipBDDWelcome<ept id=\"p1\">**</ept> – Used to skip the Welcome page and to start the Windows Deployment Wizard immediately using the specified credentials and deployment share.","source":"**SkipBDDWelcome** – Used to skip the Welcome page and to start the Windows Deployment Wizard immediately using the specified credentials and deployment share."},{"content":"Configure CustomSettings.ini","pos":[65805,65833]},{"content":"The bulk of the rules used to automate the MDT deployment process are stored in the deployment share rules, or the Customsettings.ini file.","pos":[65835,65974]},{"content":"In this file you can answer and hide all of the prompts from the Windows Deployment Wizard, which yields a deployment experience that mostly consists of a progress bar that displays the automated actions occurring on the device.","pos":[65975,66203]},{"content":"The deployment share rules are shown directly in the <bpt id=\"p1\">**</bpt>Rules<ept id=\"p1\">**</ept> tab of the deployment share properties, as shown in Figure 24.","pos":[66204,66329],"source":" The deployment share rules are shown directly in the **Rules** tab of the deployment share properties, as shown in Figure 24."},{"content":"Deployment share rules configured for automation of the Windows Deployment Wizard","pos":[66333,66414]},{"content":"Figure 24.","pos":[66538,66548]},{"content":"Deployment share rules configured for automation of the Windows Deployment Wizard","pos":[66549,66630]},{"pos":[66633,66797],"content":"To configure automation for the production deployment, copy and paste the following text into the text box on the <bpt id=\"p1\">**</bpt>Rules<ept id=\"p1\">**</ept> tab of your deployment share properties:","source":"To configure automation for the production deployment, copy and paste the following text into the text box on the **Rules** tab of your deployment share properties:"},{"content":"Rules used in this example include:","pos":[67552,67587]},{"pos":[67591,67736],"content":"<bpt id=\"p1\">**</bpt>SkipTaskSequence<ept id=\"p1\">**</ept> – This rule is used to skip the <bpt id=\"p2\">**</bpt>Task Sequence<ept id=\"p2\">**</ept> page where the user would have to select between available task sequences.","source":"**SkipTaskSequence** – This rule is used to skip the **Task Sequence** page where the user would have to select between available task sequences."},{"content":"<bpt id=\"p1\">**</bpt>TaskSequenceID<ept id=\"p1\">**</ept> – This rule is used to instruct the Windows Deployment Wizard to run a specific task sequence.","pos":[67739,67852],"source":"**TaskSequenceID** – This rule is used to instruct the Windows Deployment Wizard to run a specific task sequence."},{"content":"In this scenario the task sequence ID should match the deployment task sequence you created in the previous section.","pos":[67853,67969]},{"pos":[67972,68093],"content":"<bpt id=\"p1\">**</bpt>OSInstall<ept id=\"p1\">**</ept> – This rule indicates that the Windows Deployment Wizard will be performing an operating system deployment.","source":"**OSInstall** – This rule indicates that the Windows Deployment Wizard will be performing an operating system deployment."},{"pos":[68096,68252],"content":"<bpt id=\"p1\">**</bpt>SkipCapture<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Capture Image<ept id=\"p2\">**</ept> page from being displayed, prompting the user to create an image of this device after deployment.","source":"**SkipCapture** – This rule prevents the **Capture Image** page from being displayed, prompting the user to create an image of this device after deployment."},{"content":"<bpt id=\"p1\">**</bpt>SkipAdminPassword<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Admin Password<ept id=\"p2\">**</ept> page from being displayed.","pos":[68255,68347],"source":"**SkipAdminPassword** – This rule prevents the **Admin Password** page from being displayed."},{"content":"The Administrator password specified in the task sequence will still be applied.","pos":[68348,68428]},{"content":"<bpt id=\"p1\">**</bpt>SkipProductKey<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Specify Product Key<ept id=\"p2\">**</ept> page from being displayed.","pos":[68431,68525],"source":"**SkipProductKey** – This rule prevents the **Specify Product Key** page from being displayed."},{"content":"The product key specified in the task sequence will still be applied.","pos":[68526,68595]},{"pos":[68598,68805],"content":"<bpt id=\"p1\">**</bpt>SkipComputerBackup<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Move Data and Settings<ept id=\"p2\">**</ept> page from being displayed, where the user is asked if they would like to make a backup of the computer before performing deployment.","source":"**SkipComputerBackup** – This rule prevents the **Move Data and Settings** page from being displayed, where the user is asked if they would like to make a backup of the computer before performing deployment."},{"pos":[68808,68983],"content":"<bpt id=\"p1\">**</bpt>SkipBitLocker<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>BitLocker<ept id=\"p2\">**</ept> page from being displayed, where the user is asked if BitLocker Drive Encryption should be used to encrypt the device.","source":"**SkipBitLocker** – This rule prevents the **BitLocker** page from being displayed, where the user is asked if BitLocker Drive Encryption should be used to encrypt the device."},{"pos":[68986,69124],"content":"<bpt id=\"p1\">**</bpt>SkipBDDWelcome<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Welcome<ept id=\"p2\">**</ept> page from being displayed, where the user is prompted to begin Windows deployment.","source":"**SkipBDDWelcome** – This rule prevents the **Welcome** page from being displayed, where the user is prompted to begin Windows deployment."},{"pos":[69127,69309],"content":"<bpt id=\"p1\">**</bpt>SkipUserData<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>User Data (Restore)<ept id=\"p2\">**</ept> page from being displayed, where the user is asked to restore previously backed up user data in the new environment.","source":"**SkipUserData** – This rule prevents the **User Data (Restore)** page from being displayed, where the user is asked to restore previously backed up user data in the new environment."},{"pos":[69312,69436],"content":"<bpt id=\"p1\">**</bpt>UserDataLocation<ept id=\"p1\">**</ept> – This rule prevents the user from being prompted to supply a location on the User Data (Restore) page.","source":"**UserDataLocation** – This rule prevents the user from being prompted to supply a location on the User Data (Restore) page."},{"pos":[69439,69633],"content":"<bpt id=\"p1\">**</bpt>SkipApplications<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Applications<ept id=\"p2\">**</ept> page from being displayed, where the user is prompted to select from available applications to be installed in the new environment.","source":"**SkipApplications** – This rule prevents the **Applications** page from being displayed, where the user is prompted to select from available applications to be installed in the new environment."},{"pos":[69636,69824],"content":"<bpt id=\"p1\">**</bpt>SkipPackageDisplay<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Packages<ept id=\"p2\">**</ept> page from being displayed, where the user is prompted to select from available packages to be installed in the new environment.","source":"**SkipPackageDisplay** – This rule prevents the **Packages** page from being displayed, where the user is prompted to select from available packages to be installed in the new environment."},{"pos":[69827,70055],"content":"<bpt id=\"p1\">**</bpt>SkipComputerName<ept id=\"p1\">**</ept> – This rule, when combined with the <bpt id=\"p2\">**</bpt>SkipDomainMembership<ept id=\"p2\">**</ept> rule, prevents the <bpt id=\"p3\">**</bpt>Computer Details<ept id=\"p3\">**</ept> page from being displayed, where the user is asked to supply computer name and join a domain or workgroup.","source":"**SkipComputerName** – This rule, when combined with the **SkipDomainMembership** rule, prevents the **Computer Details** page from being displayed, where the user is asked to supply computer name and join a domain or workgroup."},{"pos":[70058,70286],"content":"<bpt id=\"p1\">**</bpt>SkipDomainMembership<ept id=\"p1\">**</ept> – This rule, when combined with the <bpt id=\"p2\">**</bpt>SkipComputerName<ept id=\"p2\">**</ept> rule, prevents the <bpt id=\"p3\">**</bpt>Computer Details<ept id=\"p3\">**</ept> page from being displayed, where the user is asked to supply computer name and join a domain or workgroup.","source":"**SkipDomainMembership** – This rule, when combined with the **SkipComputerName** rule, prevents the **Computer Details** page from being displayed, where the user is asked to supply computer name and join a domain or workgroup."},{"pos":[70289,70435],"content":"<bpt id=\"p1\">**</bpt>JoinDomain<ept id=\"p1\">**</ept> – This rule instructs the Windows Deployment Wizard to have the computer join the specified domain using the specified credentials.","source":"**JoinDomain** – This rule instructs the Windows Deployment Wizard to have the computer join the specified domain using the specified credentials."},{"pos":[70439,70520],"content":"<bpt id=\"p1\">**</bpt>DomainAdmin<ept id=\"p1\">**</ept> – This rule specifies the username for the domain join operation.","source":"**DomainAdmin** – This rule specifies the username for the domain join operation."},{"pos":[70523,70625],"content":"<bpt id=\"p1\">**</bpt>DomainAdminDomain<ept id=\"p1\">**</ept> – This rule specifies the domain for the username for the domain join operation.","source":"**DomainAdminDomain** – This rule specifies the domain for the username for the domain join operation."},{"pos":[70628,70734],"content":"<bpt id=\"p1\">**</bpt>DomainAdminPassword<ept id=\"p1\">**</ept> – This rule specifies the password for the username for the domain join operation.","source":"**DomainAdminPassword** – This rule specifies the password for the username for the domain join operation."},{"pos":[70737,70872],"content":"<bpt id=\"p1\">**</bpt>SkipLocaleSelection<ept id=\"p1\">**</ept> –  This rule, along with the <bpt id=\"p2\">**</bpt>SkipTimeZone<ept id=\"p2\">**</ept> rule, prevents the <bpt id=\"p3\">**</bpt>Locale and Time<ept id=\"p3\">**</ept> page from being displayed.","source":"**SkipLocaleSelection** –  This rule, along with the **SkipTimeZone** rule, prevents the **Locale and Time** page from being displayed."},{"pos":[70875,70982],"content":"<bpt id=\"p1\">**</bpt>KeyboardLocale<ept id=\"p1\">**</ept> – This rule is used to specify the keyboard layout for the deployed Windows environment.","source":"**KeyboardLocale** – This rule is used to specify the keyboard layout for the deployed Windows environment."},{"pos":[70985,71092],"content":"<bpt id=\"p1\">**</bpt>UserLocale<ept id=\"p1\">**</ept> – This rule is used to specify the geographical locale for the deployed Windows environment.","source":"**UserLocale** – This rule is used to specify the geographical locale for the deployed Windows environment."},{"pos":[71095,71201],"content":"<bpt id=\"p1\">**</bpt>UILanguage<ept id=\"p1\">**</ept> – This rule is used to specify the language to be used in the deployed Windows environment.","source":"**UILanguage** – This rule is used to specify the language to be used in the deployed Windows environment."},{"pos":[71204,71339],"content":"<bpt id=\"p1\">**</bpt>SkipTimeZone<ept id=\"p1\">**</ept> –  This rule, along with the <bpt id=\"p2\">**</bpt>SkipLocaleSelection<ept id=\"p2\">**</ept> rule, prevents the <bpt id=\"p3\">**</bpt>Locale and Time<ept id=\"p3\">**</ept> page from being displayed.","source":"**SkipTimeZone** –  This rule, along with the **SkipLocaleSelection** rule, prevents the **Locale and Time** page from being displayed."},{"pos":[71342,71441],"content":"<bpt id=\"p1\">**</bpt>TimeZoneName<ept id=\"p1\">**</ept> – This rule is used to specify the time zone for the deployed Windows environment.","source":"**TimeZoneName** – This rule is used to specify the time zone for the deployed Windows environment."},{"pos":[71444,71564],"content":"<bpt id=\"p1\">**</bpt>UserID<ept id=\"p1\">**</ept> – This rule is used to supply the username under which the MDT actions and task sequence steps are performed.","source":"**UserID** – This rule is used to supply the username under which the MDT actions and task sequence steps are performed."},{"pos":[71567,71706],"content":"<bpt id=\"p1\">**</bpt>UserDomain<ept id=\"p1\">**</ept> – This rule is used to supply the domain for the username under which the MDT actions and task sequence steps are performed.","source":"**UserDomain** – This rule is used to supply the domain for the username under which the MDT actions and task sequence steps are performed."},{"pos":[71709,71852],"content":"<bpt id=\"p1\">**</bpt>UserPassword<ept id=\"p1\">**</ept> – This rule is used to supply the password for the username under which the MDT actions and task sequence steps are performed.","source":"**UserPassword** – This rule is used to supply the password for the username under which the MDT actions and task sequence steps are performed."},{"pos":[71855,72055],"content":"<bpt id=\"p1\">**</bpt>SkipSummary<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Summary<ept id=\"p2\">**</ept> page from being displayed before the task sequence is run, where the user is prompted to confirm the selections before beginning the task sequence.","source":"**SkipSummary** – This rule prevents the **Summary** page from being displayed before the task sequence is run, where the user is prompted to confirm the selections before beginning the task sequence."},{"pos":[72058,72179],"content":"<bpt id=\"p1\">**</bpt>SkipFinalSummary<ept id=\"p1\">**</ept> – This rule prevents the <bpt id=\"p2\">**</bpt>Summary<ept id=\"p2\">**</ept> page from being displayed when the task sequence has completed.","source":"**SkipFinalSummary** – This rule prevents the **Summary** page from being displayed when the task sequence has completed."},{"pos":[72182,72311],"content":"<bpt id=\"p1\">**</bpt>FinishAction<ept id=\"p1\">**</ept> – This rule specifies whether to log out, reboot, or shut down the device after the task sequence has completed.","source":"**FinishAction** – This rule specifies whether to log out, reboot, or shut down the device after the task sequence has completed."},{"pos":[72313,72486],"content":"You can read about all of the possible deployment share and boot media rules in the <bpt id=\"p1\">[</bpt>Microsoft Deployment Toolkit Reference<ept id=\"p1\">](https://technet.microsoft.com/library/dn781091)</ept>.","source":"You can read about all of the possible deployment share and boot media rules in the [Microsoft Deployment Toolkit Reference](https://technet.microsoft.com/library/dn781091)."},{"content":"Update and import updated MDT boot media","pos":[72492,72532]},{"content":"The process to update MDT boot media with these new rules and changes to the deployment share is very similar to the process to generate boot media from scratch.","pos":[72534,72695]},{"content":"To update the MDT boot media, follow these steps:","pos":[72697,72746]},{"pos":[72751,72900],"content":"Right-click the deployment share in the Deployment Workbench, and then click <bpt id=\"p1\">**</bpt>Update Deployment Share<ept id=\"p1\">**</ept> to start the Update Deployment Share Wizard.","source":"Right-click the deployment share in the Deployment Workbench, and then click **Update Deployment Share** to start the Update Deployment Share Wizard."},{"content":"The Update Deployment Share Wizard displays a series of steps, as follows:","pos":[72904,72978]},{"content":"<bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> – Choose between the <bpt id=\"p2\">**</bpt>Completely Regenerate the Boot Images<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Optimize the Boot Image Updating Process<ept id=\"p3\">**</ept> options.","pos":[72983,73114],"source":"**Options** – Choose between the **Completely Regenerate the Boot Images** or **Optimize the Boot Image Updating Process** options."},{"content":"Completely regenerating the boot images will take more time, but produces boot media that is not fragmented and does not contain out of date components.","pos":[73115,73267]},{"content":"Optimizing the boot image updating process will proceed more quickly, but may result in longer load times when booting via PXE.","pos":[73268,73395]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[73396,73411],"source":" Click **Next**."},{"pos":[73416,73533],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified options on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin the update of boot images.","source":"**Summary** – Review the specified options on this page before you click **Next** to begin the update of boot images."},{"pos":[73538,73634],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the boot images are being updated a progress bar is displayed on this page.","source":"**Progress** – While the boot images are being updated a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the boot images have been updated, the success of the process is displayed on this page.","pos":[73639,73751],"source":"**Confirmation** – When the boot images have been updated, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete the Update Deployment Share Wizard.","pos":[73752,73816],"source":" Click **Finish** to complete the Update Deployment Share Wizard."},{"content":"To import the updated MDT boot media into WDS for PXE boot, follow these steps:","pos":[73818,73897]},{"content":"Open Windows Deployment Services from the Start menu or Start screen.","pos":[73902,73971]},{"pos":[73975,74021],"content":"Expand <bpt id=\"p1\">**</bpt>Servers<ept id=\"p1\">**</ept> and your deployment server.","source":"Expand **Servers** and your deployment server."},{"pos":[74025,74058],"content":"Click the <bpt id=\"p1\">**</bpt>Boot Images<ept id=\"p1\">**</ept> folder.","source":"Click the **Boot Images** folder."},{"pos":[74062,74174],"content":"Right-click the existing MDT boot image, and then click <bpt id=\"p1\">**</bpt>Replace Image<ept id=\"p1\">**</ept> to open the Replace Boot Image Wizard.","source":"Right-click the existing MDT boot image, and then click **Replace Image** to open the Replace Boot Image Wizard."},{"content":"Replace the previously imported MDT boot image with the updated version by using these steps in the Replace Boot Image Wizard:","pos":[74178,74304]},{"content":"<bpt id=\"p1\">**</bpt>Image File<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> and navigate to the <bpt id=\"p3\">**</bpt>Boot<ept id=\"p3\">**</ept> folder in your deployment share, click <bpt id=\"p4\">**</bpt>LiteTouchPE_x86.wim<ept id=\"p4\">**</ept>, and then click <bpt id=\"p5\">**</bpt>Open<ept id=\"p5\">**</ept>.","pos":[74309,74460],"source":"**Image File** – Click **Browse** and navigate to the **Boot** folder in your deployment share, click **LiteTouchPE_x86.wim**, and then click **Open**."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[74461,74476],"source":" Click **Next**."},{"pos":[74481,74596],"content":"<bpt id=\"p1\">**</bpt>Available Images<ept id=\"p1\">**</ept> – Only one image should be listed and selected <bpt id=\"p2\">**</bpt>LiteTouch Windows PE (x86)<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Available Images** – Only one image should be listed and selected **LiteTouch Windows PE (x86)**, click **Next**."},{"pos":[74601,74723],"content":"<bpt id=\"p1\">**</bpt>Image Metadata<ept id=\"p1\">**</ept> – Enter a name and description for the MDT boot media, or click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to accept the default options.","source":"**Image Metadata** – Enter a name and description for the MDT boot media, or click **Next** to accept the default options."},{"pos":[74728,74826],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review your selections for importing a boot image into WDS, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Summary** – Review your selections for importing a boot image into WDS, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Task Progress<ept id=\"p1\">**</ept> – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder.","pos":[74831,74956],"source":"**Task Progress** – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> when the task is complete to close the Replace Boot Image Wizard.","pos":[74957,75039],"source":" Click **Finish** when the task is complete to close the Replace Boot Image Wizard."},{"pos":[75043,75141],"content":"Right-click the <bpt id=\"p1\">**</bpt>Boot Images<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>Add Image<ept id=\"p2\">**</ept> to open the Add Image Wizard.","source":"Right-click the **Boot Images** folder, and then click **Add Image** to open the Add Image Wizard."},{"content":"Add the new 64-bit boot image for 64-bit UEFI device compatibility with the Add Image Wizard , as follows:","pos":[75145,75251]},{"content":"<bpt id=\"p1\">**</bpt>Image File<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> and navigate to the <bpt id=\"p3\">**</bpt>Boot<ept id=\"p3\">**</ept> folder in your deployment share, select <bpt id=\"p4\">**</bpt>LiteTouchPE_x64.wim<ept id=\"p4\">**</ept>, and then click <bpt id=\"p5\">**</bpt>Open<ept id=\"p5\">**</ept>.","pos":[75256,75408],"source":"**Image File** – Click **Browse** and navigate to the **Boot** folder in your deployment share, select **LiteTouchPE_x64.wim**, and then click **Open**."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[75409,75424],"source":" Click **Next**."},{"pos":[75429,75551],"content":"<bpt id=\"p1\">**</bpt>Image Metadata<ept id=\"p1\">**</ept> – Enter a name and description for the MDT boot media, or click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to accept the default options.","source":"**Image Metadata** – Enter a name and description for the MDT boot media, or click **Next** to accept the default options."},{"pos":[75556,75650],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review your selections to import a boot image into WDS, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Summary** – Review your selections to import a boot image into WDS, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Task Progress<ept id=\"p1\">**</ept> – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder.","pos":[75655,75780],"source":"**Task Progress** – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> when the task is complete to close the Add Image Wizard.","pos":[75781,75854],"source":" Click **Finish** when the task is complete to close the Add Image Wizard."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Although it is a best practice to replace and update the boot images in WDS whenever the MDT deployment share is updated, for deployment to Surface devices the 32-bit boot image, LiteTouchPE_x86.wim, is not required.","pos":[75857,76094],"source":"**Note:**&nbsp;&nbsp;Although it is a best practice to replace and update the boot images in WDS whenever the MDT deployment share is updated, for deployment to Surface devices the 32-bit boot image, LiteTouchPE_x86.wim, is not required."},{"content":"Only the 64-bit boot image is required for 64-bit UEFI devices.","pos":[76095,76158]},{"content":"Deploy Windows to Surface","pos":[76164,76189]},{"content":"With all of the automation provided by the deployment share rules and task sequence, performing the deployment on each Surface device becomes as easy as a single touch.","pos":[76191,76359]},{"pos":[76362,76652],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For the deployment to require only a single touch, the Surface devices must be connected to a keyboard, connected to the network with a Microsoft Surface USB Ethernet Adapter or Surface Dock, and configured with PXE boot as the first boot option, as shown in Figure 25.","source":"**Note:**&nbsp;&nbsp;For the deployment to require only a single touch, the Surface devices must be connected to a keyboard, connected to the network with a Microsoft Surface USB Ethernet Adapter or Surface Dock, and configured with PXE boot as the first boot option, as shown in Figure 25."},{"content":"Set boot priority for PXE boot","pos":[76656,76686]},{"content":"Figure 25.","pos":[76759,76769]},{"content":"Setting boot priority for PXE boot","pos":[76770,76804]},{"content":"On a properly configured Surface device, simply turn on the device and press Enter when you are prompted to boot from the network.","pos":[76807,76937]},{"content":"The fully automated MDT deployment process will then take over and perform the following tasks:","pos":[76938,77033]},{"content":"The MDT boot media will be loaded to your Surface device via the network","pos":[77037,77109]},{"content":"The MDT boot media will use the provided credentials and rules to connect to the MDT deployment share","pos":[77112,77213]},{"content":"The task sequence and drivers will be automatically selected for your device via make and model information","pos":[77216,77323]},{"content":"The task sequence will deploy your updated Windows 10 image to the device complete with the selected drivers","pos":[77326,77434]},{"content":"The task sequence will join your device to the domain","pos":[77437,77490]},{"content":"The task sequence will install the applications you specified, Microsoft Office and Surface app","pos":[77493,77588]},{"content":"Windows Update will run, installing any new Windows Updates or updates for installed applications, like Microsoft Office","pos":[77591,77711]},{"content":"The task sequence will complete silently and log out of the device","pos":[77714,77780]},{"pos":[77783,77987],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For Surface devices not configured to boot to the network as the first boot option, you can hold Volume Down and press Power to boot the system immediately to a USB or network device.","source":"**Note:**&nbsp;&nbsp;For Surface devices not configured to boot to the network as the first boot option, you can hold Volume Down and press Power to boot the system immediately to a USB or network device."},{"content":"The resulting configuration is a Surface device that is logged out and ready for an end user to enter their credentials, log on, and get right to work.","pos":[77989,78140]},{"content":"The applications and drivers they need are already installed and up to date.","pos":[78141,78217]}],"content":"---\ntitle: Deploy Windows 10 to Surface devices with Microsoft Deployment Toolkit (Surface)\ndescription: Walk through the recommended process of how to deploy Windows 10 to your Surface devices with the Microsoft Deployment Toolkit.\nkeywords: windows 10 surface, automate, customize, mdt\nms.prod: w10\nms.mktglfcycl: deploy\nms.pagetype: surface\nms.sitesec: library\nauthor: Scottmca\n---\n\n# Deploy Windows 10 to Surface devices with Microsoft Deployment Toolkit\n\n#### Applies to\n* Surface Pro 4\n* Surface Book\n* Surface 3\n* Windows 10\n\nThis article walks you through the recommended process to deploy Windows 10 to Surface devices with Microsoft deployment technologies. The process described in this article yields a complete Windows 10 environment including updated firmware and drivers for your Surface device along with applications like Microsoft Office 365 and the Surface app. When the process is complete, the Surface device will be ready for use by the end user. You can customize this process to include your own applications and configuration to meet the needs of your organization. You can also follow the guidance provided in this article to integrate deployment to Surface devices into existing deployment strategies.\n\nBy following the procedures in this article, you can create an up-to-date reference image and deploy this image to your Surface devices, a process known as *reimaging*. Reimaging will erase and overwrite the existing environment on your Surface devices. This process allows you to rapidly configure your Surface devices with identical environments that can be configured to precisely fit your organization’s requirements. \n\nAn alternative to the reimaging process is an upgrade process. The upgrade process is non-destructive and instead of erasing the existing environment on your Surface device, it allows you to install Windows 10 while retaining your user data, applications, and settings. You can read about how to manage and automate the upgrade process of Surface devices to Windows 10 at [Upgrade Surface devices to Windows 10 with MDT](upgrade-surface-devices-to-windows-10-with-mdt.md). \n\nThe goal of the deployment process presented in this article is automation. By leveraging the many technologies and tools available from Microsoft, you can create a process that requires only a single touch on the devices being deployed. The automation can load the deployment environment; format the device; prepare an updated Windows image with the drivers required for the device; apply that image to the device; configure the Windows environment with licensing, membership in a domain, and user accounts; install applications; apply any Windows updates that were not included in the reference image; and log out.\n\nBy automating each aspect of the deployment process, you not only greatly decrease the effort involved, but you create a process that can be easily repeated and where human error becomes less of a factor. Take for example a scenario where you create a reference image for the device manually, but you accidentally install conflicting applications and cause the image to become unstable. In this scenario you have no choice but to begin again the manual process of creating your image. If in this same scenario you had automated the reference image creation process, you could repair the conflict by simply editing a step in the task sequence and then re-running the task sequence.\n\n## Deployment tools\n\nThe deployment process described in this article leverages a number of Microsoft deployment tools and technologies. Some of these tools and technologies are included in Windows client and Windows Server, such as Hyper-V and Windows Deployment Services (WDS), while others are available as free downloads from the [Microsoft Download Center](https://www.microsoft.com/en-us/download/windows.aspx).\n\n#### Microsoft Deployment Toolkit\n\nThe Microsoft Deployment Toolkit (MDT) is the primary component of a Windows deployment. It serves as a unified interface for most of the Microsoft deployment tools and technologies, such as the Windows Assessment and Deployment Kit (Windows ADK), Windows System Image Manager (Windows SIM), Deployment Image Servicing and Management (DISM), User State Migration Tool (USMT), and many other tools and technologies. Each of these is discussed throughout this article. The unified interface, called the *Deployment Workbench*, facilitates automation of the deployment process through a series of stored deployment procedures, known as a *task sequence*. Along with these task sequences and the many scripts and tools that MDT provides, the resources for a Windows deployment (driver files, application installation files, and image files) are stored in a network share known as the *deployment share*. \n\nYou can download and find out more about MDT at [Microsoft Deployment Toolkit](https://technet.microsoft.com/en-us/windows/dn475741).\n\n#### Windows Assessment and Deployment Kit\n\nAlthough MDT is the tool you will interact with most during the deployment process, the deployment tools found in the Windows ADK perform most of the deployment tasks during the deployment process. The resources for deployment are held within the MDT deployment share, but it is the collection of tools included in Windows ADK that access the image files, stage drivers and Windows updates, run the deployment experience, provide instructions to Windows Setup, and back up and restore user data.\n\nYou can download and find out more about the Windows ADK at [Download the Windows ADK](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#windowsadk).\n\n#### Windows 10 installation media\n\nBefore you can perform a deployment with MDT, you must first supply a set of operating system installation files and an operating system image. These files and image can be found on the physical installation media (DVD) for Windows 10. You can also find these files in the disk image (ISO file) for Windows 10, which you can download from the [Volume Licensing Service Center (VLSC)](https://www.microsoft.com/Licensing/servicecenter/default.aspx).\n\n>**Note:**&nbsp;&nbsp;The installation media generated from the [Get Windows 10](https://www.microsoft.com/en-us/software-download/windows10/) page differs from physical media or media downloaded from the VLSC, in that it contains an image file in Electronic Software Download (ESD) format rather than in the Windows Imaging (WIM) format. Installation media with an image file in WIM format is required for use with MDT. Installation media from the Get Windows 10 page cannot be used for Windows deployment with MDT.\n\n#### Windows Server\n\nAlthough MDT can be installed on a Windows client, to take full advantage of Windows Deployment Services’ ability to network boot, a full Windows Server environment is recommended. To provide network boot for UEFI devices like Surface with WDS, you will need Windows Server 2008 R2 or later.\n\n>**Note:**&nbsp;&nbsp;To evaluate the deployment process for Surface devices or to test the deployment process described in this article with the upcoming release of Windows Server 2016, you can download evaluation and preview versions from the [TechNet Evaluation Center](https://www.microsoft.com/en-us/evalcenter).\n\n#### Windows Deployment Services\n\nWindows Deployment Services (WDS) is leveraged to facilitate network boot capabilities provided by the Preboot Execution Environment (PXE) server. The boot media generated by MDT is loaded onto the Surface device simply by pressing Enter at the prompt when the device attempts to boot from the attached network adapter or Surface Dock.\n\n#### Hyper-V virtualization platform\n\nThe process of creating a reference image should always be performed in a virtual environment. When you use a virtual machine as the platform to build your reference image, you eliminate the need for installation of additional drivers. The drivers for a Hyper-V virtual machine are included by default in the factory Windows 10 image. When you avoid the installation of additional drivers – especially complex drivers that include application components like control panel applications – you ensure that the image created by your reference image process will be as universally compatible as possible.\n\n>**Note:**&nbsp;&nbsp;A Generation 1 virtual machine is recommended for the preparation of a reference image in a Hyper-V virtual environment.\n\nBecause customizations are performed by MDT at the time of deployment, the goal of reference image creation is not to perform customization but to increase performance during deployment by reducing the number of actions that need to occur on each deployed device. The biggest action that can slow down an MDT deployment is the installation of Windows updates. When MDT performs this step during the deployment process, it downloads the updates on each deployed device and installs them. By installing Windows updates in your reference image, the updates are already installed when the image is deployed to the device and the MDT update process only needs to install updates that are new since the image was created or are applicable to products other than Windows (for example, Microsoft Office updates).\n\n>**Note:**&nbsp;&nbsp;Hyper-V is available not only on Windows Server, but also on Windows clients, including Professional and Enterprise editions of Windows 8, Windows 8.1, and Windows 10. Find out more at [Client Hyper-V on Windows 10](https://msdn.microsoft.com/virtualization/hyperv_on_windows/windows_welcome) and [Client Hyper-V on Windows 8 and Windows 8.1](https://technet.microsoft.com/library/hh857623) in the TechNet Library.  Hyper-V is also available as a standalone product, Microsoft Hyper-V Server, at no cost. You can download [Microsoft Hyper-V Server 2012 R2](https://www.microsoft.com/en-us/evalcenter/evaluate-hyper-v-server-2012-r2) or [Microsoft Hyper-V Server 2016 Technical Preview](https://www.microsoft.com/en-us/evalcenter/evaluate-hyper-v-server-technical-preview) from the TechNet Evaluation Center.\n\n#### Surface firmware and drivers\n\nFor your deployed Windows environment to function correctly on your Surface devices, you will need to install the drivers used by Windows to communicate with the components of your device. These drivers are available for download in the Microsoft Download Center for each Surface device. You can find the correct Microsoft Download Center page for your device at [Download the latest firmware and drivers for Surface devices](https://technet.microsoft.com/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices).\n\nWhen you browse to the specific Microsoft Download Center page for your device, you will notice that there are two files available for download. One file is a Windows Installer (.msi) file. This file is used to update drivers on devices that are already running Windows or that have device management solutions. The other file is an archive (.zip) file. This file contains the individual driver files that are used during deployment, or for manual installation with Device Manager. The file that you will need to download is the .zip archive file. You can read more about the difference between the firmware and driver pack file types at [Manage Surface driver and firmware updates](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-pro-3-firmware-updates).\n\n\nIn addition to the driver files that help Windows communicate with the hardware components of the Surface device, the .zip file you download will also contain firmware updates. These firmware updates will update the instructions used by the device hardware to communicate between components and Windows. The firmware of Surface device components is updated by installation of specific driver files and thus is installed along with the other drivers during deployment. The firmware of an out-of-date Surface device is thus updated when the device reboots during and after the Windows deployment process.\n\n>**Note:**&nbsp;&nbsp;Beginning in Windows 10, the drivers for Surface devices are included in the Windows Preinstallation Environment (WinPE). In earlier versions of Windows, specific drivers (like network drivers) had to be imported and configured in MDT for use in WinPE to successfully deploy to Surface devices.\n\n#### Application installation files\n\nIn addition to the drivers that are used by Windows to communicate with the Surface device’s hardware and components, you will also need to provide the installation files for any applications that you want to install on your deployed Surface devices. To automate the deployment of an application, you will also need to determine the command-line instructions for that application to perform a silent installation. In this article, the Surface app and Microsoft Office 365 will be installed as examples of application installation. The application installation process can be used with any application with installation files that can be launched from command line.\n\n>**Note:**&nbsp;&nbsp;If the application files for your application are stored on your organization’s network and will be accessible from your Surface devices during the deployment process, you can deploy that application directly from that network location. To use installation files from a network location, use the **Install Application Without Source Files or Elsewhere on the Network** option in the MDT New Application Wizard, which is described in the [Import applications](#import-applications) section later in this article.\n\n#### Microsoft Surface Deployment Accelerator\n\nIf you want to deploy only to Surface devices or you want an accelerated method to perform deployment to Surface devices, you can use the Microsoft Surface Deployment Accelerator to generate an MDT deployment share complete with Surface device drivers, Surface apps, and pre-configured task sequences to create a reference image and perform deployment to Surface devices. Microsoft Surface Deployment Accelerator can automatically import boot images into WDS and prepare WDS for network boot (PXE). You can download the Microsoft Surface Deployment Accelerator from the [Surface Tools for IT](https://www.microsoft.com/en-us/download/details.aspx?id=46703) page in the Microsoft Download Center.\n\n### Install the deployment tools\n\nBefore you can configure the deployment environment with Windows images, drivers, and applications, you must first install the deployment tools that will be used throughout the deployment process. The three main tools to be installed are WDS, Windows ADK, and MDT. WDS provides the capacity for network boot, Windows ADK provides several deployment tools that perform specific deployment tasks, and MDT provides automation and a central interface from which to manage and control the deployment process.\n\nTo boot from the network with either your reference virtual machines or your Surface devices, your deployment environment must include a Windows Server environment. The Windows Server environment is required to install WDS and the WDS PXE server. Without PXE support, you will be required to create physical boot media, such as a USB stick to perform your deployment – MDT and Windows ADK will still be required, but Windows Server is not required. Both MDT and Windows ADK can be installed on a Windows client and perform a Windows deployment.\n\n>**Note:**&nbsp;&nbsp;To download deployment tools directly to Windows Server, you must disable [Internet Explorer Enhanced Security Configuration](https://technet.microsoft.com/library/dd883248). On Windows Server 2012 R2, this can be performed directly through the **Server Manager** option on the **Local Server** tab. In the **Properties** section, **IE Enhanced Security Configuration** can be found on the right side. You may also need to enable the **File Download** option for the **Internet** zone through the **Security** tab of **Internet Options**.\n\n#### Install Windows Deployment Services\n\nWindows Deployment Services (WDS) is a Windows Server role. To add the WDS role to a Windows Server 2012 R2 environment, use the Add Roles and Features Wizard, as shown in Figure 1. Start the Add Roles and Features Wizard from the **Manage** button of **Server Manager**. Install both the Deployment Server and Transport Server role services.\n\n![Install the Windows Deployment Services role](images\\surface-deploymdt-fig1.png \"Install the Windows Deployment Services role\")\n\n*Figure 1. Install the Windows Deployment Services server role*\n\nAfter the WDS role is installed, you need to configure WDS. You can begin the configuration process from the WDS node of Server Manager by right-clicking your server’s name and then clicking **Windows Deployment Services Management Console**. In the **Windows Deployment Services** window, expand the **Servers** node to find your server, right-click your server, and then click **Configure** in the menu to start the Windows Deployment Services Configuration Wizard, as shown in Figure 2.\n\n![Configure PXE response for Windows Deployment Services](images\\surface-deploymdt-fig2.png \"Configure PXE response for Windows Deployment Services\")\n\n*Figure 2. Configure PXE response for Windows Deployment Services*\n\n>**Note:**&nbsp;&nbsp;Before you configure WDS make sure you have a local NTFS volume that is not your system drive (C:) available for use with WDS. This volume is used to store WDS boot images, deployment images, and configuration.\n\nUsing the Windows Deployment Services Configuration Wizard, configure WDS to fit the needs of your organization. You can find detailed instructions for the installation and configuration of WDS at [Windows Deployment Services Getting Started Guide for Windows Server 2012](https://technet.microsoft.com/library/jj648426). On the **PXE Server Initial Settings** page, be sure to configure WDS so that it will respond to your Surface devices when they attempt to boot from the network. If you have already installed WDS or need to change your PXE server response settings, you can do so on the **PXE Response** tab of the **Properties** of your server in the Windows Deployment Services Management Console.\n\n>**Note:**&nbsp;&nbsp;You will add boot images to WDS when you update your boot images in MDT. You do not need to add boot images or Windows images to WDS when you configure the role.\n\n#### Install Windows Assessment and Deployment Kit\n\nTo install Windows ADK, run the Adksetup.exe file that you downloaded from [Download the Windows ADK](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#adkwin10). Windows ADK must be installed before MDT. You should always download and use the most recent version of Windows ADK. A new version is usually released corresponding with each new version of Windows.\n\n>**Note:**&nbsp;&nbsp;You can also use the Adksetup.exe file to download the Windows ADK installation files locally for use on other devices.\n\nWhen you get to the **Select the features you want to install** page, you only need to select the **Deployment Tools** and **Windows Preinstallation Environment (Windows PE)** check boxes to deploy Windows 10 using MDT, as shown in Figure 3. \n\n![Required options for deployment with MDT](images\\surface-deploymdt-fig3.png \"Required options for deployment with MDT\")\n\n*Figure 3. Only Deployment Tools and Windows PE options are required for deployment with MDT*\n\n#### Install Microsoft Deployment Toolkit\n\nAfter the Windows ADK installation completes successfully, you can install MDT. When you download MDT, ensure that you download the version that matches the architecture of your deployment server environment. For Windows Server the architecture is 64-bit. Download the MDT installation file that ends in **x64**. When MDT is installed you can use the default options during the installation wizard, as shown in Figure 4.\n\n![MDT installation with default options](images/surface-deploymdt-fig4.png \"MDT installation with default options\")\n\n*Figure 4. Install the Microsoft Deployment Toolkit with default options*\n\nBefore you can open the MDT Deployment Workbench, you must enable execution of scripts in PowerShell. If you do not do this, the following error message may be displayed: *\"Initialization Error PowerShell is required to use the Deployment Workbench.  Please install PowerShell then relaunch Deployment Workbench.\"*\n\nTo enable the execution of scripts, run the following cmdlet in PowerShell as an Administrator:\n\n   `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser`\n\n## Create a reference image\n\nNow that you have installed the required tools, you can begin the first step of customizing your deployment environment to your needs – create a reference image. Because the reference image should be created in a virtual machine where there is no need for drivers to be installed, and because the reference image will not include applications, you can use the MDT deployment environment almost entirely with default settings.\n\n### Create a deployment share\n\nNow that you have the tools installed, the next step is to configure MDT for the creation of a reference image. Before you can perform the process of creating a reference image, MDT needs to be set up with a repository for scripts, images, and other deployment resources. This repository is known as the *deployment share*. After the deployment share is created, you must supply MDT with a complete set of Windows 10 installation files, the last set of tools required before MDT can perform reference image creation.\n\nTo create the deployment share, follow these steps:\n\n1. Open the Deployment Workbench from your Start menu or Start screen, as shown in Figure 5.\n\n   ![The MDT Deployment Workbench](images\\surface-deploymdt-fig5.png \"The MDT Deployment Workbench\")\n\n   *Figure 5. The MDT Deployment Workbench*\n\n2. Right-click the **Deployment Shares** folder, and then click **New Deployment Share** to start the New Deployment Share Wizard, as shown in Figure 6.\n\n   ![Summary page of the New Deployment Share Wizard](images\\surface-deploymdt-fig6.png \"Summary page of the New Deployment Share Wizard\")\n\n   *Figure 6. The Summary page of the New Deployment Share Wizard*\n\n3. Create a new deployment share with New Deployment Share Wizard with the following steps:\n\n  * **Path** – Specify a local folder where the deployment share will reside, and then click **Next**.\n\n      >**Note:**&nbsp;&nbsp;Like the WDS remote installation folder, it is recommended that you put this folder on an NTFS volume that is not your system volume.\n\n  * **Share** – Specify a name for the network share under which the local folder specified on the **Path** page will be shared, and then click **Next**.\n\n      >**Note:**&nbsp;&nbsp;The share name cannot contain spaces.\n\n      >**Note:**&nbsp;&nbsp;You can use a Dollar Sign (**$**) to hide your network share so that it will not be displayed when users browse the available network shares on the server in File Explorer.\n\n  * **Descriptive Name** – Enter a descriptive name for the network share (this descriptive name can contain spaces), and then click **Next**. The descriptive name will be the name of the folder as it appears in the Deployment Workbench.\n  * **Options** – You can accept the default options on this page. Click **Next**.\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the deployment share.\n  * **Progress** – While the deployment share is being created, a progress bar is displayed on this page to indicate the status of the deployment share creation process.\n  * **Confirmation** – When the deployment share creation process completes, the success of the process is displayed on this page. Click **Finish** to complete the New Deployment Share Wizard.\n\n4. When the New Deployment Share Wizard is complete, you can expand the Deployment Shares folder to find your newly created deployment share.\n5. You can expand your deployment share, where you will find several folders for the resources, scripts, and components of your MDT deployment environment are stored.\n\nTo secure the deployment share and prevent unauthorized access to the deployment resources, you can create a local user on the deployment share host and configure permissions for that user to have read-only access to the deployment share only. It is especially important to secure access to the deployment share if you intend to automate the logon to the deployment share during the deployment boot process. By automating the logon to the deployment share during the boot of deployment media, the credentials for that logon are stored in plaintext in the bootstrap.ini file on the boot media.\n\n>**Note:**&nbsp;&nbsp;If you intend to capture images (such as the reference image) with this user, the user must also have write permission on the Captures folder in the MDT deployment share.\n\nYou now have an empty deployment share that is ready for you to add the resources that will be required for reference image creation and deployment to Surface devices.\n\n### Import Windows installation files\n\nThe first resources that are required to perform a deployment of Windows are the installation files from Windows 10 installation media. Even if you have an already prepared reference image, you still need to supply the unaltered installation files from your installation media. The source of these files can be a physical disk, or it can be an ISO file like the download from the Volume Licensing Service Center (VLSC).\n\n>**Note:**&nbsp;&nbsp;A 64-bit operating system is required for compatibility with Surface Pro 4, Surface Book, Surface Pro 3, and Surface 3.\n\nTo import Windows 10 installation files, follow these steps:\n\n1. Right-click the **Operating Systems** folder under your deployment share in the Deployment Workbench, and then click **New Folder** to open the **New Folder** page, as shown in Figure 7.\n\n   ![Create a new folder on the New Folder page](images\\surface-deploymdt-fig7.png \"Create a new folder on the New Folder page\")\n   \n   *Figure 7. Create a new folder on the New Folder page*\n\n2. On the **New Folder** page a series of steps is displayed, as follows:\n  * **General Settings** – Enter a name for the folder in the **Folder Name** field (for example, Windows 10 Enterprise), add any comments you want in the **Comments** field, and then click **Next**.\n  * **Summary** – Review the specified configuration of the new folder on this page, and then click **Next**.\n  * **Progress** – A progress bar will be displayed on this page while the folder is created. This page will likely pass very quickly.\n  * **Confirmation** – When the new folder has been created, a **Confirmation** page displays the success of the operation. Click **Finish** to close the **New Folder** page.\n3. Expand the Operating Systems folder to see the newly created folder.\n4. Right-click the newly created folder, and then click **Import Operating System** to launch the Import Operating System Wizard, as shown in Figure 8.\n\n   ![Import source files with the Import Operating System Wizard](images\\surface-deploymdt-fig8.png \"Import source files with the Import Operating System Wizard\")\n\n   *Figure 8. Import source files with the Import Operating System Wizard*\n\n5. The Import Operating System Wizard walks you through the import of your operating system files, as follows:\n  * **OS Type** – Click **Full Set of Source Files** to specify that you are importing the Windows source files from installation media, and then click **Next**.\n  * **Source** – Click **Browse**, move to and select the folder or drive where your installation files are found, and then click **Next**.\n  * **Destination** – Enter a name for the new folder that will be created to hold the installation files, and then click **Next**.\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin the import process.\n  * **Progress** – While the installation files are imported, a progress bar is displayed on this page.\n  * **Confirmation** – When the operating system import process completes, the success of the process is displayed on this page. Click **Finish** to complete Import Operating System Wizard.\n6.  Expand the folder you created in Step 1 to see the entry for your newly imported installation files for Windows 10.\n\nNow that you’ve imported the installation files from the installation media, you have the files that MDT needs to create the reference image and you are ready to instruct MDT how to create the reference image to your specifications.\n\n### Create reference image task sequence\n\nAs described in the [Deployment tools](#deployment-tools) section of this article, the goal of creating a reference image is to keep the Windows environment as simple as possible while performing tasks that would be common to all devices being deployed. You should now have a basic MDT deployment share configured with default options and a set of unaltered, factory installation files for Windows 10. This simple configuration is perfect for reference image creation because the deployment share contains no applications or drivers to interfere with the process.\n\n>**Note:**&nbsp;&nbsp;For some organizations keeping a simple deployment share without applications or drivers is the simplest solution for creation of reference images. You can easily connect to more than one deployment share from a single Deployment Workbench and copy images from a simple, reference-image-only deployment share to a production deployment share complete with drivers and applications.\n\nTo create the reference image task sequence, follow these steps:\n\n1. Right-click the **Task Sequences** folder under your deployment share in the Deployment Workbench, and then click **New Task Sequence** to start the New Task Sequence Wizard, as shown in Figure 9.\n\n   ![Create new task sequence to deploy and update a Windows 10 reference environment](images\\surface-deploymdt-fig9.png \"Create new task sequence to deploy and update a Windows 10 reference environment\")\n\n   *Figure 9. Create a new task sequence to deploy and update a Windows 10 reference environment*\n\n2. The New Task Sequence Wizard presents a series of steps, as follows:\n  * **General Settings** – Enter an identifier for the reference image task sequence in the **Task Sequence ID** field, a name for the reference image task sequence in the **Task Sequence Name** field, and any comments for the reference image task sequence in the **Task Sequence Comments** field, and then click **Next**.\n  >**Note:**&nbsp;&nbsp;The **Task Sequence ID** field cannot contain spaces and can be a maximum of 16 characters.\n  * **Select Template** – Select **Standard Client Task Sequence** from the drop-down menu, and then click **Next**.\n  * **Select OS** – Navigate to and select the Windows 10 image you imported with the Windows 10 installation files, and then click **Next**.\n  * **Specify Product Key** – Click **Do Not Specify a Product Key at This Time**, and then click **Next**.\n  * **OS Settings** – Enter a name, organization, and home page URL in the **Full Name**, **Organization**, and **Internet Explorer Home Page** fields, and then click **Next**.\n  * **Admin Password** – Click **Use the Specified Local Administrator Password**, enter a password in the provided field, and then click **Next**.\n  >**Note:**&nbsp;&nbsp;During creation of a reference image, any specified Administrator password will be automatically removed when the image is prepared for capture with Sysprep. During reference image creation, a password is not necessary, but is recommended to remain in line with best practices for production deployment environments.\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the task sequence.\n  * **Progress** – While the task sequence is created, a progress bar is displayed on this page.\n  * **Confirmation** – When the task sequence creation completes, the success of the process is displayed on this page. Click **Finish** to complete the New Task Sequence Wizard.\n2. Select the **Task Sequences** folder, right-click the new task sequence you created, and then click **Properties**.\n3. Select the **Task Sequence** tab to view the steps that are included in the Standard Client Task Sequence template, as shown in Figure 10.\n\n   ![Enable Windows Update in the reference image task sequence](images\\surface-deploymdt-fig10.png \"Enable Windows Update in the reference image task sequence\")\n\n   *Figure 10. Enable Windows Update in the reference image task sequence*\n\n4. Select the **Windows Update (Pre-Application Installation)** option, located under the **State Restore** folder.\n5. Click the **Options** tab, and then clear the **Disable This Step** check box.\n6. Repeat Step 4 and Step 5 for the **Windows Update (Post-Application Installation)** option.\n7. Click **OK** to apply changes to the task sequence, and then close the task sequence properties window.\n\n### Generate and import MDT boot media\n\nTo boot the reference virtual machine from the network, the MDT deployment share first must be updated to generate boot media with the resources that have been added in the previous sections.\n\nTo update the MDT boot media, follow these steps:\n\n1. Right-click the deployment share in the Deployment Workbench, and then click **Update Deployment Share** to start the Update Deployment Share Wizard, as shown in Figure 11.\n\n   ![Generate boot images with the Update Deployment Share Wizard](images\\surface-deploymdt-fig11.png \"Generate boot images with the Update Deployment Share Wizard\")\n\n   *Figure 11. Generate boot images with the Update Deployment Share Wizard*\n\n2. Use the Update Deployment Share Wizard to create boot images with the following process:\n  * **Options** – Click **Completely Regenerate the Boot Images**, and then click **Next**.\n  >**Note:**&nbsp;&nbsp;Because this is the first time the newly created deployment share has been updated, new boot images will be generated regardless of which option you select on the **Options** page.\n  * **Summary** – Review the specified options on this page before you click **Next** to begin generation of boot images.\n  * **Progress** – While the boot images are being generated, a progress bar is displayed on this page.\n  * **Confirmation** – When the boot images have been generated, the success of the process is displayed on this page. Click **Finish** to complete the Update Deployment Share Wizard.\n3. Confirm that boot images have been generated by navigating to the deployment share in File Explorer and opening the Boot folder. The following files should be displayed, as shown in Figure 12:\n  * **LiteTouchPE_x86.iso**\n  * **LiteTouchPE_x86.wim**\n  * **LiteTouchPE_x64.iso**\n  * **LiteTouchPE_x64.wim**\n\n\n   ![Boot images in the Boot folder after Update Deployment Share Wizard completes](images\\surface-deploymdt-fig12.png \"Boot images in the Boot folder after Update Deployment Share Wizard completes\")\n\n   *Figure 12. Boot images displayed in the Boot folder after completion of the Update Deployment Share Wizard*\n\nTo import the MDT boot media into WDS for PXE boot, follow these steps:\n\n1. Open Windows Deployment Services from the Start menu or Start screen.\n2. Expand **Servers** and your deployment server.\n3. Click the **Boot Images** folder, as shown in Figure 13.\n\n   ![Start the Add Image Wizard from the Boot Images folder](images\\surface-deploymdt-fig13.png \"Start the Add Image Wizard from the Boot Images folder\")\n\n   *Figure 13. Start the Add Image Wizard from the Boot Images folder*\n\n4. Right-click the **Boot Images** folder, and then click **Add Boot Image** to open the Add Image Wizard, as shown in Figure 14.\n\n   ![Import the LiteTouchPE_x86.wim MDT boot image](images\\surface-deploymdt-fig14.png \"Import the LiteTouchPE_x86.wim MDT boot image\")\n\n   *Figure 14. Import the LiteTouchPE_x86.wim MDT boot image*\n\n5. The Add Image Wizard displays a series of steps, as follows:\n  * **Image File** – Click **Browse** and navigate to the **Boot** folder in your deployment share, click **LiteTouchPE_x86.wim**, click **Open**, and then click **Next**.\n  * **Image Metadata** – Enter a name and description for the MDT boot media, or click **Next** to accept the default options.\n  * **Summary** – Review your selections to import a boot image into WDS, and then click **Next**.\n  * **Task Progress** – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder. Click **Finish** when the task is complete to close the Add Image Wizard.\n\n>**Note:**&nbsp;&nbsp;Only the 32-bit boot image, LiteTouchPE_x86.wim, is required to boot from BIOS devices, including Generation 1 Hyper-V virtual machines like the reference virtual machine.\n\nIf your WDS configuration is properly set up to respond to PXE clients, you should now be able to boot from the network with any device with a network adapter properly configured for network boot (PXE).\n\n>**Note:**&nbsp;&nbsp;If your WDS server resides on the same server as DHCP or in a different subnet than the devices you are attempting to boot, additional configuration may be required. For more information, see [Managing Network Boot Programs](https://technet.microsoft.com/library/cc732351).\n\n### Deploy and capture a reference image\n\nYour deployment environment is now set up to create a reference image for Windows 10 complete with Windows Updates.\n\n>**Note:**&nbsp;&nbsp;You cannot install version updates (such as Windows 10, Version 1511) in a reference image. To create a reference image with a new version of Windows, you must use installation files from that version of Windows. When  you install a version update in Windows, it effectively performs an upgrade to a new version of Windows, and upgraded installations of Windows cannot be prepared for deployment with Sysprep.<br/><br/>\nBy using a fully automated task sequence in an MDT deployment share dedicated to reference image creation, you can greatly reduce the time and effort required to create new reference images and it is the best way to ensure that your organization is ready for feature updates and new versions of Windows 10.\n\nYou can now boot from the network with a virtual machine to run the prepared task sequence and generate a reference image. When you prepare your virtual machine in Hyper-V for reference image creation, consider the following:\n\n* Use a Generation 1 virtual machine for the simplicity of drivers and to ensure maximum compatibility with both BIOS and UEFI devices.\n* Ensure your virtual machine has at least 1 GB of system memory at boot. You can ensure that the virtual machine has at least 1 GB of memory at boot but allow the memory to adjust after boot by using Dynamic Memory. You can read more about Dynamic Memory in the [Hyper-V Dynamic Memory Overview](https://technet.microsoft.com/library/hh831766).\n* Ensure your virtual machine uses a legacy network adapter to support network boot (PXE); that network adapter should be connected to the same network as your deployment server, and that network adapter should receive an IP address automatically via DHCP.\n* Configure your boot order such that PXE Boot is the first option.\n\nWhen your virtual machine (VM) is properly configured and ready, start or boot the VM and be prepared to press the F12 key when prompted to boot via PXE from the WDS server.\n\nPerform the reference image deployment and capture using the following steps:\n\n1. Start your virtual machine and press the F12 key when prompted to boot to the WDS server via PXE, as shown in Figure 15.\n\n   ![Start network boot by pressing the F12 key](images\\surface-deploymdt-fig15.png \"Start network boot by pressing the F12 key\")\n\n   *Figure 15. Start network boot by pressing the F12 key*\n\n2. Click **Run the Deployment Wizard to Install a New Operating System** to begin the MDT deployment process.\n3. Enter your MDT username and password, a user with rights to access the MDT deployment share over the network and with rights to write to the Captures folder in the deployment share.\n4. After your credentials are validated, the Windows Deployment Wizard will start and process the boot and deployment share rules.\n5. The Windows Deployment Wizard displays a series of steps, as follows:\n  * **Task Sequence** – Select the task sequence you created for reference image creation (it should be the only task sequence available), and then click **Next**.\n  * **Computer Details** – Leave the default computer name, workgroup name, and the **Join a Workgroup** option selected, and then click **Next**. The computer name and workgroup will be reset when the image is prepared by Sysprep and captured.\n  * **Move Data and Settings** – Leave the default option of **Do Not Move User Data and Settings** selected, and then click **Next**.\n  * **User Data (Restore)** – Leave the default option of **Do Not Restore User Data and Settings** selected, and then click **Next**.\n  * **Locale and Time** – Leave the default options for language and time settings selected. The locale and time settings will be specified during deployment of the image to other devices. Click **Next**.\n  * **Capture Image** – Click the **Capture an Image of this Reference Computer** option, as shown in Figure 16. In the **Location** field, keep the default location of the Captures folder. You can keep or change the name of the image file in the **File Name** field. When you are finished, click **Next**.\n  \n  ![Capture an image of the reference machine](images\\surface-deploymdt-fig16.png \"Capture an image of the reference machine\")\n    \n  *Figure 16. Use the Capture Image page to capture an image of the reference machine after deployment*\n\n  * **Ready** – You can review your selections by expanding **Details** on the **Ready** page. Click **Begin** when you are ready to perform the deployment and capture of your reference image.\n\n6. Your reference task sequence will run with the specified options.\n\nAs the task sequence processes the deployment, it will automatically perform the following tasks:\n* Install the Windows 10 image from the installation files you supplied\n* Reboot into Windows 10\n* Run Windows updates until all Windows updates have been installed and the Windows environment is fully up to date\n* Run Sysprep and prepare the Windows 10 environment for deployment\n* Reboot into WinPE\n* Capture an image of the Windows 10 environment and store it in the Captures folder in the MDT deployment share\n\n>**Note:**&nbsp;&nbsp;The Windows Update process can take some time to complete as it searches the Internet for updates, downloads those updates, and then installs them. By performing this process now, in the reference environment, you eliminate the need to perform these tasks on each deployed device and significantly reduce the amount of time and bandwidth required to perform your deployment. \n\nWhen the task sequence completes, your virtual machine will be off and a new reference image complete with updates will be ready in your MDT deployment share for you to import it and prepare your deployment environment for deployment to Surface devices.\n\n## Deploy Windows 10 to Surface devices\n\nWith a freshly prepared reference image, you are now ready to configure the deployment process for deployment to the Surface devices. Use the steps detailed in this section to produce a deployment process that requires minimal effort on each Surface device to produce a complete and ready-to-use Windows 10 environment.\n\n### Import reference image\n\nAfter the reference image has been created and stored in the Captures folder, you need to add it to your MDT deployment share as an image for deployment. You perform this task by using the same process that you used to import the installation files for Windows 10.\n\nTo import the reference image for deployment, use the following steps:\n\n1. Right-click the **Operating Systems** folder under your deployment share in the Deployment Workbench or the folder you created in when you imported Windows 10 installation files, and then click **Import Operating System** to start the Import Operating System Wizard. \n2. Import the custom image with the Import Operating System Wizard by using the following steps:\n  * **OS Type** – Select Custom Image File to specify that you are importing the Windows source files from installation media, and then click **Next**.\n  * **Image** – Click **Browse**, and then navigate to and select the image file in the **Captures** folder in your deployment share. Select the **Move the Files to the Deployment Share Instead of Copying Them** checkbox if desired. Click **Next**. \n  * **Setup** – Click **Setup Files are not Neededf**, and then click **Next**.\n  * **Destination** – Enter a name for the new folder that will be created to hold the image file, and then click **Next**.\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin the import process.\n  * **Progress** – While the image is imported, a progress bar is displayed on this page.\n  * **Confirmation** – When the import process completes, the success of the process is displayed on this page. Click **Finish** to complete the Import Operating System Wizard.\n3.  Expand the folder in which you imported the image to verify that the import completed successfully.\n\n>**Note:**&nbsp;&nbsp;You can import the reference image into the same deployment share that you used to create your reference image, or you could import the reference image into a new deployment share for deployment to your Surface devices. If you chose to create a new deployment share for deployment of your reference image, remember that you still need to import a full set of installation files from installation media.\n\nNow that your updated reference image is imported, it is time to prepare your deployment environment for deployment to Surface devices complete with drivers, applications, and automation.\n\n### Import Surface drivers\n\nBefore you can deploy your updated reference image to Surface devices, or any physical environment, you need to supply MDT with the drivers that Windows will use to communicate with that physical environment. For Surface devices you can download all of the drivers required by Windows in a single archive (.zip) file in a format that is ready for deployment. In addition to the drivers that are used by Windows to communicate with the hardware and components, Surface firmware and driver packs also include updates for the firmware of those components. By installing the Surface firmware and driver pack, you will also bring your device’s firmware up to date. If you have not done so already, download the drivers for your Surface device listed at [Download the latest firmware and drivers for Surface devices](https://technet.microsoft.com/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices).\n\nMany devices require that you import drivers specifically for WinPE in order for the MDT boot media to communicate with the deployment share and to boot properly on that device. Even Surface Pro 3 required that network drivers be imported specifically for WinPE for deployment of Windows 8.1. Fortunately, for Windows 10 deployments to Surface devices, all of the required drivers for operation of WinPE are contained within the out-of-box drivers that are built into Windows 10. It is still a good idea to prepare your environment with folder structure and selection profiles that allow you to specify drivers for use in WinPE. You can read more about that folder structure in **Step 5: Prepare the drivers repository** in [Deploy a Windows 10 image using MDT 2013 Update 2](https://technet.microsoft.com/en-us/itpro/windows/deploy/deploy-a-windows-10-image-using-mdt/#sec05).\n\nTo import the Surface drivers (in this example, Surface Pro 4) into MDT, follow these steps:\n\n1. Extract the downloaded archive (.zip) file to a folder that you can easily locate. Keep the driver files separate from other drivers or files.\n2. Open the Deployment Workbench and expand the Deployment Shares node and your deployment share. \n3. If you have not already created a folder structure by operating system version, you should do so now and create under the Windows 10 x64 folder a new folder for Surface Pro 4 drivers named Surface Pro 4. Your Out-of-Box Drivers folder should resemble the following structure, as shown in Figure 17:\n   * WinPE x86\n   * WinPE x64\n   * Windows 10 x64\n     * Microsoft Corporation\n       * Surface Pro 4\n\n   ![Recommended folder structure for drivers](images\\surface-deploymdt-fig17.png \"Recommended folder structure for drivers\")\n\n   *Figure 17. The recommended folder structure for drivers*\n\n4. Right-click the **Surface Pro 4** folder, and then click **Import Drivers** to start the Import Drivers Wizard, as shown in Figure 18.\n\n   ![Progress page during drivers import](images\\surface-deploymdt-fig18.png \"Progress page during drivers import\")\n\n   *Figure 18. The Progress page during drivers import*\n\n5. The Import Driver Wizard displays a series of steps, as follows:\n  * **Specify Directory** – Click **Browse** and navigate to the folder where you extracted the Surface Pro 4 firmware and drivers in Step 1.\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin the import process.\n  * **Progress** – While the drivers are imported, a progress bar is displayed on this page.\n  * **Confirmation** – When the import process completes, the success of the process is displayed on this page. Click **Finish** to complete the Import Drivers Wizard.\n6.  Click the **Surface Pro 4** folder and verify that the folder now contains the drivers that were imported, as shown in Figure 19.\n\n   ![Drivers for Surface Pro 4 imported and organized in the MDT deployment share](images\\surface-deploymdt-fig19.png \"Drivers for Surface Pro 4 imported and organized in the MDT deployment share\")\n\n   *Figure 19. Drivers for Surface Pro 4 imported and organized in the MDT deployment share*\n\n### Import applications\n\nYou can import any number of applications into MDT for installation on your devices during the deployment process. You can configure your applications and task sequences to prompt you during deployment to pick and choose which applications are installed, or you can use your task sequence to explicitly define which applications are installed. For more information, see **Step 4: Add an application** in [Deploy a Windows 10 image using MDT 2013 Update 2](https://technet.microsoft.com/en-us/itpro/windows/deploy/deploy-a-windows-10-image-using-mdt/#sec04).\n\n#### Import Microsoft Office 365 Installer\n\nThe Office Deployment Tool is a free download available in the Microsoft Download Center that allows IT professionals and system administrators to download and prepare Office installation packages for Office Click-to-Run. You can find the Office Deployment Tool and instructions to download Click-to-Run for Office 365 installation source files at [Download Click-to-Run for Office 365 products by using the Office Deployment Tool](https://technet.microsoft.com/library/jj219424).\n\nDownload and install the version of Office Deployment Tool (ODT), for Office 2013 or Office 2016, that fits your organization’s needs and use the steps provided by that page to download the Office installation files for use with MDT.\n\nAfter you have downloaded the source files for your version of Office Click-to-Run, you need to edit the Configuration.xml file with instructions to install Office Click-to-Run silently. To configure the Office Deployment Tool for silent installation, follow these steps:\n\n1. Right-click the existing **Configuration.xml** file, and then click **Edit**.\n2. This action opens the file in Notepad. Replace the existing text with the following:\n  ```\n   <Configuration> \n   <Add OfficeClientEdition=\"32\">  \n    <Product ID=\"O365ProPlusRetail\" >  \n     <Language ID=\"en-us\" />        \n    </Product>  \n   </Add> \n   <Display Level=\"None\" AcceptEULA=\"TRUE\" /> </Configuration>\n```\n\n3. Save the file.\n\nThe default behavior of Setup.exe is to look for the source files in the path that contains **Setup.exe**. If the installation files are not found in this folder, the Office Deployment Tool will default to online source files from an Internet connection.\n\nFor MDT to perform an automated installation of office, it is important to configure the **Display Level** option to a value of **None**. This setting is used to suppress the installation dialog box for silent installation. It is required that the **AcceptEULA** option is set to **True** to accept the license agreement when the **Display Level** option is set to **None**. With both of these options configured, the installation of Office will occur without the display of dialog boxes which could potentially cause the installation to pause until a user can address an open dialog box.\n\nNow that the installation and configuration files are prepared, the application can be imported into the deployment share by following these steps:\n\n1. Open the Deployment Workbench. \n2. Expand the deployment share, right-click the **Applications** folder, and then click **New Application** to start the New Application Wizard, as shown in Figure 20.\n\n   ![Enter the command and directory for Office 2016 Click-to-Run](images\\surface-deploymdt-fig20.png \"Enter the command and directory for Office 2016 Click-to-Run\")\n\n   *Figure 20. Enter the command and directory for Office 2016 Click-to-Run*\n\n3. The New Application Wizard walks you through importing the Office 2016 Click-to-Run files, as follows:\n  * **Application Type** – Click **Application with Source Files**, and then click **Next**.\n  * **Details** – Enter a name for the application (for example, Office 2016 Click-to-Run) in the **Application Name** field. Enter publisher, version, and language information in the **Publisher**, **Version**, and **Language** fields if desired. Click **Next**.\n  * **Source** – Click **Browse** to navigate to and select the folder where you downloaded the Office installation files with the Office Deployment Tool, and then click **Next**.\n  * **Destination** – Enter a name for the folder where the application files will be stored in the **Specify the Name of the Directory that Should Be Created** field or click **Next** to accept the default name.\n  * **Command Details** – Enter the Office Deployment Tool installation command line:\n\n     `Setup.exe /configure configuration.xml`\n\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin the import process.\n  * **Progress** – While the installation files are imported, a progress bar is displayed on this page.\n  * **Confirmation** – When the import process completes, the success of the process is displayed on this page. Click **Finish** to complete the New Application Wizard.\n\n4. You should now see the **Office 2016 Click-to-Run** item under the **Applications** folder in the Deployment Workbench.\n\n#### Import Surface app installer\n\nThe Surface app is a Windows Store app that provides the user with greater control over specific Surface device functions and capabilities (for example, control over the sensitivity of the Surface Pen). It is a highly recommended app for Surface devices to provide end users with the best experience and greatest control over their device. Find out more about the Surface app at [Install and use the Surface app](https://www.microsoft.com/surface/en-us/support/apps-and-windows-store/surface-app?os=windows-10).\n\nTo perform a deployment of the Surface app, you will need to download the app files through Windows Store for Business. You can find detailed instructions on how to download the Surface app through Windows Store for Business at [Deploy Surface app with Windows Store for Business](https://technet.microsoft.com/en-us/itpro/surface/deploy-surface-app-with-windows-store-for-business).\n\nAfter you have downloaded the installation files for Surface app, including the AppxBundle and license files, you can import these files into the deployment share through the same process as a desktop application like Microsoft Office. Both the AppxBundle and license files must be together in the same folder for the import process to complete successfully. Use the following command on the **Command Details** page to install the Surface app:\n   ```\nDISM.exe /Online /Add-ProvisionedAppxPackage /PackagePath: Microsoft.SurfaceHub_10.0.342.0_neutral_~_8wekyb3d8bbwe.AppxBundle /LicensePath: Microsoft.SurfaceHub_8wekyb3d8bbwe_a53ef8ab-9dbd-dec1-46c5-7b664d4dd003.xml\n   ```\n\n### Create deployment task sequence\n\nThe next step in the process is to create the deployment task sequence. This task sequence will be configured to completely automate the deployment process and will work along with customized deployment share rules to reduce the need for user interaction down to a single touch. Before you can make  customizations to include all of this automation, the new task sequence has to be created from a template.\n\nTo create the deployment task sequence, follow these steps:\n1. In the Deployment Workbench, under your Deployment Share, right-click the **Task Sequences** folder, and then click **New Task Sequence** to start the New Task Sequence Wizard.\n2. Use these steps to create the deployment task sequence with the New Task Sequence Wizard:\n  * **General Settings** – Enter an identifier for the deployment task sequence in the **Task Sequence ID** field, a name for the deployment task sequence in the **Task Sequence Name** field, and any comments for the deployment task sequence in the **Task Sequence Comments** field, then click **Next**.\n  >**Note:**&nbsp;&nbsp;The **Task Sequence ID** field cannot contain spaces and can be a maximum of 16 characters.\n  * **Select Template** – Click **Standard Client Task Sequence** from the drop-down menu, and then click **Next**.\n  * **Select OS** – Navigate to and select the reference image that you imported, and then click **Next**.\n  * **Specify Product Key** – Select the product key entry that fits your organization's licensing system. The **Do Not Specify a Product Key at This Time** option can be used for systems that will be activated via Key Management Services (KMS) or Active Directory Based Activation (ADBA). A product key can be specified specifically if your organization uses Multiple Activation Keys (MAK). Click **Next**.\n  * **OS Settings** – Enter a name and organization for registration of Windows, and a home page URL for users when they browse the Internet in the **Full Name**, **Organization**, and **Internet Explorer Home Page** fields, and then click **Next**.\n  * **Admin Password** – Click **Use the Specified Local Administrator Password**, enter a password in the provided field, and then click **Next**.\n  * **Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the task sequence.\n  * **Progress** – While the task sequence is being created, a progress bar is displayed on this page.\n  * **Confirmation** – When the task sequence creation completes, the success of the process is displayed on this page. Click **Finish** to complete the New Task Sequence Wizard.\n\nAfter the task sequence is created it can be modified for increased automation, such as the installation of applications without user interaction, the selection of drivers, and the installation of Windows updates.\n\n1. Click the **Task Sequences** folder, right-click the new task sequence you created, and then click **Properties**.\n2. Click the **Task Sequence** tab to view the steps that are included in the new task sequence.\n3. Click the **Windows Update (Pre-Application Installation)** step, located under the **State Restore** folder.\n4. Click the **Options** tab, and then clear the **Disable This Step** check box.\n5. Repeat Step 4 and Step 5 for the **Windows Update (Post-Application Installation)** option.\n6. Between the two **Windows Update** steps is the **Install Applications** step. Click the **Install Applications** step, and then click **Add**.\n7. Hover the mouse over **General** under the **Add** menu, and then click **Install Application**. This will add a new step after the selected step for the installation of a specific application as shown in Figure 21.\n\n   ![A new Install Application step in the deployment task sequence](images\\surface-deploymdt-fig21.png \"A new Install Application step in the deployment task sequence\")\n\n   *Figure 21. A new Install Application step in the deployment task sequence*\n\n8. On the **Properties** tab of the new **Install Application** step, enter **Install Microsoft Office 2016 Click-to-Run** in the **Name** field.\n9. Click **Install a Single Application**, and then click **Browse** to view available applications that have been imported into the deployment share.\n10. Select Office 2016 Click-to-Run from the list of applications, and then click **OK**.\n11. Repeat Steps 6 through 10 for the Surface app.\n12. Expand the **Preinstall** folder, and then click the **Enable BitLocker (Offline)** step.\n13. Open the **Add** menu again and choose **Set Task Sequence Variable** from under the **General** menu.\n14. On the **Properties** tab of the new **Set Task Sequence Variable** step (as shown in Figure 22), configure the following options:\n  * **Name** – Set DriverGroup001\n  * **Task Sequence Variable** – DriverGroup001\n  * **Value** – Windows 10 x64\\%Make%\\%Model%\n\n   ![Configure a new Set Task Sequence Variable step in the deployment task sequence](images\\surface-deploymdt-fig22.png \"Configure a new Set Task Sequence Variable step in the deployment task sequence\")\n\n   Figure 22. Configure a new Set Task Sequence Variable step in the deployment task sequence\n\n15. Select the **Inject Drivers** step, the next step in the task sequence.\n16. On the **Properties** tab of the **Inject Drivers** step (as shown in Figure 23), configure the following options:\n  * In the **Choose a selection profile** drop-down menu, select **Nothing**.\n  * Click the **Install all drivers from the selection profile** button.\n\n   ![Configure deployment task sequence not to choose the drivers to inject into Windows](images\\surface-deploymdt-fig23.png \"Configure deployment task sequence not to choose the drivers to inject into Windows\")\n\n   *Figure 23. Configure the deployment task sequence not to choose the drivers to inject into Windows*\n\n17. Click **OK** to apply changes to the task sequence and close the task sequence properties window.\n\n### Configure deployment share rules\n\nThe experience of users during a Windows deployment is largely governed by a set of rules that control how the MDT and Windows Deployment Wizard experience should proceed. These rules are stored in two configuration files. Boot media rules are stored in the Bootstrap.ini file that is processed when the MDT boot media is first run. Deployment share rules are stored in the Customsettings.ini file and tell the Windows Deployment Wizard how to operate (for example, what screens to show and what questions to ask). By using these the rules stored in these two files, you can completely automate the process of deployment to where you will not be asked to supply the answer to any questions during deployment and the deployment will perform all tasks completely on its own.\n\n#### Configure Bootstrap.ini\n\nBootstrap.ini is the simpler of the two rule files. The purpose it serves is to provide instructions from when the MDT boot media starts on a device until the Windows Deployment Wizard is started. The primary use of this file is to provide the credentials that will be used to log on to the deployment share and start the Windows Deployment Wizard.\n\nTo automate the boot media rules, follow these steps:\n\n1. Right-click your deployment share in the Deployment Workbench, and then click **Properties**.\n2. Click the **Rules** tab, and then click **Edit Bootstrap.ini** to open Bootstrap.ini in Notepad.\n3. Replace the text of the Bootstrap.ini file with the following text:\n\n  ```\n  [Settings]\n  Priority=Model,Default\n\n  [Surface Pro 4]\n  DeployRoot=\\\\STNDeployServer\\DeploymentShare$\n  UserDomain=STNDeployServer\n  UserID=MDTUser\n  UserPassword=P@ssw0rd\n  SkipBDDWelcome=YES\n\n  [Surface Pro 4]\n  DeployRoot=\\\\STNDeployServer\\DeploymentShare$\n  ```\n\n4. Press Ctrl+S to save Bootstrap.ini, and then close Notepad.\n\nYou can use a number of variables in both boot media and deployment share rules to apply rules only when certain conditions are met. For example, you can use MAC addresses to identify specific machines where MDT will run fully automated, but will run with required user interaction on all other devices. You can also use the model of the device to instruct the MDT boot media to perform different actions based on computer model, much as the way **[Surface Pro 4]** is listed in Step 3. You can use the following cmdlet in a PowerShell session to see what the Model variable would be on a device:\n   \n```wmic csproduct get name```\n\nRules used in the text shown in Step 3 include:\n\n* **DeployRoot** – Used to specify the deployment share that the MDT boot media will connect to.\n* **UserDomain** – Used to specify the domain or computer where the MDT user account is located.\n* **UserID** – Used to specify the MDT user account for automatic logon to the deployment share.\n* **UserPassword** – Used to specify the MDT user password for automatic logon to the deployment share.\n* **SkipBDDWelcome** – Used to skip the Welcome page and to start the Windows Deployment Wizard immediately using the specified credentials and deployment share.\n\n#### Configure CustomSettings.ini\n\nThe bulk of the rules used to automate the MDT deployment process are stored in the deployment share rules, or the Customsettings.ini file. In this file you can answer and hide all of the prompts from the Windows Deployment Wizard, which yields a deployment experience that mostly consists of a progress bar that displays the automated actions occurring on the device. The deployment share rules are shown directly in the **Rules** tab of the deployment share properties, as shown in Figure 24.\n\n![Deployment share rules configured for automation of the Windows Deployment Wizard](images\\surface-deploymdt-fig24.png \"Deployment share rules configured for automation of the Windows Deployment Wizard\")\n\n*Figure 24. Deployment share rules configured for automation of the Windows Deployment Wizard*\n\nTo configure automation for the production deployment, copy and paste the following text into the text box on the **Rules** tab of your deployment share properties:\n\n   ```\n[Settings]\nPriority=Model,Default\nProperties=MyCustomProperty\n\n[Surface Pro 4]\nSkipTaskSequence=YES\nTaskSequenceID=Win10SP4\n\n[Default]\nOSInstall=Y\nSkipCapture=YES\nSkipAdminPassword=YES\nSkipProductKey=YES\nSkipComputerBackup=YES\nSkipBitLocker=YES\nSkipBDDWelcome=YES\nSkipUserData=YES\nUserDataLocation=AUTO\nSkipApplications=YES\nSkipPackageDisplay=YES\nSkipComputerName=YES\nSkipDomainMembership=YES\nJoinDomain=contoso.com\nDomainAdmin=MDT\nDomainAdminDomain=contoso\nDomainAdminPassword=P@ssw0rd\nSkipLocaleSelection=YES\nKeyboardLocale=en-US\nUserLocale=en-US\nUILanguage=en-US\nSkipTimeZone=YES\nTimeZoneName=Pacific Standard Time\nUserID=MDTUser\nUserDomain=STNDeployServer\nUserPassword=P@ssw0rd\nSkipSummary=YES\nSkipFinalSummary=YES\nFinishAction=LOGOFF\n   ```\nRules used in this example include:\n\n* **SkipTaskSequence** – This rule is used to skip the **Task Sequence** page where the user would have to select between available task sequences.\n* **TaskSequenceID** – This rule is used to instruct the Windows Deployment Wizard to run a specific task sequence. In this scenario the task sequence ID should match the deployment task sequence you created in the previous section.\n* **OSInstall** – This rule indicates that the Windows Deployment Wizard will be performing an operating system deployment.\n* **SkipCapture** – This rule prevents the **Capture Image** page from being displayed, prompting the user to create an image of this device after deployment.\n* **SkipAdminPassword** – This rule prevents the **Admin Password** page from being displayed. The Administrator password specified in the task sequence will still be applied.\n* **SkipProductKey** – This rule prevents the **Specify Product Key** page from being displayed. The product key specified in the task sequence will still be applied.\n* **SkipComputerBackup** – This rule prevents the **Move Data and Settings** page from being displayed, where the user is asked if they would like to make a backup of the computer before performing deployment.\n* **SkipBitLocker** – This rule prevents the **BitLocker** page from being displayed, where the user is asked if BitLocker Drive Encryption should be used to encrypt the device.\n* **SkipBDDWelcome** – This rule prevents the **Welcome** page from being displayed, where the user is prompted to begin Windows deployment.\n* **SkipUserData** – This rule prevents the **User Data (Restore)** page from being displayed, where the user is asked to restore previously backed up user data in the new environment.\n* **UserDataLocation** – This rule prevents the user from being prompted to supply a location on the User Data (Restore) page.\n* **SkipApplications** – This rule prevents the **Applications** page from being displayed, where the user is prompted to select from available applications to be installed in the new environment.\n* **SkipPackageDisplay** – This rule prevents the **Packages** page from being displayed, where the user is prompted to select from available packages to be installed in the new environment.\n* **SkipComputerName** – This rule, when combined with the **SkipDomainMembership** rule, prevents the **Computer Details** page from being displayed, where the user is asked to supply computer name and join a domain or workgroup.\n* **SkipDomainMembership** – This rule, when combined with the **SkipComputerName** rule, prevents the **Computer Details** page from being displayed, where the user is asked to supply computer name and join a domain or workgroup.\n* **JoinDomain** – This rule instructs the Windows Deployment Wizard to have the computer join the specified domain using the specified credentials. \n* **DomainAdmin** – This rule specifies the username for the domain join operation.\n* **DomainAdminDomain** – This rule specifies the domain for the username for the domain join operation.\n* **DomainAdminPassword** – This rule specifies the password for the username for the domain join operation.\n* **SkipLocaleSelection** –  This rule, along with the **SkipTimeZone** rule, prevents the **Locale and Time** page from being displayed.\n* **KeyboardLocale** – This rule is used to specify the keyboard layout for the deployed Windows environment.\n* **UserLocale** – This rule is used to specify the geographical locale for the deployed Windows environment.\n* **UILanguage** – This rule is used to specify the language to be used in the deployed Windows environment.\n* **SkipTimeZone** –  This rule, along with the **SkipLocaleSelection** rule, prevents the **Locale and Time** page from being displayed.\n* **TimeZoneName** – This rule is used to specify the time zone for the deployed Windows environment.\n* **UserID** – This rule is used to supply the username under which the MDT actions and task sequence steps are performed.\n* **UserDomain** – This rule is used to supply the domain for the username under which the MDT actions and task sequence steps are performed.\n* **UserPassword** – This rule is used to supply the password for the username under which the MDT actions and task sequence steps are performed.\n* **SkipSummary** – This rule prevents the **Summary** page from being displayed before the task sequence is run, where the user is prompted to confirm the selections before beginning the task sequence.\n* **SkipFinalSummary** – This rule prevents the **Summary** page from being displayed when the task sequence has completed.\n* **FinishAction** – This rule specifies whether to log out, reboot, or shut down the device after the task sequence has completed.\n\nYou can read about all of the possible deployment share and boot media rules in the [Microsoft Deployment Toolkit Reference](https://technet.microsoft.com/library/dn781091).\n\n### Update and import updated MDT boot media\n\nThe process to update MDT boot media with these new rules and changes to the deployment share is very similar to the process to generate boot media from scratch.\n\nTo update the MDT boot media, follow these steps:\n\n1. Right-click the deployment share in the Deployment Workbench, and then click **Update Deployment Share** to start the Update Deployment Share Wizard.\n2. The Update Deployment Share Wizard displays a series of steps, as follows:\n  * **Options** – Choose between the **Completely Regenerate the Boot Images** or **Optimize the Boot Image Updating Process** options. Completely regenerating the boot images will take more time, but produces boot media that is not fragmented and does not contain out of date components. Optimizing the boot image updating process will proceed more quickly, but may result in longer load times when booting via PXE. Click **Next**.\n  * **Summary** – Review the specified options on this page before you click **Next** to begin the update of boot images.\n  * **Progress** – While the boot images are being updated a progress bar is displayed on this page.\n  * **Confirmation** – When the boot images have been updated, the success of the process is displayed on this page. Click **Finish** to complete the Update Deployment Share Wizard.\n\nTo import the updated MDT boot media into WDS for PXE boot, follow these steps:\n\n1. Open Windows Deployment Services from the Start menu or Start screen.\n2. Expand **Servers** and your deployment server.\n3. Click the **Boot Images** folder.\n4. Right-click the existing MDT boot image, and then click **Replace Image** to open the Replace Boot Image Wizard.\n5. Replace the previously imported MDT boot image with the updated version by using these steps in the Replace Boot Image Wizard:\n  * **Image File** – Click **Browse** and navigate to the **Boot** folder in your deployment share, click **LiteTouchPE_x86.wim**, and then click **Open**. Click **Next**.\n  * **Available Images** – Only one image should be listed and selected **LiteTouch Windows PE (x86)**, click **Next**.\n  * **Image Metadata** – Enter a name and description for the MDT boot media, or click **Next** to accept the default options.\n  * **Summary** – Review your selections for importing a boot image into WDS, and then click **Next**.\n  * **Task Progress** – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder. Click **Finish** when the task is complete to close the Replace Boot Image Wizard.\n6. Right-click the **Boot Images** folder, and then click **Add Image** to open the Add Image Wizard.\n7. Add the new 64-bit boot image for 64-bit UEFI device compatibility with the Add Image Wizard , as follows:\n  * **Image File** – Click **Browse** and navigate to the **Boot** folder in your deployment share, select **LiteTouchPE_x64.wim**, and then click **Open**. Click **Next**.\n  * **Image Metadata** – Enter a name and description for the MDT boot media, or click **Next** to accept the default options.\n  * **Summary** – Review your selections to import a boot image into WDS, and then click **Next**.\n  * **Task Progress** – A progress bar is displayed as the selected image file is copied into the WDS remote installation folder. Click **Finish** when the task is complete to close the Add Image Wizard.\n\n>**Note:**&nbsp;&nbsp;Although it is a best practice to replace and update the boot images in WDS whenever the MDT deployment share is updated, for deployment to Surface devices the 32-bit boot image, LiteTouchPE_x86.wim, is not required. Only the 64-bit boot image is required for 64-bit UEFI devices.\n\n### Deploy Windows to Surface\n\nWith all of the automation provided by the deployment share rules and task sequence, performing the deployment on each Surface device becomes as easy as a single touch.\n\n>**Note:**&nbsp;&nbsp;For the deployment to require only a single touch, the Surface devices must be connected to a keyboard, connected to the network with a Microsoft Surface USB Ethernet Adapter or Surface Dock, and configured with PXE boot as the first boot option, as shown in Figure 25.\n\n![Set boot priority for PXE boot](images\\surface-deploymdt-fig25.png \"Set boot priority for PXE boot\")\n\n*Figure 25. Setting boot priority for PXE boot*\n\nOn a properly configured Surface device, simply turn on the device and press Enter when you are prompted to boot from the network. The fully automated MDT deployment process will then take over and perform the following tasks:\n\n* The MDT boot media will be loaded to your Surface device via the network\n* The MDT boot media will use the provided credentials and rules to connect to the MDT deployment share\n* The task sequence and drivers will be automatically selected for your device via make and model information\n* The task sequence will deploy your updated Windows 10 image to the device complete with the selected drivers\n* The task sequence will join your device to the domain\n* The task sequence will install the applications you specified, Microsoft Office and Surface app\n* Windows Update will run, installing any new Windows Updates or updates for installed applications, like Microsoft Office\n* The task sequence will complete silently and log out of the device\n\n>**Note:**&nbsp;&nbsp;For Surface devices not configured to boot to the network as the first boot option, you can hold Volume Down and press Power to boot the system immediately to a USB or network device.\n\nThe resulting configuration is a Surface device that is logged out and ready for an end user to enter their credentials, log on, and get right to work. The applications and drivers they need are already installed and up to date.\n\n\n\n\n"}