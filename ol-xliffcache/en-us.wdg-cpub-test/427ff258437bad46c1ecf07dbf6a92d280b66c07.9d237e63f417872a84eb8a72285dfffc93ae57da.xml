{"nodes":[{"pos":[11,55],"content":"Surface Enterprise Management Mode (Surface)","needQuote":true,"nodes":[{"content":"Surface Enterprise Management Mode (Surface)","pos":[0,44]}]},{"pos":[69,198],"content":"See how this feature of Surface devices with Surface UEFI helps you secure and manage firmware settings within your organization.","needQuote":true,"nodes":[{"content":"See how this feature of Surface devices with Surface UEFI helps you secure and manage firmware settings within your organization.","pos":[0,129]}]},{"pos":[209,248],"content":"uefi, configure, firmware, secure, semm","needQuote":true,"nodes":[{"content":"uefi, configure, firmware, secure, semm","pos":[0,39]}]},{"content":"Microsoft Surface Enterprise Management Mode","pos":[367,411]},{"content":"Microsoft Surface Enterprise Management Mode (SEMM) is a feature of Surface devices with Surface UEFI that allows you to secure and manage firmware settings within your organization.","pos":[413,595]},{"content":"With SEMM, IT professionals can prepare configurations of UEFI settings and install them on a Surface device.","pos":[596,705]},{"content":"In addition to the ability to configure UEFI settings, SEMM also uses a certificate to protect the configuration from unauthorized tampering or removal.","pos":[706,858]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>SEMM is only available on devices with Surface UEFI firmware, such as Surface Pro 4 and Surface Book.","pos":[861,983],"source":"**Note**:&nbsp;&nbsp;SEMM is only available on devices with Surface UEFI firmware, such as Surface Pro 4 and Surface Book."},{"content":"For more information about Surface UEFI, see <bpt id=\"p1\">[</bpt>Manage Surface UEFI Settings<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-uefi-settings)</ept>.","pos":[984,1140],"source":" For more information about Surface UEFI, see [Manage Surface UEFI Settings](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-uefi-settings)."},{"content":"When Surface devices are configured by SEMM and secured with the SEMM certificate, they are considered <bpt id=\"p1\">*</bpt>enrolled<ept id=\"p1\">*</ept> in SEMM.","pos":[1142,1264],"source":"When Surface devices are configured by SEMM and secured with the SEMM certificate, they are considered *enrolled* in SEMM."},{"content":"When the SEMM certificate is removed and control of UEFI settings is returned to the user of the device, the Surface device is considered <bpt id=\"p1\">*</bpt>unenrolled<ept id=\"p1\">*</ept> in SEMM.","pos":[1265,1424],"source":" When the SEMM certificate is removed and control of UEFI settings is returned to the user of the device, the Surface device is considered *unenrolled* in SEMM."},{"content":"Microsoft Surface UEFI Configurator","pos":[1429,1464]},{"content":"The primary workspace of SEMM is Microsoft Surface UEFI Configurator, as shown in Figure 1.","pos":[1466,1557]},{"content":"Microsoft Surface UEFI Configurator is a tool that is used to create Windows Installer (.msi) packages that are used to enroll, configure, and unenroll SEMM on a Surface device.","pos":[1558,1735]},{"content":"These packages contain a configuration file where the settings for UEFI are specified.","pos":[1736,1822]},{"content":"SEMM packages also contain a certificate that is installed and stored in firmware and used to verify the signature of configuration files before UEFI settings are applied.","pos":[1823,1994]},{"content":"Microsoft Surface UEFI Configurator","pos":[1998,2033]},{"content":"Figure 1.","pos":[2127,2136]},{"content":"Microsoft Surface UEFI Configurator","pos":[2137,2172]},{"pos":[2176,2262],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Windows 10 is required to run Microsoft Surface UEFI Configurator","source":"**Note**:&nbsp;&nbsp;Windows 10 is required to run Microsoft Surface UEFI Configurator"},{"content":"You can use the Microsoft Surface UEFI Configurator tool in three modes:","pos":[2264,2336]},{"content":"<bpt id=\"p1\">[</bpt>Surface UEFI Configuration Package<ept id=\"p1\">](#configuration-package)</ept>.","pos":[2340,2401],"source":"[Surface UEFI Configuration Package](#configuration-package)."},{"content":"Use this mode to create a Surface UEFI configuration package to enroll a Surface device in SEMM and to configure UEFI settings on enrolled devices.","pos":[2402,2549]},{"content":"<bpt id=\"p1\">[</bpt>Surface UEFI Reset Package<ept id=\"p1\">](#reset-package)</ept>.","pos":[2552,2597],"source":"[Surface UEFI Reset Package](#reset-package)."},{"content":"Use this mode to unenroll a Surface device from SEMM.","pos":[2598,2651]},{"content":"<bpt id=\"p1\">[</bpt>Surface UEFI Recovery Request<ept id=\"p1\">](#recovery-request)</ept>.","pos":[2654,2705],"source":"[Surface UEFI Recovery Request](#recovery-request)."},{"content":"Use this mode to respond to a recovery request to unenroll a Surface device from SEMM where a Reset Package operation is not successful.","pos":[2706,2842]},{"content":"Download Microsoft Surface UEFI Configurator","pos":[2850,2894]},{"pos":[2896,3083],"content":"You can download Microsoft Surface UEFI Configurator from the <bpt id=\"p1\">[</bpt>Surface Tools for IT<ept id=\"p1\">](https://www.microsoft.com/en-us/download/details.aspx?id=46703)</ept> page in the Microsoft Download Center.","source":"You can download Microsoft Surface UEFI Configurator from the [Surface Tools for IT](https://www.microsoft.com/en-us/download/details.aspx?id=46703) page in the Microsoft Download Center."},{"content":"Configuration package","pos":[3089,3110]},{"content":"Surface UEFI configuration packages are the primary mechanism to implement and manage SEMM on Surface devices.","pos":[3112,3222]},{"content":"These packages contain a configuration file of UEFI settings specified during creation of the package in Microsoft Surface UEFI Configurator and a certificate file, as shown in Figure 2.","pos":[3223,3409]},{"content":"When a configuration package is run for the first time on a Surface device that is not already enrolled in SEMM, it provisions the certificate file in the device’s firmware and enrolls the device in SEMM.","pos":[3410,3614]},{"content":"When enrolling a device in SEMM, you will be prompted to confirm the operation by providing the last two digits of the SEMM certificate thumbprint before the certificate file is stored and the enrollment can complete.","pos":[3615,3832]},{"content":"This confirmation requires that a user be present at the device at the time of enrollment to perform the confirmation.","pos":[3833,3951]},{"content":"Secure a SEMM configuration package with a certificate","pos":[3955,4009]},{"content":"Figure 2.","pos":[4118,4127]},{"content":"Secure a SEMM configuration package with a certificate","pos":[4128,4182]},{"pos":[4185,4410],"content":"See the <bpt id=\"p1\">[</bpt>Surface Enterprise Management Mode certificate requirements<ept id=\"p1\">](#surface-enterprise-management-mode-certificate-requirements)</ept> section of this article for more information about the requirements for the SEMM certificate.","source":"See the [Surface Enterprise Management Mode certificate requirements](#surface-enterprise-management-mode-certificate-requirements) section of this article for more information about the requirements for the SEMM certificate."},{"pos":[4413,4612],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You can also specify a UEFI password with SEMM that is required to view the <bpt id=\"p2\">**</bpt>Security<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Devices<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Boot Configuration<ept id=\"p4\">**</ept>, or <bpt id=\"p5\">**</bpt>Enterprise Management<ept id=\"p5\">**</ept> pages of Surface UEFI.","source":"**Note**:&nbsp;&nbsp;You can also specify a UEFI password with SEMM that is required to view the **Security**, **Devices**, **Boot Configuration**, or **Enterprise Management** pages of Surface UEFI."},{"content":"After a device is enrolled in SEMM, the configuration file is read and the settings specified in the file are applied to UEFI.","pos":[4614,4740]},{"content":"When you run a configuration package on a device that is already enrolled in SEMM, the signature of the configuration file is checked against the certificate that is stored in the device firmware.","pos":[4741,4937]},{"content":"If the signature does not match, no changes are applied to the device.","pos":[4938,5008]},{"content":"You can use Surface UEFI settings to enable or disable the operation of individual components, such as cameras, wireless communication, or docking USB port (as shown in Figure 3), and configure advanced settings (as shown in Figure 4).","pos":[5010,5245]},{"content":"Enable or disable devices in Surface UEFI with SEMM","pos":[5249,5300]},{"content":"Figure 3.","pos":[5406,5415]},{"content":"Enable or disable devices in Surface UEFI with SEMM","pos":[5416,5467]},{"content":"Configure advanced settings in SEMM","pos":[5472,5507]},{"content":"Figure 4.","pos":[5600,5609]},{"content":"Configure advanced settings with SEMM","pos":[5610,5647]},{"content":"You can enable or disable the following devices with SEMM:","pos":[5650,5708]},{"content":"Docking USB Port","pos":[5712,5728]},{"content":"On-board Audio","pos":[5731,5745]},{"content":"Type Cover","pos":[5748,5758]},{"content":"Micro SD or SD Card Slots","pos":[5761,5786]},{"content":"Front Camera","pos":[5789,5801]},{"content":"Rear Camera","pos":[5804,5815]},{"content":"Infrared Camera, for Windows Hello","pos":[5818,5852]},{"content":"Bluetooth Only","pos":[5855,5869]},{"content":"Wi-Fi and Bluetooth","pos":[5872,5891]},{"content":"Trusted Platform Module (TPM)","pos":[5894,5923]},{"content":"You can configure the following advanced settings with SEMM:","pos":[5925,5985]},{"content":"IPv6 support for PXE boot","pos":[5989,6014]},{"content":"Alternate boot order, where the Volume Down button and Power button can be pressed together during boot, to boot directly to a USB or Ethernet device","pos":[6017,6166]},{"content":"Lock the boot order to prevent changes","pos":[6169,6207]},{"content":"Support for booting to USB devices","pos":[6210,6244]},{"pos":[6247,6292],"content":"Display of the Surface UEFI <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> page","source":"Display of the Surface UEFI **Security** page"},{"pos":[6295,6339],"content":"Display of the Surface UEFI <bpt id=\"p1\">**</bpt>Devices<ept id=\"p1\">**</ept> page","source":"Display of the Surface UEFI **Devices** page"},{"pos":[6342,6383],"content":"Display of the Surface UEFI <bpt id=\"p1\">**</bpt>Boot<ept id=\"p1\">**</ept> page","source":"Display of the Surface UEFI **Boot** page"},{"pos":[6386,6527],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>When you create a SEMM configuration package, two characters are shown on the <bpt id=\"p2\">**</bpt>Successful<ept id=\"p2\">**</ept> page, as shown in Figure 5.","source":"**Note**:&nbsp;&nbsp;When you create a SEMM configuration package, two characters are shown on the **Successful** page, as shown in Figure 5."},{"content":"Certificate thumbprint display","pos":[6531,6561]},{"content":"Figure 5.","pos":[6640,6649]},{"content":"Display of the last two characters of the certificate thumbprint on the Successful page","pos":[6650,6737]},{"content":"These characters are the last two characters of the certificate thumbprint and should be written down or recorded.","pos":[6740,6854]},{"content":"The characters are required to confirm enrollment in SEMM on a Surface device, as shown in Figure 6.","pos":[6855,6955]},{"content":"Enrollment confirmation in SEMM","pos":[6959,6990]},{"content":"Figure 6.","pos":[7076,7085]},{"content":"Enrollment confirmation in SEMM with the SEMM certificate thumbprint","pos":[7086,7154]},{"content":"To enroll a Surface device in SEMM or to apply the UEFI configuration from a configuration package, all you need to do is run the .msi file on the intended Surface device.","pos":[7157,7328]},{"content":"You can use application deployment or operating system deployment technologies such as <bpt id=\"p1\">[</bpt>System Center Configuration Manager<ept id=\"p1\">](https://technet.microsoft.com/library/mt346023)</ept> or the <bpt id=\"p2\">[</bpt>Microsoft Deployment Toolkit<ept id=\"p2\">](https://technet.microsoft.com/en-us/windows/dn475741)</ept>.","pos":[7329,7594],"source":" You can use application deployment or operating system deployment technologies such as [System Center Configuration Manager](https://technet.microsoft.com/library/mt346023) or the [Microsoft Deployment Toolkit](https://technet.microsoft.com/en-us/windows/dn475741)."},{"content":"When you enroll a device in SEMM you must be present to confirm the enrollment on the device.","pos":[7595,7688]},{"content":"User interaction is not required when you apply a configuration to devices that are already enrolled in SEMM.","pos":[7689,7798]},{"content":"Reset package","pos":[7804,7817]},{"content":"A Surface UEFI reset package is used to perform only one task — to unenroll a Surface device from SEMM.","pos":[7819,7922]},{"content":"The reset package contains signed instructions to remove the SEMM certificate from the device’s firmware and to reset UEFI settings to factory default.","pos":[7923,8074]},{"content":"Like a Surface UEFI configuration package, a reset package must be signed with the same SEMM certificate that is provisioned on the Surface device.","pos":[8075,8222]},{"content":"When you create a SEMM reset package, you are required to supply the serial number of the Surface device you intend to reset.","pos":[8223,8348]},{"content":"SEMM reset packages are not universal and are specific to one device.","pos":[8349,8418]},{"content":"Recovery request","pos":[8424,8440]},{"content":"In some scenarios, it may be impossible to use a Surface UEFI reset package.","pos":[8442,8518]},{"content":"(For example, if Windows becomes unusable on the Surface device.) In these scenarios you can unenroll the Surface device from SEMM through the <bpt id=\"p1\">**</bpt>Enterprise Management<ept id=\"p1\">**</ept> page of Surface UEFI (shown in Figure 7) with a Recovery Request operation.","pos":[8519,8763],"source":" (For example, if Windows becomes unusable on the Surface device.) In these scenarios you can unenroll the Surface device from SEMM through the **Enterprise Management** page of Surface UEFI (shown in Figure 7) with a Recovery Request operation."},{"content":"Initiate a SEMM recovery request","pos":[8767,8799]},{"content":"Figure 7.","pos":[8885,8894]},{"content":"Initiate a SEMM recovery request on the Enterprise Management page","pos":[8895,8961]},{"content":"When you use the process on the <bpt id=\"p1\">**</bpt>Enterprise Management<ept id=\"p1\">**</ept> page to reset SEMM on a Surface device, you are provided with a Reset Request.","pos":[8964,9100],"source":"When you use the process on the **Enterprise Management** page to reset SEMM on a Surface device, you are provided with a Reset Request."},{"content":"This Reset Request can be saved as a file to a USB drive, copied as text, or read as a QR Code with a mobile device to be easily emailed or messaged.","pos":[9101,9250]},{"content":"Use the Microsoft Surface UEFI Configurator Reset Request option to load a Reset Request file or enter the Reset Request text or QR Code.","pos":[9251,9388]},{"content":"Microsoft Surface UEFI Configurator will generate a verification code that can be entered on the Surface device.","pos":[9389,9501]},{"content":"If you enter the code on the Surface device and click <bpt id=\"p1\">**</bpt>Restart<ept id=\"p1\">**</ept>, the device will be unenrolled from SEMM.","pos":[9502,9609],"source":" If you enter the code on the Surface device and click **Restart**, the device will be unenrolled from SEMM."},{"pos":[9613,9688],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A Reset Request expires two hours after it is created.","source":"**Note**:&nbsp;&nbsp;A Reset Request expires two hours after it is created."},{"content":"Surface Enterprise Management Mode certificate requirements","pos":[9693,9752]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The SEMM certificate is required to perform any modification to SEMM or Surface UEFI settings on enrolled Surface devices.","pos":[9755,9898],"source":"**Note**:&nbsp;&nbsp;The SEMM certificate is required to perform any modification to SEMM or Surface UEFI settings on enrolled Surface devices."},{"content":"If the SEMM certificate is corrupted or lost, SEMM cannot be removed or reset.","pos":[9899,9977]},{"content":"Manage your SEMM certificate accordingly with an appropriate solution for backup and recovery.","pos":[9978,10072]},{"content":"Packages created with the Microsoft Surface UEFI Configurator tool are signed with a certificate.","pos":[10074,10171]},{"content":"This certificate ensures that after a device is enrolled in SEMM, only packages created with the approved certificate can be used to modify the settings of UEFI.","pos":[10172,10333]},{"content":"The following settings are recommended for the SEMM certificate:","pos":[10334,10398]},{"pos":[10402,10425],"content":"<bpt id=\"p1\">**</bpt>Key Algorithm<ept id=\"p1\">**</ept> – RSA","source":"**Key Algorithm** – RSA"},{"pos":[10429,10450],"content":"<bpt id=\"p1\">**</bpt>Key Length<ept id=\"p1\">**</ept> – 2048","source":"**Key Length** – 2048"},{"pos":[10453,10481],"content":"<bpt id=\"p1\">**</bpt>Hash Algorithm<ept id=\"p1\">**</ept> – SHA-256","source":"**Hash Algorithm** – SHA-256"},{"pos":[10484,10520],"content":"<bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> – SSL Server Authentication","source":"**Type** – SSL Server Authentication"},{"pos":[10523,10555],"content":"<bpt id=\"p1\">**</bpt>Key Usage<ept id=\"p1\">**</ept> – Key Encipherment","source":"**Key Usage** – Key Encipherment"},{"pos":[10558,10626],"content":"<bpt id=\"p1\">**</bpt>Provider<ept id=\"p1\">**</ept> – Microsoft Enhanced RSA and AES Cryptographic Provider","source":"**Provider** – Microsoft Enhanced RSA and AES Cryptographic Provider"},{"pos":[10629,10686],"content":"<bpt id=\"p1\">**</bpt>Expiration Date<ept id=\"p1\">**</ept> – 15 Months from certificate creation","source":"**Expiration Date** – 15 Months from certificate creation"},{"pos":[10689,10723],"content":"<bpt id=\"p1\">**</bpt>Key Export Policy<ept id=\"p1\">**</ept> – Exportable","source":"**Key Export Policy** – Exportable"},{"content":"It is also recommended that the SEMM certificate be authenticated in a two-tier public key infrastructure (PKI) architecture where the intermediate certification authority (CA) is dedicated to SEMM, enabling certificate revocation.","pos":[10725,10956]},{"content":"For more information about a two-tier PKI configuration, see <bpt id=\"p1\">[</bpt>Test Lab Guide: Deploying an AD CS Two-Tier PKI Hierarchy<ept id=\"p1\">](https://technet.microsoft.com/library/hh831348)</ept>.","pos":[10957,11126],"source":" For more information about a two-tier PKI configuration, see [Test Lab Guide: Deploying an AD CS Two-Tier PKI Hierarchy](https://technet.microsoft.com/library/hh831348)."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You can use the following PowerShell script to create a self-signed certificate for use in proof-of-concept scenarios.","pos":[11129,11268],"source":"**Note**:&nbsp;&nbsp;You can use the following PowerShell script to create a self-signed certificate for use in proof-of-concept scenarios."},{"content":"To use this script, copy the following text into Notepad and save the file as a PowerShell script (.ps1).","pos":[11269,11376],"source":"\n  To use this script, copy the following text into Notepad and save the file as a PowerShell script (.ps1)."},{"content":"This script creates a certificate with a password of <ph id=\"ph1\">`12345678`</ph>.","pos":[11377,11441],"source":" This script creates a certificate with a password of `12345678`."},{"content":"The certificate generated by this script is not recommended for production environments.","pos":[11451,11539]},{"content":"For use with SEMM and Microsoft Surface UEFI Configurator, the certificate must be exported with the private key and with password protection.","pos":[12449,12591]},{"content":"Microsoft Surface UEFI Configurator will prompt you to select the SEMM certificate file (.pfx) and certificate password when it is required.","pos":[12592,12732]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For organizations that use an offline root in their PKI infrastructure, Microsoft Surface UEFI Configurator must be run in an environment connected to the root CA to authenticate the SEMM certificate.","pos":[12735,12956],"source":"**Note**:&nbsp;&nbsp;For organizations that use an offline root in their PKI infrastructure, Microsoft Surface UEFI Configurator must be run in an environment connected to the root CA to authenticate the SEMM certificate."},{"content":"The packages generated by Microsoft Surface UEFI Configurator can be transferred as files and therefore can be transferred outside the offline network environment with removable storage, such as a USB stick.","pos":[12957,13164]}],"content":"---\ntitle: Surface Enterprise Management Mode (Surface)\ndescription: See how this feature of Surface devices with Surface UEFI helps you secure and manage firmware settings within your organization.\nkeywords: uefi, configure, firmware, secure, semm\nms.prod: w10\nms.mktglfcycl: manage\nms.pagetype: surface, devices, security\nms.sitesec: library\nauthor: jobotto\n---\n\n# Microsoft Surface Enterprise Management Mode\n\nMicrosoft Surface Enterprise Management Mode (SEMM) is a feature of Surface devices with Surface UEFI that allows you to secure and manage firmware settings within your organization. With SEMM, IT professionals can prepare configurations of UEFI settings and install them on a Surface device. In addition to the ability to configure UEFI settings, SEMM also uses a certificate to protect the configuration from unauthorized tampering or removal.\n\n>**Note**:&nbsp;&nbsp;SEMM is only available on devices with Surface UEFI firmware, such as Surface Pro 4 and Surface Book. For more information about Surface UEFI, see [Manage Surface UEFI Settings](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-uefi-settings).\n\nWhen Surface devices are configured by SEMM and secured with the SEMM certificate, they are considered *enrolled* in SEMM. When the SEMM certificate is removed and control of UEFI settings is returned to the user of the device, the Surface device is considered *unenrolled* in SEMM.\n\n## Microsoft Surface UEFI Configurator\n\nThe primary workspace of SEMM is Microsoft Surface UEFI Configurator, as shown in Figure 1. Microsoft Surface UEFI Configurator is a tool that is used to create Windows Installer (.msi) packages that are used to enroll, configure, and unenroll SEMM on a Surface device. These packages contain a configuration file where the settings for UEFI are specified. SEMM packages also contain a certificate that is installed and stored in firmware and used to verify the signature of configuration files before UEFI settings are applied.\n\n![Microsoft Surface UEFI Configurator](images\\surface-ent-mgmt-fig1-uefi-configurator.png \"Microsoft Surface UEFI Configurator\")\n\n*Figure 1. Microsoft Surface UEFI Configurator*\n\n>**Note**:&nbsp;&nbsp;Windows 10 is required to run Microsoft Surface UEFI Configurator\n\nYou can use the Microsoft Surface UEFI Configurator tool in three modes:\n\n* [Surface UEFI Configuration Package](#configuration-package). Use this mode to create a Surface UEFI configuration package to enroll a Surface device in SEMM and to configure UEFI settings on enrolled devices.\n* [Surface UEFI Reset Package](#reset-package). Use this mode to unenroll a Surface device from SEMM.\n* [Surface UEFI Recovery Request](#recovery-request). Use this mode to respond to a recovery request to unenroll a Surface device from SEMM where a Reset Package operation is not successful.\n\n\n#### Download Microsoft Surface UEFI Configurator\n\nYou can download Microsoft Surface UEFI Configurator from the [Surface Tools for IT](https://www.microsoft.com/en-us/download/details.aspx?id=46703) page in the Microsoft Download Center.\n\n### Configuration package\n\nSurface UEFI configuration packages are the primary mechanism to implement and manage SEMM on Surface devices. These packages contain a configuration file of UEFI settings specified during creation of the package in Microsoft Surface UEFI Configurator and a certificate file, as shown in Figure 2. When a configuration package is run for the first time on a Surface device that is not already enrolled in SEMM, it provisions the certificate file in the device’s firmware and enrolls the device in SEMM. When enrolling a device in SEMM, you will be prompted to confirm the operation by providing the last two digits of the SEMM certificate thumbprint before the certificate file is stored and the enrollment can complete. This confirmation requires that a user be present at the device at the time of enrollment to perform the confirmation.\n\n![Secure a SEMM configuration package with a certificate](images\\surface-ent-mgmt-fig2-securepackage.png \"Secure a SEMM configuration package with a certificate\")\n\n*Figure 2. Secure a SEMM configuration package with a certificate*\n\nSee the [Surface Enterprise Management Mode certificate requirements](#surface-enterprise-management-mode-certificate-requirements) section of this article for more information about the requirements for the SEMM certificate.\n\n>**Note**:&nbsp;&nbsp;You can also specify a UEFI password with SEMM that is required to view the **Security**, **Devices**, **Boot Configuration**, or **Enterprise Management** pages of Surface UEFI.\n\nAfter a device is enrolled in SEMM, the configuration file is read and the settings specified in the file are applied to UEFI. When you run a configuration package on a device that is already enrolled in SEMM, the signature of the configuration file is checked against the certificate that is stored in the device firmware. If the signature does not match, no changes are applied to the device.\n\nYou can use Surface UEFI settings to enable or disable the operation of individual components, such as cameras, wireless communication, or docking USB port (as shown in Figure 3), and configure advanced settings (as shown in Figure 4).\n\n![Enable or disable devices in Surface UEFI with SEMM](images\\surface-ent-mgmt-fig3-enabledisable.png \"Enable or disable devices in Surface UEFI with SEMM\")\n\n*Figure 3. Enable or disable devices in Surface UEFI with SEMM*\n\n![Configure advanced settings in SEMM](images\\surface-ent-mgmt-fig4-advancedsettings.png \"Configure advanced settings in SEMM\")\n\n*Figure 4. Configure advanced settings with SEMM*\n\nYou can enable or disable the following devices with SEMM:\n\n* Docking USB Port\n* On-board Audio\n* Type Cover\n* Micro SD or SD Card Slots\n* Front Camera\n* Rear Camera\n* Infrared Camera, for Windows Hello\n* Bluetooth Only\n* Wi-Fi and Bluetooth\n* Trusted Platform Module (TPM)\n\nYou can configure the following advanced settings with SEMM:\n\n* IPv6 support for PXE boot\n* Alternate boot order, where the Volume Down button and Power button can be pressed together during boot, to boot directly to a USB or Ethernet device\n* Lock the boot order to prevent changes\n* Support for booting to USB devices\n* Display of the Surface UEFI **Security** page\n* Display of the Surface UEFI **Devices** page\n* Display of the Surface UEFI **Boot** page\n\n>**Note**:&nbsp;&nbsp;When you create a SEMM configuration package, two characters are shown on the **Successful** page, as shown in Figure 5.\n\n![Certificate thumbprint display](images\\surface-ent-mgmt-fig5-success.png \"Certificate thumbprint display\")\n\n*Figure 5. Display of the last two characters of the certificate thumbprint on the Successful page*\n\nThese characters are the last two characters of the certificate thumbprint and should be written down or recorded. The characters are required to confirm enrollment in SEMM on a Surface device, as shown in Figure 6.\n\n![Enrollment confirmation in SEMM](images\\surface-ent-mgmt-fig6-enrollconfirm.png \"Enrollment confirmation in SEMM\")\n\n*Figure 6. Enrollment confirmation in SEMM with the SEMM certificate thumbprint*\n\nTo enroll a Surface device in SEMM or to apply the UEFI configuration from a configuration package, all you need to do is run the .msi file on the intended Surface device. You can use application deployment or operating system deployment technologies such as [System Center Configuration Manager](https://technet.microsoft.com/library/mt346023) or the [Microsoft Deployment Toolkit](https://technet.microsoft.com/en-us/windows/dn475741). When you enroll a device in SEMM you must be present to confirm the enrollment on the device. User interaction is not required when you apply a configuration to devices that are already enrolled in SEMM.\n\n### Reset package\n\nA Surface UEFI reset package is used to perform only one task — to unenroll a Surface device from SEMM. The reset package contains signed instructions to remove the SEMM certificate from the device’s firmware and to reset UEFI settings to factory default. Like a Surface UEFI configuration package, a reset package must be signed with the same SEMM certificate that is provisioned on the Surface device. When you create a SEMM reset package, you are required to supply the serial number of the Surface device you intend to reset. SEMM reset packages are not universal and are specific to one device.\n\n### Recovery request\n\nIn some scenarios, it may be impossible to use a Surface UEFI reset package. (For example, if Windows becomes unusable on the Surface device.) In these scenarios you can unenroll the Surface device from SEMM through the **Enterprise Management** page of Surface UEFI (shown in Figure 7) with a Recovery Request operation.\n\n![Initiate a SEMM recovery request](images\\surface-ent-mgmt-fig7-semmrecovery.png \"Initiate a SEMM recovery request\")\n\n*Figure 7. Initiate a SEMM recovery request on the Enterprise Management page*\n\nWhen you use the process on the **Enterprise Management** page to reset SEMM on a Surface device, you are provided with a Reset Request. This Reset Request can be saved as a file to a USB drive, copied as text, or read as a QR Code with a mobile device to be easily emailed or messaged. Use the Microsoft Surface UEFI Configurator Reset Request option to load a Reset Request file or enter the Reset Request text or QR Code. Microsoft Surface UEFI Configurator will generate a verification code that can be entered on the Surface device. If you enter the code on the Surface device and click **Restart**, the device will be unenrolled from SEMM. \n\n>**Note**:&nbsp;&nbsp;A Reset Request expires two hours after it is created.\n\n## Surface Enterprise Management Mode certificate requirements\n\n>**Note**:&nbsp;&nbsp;The SEMM certificate is required to perform any modification to SEMM or Surface UEFI settings on enrolled Surface devices. If the SEMM certificate is corrupted or lost, SEMM cannot be removed or reset. Manage your SEMM certificate accordingly with an appropriate solution for backup and recovery.\n\nPackages created with the Microsoft Surface UEFI Configurator tool are signed with a certificate. This certificate ensures that after a device is enrolled in SEMM, only packages created with the approved certificate can be used to modify the settings of UEFI. The following settings are recommended for the SEMM certificate:\n\n* **Key Algorithm** – RSA \n* **Key Length** – 2048\n* **Hash Algorithm** – SHA-256\n* **Type** – SSL Server Authentication\n* **Key Usage** – Key Encipherment\n* **Provider** – Microsoft Enhanced RSA and AES Cryptographic Provider\n* **Expiration Date** – 15 Months from certificate creation\n* **Key Export Policy** – Exportable\n\nIt is also recommended that the SEMM certificate be authenticated in a two-tier public key infrastructure (PKI) architecture where the intermediate certification authority (CA) is dedicated to SEMM, enabling certificate revocation. For more information about a two-tier PKI configuration, see [Test Lab Guide: Deploying an AD CS Two-Tier PKI Hierarchy](https://technet.microsoft.com/library/hh831348).\n\n>**Note**:&nbsp;&nbsp;You can use the following PowerShell script to create a self-signed certificate for use in proof-of-concept scenarios.\n  To use this script, copy the following text into Notepad and save the file as a PowerShell script (.ps1). This script creates a certificate with a password of `12345678`.<br/><br/>The certificate generated by this script is not recommended for production environments.\n  \n   ```\nif (-not (Test-Path \"Demo Certificate\"))  { New-Item -ItemType Directory -Force -Path \"Demo Certificate\" }\nif (Test-Path \"Demo Certificate\\TempOwner.pfx\") { Remove-Item \"Demo Certificate\\TempOwner.pfx\" }\n\n# Generate the Ownership private signing key with password 12345678\n$pw = ConvertTo-SecureString \"12345678\" -AsPlainText -Force\n\n$TestUefiV2 = New-SelfSignedCertificate `\n  -Subject \"CN=Surface Demo Kit, O=Contoso Corporation, C=US\" `\n  -Type SSLServerAuthentication `\n  -HashAlgorithm sha256 `\n  -KeyAlgorithm RSA `\n  -KeyLength 2048 `\n  -KeyUsage KeyEncipherment `\n  -KeyUsageProperty All `\n  -Provider \"Microsoft Enhanced RSA and AES Cryptographic Provider\" `\n  -NotAfter (Get-Date).AddYears(25) `\n  -TextExtension @(\"2.5.29.37={text}1.2.840.113549.1.1.1\") `\n  -KeyExportPolicy Exportable\n\n$TestUefiV2 | Export-PfxCertificate -Password $pw -FilePath \"Demo Certificate\\TempOwner.pfx\"\n   ```\n\nFor use with SEMM and Microsoft Surface UEFI Configurator, the certificate must be exported with the private key and with password protection. Microsoft Surface UEFI Configurator will prompt you to select the SEMM certificate file (.pfx) and certificate password when it is required.\n\n>**Note**:&nbsp;&nbsp;For organizations that use an offline root in their PKI infrastructure, Microsoft Surface UEFI Configurator must be run in an environment connected to the root CA to authenticate the SEMM certificate. The packages generated by Microsoft Surface UEFI Configurator can be transferred as files and therefore can be transferred outside the offline network environment with removable storage, such as a USB stick.\n"}