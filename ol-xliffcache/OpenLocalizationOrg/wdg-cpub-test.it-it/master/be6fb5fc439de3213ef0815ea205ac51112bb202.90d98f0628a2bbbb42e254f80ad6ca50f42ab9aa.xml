{"nodes":[{"pos":[11,97],"content":"Creating a basic Windows Runtime component in C++ and calling it from JavaScript or C#","needQuote":true,"needEscape":true,"nodes":[{"content":"Creating a basic Windows Runtime component in C++ and calling it from JavaScript or C","pos":[0,85]}]},{"pos":[111,239],"content":"This walkthrough shows how to create a basic Windows Runtime Component DLL that's callable from JavaScript, C#, or Visual Basic.","needQuote":true,"needEscape":true,"nodes":[{"content":"This walkthrough shows how to create a basic Windows Runtime Component DLL that's callable from JavaScript, C#, or Visual Basic.","pos":[0,128]}]},{"content":"Walkthrough: Creating a basic Windows Runtime component in C++ and calling it from JavaScript or C","pos":[296,394]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[398,436]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[437,532],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"\\[Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[535,656]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]","pos":[657,756]},{"content":"This walkthrough shows how to create a basic Windows Runtime Component DLL that's callable from JavaScript, C#, or Visual Basic.","pos":[758,886]},{"content":"Before you begin this walkthrough, make sure that you understand concepts such as the Abstract Binary Interface (ABI), ref classes, and the Visual C++ Component Extensions that make working with ref classes easier.","pos":[887,1101]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Creating Windows Runtime Components in C++<ept id=\"p1\">](creating-windows-runtime-components-in-cpp.md)</ept> and <bpt id=\"p2\">[</bpt>Visual C++ Language Reference (C++/CX)<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh699871.aspx)</ept>.","pos":[1102,1333],"source":" For more information, see [Creating Windows Runtime Components in C++](creating-windows-runtime-components-in-cpp.md) and [Visual C++ Language Reference (C++/CX)](https://msdn.microsoft.com/library/windows/apps/xaml/hh699871.aspx)."},{"content":"Creating the C++ component DLL","pos":[1338,1368]},{"content":"In this example, we create the component project first, but you could create the JavaScript project first.","pos":[1371,1477]},{"content":"The order doesn’t matter.","pos":[1478,1503]},{"content":"Notice that the main class of the component contains examples of property and method definitions, and an event declaration.","pos":[1505,1628]},{"content":"These are provided just to show you how it's done.","pos":[1629,1679]},{"content":"They are not required, and in this example, we'll replace all of the generated code with our own code.","pos":[1680,1782]},{"content":"To create the C++ component project","pos":[1789,1824]},{"pos":[1832,1893],"content":"On the Visual Studio menu bar, choose <bpt id=\"p1\">**</bpt>File, New, Project<ept id=\"p1\">**</ept>.","source":"On the Visual Studio menu bar, choose **File, New, Project**."},{"pos":[1898,2025],"content":"In the <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog box, in the left pane, expand <bpt id=\"p2\">**</bpt>Visual C++<ept id=\"p2\">**</ept> and then select the node for Universal Windows apps.","source":"In the **New Project** dialog box, in the left pane, expand **Visual C++** and then select the node for Universal Windows apps."},{"pos":[2030,2124],"content":"In the center pane, select <bpt id=\"p1\">**</bpt>Windows Runtime Component<ept id=\"p1\">**</ept> and then name the project WinRT\\_CPP.","source":"In the center pane, select **Windows Runtime Component** and then name the project WinRT\\_CPP."},{"pos":[2129,2154],"content":"Choose the <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> button.","source":"Choose the **OK** button."},{"content":"To add an activatable class to the component","pos":[2161,2205]},{"content":"An activatable class is one that client code can create by using a <bpt id=\"p1\">**</bpt>new<ept id=\"p1\">**</ept> expression (<bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> in Visual Basic, or <bpt id=\"p3\">**</bpt>ref new<ept id=\"p3\">**</ept> in C++).","pos":[2213,2348],"source":"An activatable class is one that client code can create by using a **new** expression (**New** in Visual Basic, or **ref new** in C++)."},{"content":"In your component, you declare it as <bpt id=\"p1\">**</bpt>public ref class sealed<ept id=\"p1\">**</ept>.","pos":[2349,2414],"source":" In your component, you declare it as **public ref class sealed**."},{"content":"In fact, the Class1.h and .cpp files already have a ref class.","pos":[2415,2477]},{"content":"You can change the name, but in this example we’ll use the default name—Class1.","pos":[2478,2557]},{"content":"You can define additional ref classes or regular classes in your component if they are required.","pos":[2558,2654]},{"content":"For more information about ref classes, see <bpt id=\"p1\">[</bpt>Type System (C++/CX)<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh755822.aspx)</ept>.","pos":[2655,2785],"source":" For more information about ref classes, see [Type System (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh755822.aspx)."},{"content":"Add these \\#include directives to Class1.h:","pos":[2791,2834]},{"content":"Running the app","pos":[4479,4494]},{"content":"Select either the C# project or JavaScript project as the startup project by opening the shortcut menu for the project node in Solution Explorer and choosing <bpt id=\"p1\">**</bpt>Set As Startup Project<ept id=\"p1\">**</ept>.","pos":[4497,4682],"source":"Select either the C# project or JavaScript project as the startup project by opening the shortcut menu for the project node in Solution Explorer and choosing **Set As Startup Project**."},{"content":"Then press F5 to run with debugging, or Ctrl+F5 to run without debugging.","pos":[4683,4756]},{"content":"Inspecting your component in Object Browser (optional)","pos":[4761,4815]},{"content":"In Object Browser, you can inspect all Windows Runtime types that are defined in .winmd files.","pos":[4818,4912]},{"content":"This includes the types in the Platform namespace and the default namespace.","pos":[4913,4989]},{"content":"However, because the types in the Platform::Collections namespace are defined in the header file collections.h, not in a winmd file, they don’t appear in Object Browser.","pos":[4990,5159]},{"content":"To inspect a component","pos":[5166,5188]},{"pos":[5196,5258],"content":"On the menu bar, choose <bpt id=\"p1\">**</bpt>View, Object Browser<ept id=\"p1\">**</ept> (Ctrl+Alt+J).","source":"On the menu bar, choose **View, Object Browser** (Ctrl+Alt+J)."},{"content":"In the left pane of the Object Browser, expand the WinRT\\_CPP node to show the types and methods that are defined on your component.","pos":[5263,5395]},{"content":"Debugging tips","pos":[5400,5414]},{"content":"For a better debugging experience, download the debugging symbols from the public Microsoft symbol servers:","pos":[5417,5524]},{"content":"To download debugging symbols","pos":[5531,5560]},{"pos":[5568,5611],"content":"On the menu bar, choose <bpt id=\"p1\">**</bpt>Tools, Options<ept id=\"p1\">**</ept>.","source":"On the menu bar, choose **Tools, Options**."},{"pos":[5616,5691],"content":"In the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> dialog box, expand <bpt id=\"p2\">**</bpt>Debugging<ept id=\"p2\">**</ept> and select <bpt id=\"p3\">**</bpt>Symbols<ept id=\"p3\">**</ept>.","source":"In the **Options** dialog box, expand **Debugging** and select **Symbols**."},{"pos":[5696,5765],"content":"Select <bpt id=\"p1\">**</bpt>Microsoft Symbol Servers<ept id=\"p1\">**</ept> and the choose the <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> button.","source":"Select **Microsoft Symbol Servers** and the choose the **OK** button."},{"content":"It might take some time to download the symbols the first time.","pos":[5767,5830]},{"content":"For faster performance the next time you press F5, specify a local directory in which to cache the symbols.","pos":[5831,5938]},{"content":"When you debug a JavaScript solution that has a component DLL, you can set the debugger to enable either stepping through script or stepping through native code in the component, but not both at the same time.","pos":[5940,6149]},{"content":"To change the setting, open the shortcut menu for the JavaScript project node in Solution Explorer and choose <bpt id=\"p1\">**</bpt>Properties, Debugging, Debugger Type<ept id=\"p1\">**</ept>.","pos":[6150,6301],"source":" To change the setting, open the shortcut menu for the JavaScript project node in Solution Explorer and choose **Properties, Debugging, Debugger Type**."},{"content":"Be sure to select appropriate capabilities in the package designer.","pos":[6303,6370]},{"content":"You can open the package designer by opening the Package.appxmanifest file.","pos":[6371,6446]},{"content":"For example, if you are attempting to programmatically access files in the Pictures folder, be sure to select the <bpt id=\"p1\">**</bpt>Pictures Library<ept id=\"p1\">**</ept> check box in the <bpt id=\"p2\">**</bpt>Capabilities<ept id=\"p2\">**</ept> pane of the package designer.","pos":[6447,6645],"source":" For example, if you are attempting to programmatically access files in the Pictures folder, be sure to select the **Pictures Library** check box in the **Capabilities** pane of the package designer."},{"content":"If your JavaScript code doesn't recognize the public properties or methods in the component, make sure that in JavaScript you are using camel casing.","pos":[6647,6796]},{"content":"For example, the <ph id=\"ph1\">`ComputeResult`</ph> C++ method must be referenced as <ph id=\"ph2\">`computeResult`</ph> in JavaScript.","pos":[6797,6893],"source":" For example, the `ComputeResult` C++ method must be referenced as `computeResult` in JavaScript."},{"content":"If you remove a C++ Windows Runtime Component project from a solution, you must also manually remove the project reference from the JavaScript project.","pos":[6895,7046]},{"content":"Failure to do so prevents subsequent debug or build operations.","pos":[7047,7110]},{"content":"If necessary, you can then add an assembly reference to the DLL.","pos":[7111,7175]},{"content":"Related topics","pos":[7180,7194]},{"content":"Creating Windows Runtime Components in C++","pos":[7199,7241]}],"content":"---\ntitle: Creating a basic Windows Runtime component in C++ and calling it from JavaScript or C#\ndescription: This walkthrough shows how to create a basic Windows Runtime Component DLL that's callable from JavaScript, C#, or Visual Basic.\nms.assetid: 764CD9C6-3565-4DFF-88D7-D92185C7E452\n---\n\n# Walkthrough: Creating a basic Windows Runtime component in C++ and calling it from JavaScript or C#\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n\\[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]\n\nThis walkthrough shows how to create a basic Windows Runtime Component DLL that's callable from JavaScript, C#, or Visual Basic. Before you begin this walkthrough, make sure that you understand concepts such as the Abstract Binary Interface (ABI), ref classes, and the Visual C++ Component Extensions that make working with ref classes easier. For more information, see [Creating Windows Runtime Components in C++](creating-windows-runtime-components-in-cpp.md) and [Visual C++ Language Reference (C++/CX)](https://msdn.microsoft.com/library/windows/apps/xaml/hh699871.aspx).\n\n## Creating the C++ component DLL\n\n\nIn this example, we create the component project first, but you could create the JavaScript project first. The order doesn’t matter.\n\nNotice that the main class of the component contains examples of property and method definitions, and an event declaration. These are provided just to show you how it's done. They are not required, and in this example, we'll replace all of the generated code with our own code.\n\n## **To create the C++ component project**\n\n1.  On the Visual Studio menu bar, choose **File, New, Project**.\n2.  In the **New Project** dialog box, in the left pane, expand **Visual C++** and then select the node for Universal Windows apps.\n3.  In the center pane, select **Windows Runtime Component** and then name the project WinRT\\_CPP.\n4.  Choose the **OK** button.\n\n## **To add an activatable class to the component**\n\n1.  An activatable class is one that client code can create by using a **new** expression (**New** in Visual Basic, or **ref new** in C++). In your component, you declare it as **public ref class sealed**. In fact, the Class1.h and .cpp files already have a ref class. You can change the name, but in this example we’ll use the default name—Class1. You can define additional ref classes or regular classes in your component if they are required. For more information about ref classes, see [Type System (C++/CX)](https://msdn.microsoft.com/library/windows/apps/hh755822.aspx).\n\n2.  Add these \\#include directives to Class1.h:\n\n    ```cpp\n             private void PrimesUnOrderedButton_Click_1(object sender, RoutedEventArgs e)\n            {\n                var nativeObject = new WinRT_CPP.Class1();\n\n                StringBuilder sb = new StringBuilder();\n                sb.Append(\"Primes found (unordered): \");\n                PrimesUnOrderedResult.Text = sb.ToString();\n\n                // primeFoundEvent is a user-defined event in nativeObject\n                // It passes the results back to this thread as they are produced\n                // and the event handler that we define here immediately displays them.\n                nativeObject.primeFoundEvent += (n) =>\n                {\n                    sb.Append(n.ToString()).Append(\" \");\n                    PrimesUnOrderedResult.Text = sb.ToString();\n                };\n\n                // Call the async method.\n                var asyncResult = nativeObject.GetPrimesUnordered(2, 100000);\n\n                // Provide a handler for the Progress event that the asyncResult\n                // object fires at regular intervals. This handler updates the progress bar.\n                asyncResult.Progress += (asyncInfo, progress) =>\n                    {\n                        PrimesUnOrderedProgress.Value = progress;\n                    };\n            }\n\n            private void Clear_Button_Click(object sender, RoutedEventArgs e)\n            {\n                PrimesOrderedProgress.Value = 0;\n                PrimesUnOrderedProgress.Value = 0;\n                PrimesUnOrderedResult.Text = \"\";\n                PrimesOrderedResult.Text = \"\";\n                Result1.Text = \"\";\n            }\n    ```\n\n## Running the app\n\n\nSelect either the C# project or JavaScript project as the startup project by opening the shortcut menu for the project node in Solution Explorer and choosing **Set As Startup Project**. Then press F5 to run with debugging, or Ctrl+F5 to run without debugging.\n\n## Inspecting your component in Object Browser (optional)\n\n\nIn Object Browser, you can inspect all Windows Runtime types that are defined in .winmd files. This includes the types in the Platform namespace and the default namespace. However, because the types in the Platform::Collections namespace are defined in the header file collections.h, not in a winmd file, they don’t appear in Object Browser.\n\n## **To inspect a component**\n\n1.  On the menu bar, choose **View, Object Browser** (Ctrl+Alt+J).\n2.  In the left pane of the Object Browser, expand the WinRT\\_CPP node to show the types and methods that are defined on your component.\n\n## Debugging tips\n\n\nFor a better debugging experience, download the debugging symbols from the public Microsoft symbol servers:\n\n## **To download debugging symbols**\n\n1.  On the menu bar, choose **Tools, Options**.\n2.  In the **Options** dialog box, expand **Debugging** and select **Symbols**.\n3.  Select **Microsoft Symbol Servers** and the choose the **OK** button.\n\nIt might take some time to download the symbols the first time. For faster performance the next time you press F5, specify a local directory in which to cache the symbols.\n\nWhen you debug a JavaScript solution that has a component DLL, you can set the debugger to enable either stepping through script or stepping through native code in the component, but not both at the same time. To change the setting, open the shortcut menu for the JavaScript project node in Solution Explorer and choose **Properties, Debugging, Debugger Type**.\n\nBe sure to select appropriate capabilities in the package designer. You can open the package designer by opening the Package.appxmanifest file. For example, if you are attempting to programmatically access files in the Pictures folder, be sure to select the **Pictures Library** check box in the **Capabilities** pane of the package designer.\n\nIf your JavaScript code doesn't recognize the public properties or methods in the component, make sure that in JavaScript you are using camel casing. For example, the `ComputeResult` C++ method must be referenced as `computeResult` in JavaScript.\n\nIf you remove a C++ Windows Runtime Component project from a solution, you must also manually remove the project reference from the JavaScript project. Failure to do so prevents subsequent debug or build operations. If necessary, you can then add an assembly reference to the DLL.\n\n## Related topics\n\n* [Creating Windows Runtime Components in C++](creating-windows-runtime-components-in-cpp.md)\n\n"}