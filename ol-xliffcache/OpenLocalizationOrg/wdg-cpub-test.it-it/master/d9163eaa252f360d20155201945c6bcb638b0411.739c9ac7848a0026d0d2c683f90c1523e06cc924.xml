{"nodes":[{"pos":[17,189],"content":"Learn how to access and update the list of supported phrases (PhraseList elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.","needQuote":true,"needEscape":true,"nodes":[{"content":"Learn how to access and update the list of supported phrases (PhraseList elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.","pos":[0,172]}]},{"pos":[197,232],"content":"Dynamically modify VCD phrase lists","needQuote":true,"needEscape":true,"nodes":[{"content":"Dynamically modify VCD phrase lists","pos":[0,35]}]},{"content":"Dynamically modify VCD phrase lists","pos":[341,376]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[379,417]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[418,513],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[518,532]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[543,581]},{"content":"VCD elements and attributes v1.2","pos":[650,682]},{"pos":[745,921],"content":"Learn how to access and update the list of supported phrases (<bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.","source":"Learn how to access and update the list of supported phrases (**PhraseList** elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time."},{"content":"Dynamically modifying a phrase list at run time can be useful if the voice command is specific to a task involving some kind of user-defined favorites or transient app data.","pos":[923,1096]},{"content":"For example, let's say you have a travel app where users can enter destinations, and you want users to be able to start the app by saying the app name followed by \"Show trip to <ph id=\"ph1\">&amp;lt;</ph>destination<ph id=\"ph2\">&amp;gt;</ph>\".","pos":[1098,1296],"source":"For example, let's say you have a travel app where users can enter destinations, and you want users to be able to start the app by saying the app name followed by \"Show trip to &lt;destination&gt;\"."},{"content":"You don't need to create a separate <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element for each possible destination.","pos":[1297,1385],"source":" You don't need to create a separate **ListenFor** element for each possible destination."},{"content":"Instead, you can dynamically populate <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> at run time with the destinations created by the user.","pos":[1386,1493],"source":" Instead, you can dynamically populate **PhraseList** at run time with the destinations created by the user."},{"content":"In the <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element itself, you could specify something like: <ph id=\"ph1\">`&lt;ListenFor&gt; Show trip to {destination}  &lt;/ListenFor&gt;`</ph>, where \"destination\" is the value of the <bpt id=\"p2\">**</bpt>Label<ept id=\"p2\">**</ept> attribute for the <bpt id=\"p3\">**</bpt>PhraseList<ept id=\"p3\">**</ept>.","pos":[1494,1704],"source":" In the **ListenFor** element itself, you could specify something like: `<ListenFor> Show trip to {destination}  </ListenFor>`, where \"destination\" is the value of the **Label** attribute for the **PhraseList**."},{"pos":[1706,1880],"content":"For more info about <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> and other VCD elements, see the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VCD elements and attributes v1.2<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> reference.","source":"For more info about **PhraseList** and other VCD elements, see the [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593) reference."},{"content":"Prerequisites:","pos":[1884,1898]},{"content":"This topic builds on <bpt id=\"p1\">[</bpt>Launch a foreground app with voice commands in Cortana<ept id=\"p1\">](launch-a-foreground-app-with-voice-commands-in-cortana.md)</ept>.","pos":[1904,2041],"source":"This topic builds on [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md)."},{"content":"We continue here to demonstrate features with a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept>.","pos":[2042,2149],"source":" We continue here to demonstrate features with a trip planning and management app named **Adventure Works**."},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[2151,2304]},{"content":"Create your first app","pos":[2311,2332]},{"pos":[2396,2513],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>","source":"Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)"},{"content":"User experience guidelines:","pos":[2517,2544]},{"pos":[2550,2858],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app.","source":"See [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[2980,3000],"content":"Identify the command"},{"content":"To update a <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> element in the VCD file, get the <bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept> element that contains the phrase list.","pos":[3003,3116],"source":"To update a **PhraseList** element in the VCD file, get the **CommandSet** element that contains the phrase list."},{"content":"Use the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> attribute of that <bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept> element (<bpt id=\"p3\">**</bpt>Name<ept id=\"p3\">**</ept> must be unique in the VCD file) as a key to access the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>VoiceCommandManager.InstalledCommandSets<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn653257)</ept> property and get the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>VoiceCommandSet<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn653258)</ept> reference.","pos":[3117,3456],"source":" Use the **Name** attribute of that **CommandSet** element (**Name** must be unique in the VCD file) as a key to access the [**VoiceCommandManager.InstalledCommandSets**](https://msdn.microsoft.com/library/windows/apps/dn653257) property and get the [**VoiceCommandSet**](https://msdn.microsoft.com/library/windows/apps/dn653258) reference."},{"pos":[3587,3610],"content":"Replace the phrase list"},{"pos":[3613,3937],"content":"After you've identified the command set, get a reference to the phrase list that you want to modify and call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetPhraseListAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn653261)</ept> method; use the <bpt id=\"p3\">**</bpt>Label<ept id=\"p3\">**</ept> attribute of the <bpt id=\"p4\">**</bpt>PhraseList<ept id=\"p4\">**</ept> element and an array of strings as the new content of the phrase list.","source":"After you've identified the command set, get a reference to the phrase list that you want to modify and call the [**SetPhraseListAsync**](https://msdn.microsoft.com/library/windows/apps/dn653261) method; use the **Label** attribute of the **PhraseList** element and an array of strings as the new content of the phrase list."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If you modify a phrase list, the entire phrase list is replaced.","pos":[3939,4013],"source":"**Note**  If you modify a phrase list, the entire phrase list is replaced."},{"content":"If you want to insert new items into a phrase list, you must specify both the existing items and the new items in the call to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetPhraseListAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn653261)</ept>.","pos":[4014,4223],"source":" If you want to insert new items into a phrase list, you must specify both the existing items and the new items in the call to [**SetPhraseListAsync**](https://msdn.microsoft.com/library/windows/apps/dn653261)."},{"content":"Here, the VCD file defines a <bpt id=\"p1\">**</bpt>Command<ept id=\"p1\">**</ept>\"showTripToDestination\" with a <bpt id=\"p2\">**</bpt>PhraseList<ept id=\"p2\">**</ept> that defines three options for selecting a destination in our <bpt id=\"p3\">**</bpt>Adventure Works<ept id=\"p3\">**</ept> travel app.","pos":[4228,4407],"source":"Here, the VCD file defines a **Command**\"showTripToDestination\" with a **PhraseList** that defines three options for selecting a destination in our **Adventure Works** travel app."},{"content":"As the user saves and deletes destinations in the app, the app updates the options in the <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept>.","pos":[4408,4513],"source":" As the user saves and deletes destinations in the app, the app updates the options in the **PhraseList**."},{"pos":[5273,5385],"content":"Here's how to update the <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> shown in the previous example with an additional destination to Phoenix.","source":"Here's how to update the **PhraseList** shown in the previous example with an additional destination to Phoenix."},{"pos":[5880,5887],"content":"Remarks"},{"content":"Using a <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> to constrain the recognition is appropriate for a relatively small set or words.","pos":[5890,5993],"source":"Using a **PhraseList** to constrain the recognition is appropriate for a relatively small set or words."},{"content":"When the set of words is too large (hundreds of words, for example), or shouldn’t be constrained at all, use the <bpt id=\"p1\">**</bpt>PhraseTopic<ept id=\"p1\">**</ept> element and a <bpt id=\"p2\">**</bpt>Subject<ept id=\"p2\">**</ept> element to refine the relevance of speech-recognition results to improve scalability.","pos":[5994,6234],"source":" When the set of words is too large (hundreds of words, for example), or shouldn’t be constrained at all, use the **PhraseTopic** element and a **Subject** element to refine the relevance of speech-recognition results to improve scalability."},{"pos":[6236,6361],"content":"In our example, we have a <bpt id=\"p1\">**</bpt>PhraseTopic<ept id=\"p1\">**</ept> with a <bpt id=\"p2\">**</bpt>Scenario<ept id=\"p2\">**</ept> of \"Search\", further refined by a <bpt id=\"p3\">**</bpt>Subject<ept id=\"p3\">**</ept> of \"City\\\\State\".","source":"In our example, we have a **PhraseTopic** with a **Scenario** of \"Search\", further refined by a **Subject** of \"City\\\\State\"."},{"pos":[7203,7219],"content":"Related articles"},{"content":"Developers","pos":[7224,7234]},{"content":"Cortana interactions","pos":[7240,7260]},{"content":"Launch a foreground app with voice commands in Cortana","pos":[7290,7344]},{"content":"Launch a background app with voice commands in Cortana","pos":[7408,7462]},{"pos":[7525,7635],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD elements and attributes v1.2<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p3\">**</bpt>Designers<ept id=\"p3\">**</ept>","source":"[**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n**Designers**"},{"content":"Cortana design guidelines","pos":[7639,7664]},{"pos":[7726,7822],"content":"<bpt id=\"p1\">[</bpt>Speech design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">**</bpt>Samples<ept id=\"p2\">**</ept>","source":"[Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n**Samples**"},{"content":"Cortana voice command sample","pos":[7826,7854]}],"content":"---\nDescription: Learn how to access and update the list of supported phrases (PhraseList elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.\ntitle: Dynamically modify VCD phrase lists\nms.assetid: 98024EAC-EC0E-44AA-AEC5-A611BA7C5884\nlabel: Modify VCD phrase lists\ntemplate: detail.hbs\n---\n\n# Dynamically modify VCD phrase lists\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\nLearn how to access and update the list of supported phrases (**PhraseList** elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.\n\nDynamically modifying a phrase list at run time can be useful if the voice command is specific to a task involving some kind of user-defined favorites or transient app data.\n\nFor example, let's say you have a travel app where users can enter destinations, and you want users to be able to start the app by saying the app name followed by \"Show trip to &lt;destination&gt;\". You don't need to create a separate **ListenFor** element for each possible destination. Instead, you can dynamically populate **PhraseList** at run time with the destinations created by the user. In the **ListenFor** element itself, you could specify something like: `<ListenFor> Show trip to {destination}  </ListenFor>`, where \"destination\" is the value of the **Label** attribute for the **PhraseList**.\n\nFor more info about **PhraseList** and other VCD elements, see the [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593) reference.\n\n**Prerequisites:  **\n\nThis topic builds on [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md). We continue here to demonstrate features with a trip planning and management app named **Adventure Works**.\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Identify_the_command\"></span><span id=\"identify_the_command\"></span><span id=\"IDENTIFY_THE_COMMAND\"></span>Identify the command\n\n\nTo update a **PhraseList** element in the VCD file, get the **CommandSet** element that contains the phrase list. Use the **Name** attribute of that **CommandSet** element (**Name** must be unique in the VCD file) as a key to access the [**VoiceCommandManager.InstalledCommandSets**](https://msdn.microsoft.com/library/windows/apps/dn653257) property and get the [**VoiceCommandSet**](https://msdn.microsoft.com/library/windows/apps/dn653258) reference.\n\n## <span id=\"Replace_the_phrase_list\"></span><span id=\"replace_the_phrase_list\"></span><span id=\"REPLACE_THE_PHRASE_LIST\"></span>Replace the phrase list\n\n\nAfter you've identified the command set, get a reference to the phrase list that you want to modify and call the [**SetPhraseListAsync**](https://msdn.microsoft.com/library/windows/apps/dn653261) method; use the **Label** attribute of the **PhraseList** element and an array of strings as the new content of the phrase list.\n\n**Note**  If you modify a phrase list, the entire phrase list is replaced. If you want to insert new items into a phrase list, you must specify both the existing items and the new items in the call to [**SetPhraseListAsync**](https://msdn.microsoft.com/library/windows/apps/dn653261).\n\n \n\nHere, the VCD file defines a **Command**\"showTripToDestination\" with a **PhraseList** that defines three options for selecting a destination in our **Adventure Works** travel app. As the user saves and deletes destinations in the app, the app updates the options in the **PhraseList**.\n\n```XML\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.1\">\n  <CommandSet xml:lang=\"en-us\" Name=\"AdventureWorksCommandSet_en-us\">\n    <CommandPrefix> Adventure Works, </CommandPrefix>\n    <Example> Show trip to London </Example>\n\n    <Command Name=\"showTripToDestination\">\n      <Example> show trip to London  </Example>\n      <ListenFor> show trip to {destination} </ListenFor>\n      <Feedback> Showing trip to {destination} </Feedback>\n      <Navigate/>\n    </Command>\n\n    <PhraseList Label=\"destination\">\n      <Item> London </Item>\n      <Item> Dallas </Item>\n      <Item> New York </Item>\n    </PhraseList>\n\n  </CommandSet>\n\n<!-- Other CommandSets for other languages -->\n\n</VoiceCommands>\n```\n\nHere's how to update the **PhraseList** shown in the previous example with an additional destination to Phoenix.\n\n```CSharp\nWindows.ApplicationModel.VoiceCommands.VoiceCommnadDefinition.VoiceCommandSet commandSetEnUs;\n\nif (Windows.ApplicationModel.VoiceCommands.VoiceCommandDefinitionManager.\n      InstalledCommandSets.TryGetValue(\n        \"AdventureWorksCommandSet_en-us\", out commandSetEnUs))\n{\n  await commandSetEnUs.SetPhraseListAsync(\n    \"destination\", new string[] {“London”, “Dallas”, “New York”, “Phoenix”});\n}\n```\n\n## <span id=\"Remarks\"></span><span id=\"remarks\"></span><span id=\"REMARKS\"></span>Remarks\n\n\nUsing a **PhraseList** to constrain the recognition is appropriate for a relatively small set or words. When the set of words is too large (hundreds of words, for example), or shouldn’t be constrained at all, use the **PhraseTopic** element and a **Subject** element to refine the relevance of speech-recognition results to improve scalability.\n\nIn our example, we have a **PhraseTopic** with a **Scenario** of \"Search\", further refined by a **Subject** of \"City\\\\State\".\n\n```XML\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.1\">\n  <CommandSet xml:lang=\"en-us\" Name=\"AdventureWorksCommandSet_en-us\">\n    <CommandPrefix> Adventure Works, </CommandPrefix>\n    <Example> Show trip to London </Example>\n\n    <Command Name=\"showTripToDestination\">\n      <Example> show trip to London  </Example>\n      <ListenFor> show trip to {destination} </ListenFor>\n      <Feedback> Showing trip to {destination} </Feedback>\n      <Navigate/>\n    </Command>\n\n    <PhraseList Label=\"destination\">\n      <Item> London </Item>\n      <Item> Dallas </Item>\n      <Item> New York </Item>\n    </PhraseList>\n\n    <PhraseTopic Label=\"destination\" Scenario=\"Search\">\n      <Subject>City/State</Subject>\n    </PhraseTopic>\n\n  </CommandSet>\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md)\n* [Launch a background app with voice commands in Cortana](launch-a-background-app-with-voice-commands-in-cortana.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}