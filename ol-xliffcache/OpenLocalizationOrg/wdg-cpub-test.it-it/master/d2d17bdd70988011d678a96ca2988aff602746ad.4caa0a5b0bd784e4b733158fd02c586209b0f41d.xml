{"nodes":[{"pos":[17,81],"content":"Raw notifications are short, general purpose push notifications.","needQuote":true,"needEscape":true,"nodes":[{"content":"Raw notifications are short, general purpose push notifications.","pos":[0,64]}]},{"pos":[89,114],"content":"Raw notification overview","needQuote":true,"needEscape":true,"nodes":[{"content":"Raw notification overview","pos":[0,25]}]},{"content":"Raw notification overview","pos":[203,228]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[231,269]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[270,365],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Raw notifications are short, general purpose push notifications.","pos":[368,432]},{"content":"They are strictly instructional and do not include a UI component.","pos":[433,499]},{"content":"As with other push notifications, the Windows Push Notification Services (WNS) feature delivers raw notifications from your cloud service to your app.","pos":[500,650]},{"content":"You can use raw notifications for a variety of purposes, including to trigger your app to run a background task if the user has given the app permission to do so.","pos":[652,814]},{"content":"By using WNS to communicate with your app, you can avoid the processing overhead of creating persistent socket connections, sending HTTP GET messages, and other service-to-app connections.","pos":[815,1003]},{"pos":[1005,1244],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>   To understand raw notifications, it's best to be familiar with the concepts discussed in the <bpt id=\"p2\">[</bpt>Windows Push Notification Services (WNS) overview<ept id=\"p2\">](tiles-and-notifications-windows-push-notification-services--wns--overview.md)</ept>.","source":"**Important**   To understand raw notifications, it's best to be familiar with the concepts discussed in the [Windows Push Notification Services (WNS) overview](tiles-and-notifications-windows-push-notification-services--wns--overview.md)."},{"content":"As with toast, tile, and badge push notifications, a raw notification is pushed from your app's cloud service over an assigned channel Uniform Resource Identifier (URI) to WNS.","pos":[1249,1425]},{"content":"WNS, in turn, delivers the notification to the device and user account associated with that channel.","pos":[1426,1526]},{"content":"Unlike other push notifications, raw notifications don't have a specified format.","pos":[1527,1608]},{"content":"The content of the payload is entirely app-defined.","pos":[1609,1660]},{"content":"As an illustration of an app that could benefit from raw notifications, let's look at a theoretical document collaboration app.","pos":[1662,1789]},{"content":"Consider two users who are editing the same document at the same time.","pos":[1790,1860]},{"content":"The cloud service, which hosts the shared document, could use raw notifications to notify each user when changes are made by the other user.","pos":[1861,2001]},{"content":"The raw notifications would not necessarily contain the changes to the document, but instead would signal each user's copy of the app to contact the central location and sync the available changes.","pos":[2002,2199]},{"content":"By using raw notifications, the app and the its cloud service can save the overhead of maintaining persistent connections the entire time the document is open.","pos":[2200,2359]},{"pos":[2499,2525],"content":"How raw notifications work"},{"content":"All raw notifications are push notifications.","pos":[2528,2573]},{"content":"Therefore, the setup required to send and receive push notifications applies to raw notifications as well:","pos":[2574,2680]},{"content":"You must have a valid WNS channel to send raw notifications.","pos":[2686,2746]},{"content":"For more information about acquiring a push notification channel, see <bpt id=\"p1\">[</bpt>How to request, create, and save a notification channel<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465412)</ept>.","pos":[2747,2933],"source":" For more information about acquiring a push notification channel, see [How to request, create, and save a notification channel](https://msdn.microsoft.com/library/windows/apps/hh465412)."},{"content":"You must include the <bpt id=\"p1\">**</bpt>Internet<ept id=\"p1\">**</ept> capability in your app's manifest.","pos":[2938,3006],"source":"You must include the **Internet** capability in your app's manifest."},{"content":"In the Microsoft Visual Studio manifest editor, you will find this option under the <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> tab as <bpt id=\"p2\">**</bpt>Internet (Client)<ept id=\"p2\">**</ept>.","pos":[3007,3137],"source":" In the Microsoft Visual Studio manifest editor, you will find this option under the **Capabilities** tab as **Internet (Client)**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Capabilities<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br211422)</ept>.","pos":[3138,3241],"source":" For more information, see [**Capabilities**](https://msdn.microsoft.com/library/windows/apps/br211422)."},{"content":"The body of the notification is in an app-defined format.","pos":[3243,3300]},{"content":"The client receives the data as a null-terminated string (<bpt id=\"p1\">**</bpt>HSTRING<ept id=\"p1\">**</ept>) that only needs to be understood by the app.","pos":[3301,3416],"source":" The client receives the data as a null-terminated string (**HSTRING**) that only needs to be understood by the app."},{"content":"If the client is offline, raw notifications will be cached by WNS only if the <bpt id=\"p1\">[</bpt>X-WNS-Cache-Policy<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_cache)</ept> header is included in the notification.","pos":[3418,3639],"source":"If the client is offline, raw notifications will be cached by WNS only if the [X-WNS-Cache-Policy](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_cache) header is included in the notification."},{"content":"However, only one raw notification will be cached and delivered once the device comes back online.","pos":[3640,3738]},{"content":"There are only three possible paths for a raw notification to take on the client: they will be delivered to your running app through a notification delivery event, sent to a background task, or dropped.","pos":[3740,3942]},{"content":"Therefore, if the client is offline and WNS attempts to deliver a raw notification, the notification is dropped.","pos":[3943,4055]},{"pos":[4198,4225],"content":"Creating a raw notification"},{"content":"Sending a raw notification is similar to sending a tile, toast, or badge push notification, with these differences:","pos":[4228,4343]},{"content":"The HTTP Content-Type header must be set to \"application/octet-stream\".","pos":[4349,4420]},{"pos":[4425,4561],"content":"The HTTP <bpt id=\"p1\">[</bpt>X-WNS-Type<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_type)</ept> header must be set to \"wns/raw\".","source":"The HTTP [X-WNS-Type](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_type) header must be set to \"wns/raw\"."},{"content":"The notification body can contain any string payload smaller than 5 KB in size.","pos":[4566,4645]},{"content":"Raw notifications are intended to be used as short messages that trigger your app to take an action, such as to directly contact the service to sync a larger amount of data or to make a local state modification based on the notification content.","pos":[4647,4892]},{"content":"Note that WNS push notifications cannot be guaranteed to be delivered, so your app and cloud service must account for the possibility that the raw notification might not reach the client, such as when the client is offline.","pos":[4893,5116]},{"pos":[5118,5279],"content":"For more information on sending push notifications, see <bpt id=\"p1\">[</bpt>Quickstart: Sending a push notification<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh868252)</ept>.","source":"For more information on sending push notifications, see [Quickstart: Sending a push notification](https://msdn.microsoft.com/library/windows/apps/xaml/hh868252)."},{"pos":[5425,5453],"content":"Receiving a raw notification"},{"content":"There are two avenues through which your app can be receive raw notifications:","pos":[5456,5534]},{"pos":[5540,5644],"content":"Through <bpt id=\"p1\">[</bpt>notification delivery events<ept id=\"p1\">](#notification_delivery_events)</ept> while your application is running.","source":"Through [notification delivery events](#notification_delivery_events) while your application is running."},{"pos":[5649,5768],"content":"Through <bpt id=\"p1\">[</bpt>background tasks triggered by the raw notification<ept id=\"p1\">](#bg_tasks)</ept> if your app is enabled to run background tasks.","source":"Through [background tasks triggered by the raw notification](#bg_tasks) if your app is enabled to run background tasks."},{"content":"An app can use both mechanisms to receive raw notifications.","pos":[5770,5830]},{"content":"If an app implements both the notification delivery event handler and background tasks that are triggered by raw notifications, the notification delivery event will take priority when the app is running.","pos":[5831,6034]},{"content":"If the app is running, the notification delivery event will take priority over the background task and the app will have the first opportunity to process the notification.","pos":[6040,6211]},{"content":"The notification delivery event handler can specify, by setting the event's <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PushNotificationReceivedEventArgs.Cancel<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241297)</ept> property to <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept>, that the raw notification should not be passed to its background task once the handler exits.","pos":[6216,6512],"source":"The notification delivery event handler can specify, by setting the event's [**PushNotificationReceivedEventArgs.Cancel**](https://msdn.microsoft.com/library/windows/apps/br241297) property to **true**, that the raw notification should not be passed to its background task once the handler exits."},{"content":"If the <bpt id=\"p1\">**</bpt>Cancel<ept id=\"p1\">**</ept> property is set to <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept> or is not set (the default value is <bpt id=\"p3\">**</bpt>false<ept id=\"p3\">**</ept>), the raw notification will trigger the background task after the notification delivery event handler has done its work.","pos":[6513,6726],"source":" If the **Cancel** property is set to **false** or is not set (the default value is **false**), the raw notification will trigger the background task after the notification delivery event handler has done its work."},{"pos":[6826,6854],"content":"Notification delivery events"},{"content":"Your app can use a notification delivery event (<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PushNotificationReceived<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241292)</ept>) to receive raw notifications while the app is in use.","pos":[6856,7047],"source":"Your app can use a notification delivery event ([**PushNotificationReceived**](https://msdn.microsoft.com/library/windows/apps/br241292)) to receive raw notifications while the app is in use."},{"content":"When the cloud service sends a raw notification, the running app can receive it by handling the notification delivery event on the channel URI.","pos":[7048,7191]},{"content":"If your app is not running and does not use <bpt id=\"p1\">[</bpt>background tasks<ept id=\"p1\">](#bg_tasks)</ept>, any raw notification sent to that app is dropped by WNS on receipt.","pos":[7193,7335],"source":"If your app is not running and does not use [background tasks](#bg_tasks), any raw notification sent to that app is dropped by WNS on receipt."},{"content":"To avoid wasting your cloud service's resources, you should consider implementing logic on the service to track whether the app is active.","pos":[7336,7474]},{"content":"There are two sources of this information: an app can explicitly tell the service that it's ready to start receiving notifications, and WNS can tell the service when to stop.","pos":[7475,7649]},{"content":"<bpt id=\"p1\">**</bpt>The app notifies the cloud service<ept id=\"p1\">**</ept>: The app can contact its service to let it know that the app is running in the foreground.","pos":[7655,7784],"source":"**The app notifies the cloud service**: The app can contact its service to let it know that the app is running in the foreground."},{"content":"The disadvantage of this approach is that the app can end up contacting your service very frequently.","pos":[7785,7886]},{"content":"However, it has the advantage that the service will always know when the app is ready to receive incoming raw notifications.","pos":[7887,8011]},{"content":"Another advantage is that when the app contacts its service, the service then knows to send raw notifications to the specific instance of that app rather than broadcast.","pos":[8012,8181]},{"content":"<bpt id=\"p1\">**</bpt>The cloud service responds to WNS response messages<ept id=\"p1\">**</ept> : Your app service can use the <bpt id=\"p2\">[</bpt>X-WNS-NotificationStatus<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_notification)</ept> and <bpt id=\"p3\">[</bpt>X-WNS-DeviceConnectionStatus<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_dcs)</ept> information returned by WNS to determine when to stop sending raw notifications to the app.","pos":[8186,8597],"source":"**The cloud service responds to WNS response messages** : Your app service can use the [X-WNS-NotificationStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_notification) and [X-WNS-DeviceConnectionStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_dcs) information returned by WNS to determine when to stop sending raw notifications to the app."},{"content":"When your service sends a notification to a channel as an HTTP POST, it can receive one of these messages in the response:","pos":[8598,8720]},{"content":"<bpt id=\"p1\">**</bpt>X-WNS-NotificationStatus: dropped<ept id=\"p1\">**</ept>: This indicates that the notification was not received by the client.","pos":[8730,8837],"source":"**X-WNS-NotificationStatus: dropped**: This indicates that the notification was not received by the client."},{"content":"It's a safe assumption that the <bpt id=\"p1\">**</bpt>dropped<ept id=\"p1\">**</ept> response is caused by your app no longer being in the foreground on the user's device.","pos":[8838,8968],"source":" It's a safe assumption that the **dropped** response is caused by your app no longer being in the foreground on the user's device."},{"content":"<bpt id=\"p1\">**</bpt>X-WNS-DeviceConnectionStatus: disconnected<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>X-WNS-DeviceConnectionStatus: tempconnected<ept id=\"p2\">**</ept>: This indicates that the Windows client no longer has a connection to WNS.","pos":[8977,9149],"source":"**X-WNS-DeviceConnectionStatus: disconnected** or **X-WNS-DeviceConnectionStatus: tempconnected**: This indicates that the Windows client no longer has a connection to WNS."},{"content":"Note that to receive this message from WNS, you have to ask for it by setting the <bpt id=\"p1\">[</bpt>X-WNS-RequestForStatus<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_request)</ept> header in the notification's HTTP POST.","pos":[9150,9381],"source":" Note that to receive this message from WNS, you have to ask for it by setting the [X-WNS-RequestForStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_request) header in the notification's HTTP POST."},{"content":"Your app's cloud service can use the information in these status messages to cease communication attempts through raw notifications.","pos":[9387,9519]},{"content":"The service can resume sending raw notifications once it is contacted by the app, when the app switches back into the foreground.","pos":[9520,9649]},{"pos":[9655,9884],"content":"Note that you should not rely on <bpt id=\"p1\">[</bpt>X-WNS-NotificationStatus<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_notification)</ept> to determine whether the notification was successfully delivered to the client.","source":"Note that you should not rely on [X-WNS-NotificationStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_notification) to determine whether the notification was successfully delivered to the client."},{"pos":[9890,10030],"content":"For more information, see <bpt id=\"p1\">[</bpt>Push notification service request and response headers<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465435)</ept>","source":"For more information, see [Push notification service request and response headers](https://msdn.microsoft.com/library/windows/apps/hh465435)"},{"pos":[10090,10137],"content":"Background tasks triggered by raw notifications"},{"pos":[10139,10358],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>   Before using raw notification background tasks, an app must be granted background access via <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>BackgroundExecutionManager.RequestAccessAsync<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept>.","source":"**Important**   Before using raw notification background tasks, an app must be granted background access via [**BackgroundExecutionManager.RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485)."},{"content":"Your background task must be registered with a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PushNotificationTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept>.","pos":[10363,10498],"source":"Your background task must be registered with a [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543)."},{"content":"If it is not registered, the task will not run when a raw notification is received.","pos":[10499,10582]},{"content":"A background task that is triggered by a raw notification enables your app's cloud service to contact your app, even when the app is not running (though it might trigger it to run).","pos":[10584,10765]},{"content":"This happens without the app having to maintain a continuous connection.","pos":[10766,10838]},{"content":"Raw notifications are the only notification type that can trigger background tasks.","pos":[10839,10922]},{"content":"However, while toast, tile, and badge push notifications cannot trigger background tasks, background tasks triggered by raw notifications can update tiles and invoke toast notifications through local API calls.","pos":[10923,11133]},{"content":"As an illustration of how background tasks that are triggered by raw notifications work, let's consider an app used to read e-books.","pos":[11135,11267]},{"content":"First, a user purchases a book online, possibly on another device.","pos":[11268,11334]},{"content":"In response, the app's cloud service can send a raw notification to each of the user's devices, with a payload that states that the book was purchased and the app should download it.","pos":[11335,11517]},{"content":"The app then directly contacts the app's cloud service to begin a background download of the new book so that later, when the user launches the app, the book is already there and ready for reading.","pos":[11518,11715]},{"content":"To use a raw notification to trigger a background task, your app must:","pos":[11717,11787]},{"pos":[11793,12002],"content":"Request permission to run tasks in the background (which the user can revoke at any time) by using <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BackgroundExecutionManager.RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept>.","source":"Request permission to run tasks in the background (which the user can revoke at any time) by using [**BackgroundExecutionManager.RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485)."},{"content":"Implement the background task.","pos":[12007,12037]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Supporting your app with background tasks<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh977046)</ept>","pos":[12038,12165],"source":" For more information, see [Supporting your app with background tasks](https://msdn.microsoft.com/library/windows/apps/hh977046)"},{"content":"Your background task is then invoked in response to the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PushNotificationTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept>, each time a raw notification is received for your app.","pos":[12167,12366],"source":"Your background task is then invoked in response to the [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543), each time a raw notification is received for your app."},{"content":"Your background task interprets the raw notification's app-specific payload and acts on it.","pos":[12367,12458]},{"content":"For each app, only one background task can run at a time.","pos":[12460,12517]},{"content":"If a background task is triggered for an app for which a background task is already running, the first background task must complete before the new one is run.","pos":[12518,12677]},{"pos":[12784,12799],"content":"Other resources"},{"pos":[12802,13102],"content":"You can learn more by downloading the <bpt id=\"p1\">[</bpt>Raw notifications sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=241553)</ept> for Windows 8.1, and the <bpt id=\"p2\">[</bpt>Push and periodic notifications sample<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=231476)</ept> for Windows 8.1, and re-using their source code in your Windows 10 app.","source":"You can learn more by downloading the [Raw notifications sample](http://go.microsoft.com/fwlink/p/?linkid=241553) for Windows 8.1, and the [Push and periodic notifications sample](http://go.microsoft.com/fwlink/p/?LinkId=231476) for Windows 8.1, and re-using their source code in your Windows 10 app."},{"pos":[13140,13154],"content":"Related topics"},{"content":"Guidelines for raw notifications","pos":[13160,13192]},{"content":"Quickstart: Creating and registering a raw notification background task","pos":[13255,13326]},{"content":"Quickstart: Intercepting push notifications for running apps","pos":[13389,13449]},{"content":"RawNotification","pos":[13514,13529]},{"content":"BackgroundExecutionManager.RequestAccessAsync","pos":[13596,13641]}],"content":"---\nDescription: Raw notifications are short, general purpose push notifications.\ntitle: Raw notification overview\nms.assetid: A867C75D-D16E-4AB5-8B44-614EEB9179C7\nlabel: TBD\ntemplate: detail.hbs\n---\n\n# Raw notification overview\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nRaw notifications are short, general purpose push notifications. They are strictly instructional and do not include a UI component. As with other push notifications, the Windows Push Notification Services (WNS) feature delivers raw notifications from your cloud service to your app.\n\nYou can use raw notifications for a variety of purposes, including to trigger your app to run a background task if the user has given the app permission to do so. By using WNS to communicate with your app, you can avoid the processing overhead of creating persistent socket connections, sending HTTP GET messages, and other service-to-app connections.\n\n**Important**   To understand raw notifications, it's best to be familiar with the concepts discussed in the [Windows Push Notification Services (WNS) overview](tiles-and-notifications-windows-push-notification-services--wns--overview.md).\n\n \n\nAs with toast, tile, and badge push notifications, a raw notification is pushed from your app's cloud service over an assigned channel Uniform Resource Identifier (URI) to WNS. WNS, in turn, delivers the notification to the device and user account associated with that channel. Unlike other push notifications, raw notifications don't have a specified format. The content of the payload is entirely app-defined.\n\nAs an illustration of an app that could benefit from raw notifications, let's look at a theoretical document collaboration app. Consider two users who are editing the same document at the same time. The cloud service, which hosts the shared document, could use raw notifications to notify each user when changes are made by the other user. The raw notifications would not necessarily contain the changes to the document, but instead would signal each user's copy of the app to contact the central location and sync the available changes. By using raw notifications, the app and the its cloud service can save the overhead of maintaining persistent connections the entire time the document is open.\n\n## <span id=\"How_raw_notifications_work\"></span><span id=\"how_raw_notifications_work\"></span><span id=\"HOW_RAW_NOTIFICATIONS_WORK\"></span>How raw notifications work\n\n\nAll raw notifications are push notifications. Therefore, the setup required to send and receive push notifications applies to raw notifications as well:\n\n-   You must have a valid WNS channel to send raw notifications. For more information about acquiring a push notification channel, see [How to request, create, and save a notification channel](https://msdn.microsoft.com/library/windows/apps/hh465412).\n-   You must include the **Internet** capability in your app's manifest. In the Microsoft Visual Studio manifest editor, you will find this option under the **Capabilities** tab as **Internet (Client)**. For more information, see [**Capabilities**](https://msdn.microsoft.com/library/windows/apps/br211422).\n\nThe body of the notification is in an app-defined format. The client receives the data as a null-terminated string (**HSTRING**) that only needs to be understood by the app.\n\nIf the client is offline, raw notifications will be cached by WNS only if the [X-WNS-Cache-Policy](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_cache) header is included in the notification. However, only one raw notification will be cached and delivered once the device comes back online.\n\nThere are only three possible paths for a raw notification to take on the client: they will be delivered to your running app through a notification delivery event, sent to a background task, or dropped. Therefore, if the client is offline and WNS attempts to deliver a raw notification, the notification is dropped.\n\n## <span id=\"Creating_a_raw_notification\"></span><span id=\"creating_a_raw_notification\"></span><span id=\"CREATING_A_RAW_NOTIFICATION\"></span>Creating a raw notification\n\n\nSending a raw notification is similar to sending a tile, toast, or badge push notification, with these differences:\n\n-   The HTTP Content-Type header must be set to \"application/octet-stream\".\n-   The HTTP [X-WNS-Type](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_type) header must be set to \"wns/raw\".\n-   The notification body can contain any string payload smaller than 5 KB in size.\n\nRaw notifications are intended to be used as short messages that trigger your app to take an action, such as to directly contact the service to sync a larger amount of data or to make a local state modification based on the notification content. Note that WNS push notifications cannot be guaranteed to be delivered, so your app and cloud service must account for the possibility that the raw notification might not reach the client, such as when the client is offline.\n\nFor more information on sending push notifications, see [Quickstart: Sending a push notification](https://msdn.microsoft.com/library/windows/apps/xaml/hh868252).\n\n## <span id=\"Receiving_a_raw_notification\"></span><span id=\"receiving_a_raw_notification\"></span><span id=\"RECEIVING_A_RAW_NOTIFICATION\"></span>Receiving a raw notification\n\n\nThere are two avenues through which your app can be receive raw notifications:\n\n-   Through [notification delivery events](#notification_delivery_events) while your application is running.\n-   Through [background tasks triggered by the raw notification](#bg_tasks) if your app is enabled to run background tasks.\n\nAn app can use both mechanisms to receive raw notifications. If an app implements both the notification delivery event handler and background tasks that are triggered by raw notifications, the notification delivery event will take priority when the app is running.\n\n-   If the app is running, the notification delivery event will take priority over the background task and the app will have the first opportunity to process the notification.\n-   The notification delivery event handler can specify, by setting the event's [**PushNotificationReceivedEventArgs.Cancel**](https://msdn.microsoft.com/library/windows/apps/br241297) property to **true**, that the raw notification should not be passed to its background task once the handler exits. If the **Cancel** property is set to **false** or is not set (the default value is **false**), the raw notification will trigger the background task after the notification delivery event handler has done its work.\n\n### <span id=\"notification_delivery_events\"></span><span id=\"NOTIFICATION_DELIVERY_EVENTS\"></span>Notification delivery events\n\nYour app can use a notification delivery event ([**PushNotificationReceived**](https://msdn.microsoft.com/library/windows/apps/br241292)) to receive raw notifications while the app is in use. When the cloud service sends a raw notification, the running app can receive it by handling the notification delivery event on the channel URI.\n\nIf your app is not running and does not use [background tasks](#bg_tasks), any raw notification sent to that app is dropped by WNS on receipt. To avoid wasting your cloud service's resources, you should consider implementing logic on the service to track whether the app is active. There are two sources of this information: an app can explicitly tell the service that it's ready to start receiving notifications, and WNS can tell the service when to stop.\n\n-   **The app notifies the cloud service**: The app can contact its service to let it know that the app is running in the foreground. The disadvantage of this approach is that the app can end up contacting your service very frequently. However, it has the advantage that the service will always know when the app is ready to receive incoming raw notifications. Another advantage is that when the app contacts its service, the service then knows to send raw notifications to the specific instance of that app rather than broadcast.\n-   **The cloud service responds to WNS response messages** : Your app service can use the [X-WNS-NotificationStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_notification) and [X-WNS-DeviceConnectionStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_dcs) information returned by WNS to determine when to stop sending raw notifications to the app. When your service sends a notification to a channel as an HTTP POST, it can receive one of these messages in the response:\n\n    -   **X-WNS-NotificationStatus: dropped**: This indicates that the notification was not received by the client. It's a safe assumption that the **dropped** response is caused by your app no longer being in the foreground on the user's device.\n    -   **X-WNS-DeviceConnectionStatus: disconnected** or **X-WNS-DeviceConnectionStatus: tempconnected**: This indicates that the Windows client no longer has a connection to WNS. Note that to receive this message from WNS, you have to ask for it by setting the [X-WNS-RequestForStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_request) header in the notification's HTTP POST.\n\n    Your app's cloud service can use the information in these status messages to cease communication attempts through raw notifications. The service can resume sending raw notifications once it is contacted by the app, when the app switches back into the foreground.\n\n    Note that you should not rely on [X-WNS-NotificationStatus](https://msdn.microsoft.com/library/windows/apps/hh465435.aspx#pncodes_x_wns_notification) to determine whether the notification was successfully delivered to the client.\n\n    For more information, see [Push notification service request and response headers](https://msdn.microsoft.com/library/windows/apps/hh465435)\n\n### <span id=\"bg_tasks\"></span><span id=\"BG_TASKS\"></span>Background tasks triggered by raw notifications\n\n**Important**   Before using raw notification background tasks, an app must be granted background access via [**BackgroundExecutionManager.RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485).\n\n \n\nYour background task must be registered with a [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543). If it is not registered, the task will not run when a raw notification is received.\n\nA background task that is triggered by a raw notification enables your app's cloud service to contact your app, even when the app is not running (though it might trigger it to run). This happens without the app having to maintain a continuous connection. Raw notifications are the only notification type that can trigger background tasks. However, while toast, tile, and badge push notifications cannot trigger background tasks, background tasks triggered by raw notifications can update tiles and invoke toast notifications through local API calls.\n\nAs an illustration of how background tasks that are triggered by raw notifications work, let's consider an app used to read e-books. First, a user purchases a book online, possibly on another device. In response, the app's cloud service can send a raw notification to each of the user's devices, with a payload that states that the book was purchased and the app should download it. The app then directly contacts the app's cloud service to begin a background download of the new book so that later, when the user launches the app, the book is already there and ready for reading.\n\nTo use a raw notification to trigger a background task, your app must:\n\n1.  Request permission to run tasks in the background (which the user can revoke at any time) by using [**BackgroundExecutionManager.RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485).\n2.  Implement the background task. For more information, see [Supporting your app with background tasks](https://msdn.microsoft.com/library/windows/apps/hh977046)\n\nYour background task is then invoked in response to the [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543), each time a raw notification is received for your app. Your background task interprets the raw notification's app-specific payload and acts on it.\n\nFor each app, only one background task can run at a time. If a background task is triggered for an app for which a background task is already running, the first background task must complete before the new one is run.\n\n## <span id=\"Other_resources\"></span><span id=\"other_resources\"></span><span id=\"OTHER_RESOURCES\"></span>Other resources\n\n\nYou can learn more by downloading the [Raw notifications sample](http://go.microsoft.com/fwlink/p/?linkid=241553) for Windows 8.1, and the [Push and periodic notifications sample](http://go.microsoft.com/fwlink/p/?LinkId=231476) for Windows 8.1, and re-using their source code in your Windows 10 app.\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n* [Guidelines for raw notifications](https://msdn.microsoft.com/library/windows/apps/hh761463)\n* [Quickstart: Creating and registering a raw notification background task](https://msdn.microsoft.com/library/windows/apps/jj676800)\n* [Quickstart: Intercepting push notifications for running apps](https://msdn.microsoft.com/library/windows/apps/jj709908)\n* [**RawNotification**](https://msdn.microsoft.com/library/windows/apps/br241304)\n* [**BackgroundExecutionManager.RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485)\n \n\n \n\n\n\n\n"}