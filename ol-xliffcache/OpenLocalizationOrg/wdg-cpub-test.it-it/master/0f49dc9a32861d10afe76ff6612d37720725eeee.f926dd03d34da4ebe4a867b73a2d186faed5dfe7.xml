{"nodes":[{"pos":[60,83],"content":"Composition visual tree","needQuote":true,"needEscape":true,"nodes":[{"content":"Composition visual tree","pos":[0,23]}]},{"pos":[97,340],"content":"Composition Visuals make up the visual tree structure which all other features of the composition API use and build on. The API allows developers to define and create one or many visual objects each representing a single node in a visual tree.","needQuote":true,"needEscape":true,"nodes":[{"content":"Composition Visuals make up the visual tree structure which all other features of the composition API use and build on. The API allows developers to define and create one or many visual objects each representing a single node in a visual tree.","pos":[0,243],"nodes":[{"content":"Composition Visuals make up the visual tree structure which all other features of the composition API use and build on.","pos":[0,119]},{"content":"The API allows developers to define and create one or many visual objects each representing a single node in a visual tree.","pos":[120,243]}]}]},{"content":"Composition visual tree","pos":[347,370]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[372,410]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[411,506],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Composition Visuals make up the visual tree structure which all other features of the composition API use and build on.","pos":[508,627]},{"content":"The API allows developers to define and create one or many visual objects each representing a single node in a visual tree.","pos":[628,751]},{"content":"Visuals","pos":[756,763]},{"content":"There are three visual types that make up the visual tree structure plus a base brush class with multiple subclasses that affect the content of a visual:","pos":[765,918]},{"pos":[924,1093],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Visual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept> – base object, the majority of the properties are here, and inherited by the other Visual objects.","source":"[**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) – base object, the majority of the properties are here, and inherited by the other Visual objects."},{"pos":[1098,1305],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ContainerVisual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706810)</ept> – derives from <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Visual<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept>, and adds the ability to create children.","source":"[**ContainerVisual**](https://msdn.microsoft.com/library/windows/apps/Dn706810) – derives from [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858), and adds the ability to create children."},{"pos":[1310,1604],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SpriteVisual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Mt589433)</ept> – Derives from <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ContainerVisual<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/Dn706810)</ept> and adds the ability to associate a brush so that the Visual can render pixels including images, effects or a solid color.","source":"[**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) – Derives from [**ContainerVisual**](https://msdn.microsoft.com/library/windows/apps/Dn706810) and adds the ability to associate a brush so that the Visual can render pixels including images, effects or a solid color."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CompositionBrush<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Mt589398)</ept> – Allows the application of an effect on the content of a Visual.","pos":[1609,1755],"source":"[**CompositionBrush**](https://msdn.microsoft.com/library/windows/apps/Mt589398) – Allows the application of an effect on the content of a Visual."},{"content":"There are a number of subclasses of CompositionBrush.","pos":[1756,1809]},{"content":"The CompositionVisual Sample","pos":[1814,1842]},{"content":"In the sample there are a number of solid color squares that can be clicked on and dragged about the screen.","pos":[1844,1952]},{"content":"When a square is clicked on, it will come to the front, rotate 45 degrees, and become opaque when dragged about.","pos":[1953,2065]},{"content":"This shows a number of basic concepts for working with the API including:","pos":[2067,2140]},{"content":"Creating a compositor","pos":[2146,2167]},{"content":"Creating a SpriteVisual with a ColorBrush","pos":[2172,2213]},{"content":"Clipping a Visual","pos":[2218,2235]},{"content":"Rotating a Visual","pos":[2240,2257]},{"content":"Setting Opacity","pos":[2262,2277]},{"content":"Changing the Visual’s position in the collection.","pos":[2282,2331]},{"content":"In the sample there are also three different Visuals at work:","pos":[2333,2394]},{"pos":[2400,2569],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Visual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept> – base object, the majority of the properties are here, and inherited by the other Visual objects.","source":"[**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) – base object, the majority of the properties are here, and inherited by the other Visual objects."},{"pos":[2574,2717],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ContainerVisual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706810)</ept> – derives from Visual, and adds the ability to create children.","source":"[**ContainerVisual**](https://msdn.microsoft.com/library/windows/apps/Dn706810) – derives from Visual, and adds the ability to create children."},{"pos":[2722,2943],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SpriteVisual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Mt589433)</ept> – Derives from Visual and adds the ability to associate a brush so that the Visual can render pixels including images, effects or a solid color.","source":"[**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) – Derives from Visual and adds the ability to associate a brush so that the Visual can render pixels including images, effects or a solid color."},{"content":"While this sample doesn’t cover concepts like Animations or more complex effects, it contains the building blocks that all of those systems use.","pos":[2945,3089]},{"content":"Creating a Compositor","pos":[3094,3115]},{"content":"Creating a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Compositor<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706789)</ept> and storing it for use as a factory in a variable is a simple task.","pos":[3117,3270],"source":"Creating a [**Compositor**](https://msdn.microsoft.com/library/windows/apps/Dn706789) and storing it for use as a factory in a variable is a simple task."},{"content":"The following snippet shows creating a new <bpt id=\"p1\">**</bpt>Compositor<ept id=\"p1\">**</ept>:","pos":[3271,3329],"source":" The following snippet shows creating a new **Compositor**:"},{"content":"Creating a SpriteVisual and ColorBrush","pos":[3377,3415]},{"pos":[3417,3733],"content":"Using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Compositor<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706789)</ept> it's easy to create objects whenever you need them, such as a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SpriteVisual<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/Mt589433)</ept> and a <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>CompositionColorBrush<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/Mt589399)</ept>:","source":"Using the [**Compositor**](https://msdn.microsoft.com/library/windows/apps/Dn706789) it's easy to create objects whenever you need them, such as a [**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) and a [**CompositionColorBrush**](https://msdn.microsoft.com/library/windows/apps/Mt589399):"},{"content":"While this is only a few lines of code it demonstrates a powerful concept, <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SpriteVisual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Mt589433)</ept> objects are the heart of the effects system.","pos":[3878,4074],"source":"While this is only a few lines of code it demonstrates a powerful concept, [**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) objects are the heart of the effects system."},{"content":"The <bpt id=\"p1\">**</bpt>SpriteVisual<ept id=\"p1\">**</ept> allows for great flexibility and interplay in color, image and effect creation.","pos":[4075,4175],"source":" The **SpriteVisual** allows for great flexibility and interplay in color, image and effect creation."},{"content":"The <bpt id=\"p1\">**</bpt>SpriteVisual<ept id=\"p1\">**</ept> is a single visual type that can fill a 2D rectangle with a brush, in this case a solid color.","pos":[4176,4291],"source":" The **SpriteVisual** is a single visual type that can fill a 2D rectangle with a brush, in this case a solid color."},{"content":"Clipping a Visual","pos":[4296,4313]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Compositor<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706789)</ept> can also be used to create clips to a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Visual<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept>.","pos":[4315,4503],"source":"The [**Compositor**](https://msdn.microsoft.com/library/windows/apps/Dn706789) can also be used to create clips to a [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858)."},{"content":"Below is an example from the sample of using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>InsetClip<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706825)</ept> to trim each side of the visual:","pos":[4504,4659],"source":" Below is an example from the sample of using the [**InsetClip**](https://msdn.microsoft.com/library/windows/apps/Dn706825) to trim each side of the visual:"},{"pos":[4836,4992],"content":"Note: Like other objects in the API <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>InsetClip<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706825)</ept> can have animations applied to its properties.","source":"Note: Like other objects in the API [**InsetClip**](https://msdn.microsoft.com/library/windows/apps/Dn706825) can have animations applied to its properties."},{"pos":[5099,5114],"content":"Rotating a Clip"},{"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Visual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept> can be transformed with a rotation.","pos":[5116,5224],"source":"A [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) can be transformed with a rotation."},{"content":"Note that <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RotationAngle<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.composition.visual.rotationangle)</ept> supports both radians and degrees.","pos":[5225,5382],"source":" Note that [**RotationAngle**](https://msdn.microsoft.com/library/windows/apps/windows.ui.composition.visual.rotationangle) supports both radians and degrees."},{"content":"It defaults to radians, but it’s easy to specify degrees as shown in the following snippet:","pos":[5383,5474]},{"content":"Rotation is just one example of a set of transform components provided by the API to make these tasks easier.","pos":[5525,5634]},{"content":"Others include Offset, Scale, Orientation, RotationAxis and a 4x4 TransformMatrix.","pos":[5635,5717]},{"content":"Setting Opacity","pos":[5722,5737]},{"content":"Setting the opacity of a visual is a simple operation using a float value.","pos":[5739,5813]},{"content":"For example, in the sample all the squares start at .8 opacity:","pos":[5814,5877]},{"pos":[5913,6058],"content":"Like rotation, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Opacity<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.composition.visual.opacity)</ept> property can be animated.","source":"Like rotation, the [**Opacity**](https://msdn.microsoft.com/library/windows/apps/windows.ui.composition.visual.opacity) property can be animated."},{"content":"Changing the Visual's position in the collection","pos":[6063,6111]},{"pos":[6113,6796],"content":"The Composition API allows for a Visual's position in a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VisualCollection<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706858collection)</ept> to be changed in a number of ways, it can be placed above another Visual with <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>InsertAbove<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertabove)</ept>, placed below with <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>InsertBelow<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertbelow)</ept>, move to the top with <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>InsertAtTop<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertattop)</ept> or the bottom with <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>InsertAtBottom<ept id=\"p10\">**</ept><ept id=\"p9\">](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertatbottom)</ept>.","source":"The Composition API allows for a Visual's position in a [**VisualCollection**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection) to be changed in a number of ways, it can be placed above another Visual with [**InsertAbove**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertabove), placed below with [**InsertBelow**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertbelow), move to the top with [**InsertAtTop**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertattop) or the bottom with [**InsertAtBottom**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertatbottom)."},{"pos":[6798,6931],"content":"In the sample a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Visual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept> that has been clicked on is sorted to the top:","source":"In the sample a [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) that has been clicked on is sorted to the top:"},{"content":"Full Example","pos":[6992,7004]},{"content":"In the full sample, all of the concepts above are used together to construct and walk a simple tree of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Visual<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn706858)</ept> objects to change opacity without using XAML, WWA, or DirectX.","pos":[7006,7242],"source":"In the full sample, all of the concepts above are used together to construct and walk a simple tree of [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) objects to change opacity without using XAML, WWA, or DirectX."},{"content":"This sample shows how child <bpt id=\"p1\">**</bpt>Visual<ept id=\"p1\">**</ept> objects are created and added and how properties are changed.","pos":[7243,7343],"source":" This sample shows how child **Visual** objects are created and added and how properties are changed."}],"content":"---\nms.assetid: f1297b7d-1a10-52ae-dd84-6d1ad2ae2fe6\ntitle: Composition visual tree\ndescription: Composition Visuals make up the visual tree structure which all other features of the composition API use and build on. The API allows developers to define and create one or many visual objects each representing a single node in a visual tree.\n---\n# Composition visual tree\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nComposition Visuals make up the visual tree structure which all other features of the composition API use and build on. The API allows developers to define and create one or many visual objects each representing a single node in a visual tree.\n\n## Visuals\n\nThere are three visual types that make up the visual tree structure plus a base brush class with multiple subclasses that affect the content of a visual:\n\n-   [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) – base object, the majority of the properties are here, and inherited by the other Visual objects.\n-   [**ContainerVisual**](https://msdn.microsoft.com/library/windows/apps/Dn706810) – derives from [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858), and adds the ability to create children.\n-   [**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) – Derives from [**ContainerVisual**](https://msdn.microsoft.com/library/windows/apps/Dn706810) and adds the ability to associate a brush so that the Visual can render pixels including images, effects or a solid color.\n-   [**CompositionBrush**](https://msdn.microsoft.com/library/windows/apps/Mt589398) – Allows the application of an effect on the content of a Visual. There are a number of subclasses of CompositionBrush.\n\n## The CompositionVisual Sample\n\nIn the sample there are a number of solid color squares that can be clicked on and dragged about the screen. When a square is clicked on, it will come to the front, rotate 45 degrees, and become opaque when dragged about.\n\nThis shows a number of basic concepts for working with the API including:\n\n-   Creating a compositor\n-   Creating a SpriteVisual with a ColorBrush\n-   Clipping a Visual\n-   Rotating a Visual\n-   Setting Opacity\n-   Changing the Visual’s position in the collection.\n\nIn the sample there are also three different Visuals at work:\n\n-   [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) – base object, the majority of the properties are here, and inherited by the other Visual objects.\n-   [**ContainerVisual**](https://msdn.microsoft.com/library/windows/apps/Dn706810) – derives from Visual, and adds the ability to create children.\n-   [**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) – Derives from Visual and adds the ability to associate a brush so that the Visual can render pixels including images, effects or a solid color.\n\nWhile this sample doesn’t cover concepts like Animations or more complex effects, it contains the building blocks that all of those systems use.\n\n## Creating a Compositor\n\nCreating a [**Compositor**](https://msdn.microsoft.com/library/windows/apps/Dn706789) and storing it for use as a factory in a variable is a simple task. The following snippet shows creating a new **Compositor**:\n\n```cs\n_compositor = new Compositor();\n```\n\n## Creating a SpriteVisual and ColorBrush\n\nUsing the [**Compositor**](https://msdn.microsoft.com/library/windows/apps/Dn706789) it's easy to create objects whenever you need them, such as a [**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) and a [**CompositionColorBrush**](https://msdn.microsoft.com/library/windows/apps/Mt589399):\n\n```cs\nvar visual = _compositor.CreateSpriteVisual();\nvisual.Brush = _compositor.CreateColorBrush(Color.FromArgb(0xFF, 0xFF, 0xFF, 0xFF));\n```\n\nWhile this is only a few lines of code it demonstrates a powerful concept, [**SpriteVisual**](https://msdn.microsoft.com/library/windows/apps/Mt589433) objects are the heart of the effects system. The **SpriteVisual** allows for great flexibility and interplay in color, image and effect creation. The **SpriteVisual** is a single visual type that can fill a 2D rectangle with a brush, in this case a solid color.\n\n## Clipping a Visual\n\nThe [**Compositor**](https://msdn.microsoft.com/library/windows/apps/Dn706789) can also be used to create clips to a [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858). Below is an example from the sample of using the [**InsetClip**](https://msdn.microsoft.com/library/windows/apps/Dn706825) to trim each side of the visual:\n\n```cs\nvar clip = _compositor.CreateInsetClip();\nclip.LeftInset = 1.0f;\nclip.RightInset = 1.0f;\nclip.TopInset = 1.0f;\nclip.BottomInset = 1.0f;\n_currentVisual.Clip = clip;\n```\n\nNote: Like other objects in the API [**InsetClip**](https://msdn.microsoft.com/library/windows/apps/Dn706825) can have animations applied to its properties.\n\n## <span id=\"Rotating_a_Clip\"></span><span id=\"rotating_a_clip\"></span><span id=\"ROTATING_A_CLIP\"></span>Rotating a Clip\n\nA [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) can be transformed with a rotation. Note that [**RotationAngle**](https://msdn.microsoft.com/library/windows/apps/windows.ui.composition.visual.rotationangle) supports both radians and degrees. It defaults to radians, but it’s easy to specify degrees as shown in the following snippet:\n\n```cs\nchild.RotationAngleInDegrees = 45.0f;\n```\n\nRotation is just one example of a set of transform components provided by the API to make these tasks easier. Others include Offset, Scale, Orientation, RotationAxis and a 4x4 TransformMatrix.\n\n## Setting Opacity\n\nSetting the opacity of a visual is a simple operation using a float value. For example, in the sample all the squares start at .8 opacity:\n\n```cs\nvisual.Opacity = 0.8f;\n```\n\nLike rotation, the [**Opacity**](https://msdn.microsoft.com/library/windows/apps/windows.ui.composition.visual.opacity) property can be animated.\n\n## Changing the Visual's position in the collection\n\nThe Composition API allows for a Visual's position in a [**VisualCollection**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection) to be changed in a number of ways, it can be placed above another Visual with [**InsertAbove**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertabove), placed below with [**InsertBelow**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertbelow), move to the top with [**InsertAtTop**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertattop) or the bottom with [**InsertAtBottom**](https://msdn.microsoft.com/library/windows/apps/Dn706858collection_insertatbottom).\n\nIn the sample a [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) that has been clicked on is sorted to the top:\n\n```cs\nparent.Children.InsertAtTop(_currentVisual);\n```\n\n## Full Example\n\nIn the full sample, all of the concepts above are used together to construct and walk a simple tree of [**Visual**](https://msdn.microsoft.com/library/windows/apps/Dn706858) objects to change opacity without using XAML, WWA, or DirectX. This sample shows how child **Visual** objects are created and added and how properties are changed.\n\n```cs\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Numerics;\nusing System.Text;\nusing System.Threading.Tasks;\nusing Windows.ApplicationModel.Core;\nusing Windows.Foundation;\nusing Windows.UI;\nusing Windows.UI.Composition;\nusing Windows.UI.Core;\n\nnamespace compositionvisual\n{\n    class VisualProperties : IFrameworkView\n    {\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.Initialize\n        //\n        // This method is called during startup to associate the IFrameworkView with the\n        // CoreApplicationView.\n        //\n        //------------------------------------------------------------------------------\n\n        void IFrameworkView.Initialize(CoreApplicationView view)\n        {\n            _view = view;\n            _random = new Random();\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.SetWindow\n        //\n        // This method is called when the CoreApplication has created a new CoreWindow,\n        // allowing the application to configure the window and start producing content\n        // to display.\n        //\n        //------------------------------------------------------------------------------\n\n        void IFrameworkView.SetWindow(CoreWindow window)\n        {\n            _window = window;\n            InitNewComposition();\n            _window.PointerPressed += OnPointerPressed;\n            _window.PointerMoved += OnPointerMoved;\n            _window.PointerReleased += OnPointerReleased;\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.OnPointerPressed\n        //\n        // This method is called when the user touches the screen, taps it with a stylus\n        // or clicks the mouse.\n        //\n        //------------------------------------------------------------------------------\n\n        void OnPointerPressed(CoreWindow window, PointerEventArgs args)\n        {\n            Point position = args.CurrentPoint.Position;\n\n            //\n            // Walk our list of visuals to determine who, if anybody, was selected\n            //\n            foreach (var child in _root.Children)\n            {\n                //\n                // Did we hit this child?\n                //\n                Vector3 offset = child.Offset;\n                Vector2 size = child.Size;\n\n                if ((position.X >= offset.X) &&\n                    (position.X < offset.X + size.X) &&\n                    (position.Y >= offset.Y) &&\n                    (position.Y < offset.Y + size.Y))\n                {\n                    //\n                    // This child was hit. Since the children are stored back to front,\n                    // the last one hit is the front-most one so it wins\n                    //\n                    _currentVisual = child as ContainerVisual;\n                    _offsetBias = new Vector2((float)(offset.X - position.X),\n                                              (float)(offset.Y - position.Y));\n                }\n            }\n\n            //\n            // If a visual was hit, bring it to the front of the Z order\n            //\n            if (_currentVisual != null)\n            {\n                ContainerVisual parent = _currentVisual.Parent as ContainerVisual;\n                parent.Children.Remove(_currentVisual);\n                parent.Children.InsertAtTop(_currentVisual);\n            }\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.OnPointerMoved\n        //\n        // This method is called when the user moves their finger, stylus or mouse with\n        // a button pressed over the screen.\n        //\n        //------------------------------------------------------------------------------\n\n        void OnPointerMoved(CoreWindow window, PointerEventArgs args)\n        {\n            //\n            // If a visual is selected, drag it with the pointer position and\n            // make it opaque while we drag it\n            //\n            if (_currentVisual != null)\n            {\n                //\n                // Set up the properties of the visual the first time it is\n                // dragged. This will last for the duration of the drag\n                //\n                if (!_dragging)\n                {\n                    _currentVisual.Opacity = 1.0f;\n\n                    //\n                    // Transform the first child of the current visual so that\n                    // the image is rotated\n                    //\n                    foreach (var child in _currentVisual.Children)\n                    {\n                        child.RotationAngleInDegrees = 45.0f;\n                        child.CenterPoint = new Vector3(_currentVisual.Size.X / 2, _currentVisual.Size.Y / 2, 0);\n                        break;\n                    }\n\n                    //\n                    // Clip the visual to its original layout rect by using an inset\n                    // clip with a one-pixel margin all around\n                    //\n                    var clip = _compositor.CreateInsetClip();\n                    clip.LeftInset = 1.0f;\n                    clip.RightInset = 1.0f;\n                    clip.TopInset = 1.0f;\n                    clip.BottomInset = 1.0f;\n                    _currentVisual.Clip = clip;\n\n                    _dragging = true;\n                }\n\n                Point position = args.CurrentPoint.Position;\n                _currentVisual.Offset = new Vector3((float)(position.X + _offsetBias.X),\n                                                    (float)(position.Y + _offsetBias.Y),\n                                                    0.0f);\n            }\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.OnPointerReleased\n        //\n        // This method is called when the user lifts their finger or stylus from the\n        // screen, or lifts the mouse button.\n        //\n        //------------------------------------------------------------------------------\n\n        void OnPointerReleased(CoreWindow window, PointerEventArgs args)\n        {\n            //\n            // If a visual was selected, make it transparent again when it is\n            // released and restore the transform and clip\n            //\n            if (_currentVisual != null)\n            {\n                if (_dragging)\n                {\n                    //\n                    // Remove the transform from the first child\n                    //\n                    foreach (var child in _currentVisual.Children)\n                    {\n                        child.RotationAngle = 0.0f;\n                        child.CenterPoint = new Vector3(0.0f, 0.0f, 0.0f);\n                        break;\n                    }\n\n                    _currentVisual.Opacity = 0.8f;\n                    _currentVisual.Clip = null;\n                    _dragging = false;\n                }\n\n                _currentVisual = null;\n            }\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.Load\n        //\n        // This method is called when a specific page is being loaded in the\n        // application.  It is not used for this application.\n        //\n        //------------------------------------------------------------------------------\n\n        void IFrameworkView.Load(string unused)\n        {\n\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.Run\n        //\n        // This method is called by CoreApplication.Run() to actually run the\n        // dispatcher's message pump.\n        //\n        //------------------------------------------------------------------------------\n\n        void IFrameworkView.Run()\n        {\n            _window.Activate();\n            _window.Dispatcher.ProcessEvents(CoreProcessEventsOption.ProcessUntilQuit);\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.Uninitialize\n        //\n        // This method is called during shutdown to disconnect the CoreApplicationView,\n        // and CoreWindow from the IFrameworkView.\n        //\n        //------------------------------------------------------------------------------\n\n        void IFrameworkView.Uninitialize()\n        {\n            _window = null;\n            _view = null;\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.InitNewComposition\n        //\n        // This method is called by SetWindow(), where we initialize Composition after\n        // the CoreWindow has been created.\n        //\n        //------------------------------------------------------------------------------\n\n        void InitNewComposition()\n        {\n            //\n            // Set up Windows.UI.Composition Compositor, root ContainerVisual, and associate with\n            // the CoreWindow.\n            //\n\n            _compositor = new Compositor();\n\n            _root = _compositor.CreateContainerVisual();\n\n\n\n            _compositionTarget = _compositor.CreateTargetForCurrentView();\n            _compositionTarget.Root = _root;\n\n            //\n            // Create a few visuals for our window\n            //\n            for (int index = 0; index < 20; index++)\n            {\n                _root.Children.InsertAtTop(CreateChildElement());\n            }\n        }\n\n        //------------------------------------------------------------------------------\n        //\n        // VisualProperties.CreateChildElement\n        //\n        // Creates a small sub-tree to represent a visible element in our application.\n        //\n        //------------------------------------------------------------------------------\n\n        Visual CreateChildElement()\n        {\n            //\n            // Each element consists of three visuals, which produce the appearance\n            // of a framed rectangle\n            //\n            var element = _compositor.CreateContainerVisual();\n            element.Size = new Vector2(100.0f, 100.0f);\n\n            //\n            // Position this visual randomly within our window\n            //\n            element.Offset = new Vector3((float)(_random.NextDouble() * 400), (float)(_random.NextDouble() * 400), 0.0f);\n\n            //\n            // The outer rectangle is always white\n            //\n            //Note to preview API users - SpriteVisual and Color Brush replace SolidColorVisual\n            //for example instead of doing \n            //var visual = _compositor.CreateSolidColorVisual() and \n            //visual.Color = Color.FromArgb(0xFF, 0xFF, 0xFF, 0xFF);\n            //we now use the below\n\n            var visual = _compositor.CreateSpriteVisual();\n            element.Children.InsertAtTop(visual);\n            visual.Brush = _compositor.CreateColorBrush(Color.FromArgb(0xFF, 0xFF, 0xFF, 0xFF));\n            visual.Size = new Vector2(100.0f, 100.0f);\n\n            //\n            // The inner rectangle is inset from the outer by three pixels all around\n            //\n            var child = _compositor.CreateSpriteVisual();\n            visual.Children.InsertAtTop(child);\n            child.Offset = new Vector3(3.0f, 3.0f, 0.0f);\n            child.Size = new Vector2(94.0f, 94.0f);\n\n            //\n            // Pick a random color for every rectangle\n            //\n            byte red = (byte)(0xFF * (0.2f + (_random.NextDouble() / 0.8f)));\n            byte green = (byte)(0xFF * (0.2f + (_random.NextDouble() / 0.8f)));\n            byte blue = (byte)(0xFF * (0.2f + (_random.NextDouble() / 0.8f)));\n            child.Brush = _compositor.CreateColorBrush(Color.FromArgb(0xFF, red, green, blue));\n\n            //\n            // Make the subtree root visual partially transparent. This will cause each visual in the subtree\n            // to render partially transparent, since a visual's opacity is multiplied with its parent's\n            // opacity\n            //\n            element.Opacity = 0.8f;\n\n            return element;\n        }\n\n        // CoreWindow / CoreApplicationView\n        private CoreWindow _window;\n        private CoreApplicationView _view;\n\n        // Windows.UI.Composition\n        private Compositor _compositor;\n        private CompositionTarget _compositionTarget;\n        private ContainerVisual _root;\n        private ContainerVisual _currentVisual;\n        private Vector2 _offsetBias;\n        private bool _dragging;\n\n        // Helpers\n        private Random _random;\n    }\n\n\n    public sealed class VisualPropertiesFactory : IFrameworkViewSource\n    {\n        //------------------------------------------------------------------------------\n        //\n        // VisualPropertiesFactory.CreateView\n        //\n        // This method is called by CoreApplication to provide a new IFrameworkView for\n        // a CoreWindow that is being created.\n        //\n        //------------------------------------------------------------------------------\n\n        IFrameworkView IFrameworkViewSource.CreateView()\n        {\n            return new VisualProperties();\n        }\n\n\n        //------------------------------------------------------------------------------\n        //\n        // main\n        //\n        //------------------------------------------------------------------------------\n\n        static int Main(string[] args)\n        {\n            CoreApplication.Run(new VisualPropertiesFactory());\n\n            return 0;\n        }\n    }\n}\n```\n\n \n\n \n\n\n\n\n"}