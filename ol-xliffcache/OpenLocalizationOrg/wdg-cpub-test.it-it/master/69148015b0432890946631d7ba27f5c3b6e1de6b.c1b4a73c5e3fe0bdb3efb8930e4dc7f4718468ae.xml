{"nodes":[{"pos":[65,161],"content":"Learn about how to use a proxy auto-configuration (.pac) file to specify an automatic proxy URL.","needQuote":true,"needEscape":true,"nodes":[{"content":"Learn about how to use a proxy auto-configuration (.pac) file to specify an automatic proxy URL.","pos":[0,96]}]},{"pos":[251,359],"content":"Use proxy auto-configuration (.pac) files with IEAK 11 (Internet Explorer Administration Kit 11 for IT Pros)","needQuote":true,"needEscape":true,"nodes":[{"content":"Use proxy auto-configuration (.pac) files with IEAK 11 (Internet Explorer Administration Kit 11 for IT Pros)","pos":[0,108]}]},{"content":"Use proxy auto-configuration (.pac) files with IEAK 11","pos":[388,442]},{"content":"These are various ways you can use a proxy auto-configuration (.pac) file to specify an automatic proxy URL.","pos":[443,551]},{"content":"We've included some examples here to help guide you, but you'll need to change the proxy names, port numbers, and IP addresses to match your organization's info.","pos":[552,713]},{"content":"Included examples:","pos":[715,733]},{"content":"Example 1: Connect directly if the host is local","pos":[737,785]},{"content":"Example 2: Connect directly if the host is inside the firewall","pos":[841,903]},{"content":"Example 3: Connect directly if the host name is resolvable","pos":[972,1030]},{"content":"Example 4: Connect directly if the host is in specified subnet","pos":[1095,1157]},{"content":"Example 5: Determine the connection type based on the host domain","pos":[1226,1291]},{"content":"Example 6: Determine the connection type based on the protocol","pos":[1363,1425]},{"content":"Example 7: Determine the proxy server based on the host name matching the IP address","pos":[1494,1578]},{"content":"Example 8: Connect using a proxy server if the host IP address matches the specified IP address","pos":[1669,1764]},{"content":"Example 9: Connect using a proxy server if there are periods in the host name","pos":[1866,1943]},{"content":"Example 10: Connect using a proxy server based on specific days of the week","pos":[2027,2102]},{"content":"Example 1: Connect directly if the host is local","pos":[2186,2234]},{"content":"In this example, if the host is local, it can connect directly.","pos":[2235,2298]},{"content":"However, if the server isn't local, it must connect through a proxy server.","pos":[2299,2374]},{"content":"Specifically, the <ph id=\"ph1\">`isPlainHostName`</ph> function looks to see if there are any periods (.) in the host name.","pos":[2375,2479],"source":" Specifically, the `isPlainHostName` function looks to see if there are any periods (.) in the host name."},{"content":"If the function finds periods, it means the host isn’t local and it returns false.","pos":[2480,2562]},{"content":"Otherwise, the function returns true.","pos":[2563,2600]},{"content":"Example 2: Connect directly if the host is inside the firewall","pos":[2744,2806]},{"content":"In this example, if the host is inside the firewall, it can connect directly.","pos":[2807,2884]},{"content":"However, if the server is outside the firewall, it must connect through a proxy server.","pos":[2885,2972]},{"content":"Specifically, the <ph id=\"ph1\">`localHostOrDomainIs`</ph> function only runs for URLs in the local domain.","pos":[2973,3061],"source":" Specifically, the `localHostOrDomainIs` function only runs for URLs in the local domain."},{"content":"If the host domain name matches the provided domain information, the <ph id=\"ph1\">`dnsDomainIs`</ph> function returns true.","pos":[3062,3167],"source":" If the host domain name matches the provided domain information, the `dnsDomainIs` function returns true."},{"content":"Example 3: Connect directly if the host name is resolvable","pos":[3451,3509]},{"content":"In this example, if the host name can be resolved, it can connect directly.","pos":[3510,3585]},{"content":"However, if the name can’t be resolved, the server must connect through a proxy server.","pos":[3586,3673]},{"content":"Specifically, this function requests the DNS server to resolve the host name it's passed.","pos":[3674,3763]},{"content":"If the name can be resolved, a direct connection is made.","pos":[3764,3821]},{"content":"If it can't, the connection is made using a proxy.","pos":[3822,3872]},{"content":"This is particularly useful when an internal DNS server is used to resolve all internal host names.","pos":[3873,3972]},{"content":"Important","pos":[3976,3985]},{"content":"The <ph id=\"ph1\">`isResolvable`</ph> function queries a Domain Name System (DNS) server.","pos":[3991,4061],"source":"The `isResolvable` function queries a Domain Name System (DNS) server."},{"content":"References to Object Model objects, properties, or methods cause the proxy auto-configuration file to fail silently.","pos":[4062,4178]},{"content":"For example, the references <ph id=\"ph1\">`window.open(...)`</ph>, <ph id=\"ph2\">`alert(...)`</ph>, and <ph id=\"ph3\">`password(...)`</ph> all cause the proxy auto-configuration file to fail.","pos":[4179,4313],"source":" For example, the references `window.open(...)`, `alert(...)`, and `password(...)` all cause the proxy auto-configuration file to fail."},{"content":"Example 4: Connect directly if the host is in specified subnet","pos":[4455,4517]},{"content":"In this example, if the host is in a specified subnet, it can connect directly.","pos":[4518,4597]},{"content":"However, if the server is outside of the specified subnet, it must connect through a proxy server.","pos":[4598,4696]},{"content":"Specifically, the <ph id=\"ph1\">`isInNet`</ph> (host, pattern, mask) function returns true if the host IP address matches the specified pattern.","pos":[4697,4822],"source":" Specifically, the `isInNet` (host, pattern, mask) function returns true if the host IP address matches the specified pattern."},{"content":"The mask indicates which part of the IP address to match (255=match, 0=ignore).","pos":[4823,4902]},{"content":"Important","pos":[4906,4915]},{"content":"The <ph id=\"ph1\">`isInNet`</ph> function queries a DNS server.","pos":[4921,4965],"source":"The `isInNet` function queries a DNS server."},{"content":"References to Object Model objects, properties, or methods cause the proxy auto-configuration file to fail silently.","pos":[4966,5082]},{"content":"For example, the references <ph id=\"ph1\">`window.open(...)`</ph>, <ph id=\"ph2\">`alert(...)`</ph>, and <ph id=\"ph3\">`password(...)`</ph> all cause the proxy auto-configuration file to fail.","pos":[5083,5217],"source":" For example, the references `window.open(...)`, `alert(...)`, and `password(...)` all cause the proxy auto-configuration file to fail."},{"content":"Example 5: Determine the connection type based on the host domain","pos":[5382,5447]},{"content":"In this example, if the host is local, the server can connect directly.","pos":[5448,5519]},{"content":"However, if the host isn’t local, this function determines which proxy to use based on the host domain.","pos":[5520,5623]},{"content":"Specifically, the <ph id=\"ph1\">`shExpMatch(str, shexp)`</ph> function returns true if <ph id=\"ph2\">`str`</ph> matches the <ph id=\"ph3\">`shexp`</ph> using shell expression patterns.","pos":[5624,5750],"source":" Specifically, the `shExpMatch(str, shexp)` function returns true if `str` matches the `shexp` using shell expression patterns."},{"content":"This is particularly useful when the host domain name is one of the criteria for proxy selection.","pos":[5751,5848]},{"content":"Example 6: Determine the connection type based on the protocol","pos":[6121,6183]},{"content":"In this example, the in-use protocol is extracted from the server and used to make a proxy selection.","pos":[6184,6285]},{"content":"If no protocol match occurs, the server is directly connected.","pos":[6286,6348]},{"content":"Specifically the <ph id=\"ph1\">`substring`</ph> function extracts the specified number of characters from a string.","pos":[6349,6445],"source":" Specifically the `substring` function extracts the specified number of characters from a string."},{"content":"This is particularly useful when protocol is one of the criteria for proxy selection.","pos":[6446,6531]},{"content":"Example 7: Determine the proxy server based on the host name matching the IP address","pos":[6851,6935]},{"content":"In this example, the proxy server is selected by translating the host name into an IP address and then comparing the address to a specified string.","pos":[6936,7083]},{"content":"Important","pos":[7087,7096]},{"content":"The <ph id=\"ph1\">`dnsResolve`</ph> function queries a DNS server.","pos":[7103,7150],"source":"The `dnsResolve` function queries a DNS server."},{"content":"References to Object Model objects, properties, or methods cause the proxy auto-configuration file to fail silently.","pos":[7151,7267]},{"content":"For example, the references <ph id=\"ph1\">`window.open(...)`</ph>, <ph id=\"ph2\">`alert(...)`</ph>, and <ph id=\"ph3\">`password(...)`</ph> all cause the proxy auto-configuration file to fail.","pos":[7268,7402],"source":" For example, the references `window.open(...)`, `alert(...)`, and `password(...)` all cause the proxy auto-configuration file to fail."},{"content":"Example 8: Connect using a proxy server if the host IP address matches the specified IP address","pos":[7604,7699]},{"content":"In this example, the proxy server is selected by explicitly getting the IP address and then comparing it to a specified string.","pos":[7700,7827]},{"content":"If no protocol match occurs, the server makes a direct connection.","pos":[7828,7894]},{"content":"Specifically, the <ph id=\"ph1\">`myIpAddress`</ph> function returns the IP address (in integer-period format) for the host that the browser is running on.","pos":[7895,8030],"source":" Specifically, the `myIpAddress` function returns the IP address (in integer-period format) for the host that the browser is running on."},{"content":"Example 9: Connect using a proxy server if there are periods in the host name","pos":[8196,8273]},{"content":"In this example, the function looks to see if there are periods (.) in the host name.","pos":[8274,8359]},{"content":"If there are any periods, the connection occurs using a proxy server.","pos":[8360,8429]},{"content":"If there are no periods, a direct connection occurs.","pos":[8430,8482]},{"content":"Specifically, the <ph id=\"ph1\">`dnsDomainLevels`</ph> function returns an integer equal to the number of periods in the host name.","pos":[8483,8595],"source":" Specifically, the `dnsDomainLevels` function returns an integer equal to the number of periods in the host name."},{"content":"Note","pos":[8599,8603]},{"content":"This is another way to determine connection types based on host name characteristics.","pos":[8609,8694]},{"content":"Example 10: Connect using a proxy server based on specific days of the week","pos":[8881,8956]},{"content":"In this example, the function decides whether to connect to a proxy server, based on the days of the week.","pos":[8957,9063]},{"content":"Connecting on days that don’t fall between the specified date parameters let the server make a direct connection.","pos":[9064,9177]},{"content":"Specifically the <ph id=\"ph1\">`weekdayRange(day1 [,day2] [,GMT] )`</ph> function returns whether the current system time falls within the range specified by the parameters <ph id=\"ph2\">`day1`</ph>, <ph id=\"ph3\">`day2`</ph>, and <ph id=\"ph4\">`GMT`</ph>.","pos":[9178,9358],"source":" Specifically the `weekdayRange(day1 [,day2] [,GMT] )` function returns whether the current system time falls within the range specified by the parameters `day1`, `day2`, and `GMT`."},{"content":"Only the first parameter is required.","pos":[9359,9396]},{"content":"The GMT parameter presumes time values are in Greenwich Mean Time rather than the local time zone.","pos":[9397,9495]},{"content":"This function is particularly useful for situations where you want to use a proxy server for heavy traffic times, but allow a direct connection when traffic is light.","pos":[9496,9662]}],"content":"---\nlocalizationpriority: low\nms.mktglfcycl: deploy\ndescription: Learn about how to use a proxy auto-configuration (.pac) file to specify an automatic proxy URL.\nauthor: eross-msft\nms.prod: ie11\nms.assetid: 6c94708d-71bd-44bd-a445-7e6763b374ae\ntitle: Use proxy auto-configuration (.pac) files with IEAK 11 (Internet Explorer Administration Kit 11 for IT Pros)\nms.sitesec: library\n---\n\n\n# Use proxy auto-configuration (.pac) files with IEAK 11\nThese are various ways you can use a proxy auto-configuration (.pac) file to specify an automatic proxy URL. We've included some examples here to help guide you, but you'll need to change the proxy names, port numbers, and IP addresses to match your organization's info.\n\nIncluded examples:\n- [Example 1: Connect directly if the host is local](#example-1-connect-directly-if-the-host-is-local) \n- [Example 2: Connect directly if the host is inside the firewall](#example-2-connect-directly-if-the-host-is-inside-the-firewall)\n- [Example 3: Connect directly if the host name is resolvable](#example-3-connect-directly-if-the-host-name-is-resolvable)\n- [Example 4: Connect directly if the host is in specified subnet](#example-4-connect-directly-if-the-host-is-in-specified-subnet)\n- [Example 5: Determine the connection type based on the host domain](#example-5-determine-the-connection-type-based-on-the-host-domain)\n- [Example 6: Determine the connection type based on the protocol](#example-6-determine-the-connection-type-based-on-the-protocol)\n- [Example 7: Determine the proxy server based on the host name matching the IP address](#example-7-determine-the-proxy-server-based-on-the-host-name-matching-the-IP-address)\n- [Example 8: Connect using a proxy server if the host IP address matches the specified IP address](#example-8-connect-using-a-proxy-server-if-the-host-IP-address-matches-the-specified-IP-address)\n- [Example 9: Connect using a proxy server if there are periods in the host name](#example-9-connect-using-a-proxy-server-if-there-are-periods-in-the-host-name)\n- [Example 10: Connect using a proxy server based on specific days of the week](#example-10-connect-using-a-proxy-server-based-on-specific-days-of-the-week)\n\n\n## Example 1: Connect directly if the host is local\nIn this example, if the host is local, it can connect directly. However, if the server isn't local, it must connect through a proxy server. Specifically, the `isPlainHostName` function looks to see if there are any periods (.) in the host name. If the function finds periods, it means the host isn’t local and it returns false. Otherwise, the function returns true.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (isPlainHostName(host))\n return \"DIRECT\";\n else\n return \"PROXY proxy:80\";\n }\n```\n## Example 2: Connect directly if the host is inside the firewall\nIn this example, if the host is inside the firewall, it can connect directly. However, if the server is outside the firewall, it must connect through a proxy server. Specifically, the `localHostOrDomainIs` function only runs for URLs in the local domain. If the host domain name matches the provided domain information, the `dnsDomainIs` function returns true.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if ((isPlainHostName(host) ||\n dnsDomainIs(host, \".company.com\")) &&\n !localHostOrDomainIs(host, \"www.company.com\") &&\n !localHostOrDoaminIs(host, \"home.company.com\"))\n return \"DIRECT\";\n else\n return \"PROXY proxy:80\";\n}\n```\n## Example 3: Connect directly if the host name is resolvable\nIn this example, if the host name can be resolved, it can connect directly. However, if the name can’t be resolved, the server must connect through a proxy server. Specifically, this function requests the DNS server to resolve the host name it's passed. If the name can be resolved, a direct connection is made. If it can't, the connection is made using a proxy. This is particularly useful when an internal DNS server is used to resolve all internal host names.\n\n**Important**<br>The `isResolvable` function queries a Domain Name System (DNS) server. References to Object Model objects, properties, or methods cause the proxy auto-configuration file to fail silently. For example, the references `window.open(...)`, `alert(...)`, and `password(...)` all cause the proxy auto-configuration file to fail.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (isResolvable(host))\n return \"DIRECT\";\n else\n return \"PROXY proxy:80\";\n }\n```\n\n## Example 4: Connect directly if the host is in specified subnet\nIn this example, if the host is in a specified subnet, it can connect directly. However, if the server is outside of the specified subnet, it must connect through a proxy server. Specifically, the `isInNet` (host, pattern, mask) function returns true if the host IP address matches the specified pattern. The mask indicates which part of the IP address to match (255=match, 0=ignore).\n\n**Important**<br>The `isInNet` function queries a DNS server. References to Object Model objects, properties, or methods cause the proxy auto-configuration file to fail silently. For example, the references `window.open(...)`, `alert(...)`, and `password(...)` all cause the proxy auto-configuration file to fail.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (isInNet(host, \"999.99.9.9\", \"255.0.255.0\"))\n return \"DIRECT\";\n else\n return \"PROXY proxy:80\";\n }\n```\n## Example 5: Determine the connection type based on the host domain\nIn this example, if the host is local, the server can connect directly. However, if the host isn’t local, this function determines which proxy to use based on the host domain. Specifically, the `shExpMatch(str, shexp)` function returns true if `str` matches the `shexp` using shell expression patterns. This is particularly useful when the host domain name is one of the criteria for proxy selection.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (isPlainHostName(host))\n return \"DIRECT\";\n else if (shExpMatch(host, \"*.com\"))\n return \"PROXY comproxy:80\";\n else if (shExpMatch(host, \"*.edu\"))\n return \"PROXY eduproxy:80\";\n else\n return \"PROXY proxy\";\n }\n```\n## Example 6: Determine the connection type based on the protocol\nIn this example, the in-use protocol is extracted from the server and used to make a proxy selection. If no protocol match occurs, the server is directly connected. Specifically the `substring` function extracts the specified number of characters from a string. This is particularly useful when protocol is one of the criteria for proxy selection.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (url.substring(0, 5) == \"http:\") {\n return \"PROXY proxy:80\";\n }\n else if (url.substring(0, 4) == \"ftp:\") {\n return \"PROXY fproxy:80\";\n }\n else if (url.substring(0, 6) == \"https:\") {\n return \"PROXY secproxy:8080\";\n }\n else {\n return \"DIRECT\";\n      }\n }\n```\n## Example 7: Determine the proxy server based on the host name matching the IP address\nIn this example, the proxy server is selected by translating the host name into an IP address and then comparing the address to a specified string.\n\n**Important** <br>The `dnsResolve` function queries a DNS server. References to Object Model objects, properties, or methods cause the proxy auto-configuration file to fail silently. For example, the references `window.open(...)`, `alert(...)`, and `password(...)` all cause the proxy auto-configuration file to fail.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (dnsResolve(host) == \"999.99.99.999\") { // = http://secproxy\n return \"PROXY secproxy:8080\";\n }\n else {\n return \"PROXY proxy:80\";\n }\n }\n```\n## Example 8: Connect using a proxy server if the host IP address matches the specified IP address\nIn this example, the proxy server is selected by explicitly getting the IP address and then comparing it to a specified string. If no protocol match occurs, the server makes a direct connection. Specifically, the `myIpAddress` function returns the IP address (in integer-period format) for the host that the browser is running on.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (myIpAddress() == \"999.99.999.99\") { \n return \"PROXY proxy:80\";\n }\n else {\n return \"DIRECT\";\n }\n }\n```\n## Example 9: Connect using a proxy server if there are periods in the host name\nIn this example, the function looks to see if there are periods (.) in the host name. If there are any periods, the connection occurs using a proxy server. If there are no periods, a direct connection occurs. Specifically, the `dnsDomainLevels` function returns an integer equal to the number of periods in the host name.\n\n**Note**<br>This is another way to determine connection types based on host name characteristics.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if (dnsDomainLevels(host) > 0) { // if the number of periods in host > 0\n return \"PROXY proxy:80\";\n }\n return \"DIRECT\";\n }\n```\n## Example 10: Connect using a proxy server based on specific days of the week\nIn this example, the function decides whether to connect to a proxy server, based on the days of the week. Connecting on days that don’t fall between the specified date parameters let the server make a direct connection. Specifically the `weekdayRange(day1 [,day2] [,GMT] )` function returns whether the current system time falls within the range specified by the parameters `day1`, `day2`, and `GMT`. Only the first parameter is required. The GMT parameter presumes time values are in Greenwich Mean Time rather than the local time zone. This function is particularly useful for situations where you want to use a proxy server for heavy traffic times, but allow a direct connection when traffic is light.\n\n``` javascript\nfunction FindProxyForURL(url, host)\n {\n if(weekdayRange(\"WED\", \"SAT\", \"GMT\")) \n return \"PROXY proxy:80\";\n else \n return \"DIRECT\";\n }\n```\n\n"}