{"nodes":[{"pos":[11,32],"content":"Handle app activation","needQuote":true,"needEscape":true,"nodes":[{"content":"Handle app activation","pos":[0,21]}]},{"pos":[46,117],"content":"Learn how to handle app activation by overriding the OnLaunched method.","needQuote":true,"needEscape":true,"nodes":[{"content":"Learn how to handle app activation by overriding the OnLaunched method.","pos":[0,71]}]},{"content":"Handle app activation","pos":[174,195]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[198,236]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[237,332],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[337,351]},{"content":"OnLaunched","pos":[362,372]},{"pos":[435,571],"content":"Learn how to handle app activation by overriding the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnLaunched<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept> method..","source":"Learn how to handle app activation by overriding the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) method.."},{"content":"Override the launch handler","pos":[576,603]},{"content":"When an app is activated, for any reason, the system sends the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Activated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225018)</ept> event.","pos":[605,748],"source":"When an app is activated, for any reason, the system sends the [**Activated**](https://msdn.microsoft.com/library/windows/apps/br225018) event."},{"content":"For a list of activation types, see the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ActivationKind<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224693)</ept> enumeration.","pos":[749,880],"source":" For a list of activation types, see the [**ActivationKind**](https://msdn.microsoft.com/library/windows/apps/br224693) enumeration."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.UI.Xaml.Application<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242324)</ept> class defines methods you can override to handle the various activation types.","pos":[882,1056],"source":"The [**Windows.UI.Xaml.Application**](https://msdn.microsoft.com/library/windows/apps/br242324) class defines methods you can override to handle the various activation types."},{"content":"Several of the activation types have a specific method that you can override.","pos":[1057,1134]},{"content":"For the other activation types, override the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnActivated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242330)</ept> method.","pos":[1135,1263],"source":" For the other activation types, override the [**OnActivated**](https://msdn.microsoft.com/library/windows/apps/br242330) method."},{"content":"Define the class for your application.","pos":[1265,1303]},{"content":"Override the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnLaunched<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept> method.","pos":[1503,1598],"source":"Override the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) method."},{"content":"This method is called whenever the user launches the app.","pos":[1599,1656]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LaunchActivatedEventArgs<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224731)</ept> parameter contains the previous state of your app and the activation arguments.","pos":[1657,1829],"source":" The [**LaunchActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224731) parameter contains the previous state of your app and the activation arguments."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  For Windows Phone Store apps, this method is called each time the user launches the app from Start tile or app list, even when the app is currently suspended in memory.","pos":[1831,2009],"source":"**Note**  For Windows Phone Store apps, this method is called each time the user launches the app from Start tile or app list, even when the app is currently suspended in memory."},{"content":"On Windows, launching a suspended app from Start tile or app list doesn’t call this method.","pos":[2010,2101]},{"content":"Restore application data if app was suspended then terminated","pos":[3695,3756]},{"content":"When the user switches to your terminated app, the system sends the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Activated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225018)</ept> event, with <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Kind<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br224728)</ept> set to <bpt id=\"p5\">**</bpt>Launch<ept id=\"p5\">**</ept> and <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>PreviousExecutionState<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/br224729)</ept> set to <bpt id=\"p8\">**</bpt>Terminated<ept id=\"p8\">**</ept> or <bpt id=\"p9\">**</bpt>ClosedByUser<ept id=\"p9\">**</ept>.","pos":[3759,4133],"source":"When the user switches to your terminated app, the system sends the [**Activated**](https://msdn.microsoft.com/library/windows/apps/br225018) event, with [**Kind**](https://msdn.microsoft.com/library/windows/apps/br224728) set to **Launch** and [**PreviousExecutionState**](https://msdn.microsoft.com/library/windows/apps/br224729) set to **Terminated** or **ClosedByUser**."},{"content":"The app should load its saved application data and refresh its displayed content.","pos":[4134,4215]},{"pos":[5808,6056],"content":"If the value of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PreviousExecutionState<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224729)</ept> is <bpt id=\"p3\">**</bpt>NotRunning<ept id=\"p3\">**</ept>, the app failed to save its application data successfully and the app should start over as if it were being initially launched.","source":"If the value of [**PreviousExecutionState**](https://msdn.microsoft.com/library/windows/apps/br224729) is **NotRunning**, the app failed to save its application data successfully and the app should start over as if it were being initially launched."},{"content":"Remarks","pos":[6061,6068]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  For Windows Phone Store apps, the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Resuming<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br242339)</ept> event is always followed by <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>OnLaunched<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept>, even when your app is currently suspended and the user re-launches your app from a primary tile or app list.","pos":[6072,6401],"source":"**Note**  For Windows Phone Store apps, the [**Resuming**](https://msdn.microsoft.com/library/windows/apps/br242339) event is always followed by [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335), even when your app is currently suspended and the user re-launches your app from a primary tile or app list."},{"content":"Apps can skip initialization if there is already content set on the current window.","pos":[6402,6485]},{"content":"You can check the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LaunchActivatedEventArgs.TileId<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224736)</ept> property to determine if the app was launched from a primary or a secondary tile and, based on that information, decide whether you should present a fresh or resume app experience.","pos":[6486,6780],"source":" You can check the [**LaunchActivatedEventArgs.TileId**](https://msdn.microsoft.com/library/windows/apps/br224736) property to determine if the app was launched from a primary or a secondary tile and, based on that information, decide whether you should present a fresh or resume app experience."},{"content":"Related topics","pos":[6785,6799]},{"content":"Handle app suspend","pos":[6804,6822]},{"content":"Handle app resume","pos":[6846,6863]},{"content":"Guidelines for app suspend and resume","pos":[6886,6923]},{"content":"App lifecycle","pos":[6986,6999]},{"content":"Reference","pos":[7022,7031]},{"content":"Windows.ApplicationModel.Activation","pos":[7040,7075]},{"content":"Windows.UI.Xaml.Application","pos":[7142,7169]}],"content":"---\ntitle: Handle app activation\ndescription: Learn how to handle app activation by overriding the OnLaunched method.\nms.assetid: DA9A6A43-F09D-4512-A2AB-9B6132431007\n---\n\n# Handle app activation\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335)\n\nLearn how to handle app activation by overriding the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) method..\n\n## Override the launch handler\n\nWhen an app is activated, for any reason, the system sends the [**Activated**](https://msdn.microsoft.com/library/windows/apps/br225018) event. For a list of activation types, see the [**ActivationKind**](https://msdn.microsoft.com/library/windows/apps/br224693) enumeration.\n\nThe [**Windows.UI.Xaml.Application**](https://msdn.microsoft.com/library/windows/apps/br242324) class defines methods you can override to handle the various activation types. Several of the activation types have a specific method that you can override. For the other activation types, override the [**OnActivated**](https://msdn.microsoft.com/library/windows/apps/br242330) method.\n\nDefine the class for your application.\n\n```xaml\n<Application xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" \n             x:Class=\"AppName.App\" >\n```\n\nOverride the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) method. This method is called whenever the user launches the app. The [**LaunchActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224731) parameter contains the previous state of your app and the activation arguments.\n\n**Note**  For Windows Phone Store apps, this method is called each time the user launches the app from Start tile or app list, even when the app is currently suspended in memory. On Windows, launching a suspended app from Start tile or app list doesn’t call this method.\n\n> [!div class=\"tabbedCodeSnippets\"]\n```cs\nusing System;\nusing Windows.ApplicationModel.Activation;\nusing Windows.UI.Xaml;\n\nnamespace AppName\n{\n   public partial class App\n   {\n      async protected override void OnLaunched(LaunchActivatedEventArgs args)\n      {\n         EnsurePageCreatedAndActivate();\n      }\n      \n      // Creates the MainPage if it isn't already created.  Also activates\n      // the window so it takes foreground and input focus.\n      private MainPage EnsurePageCreatedAndActivate()\n      {\n         if (Window.Current.Content == null)\n         {\n             Window.Current.Content = new MainPage();\n         }\n         \n         Window.Current.Activate();\n         return Window.Current.Content as MainPage;\n      }\n   }\n}\n```\n```vb\nClass App\n   Protected Overrides Sub OnLaunched(args As LaunchActivatedEventArgs)\n      Window.Current.Content = New MainPage()\n      Window.Current.Activate()\n   End Sub\nEnd Class\n```\n```cpp\nusing namespace Windows::ApplicationModel::Activation;\nusing namespace Windows::Foundation;\nusing namespace Windows::UI::Xaml;\nusing namespace AppName;\nvoid App::OnLaunched(LaunchActivatedEventArgs^ args)\n{\n   EnsurePageCreatedAndActivate();\n}\n\n// Creates the MainPage if it isn't already created.  Also activates\n// the window so it takes foreground and input focus.\nvoid App::EnsurePageCreatedAndActivate()\n{\n    if (_mainPage == nullptr)\n    {\n        // Save the MainPage for use if we get activated later\n        _mainPage = ref new MainPage();\n    }\n    Window::Current->Content = _mainPage;\n    Window::Current->Activate();\n}\n```\n\n## Restore application data if app was suspended then terminated\n\n\nWhen the user switches to your terminated app, the system sends the [**Activated**](https://msdn.microsoft.com/library/windows/apps/br225018) event, with [**Kind**](https://msdn.microsoft.com/library/windows/apps/br224728) set to **Launch** and [**PreviousExecutionState**](https://msdn.microsoft.com/library/windows/apps/br224729) set to **Terminated** or **ClosedByUser**. The app should load its saved application data and refresh its displayed content.\n\n> [!div class=\"tabbedCodeSnippets\"]\n```cs\nasync protected override void OnLaunched(LaunchActivatedEventArgs args)\n{\n   if (args.PreviousExecutionState == ApplicationExecutionState.Terminated ||\n       args.PreviousExecutionState == ApplicationExecutionState.ClosedByUser)\n   {\n      // TODO: Populate the UI with the previously saved application data\n   }\n   else\n   {\n      // TODO: Populate the UI with defaults\n   }\n   \n   EnsurePageCreatedAndActivate();\n}\n```\n```vb\nProtected Overrides Sub OnLaunched(args As Windows.ApplicationModel.Activation.LaunchActivatedEventArgs)\n   Dim restoreState As Boolean = False\n\n   Select Case args.PreviousExecutionState\n      Case ApplicationExecutionState.Terminated\n         ' TODO: Populate the UI with the previously saved application data\n         restoreState = True\n      Case ApplicationExecutionState.ClosedByUser\n         ' TODO: Populate the UI with the previously saved application data\n         restoreState = True\n      Case Else\n         ' TODO: Populate the UI with defaults\n   End Select\n\n   Window.Current.Content = New MainPage(restoreState)\n   Window.Current.Activate()\nEnd Sub\n```\n```cpp\nvoid App::OnLaunched(Windows::ApplicationModel::Activation::LaunchActivatedEventArgs^ args)\n{\n   if (args->PreviousExecutionState == ApplicationExecutionState::Terminated ||\n       args->PreviousExecutionState == ApplicationExecutionState::ClosedByUser)\n   {\n      // TODO: Populate the UI with the previously saved application data\n   }\n   else\n   {\n      // TODO: Populate the UI with defaults\n   }\n\n   EnsurePageCreatedAndActivate();\n}\n```\n\nIf the value of [**PreviousExecutionState**](https://msdn.microsoft.com/library/windows/apps/br224729) is **NotRunning**, the app failed to save its application data successfully and the app should start over as if it were being initially launched.\n\n## Remarks\n\n> **Note**  For Windows Phone Store apps, the [**Resuming**](https://msdn.microsoft.com/library/windows/apps/br242339) event is always followed by [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335), even when your app is currently suspended and the user re-launches your app from a primary tile or app list. Apps can skip initialization if there is already content set on the current window. You can check the [**LaunchActivatedEventArgs.TileId**](https://msdn.microsoft.com/library/windows/apps/br224736) property to determine if the app was launched from a primary or a secondary tile and, based on that information, decide whether you should present a fresh or resume app experience.\n\n## Related topics\n\n* [Handle app suspend](suspend-an-app.md)\n* [Handle app resume](resume-an-app.md)\n* [Guidelines for app suspend and resume](https://msdn.microsoft.com/library/windows/apps/hh465088)\n* [App lifecycle](app-lifecycle.md)\n\n**Reference**\n\n* [**Windows.ApplicationModel.Activation**](https://msdn.microsoft.com/library/windows/apps/br224766)\n* [**Windows.UI.Xaml.Application**](https://msdn.microsoft.com/library/windows/apps/br242324)\n\n \n\n \n\n\n\n"}