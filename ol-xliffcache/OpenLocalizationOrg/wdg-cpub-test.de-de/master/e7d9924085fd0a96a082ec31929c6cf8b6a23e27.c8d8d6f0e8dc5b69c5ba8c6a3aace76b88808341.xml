{"nodes":[{"content":"Installing the WDK 8.1 Build Environment in a Lab","pos":[0,49]},{"content":"The Windows Driver Kit (WDK) 8.1 provides a feature that enables you to copy components of Visual Studio and the WDK to a new location and then launch the build environment from the command line.","pos":[170,365]},{"content":"From here you can build Windows drivers without having to run the Visual Studio or WDK installation programs.","pos":[366,475]},{"content":"You might find this feature useful if you need to integrate the WDK with your build process, or if you want to distribute the build process in a lab or test environment.","pos":[477,646]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  You can only use this feature for building drivers and applications that use C and C++.","pos":[648,745],"source":"**Note**  You can only use this feature for building drivers and applications that use C and C++."},{"content":"This feature cannot be used for managed code or Windows Store apps.","pos":[746,813]},{"content":"Download the Visual Studio and WDK and SDK setup files","pos":[819,873]},{"content":"To run the set up script that enables this feature, you need to provide the paths to the Visual Studio and WDK setup files.","pos":[1003,1126]},{"content":"Be sure to save these files (rather than install them).","pos":[1127,1182]},{"content":"Download <bpt id=\"p1\">[</bpt>Visual Studio Professional 2013<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=316548)</ept> or <bpt id=\"p2\">[</bpt>Visual Studio Ultimate 2013<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?linkid=316520)</ept>.","pos":[1188,1362],"source":"Download [Visual Studio Professional 2013](http://go.microsoft.com/fwlink/p/?linkid=316548) or [Visual Studio Ultimate 2013](http://go.microsoft.com/fwlink/p/?linkid=316520)."},{"content":"Download the Product Layout (for example, vs\\_ultimate\\_download.exe ).","pos":[1363,1434]},{"content":"When you are asked if you want to run or save vs\\_ultimate\\_download.exe, click <bpt id=\"p1\">**</bpt>Run<ept id=\"p1\">**</ept> and then select the download option and specify the download path as <bpt id=\"p2\">**</bpt>C:\\\\VSSetup<ept id=\"p2\">**</ept> (this makes the later steps easier).","pos":[1435,1644],"source":" When you are asked if you want to run or save vs\\_ultimate\\_download.exe, click **Run** and then select the download option and specify the download path as **C:\\\\VSSetup** (this makes the later steps easier)."},{"content":"Click <bpt id=\"p1\">**</bpt>Download<ept id=\"p1\">**</ept> to download and install a local copy of the DVD layout on the computer.","pos":[1645,1735],"source":" Click **Download** to download and install a local copy of the DVD layout on the computer."},{"content":"Download the standalone <bpt id=\"p1\">[</bpt>SDK<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=323507)</ept>.","pos":[1740,1819],"source":"Download the standalone [SDK](http://go.microsoft.com/fwlink/p/?linkid=323507)."},{"content":"When you are asked if you want to run or save sdksetup.exe, click <bpt id=\"p1\">**</bpt>Run<ept id=\"p1\">**</ept> and then specify the download location as <bpt id=\"p2\">**</bpt>C:\\\\Kits\\\\SDK<ept id=\"p2\">**</ept>.","pos":[1820,1954],"source":" When you are asked if you want to run or save sdksetup.exe, click **Run** and then specify the download location as **C:\\\\Kits\\\\SDK**."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> and follow the instructions to download the standalone SDK.","pos":[1955,2029],"source":" Click **Next** and follow the instructions to download the standalone SDK."},{"content":"Download the <bpt id=\"p1\">[</bpt>WDK 8.1<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=317353)</ept>.","pos":[2034,2106],"source":"Download the [WDK 8.1](http://go.microsoft.com/fwlink/p/?linkid=317353)."},{"content":"When you are asked if you want to run or save wdksetup.exe, click <bpt id=\"p1\">**</bpt>Run<ept id=\"p1\">**</ept> and then specify the download location as <bpt id=\"p2\">**</bpt>C:\\\\Kits\\\\WDK<ept id=\"p2\">**</ept>.","pos":[2107,2241],"source":" When you are asked if you want to run or save wdksetup.exe, click **Run** and then specify the download location as **C:\\\\Kits\\\\WDK**."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> and follow the instructions to download the WDK.","pos":[2242,2305],"source":" Click **Next** and follow the instructions to download the WDK."},{"content":"If you have already installed the WDK on the computer, the web installation program will tell you that the features installed on the computer are up-to-date.","pos":[2306,2463]},{"content":"To download the WDK setup files so that you can deploy the build environment, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> and specify the <bpt id=\"p2\">**</bpt>C:\\\\Kits\\\\WDK<ept id=\"p2\">**</ept> path.","pos":[2464,2596],"source":" To download the WDK setup files so that you can deploy the build environment, click **Next** and specify the **C:\\\\Kits\\\\WDK** path."},{"pos":[2666,2703],"content":"2. Download the BuildLabSupport files"},{"content":"To be able install the WDK build environment on computers in a lab, you need to first download the build lab support files on your computer.","pos":[2811,2951]},{"pos":[2957,3042],"content":"Download <bpt id=\"p1\">[</bpt>BuildLabSupportfiles.zip<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=321805)</ept>.","source":"Download [BuildLabSupportfiles.zip](http://go.microsoft.com/fwlink/p/?linkid=321805)."},{"content":"Extract the contents of the compressed file to your computer.","pos":[3047,3108]},{"content":"The extracted files include the BuildLabSupport directory and include the setup files and utilities you need.","pos":[3109,3218]},{"pos":[3286,3326],"content":"3. Install the WDK 8.1 build environment"},{"content":"The build lab support files include the <bpt id=\"p1\">**</bpt>setup.ps1<ept id=\"p1\">**</ept> PowerShell command file, which extracts the needed Visual Studio and WDK components and copies them to a target directory (folder).","pos":[3435,3620],"source":"The build lab support files include the **setup.ps1** PowerShell command file, which extracts the needed Visual Studio and WDK components and copies them to a target directory (folder)."},{"content":"You can then copy this directory to another location, from which you can build projects in a Visual Studio command-line interface (CLI) development environment.","pos":[3621,3781]},{"content":"Open a Command Prompt window with elevated privileges (<bpt id=\"p1\">**</bpt>Run as administrator<ept id=\"p1\">**</ept>) and go to the directory where you extracted build lab support files.","pos":[3787,3936],"source":"Open a Command Prompt window with elevated privileges (**Run as administrator**) and go to the directory where you extracted build lab support files."},{"content":"The PowerShell command script <bpt id=\"p1\">**</bpt>setup.ps1<ept id=\"p1\">**</ept> is in the <ph id=\"ph1\">&amp;lt;</ph><bpt id=\"p2\">*</bpt>root<ept id=\"p2\">*</ept><ph id=\"ph2\">&amp;gt;</ph>\\\\BuildLabSupport directory.","pos":[3937,4033],"source":" The PowerShell command script **setup.ps1** is in the &lt;*root*&gt;\\\\BuildLabSupport directory."},{"content":"The syntax for the PowerShell command is as follows:","pos":[4039,4091]},{"pos":[4097,4683],"content":"<span codelanguage=\"PowerShell\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">PowerShell</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>powershell –executionpolicy bypass –file Setup.ps1 –DeployBuildLab –VSInstallerPath &lt;VSInstallerFilePath&gt; -KitInstallersPath &lt;KitInstallersPath&gt; -ExpansionRoot &lt;Target Directory&gt; –LogFilePath &lt;LogFilePath&gt; -CatalogFile &lt;Filename.xml&gt;</code></pre></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"PowerShell","pos":[137,147]}]},{"pos":[4693,4860],"content":"The <bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>VSInstallerFilePath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the path to the Visual Studio installation program (for example, Vs\\_ultimate.exe) and directory that contains the product layout.","source":"The *&lt;VSInstallerFilePath&gt;* is the path to the Visual Studio installation program (for example, Vs\\_ultimate.exe) and directory that contains the product layout."},{"pos":[4869,4944],"content":"The <bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>KitInstallersPath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the path to the WDK and SDK setup files.","source":"The *&lt;KitInstallersPath&gt;* is the path to the WDK and SDK setup files."},{"pos":[4953,5034],"content":"The <bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>Target Directory<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the target directory for the extracted content.","source":"The *&lt;Target Directory&gt;* is the target directory for the extracted content."},{"pos":[5043,5112],"content":"The <bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>LogFilePath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the target destination for the log file.","source":"The *&lt;LogFilePath&gt;* is the target destination for the log file."},{"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>Filename.xml<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the name of the CatalogFile, which contains a list of Microsoft Windows installation files (MSI) to expand as part of the installation.","pos":[5121,5282],"source":"*&lt;Filename.xml&gt;* is the name of the CatalogFile, which contains a list of Microsoft Windows installation files (MSI) to expand as part of the installation."},{"content":"The name of the file is files.xml.","pos":[5283,5317]},{"content":"For example, the following command runs the script from BuildLabSupport directory and installs the build environment in C:\\\\BuildLabInstall directory.","pos":[5323,5473]},{"pos":[5765,5811],"content":"4. Build Windows driver projects and solutions"},{"content":"Using the build environment command script","pos":[5920,5962]},{"content":"Open a Command Prompt window.","pos":[5970,5999]},{"content":"Locate the LaunchBuildEnv.cmd file located in the target directory (for example, C:\\\\BuildLabInstall).","pos":[6000,6102]},{"pos":[6107,6170],"content":"Launch the build environment by running <bpt id=\"p1\">**</bpt>LaunchBuildEnv.cmd<ept id=\"p1\">**</ept>.","source":"Launch the build environment by running **LaunchBuildEnv.cmd**."},{"content":"Use MSBuild commands to build your driver projects and solutions.","pos":[6175,6240]},{"content":"For example:","pos":[6241,6253]},{"pos":[6411,6425],"content":"Related topics"},{"content":"Building a Driver","pos":[6478,6495]},{"content":"MSBuild","pos":[6522,6529]},{"pos":[6586,7554],"content":"<bpt id=\"p1\">[</bpt>Send comments about this topic to Microsoft<ept id=\"p1\">]</ept><bpt id=\"p2\">(mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[VsDriver\\vsdriver]:%20Installing%20the%20WDK%20Build%20Environment%20in%20a%20Lab%20%20RELEASE:%20%289/30/2015%29&amp;body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default. \"</bpt>Send comments about this topic to Microsoft<ept id=\"p2\">\")</ept>","source":"[Send comments about this topic to Microsoft](mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[VsDriver\\vsdriver]:%20Installing%20the%20WDK%20Build%20Environment%20in%20a%20Lab%20%20RELEASE:%20%289/30/2015%29&body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default. \"Send comments about this topic to Microsoft\")"}],"content":"Installing the WDK 8.1 Build Environment in a Lab\n======================================================================================================================\n\nThe Windows Driver Kit (WDK) 8.1 provides a feature that enables you to copy components of Visual Studio and the WDK to a new location and then launch the build environment from the command line. From here you can build Windows drivers without having to run the Visual Studio or WDK installation programs.\n\nYou might find this feature useful if you need to integrate the WDK with your build process, or if you want to distribute the build process in a lab or test environment.\n\n**Note**  You can only use this feature for building drivers and applications that use C and C++. This feature cannot be used for managed code or Windows Store apps.\n\n\n1. Download the Visual Studio and WDK and SDK setup files\n-------------------------------------------------------------------------------------------------------------------------------\n\nTo run the set up script that enables this feature, you need to provide the paths to the Visual Studio and WDK setup files. Be sure to save these files (rather than install them).\n\n1.  Download [Visual Studio Professional 2013](http://go.microsoft.com/fwlink/p/?linkid=316548) or [Visual Studio Ultimate 2013](http://go.microsoft.com/fwlink/p/?linkid=316520). Download the Product Layout (for example, vs\\_ultimate\\_download.exe ). When you are asked if you want to run or save vs\\_ultimate\\_download.exe, click **Run** and then select the download option and specify the download path as **C:\\\\VSSetup** (this makes the later steps easier). Click **Download** to download and install a local copy of the DVD layout on the computer.\n2.  Download the standalone [SDK](http://go.microsoft.com/fwlink/p/?linkid=323507). When you are asked if you want to run or save sdksetup.exe, click **Run** and then specify the download location as **C:\\\\Kits\\\\SDK**. Click **Next** and follow the instructions to download the standalone SDK.\n3.  Download the [WDK 8.1](http://go.microsoft.com/fwlink/p/?linkid=317353). When you are asked if you want to run or save wdksetup.exe, click **Run** and then specify the download location as **C:\\\\Kits\\\\WDK**. Click **Next** and follow the instructions to download the WDK. If you have already installed the WDK on the computer, the web installation program will tell you that the features installed on the computer are up-to-date. To download the WDK setup files so that you can deploy the build environment, click **Next** and specify the **C:\\\\Kits\\\\WDK** path.\n\n<span id=\"download_script\"></span><span id=\"DOWNLOAD_SCRIPT\"></span>2. Download the BuildLabSupport files\n---------------------------------------------------------------------------------------------------------\n\nTo be able install the WDK build environment on computers in a lab, you need to first download the build lab support files on your computer.\n\n1.  Download [BuildLabSupportfiles.zip](http://go.microsoft.com/fwlink/p/?linkid=321805).\n2.  Extract the contents of the compressed file to your computer. The extracted files include the BuildLabSupport directory and include the setup files and utilities you need.\n\n<span id=\"install_script\"></span><span id=\"INSTALL_SCRIPT\"></span>3. Install the WDK 8.1 build environment\n----------------------------------------------------------------------------------------------------------\n\nThe build lab support files include the **setup.ps1** PowerShell command file, which extracts the needed Visual Studio and WDK components and copies them to a target directory (folder). You can then copy this directory to another location, from which you can build projects in a Visual Studio command-line interface (CLI) development environment.\n\n-   Open a Command Prompt window with elevated privileges (**Run as administrator**) and go to the directory where you extracted build lab support files. The PowerShell command script **setup.ps1** is in the &lt;*root*&gt;\\\\BuildLabSupport directory.\n\n    The syntax for the PowerShell command is as follows:\n\n    <span codelanguage=\"PowerShell\"></span>\n    <table>\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">PowerShell</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><pre><code>powershell –executionpolicy bypass –file Setup.ps1 –DeployBuildLab –VSInstallerPath &lt;VSInstallerFilePath&gt; -KitInstallersPath &lt;KitInstallersPath&gt; -ExpansionRoot &lt;Target Directory&gt; –LogFilePath &lt;LogFilePath&gt; -CatalogFile &lt;Filename.xml&gt;</code></pre></td>\n    </tr>\n    </tbody>\n    </table>\n\n    -   The *&lt;VSInstallerFilePath&gt;* is the path to the Visual Studio installation program (for example, Vs\\_ultimate.exe) and directory that contains the product layout.\n    -   The *&lt;KitInstallersPath&gt;* is the path to the WDK and SDK setup files.\n    -   The *&lt;Target Directory&gt;* is the target directory for the extracted content.\n    -   The *&lt;LogFilePath&gt;* is the target destination for the log file.\n    -   *&lt;Filename.xml&gt;* is the name of the CatalogFile, which contains a list of Microsoft Windows installation files (MSI) to expand as part of the installation. The name of the file is files.xml.\n\n    For example, the following command runs the script from BuildLabSupport directory and installs the build environment in C:\\\\BuildLabInstall directory.\n\n    ``` syntax\n    c:\\BuildLabSupport>powershell -executionpolicy bypass -file Setup.ps1 -DeployBuildLab -VSInstallerPath c:\\VSSetup -KitInstallersPath c:\\Kits -E\n    xpansionRoot C:\\BuildLabInstall -CatalogFile  files.xml\n    ```\n\n<span id=\"build_step\"></span><span id=\"BUILD_STEP\"></span>4. Build Windows driver projects and solutions\n--------------------------------------------------------------------------------------------------------\n\n**Using the build environment command script**\n\n1.  Open a Command Prompt window. Locate the LaunchBuildEnv.cmd file located in the target directory (for example, C:\\\\BuildLabInstall).\n2.  Launch the build environment by running **LaunchBuildEnv.cmd**.\n3.  Use MSBuild commands to build your driver projects and solutions. For example:\n\n    ``` syntax\n    msbuild /t:clean /t:build .\\MyDriver.vcxproj /p:Configuration=\"Win8.1 Debug\" /p:Platform=Win32\n    ```\n\n<span id=\"related_topics\"></span>Related topics\n-----------------------------------------------\n\n* [Building a Driver](building_a_driver.md)\n* [MSBuild](http://go.microsoft.com/fwlink/p/?linkid=262804)\n \n\n \n\n[Send comments about this topic to Microsoft](mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[VsDriver\\vsdriver]:%20Installing%20the%20WDK%20Build%20Environment%20in%20a%20Lab%20%20RELEASE:%20%289/30/2015%29&body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default. \"Send comments about this topic to Microsoft\")\n\n\n"}