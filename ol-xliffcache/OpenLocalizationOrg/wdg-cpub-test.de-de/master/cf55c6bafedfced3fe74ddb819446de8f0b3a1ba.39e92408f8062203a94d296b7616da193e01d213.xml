{"nodes":[{"content":"Track recently used files and folders","pos":[2,39]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[41,79]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[80,175],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[181,195]},{"content":"MostRecentlyUsedList","pos":[205,225]},{"content":"FileOpenPicker","pos":[292,306]},{"content":"Track files that your user accesses frequently by adding them to your app's most recently used list (MRU).","pos":[369,475]},{"content":"The platform manages the MRU for you by sorting items based on when they were last accessed, and by removing the oldest item when the list's 25-item limit is reached.","pos":[476,642]},{"content":"All apps have their own MRU.","pos":[643,671]},{"content":"Your app's MRU is represented by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageItemMostRecentlyUsedList<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207475)</ept> class, which you obtain from the static <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageApplicationPermissions.MostRecentlyUsedList<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br207458)</ept> property.","pos":[673,970],"source":"Your app's MRU is represented by the [**StorageItemMostRecentlyUsedList**](https://msdn.microsoft.com/library/windows/apps/br207475) class, which you obtain from the static [**StorageApplicationPermissions.MostRecentlyUsedList**](https://msdn.microsoft.com/library/windows/apps/br207458) property."},{"content":"MRU items are stored as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IStorageItem<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227129)</ept> objects, so both <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageFile<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> objects (which represent files) and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>StorageFolder<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br227230)</ept> objects (which represent folders) can be added to the MRU.","pos":[971,1337],"source":" MRU items are stored as [**IStorageItem**](https://msdn.microsoft.com/library/windows/apps/br227129) objects, so both [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) objects (which represent files) and [**StorageFolder**](https://msdn.microsoft.com/library/windows/apps/br227230) objects (which represent folders) can be added to the MRU."},{"pos":[1339,1510],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Also see the <bpt id=\"p2\">[</bpt>File picker sample<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?linkid=619994)</ept> and the <bpt id=\"p3\">[</bpt>File access sample<ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?linkid=619995)</ept>.","source":"**Note**  Also see the [File picker sample](http://go.microsoft.com/fwlink/p/?linkid=619994) and the [File access sample](http://go.microsoft.com/fwlink/p/?linkid=619995)."},{"content":"Prerequisites","pos":[1518,1531]},{"content":"Understand async programming for Universal Windows Platform (UWP) apps","pos":[1539,1609]},{"content":"You can learn how to write asynchronous apps in C\\# or Visual Basic, see <bpt id=\"p1\">[</bpt>Call asynchronous APIs in C\\# or Visual Basic<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt187337)</ept>.","pos":[1617,1796],"source":"You can learn how to write asynchronous apps in C\\# or Visual Basic, see [Call asynchronous APIs in C\\# or Visual Basic](https://msdn.microsoft.com/library/windows/apps/mt187337)."},{"content":"To learn how to write asynchronous apps in C++, see <bpt id=\"p1\">[</bpt>Asynchronous programming in C++<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt187334)</ept>.","pos":[1797,1941],"source":" To learn how to write asynchronous apps in C++, see [Asynchronous programming in C++](https://msdn.microsoft.com/library/windows/apps/mt187334)."},{"content":"Access permissions to the location","pos":[1949,1983]},{"pos":[1991,2049],"content":"See <bpt id=\"p1\">[</bpt>File access permissions<ept id=\"p1\">](file-access-permissions.md)</ept>.","source":"See [File access permissions](file-access-permissions.md)."},{"content":"Open files and folders with a picker","pos":[2056,2092]},{"content":"Picked files are often the same files that users return to again and again.","pos":[2144,2219]},{"content":"Add a picked file to the MRU","pos":[2225,2253]},{"content":"The files that your user picks are often files that they return to repeatedly.","pos":[2259,2337]},{"content":"So consider adding picked files to your app's MRU as soon as they are picked.","pos":[2338,2415]},{"content":"Here's how.","pos":[2416,2427]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageItemMostRecentlyUsedList.Add<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207476)</ept> is overloaded.","pos":[2695,2809],"source":"[**StorageItemMostRecentlyUsedList.Add**](https://msdn.microsoft.com/library/windows/apps/br207476) is overloaded."},{"content":"In the example, we use <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Add(IStorageItem, String)<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207481)</ept> so that we can associate metadata with the file.","pos":[2810,2971],"source":" In the example, we use [**Add(IStorageItem, String)**](https://msdn.microsoft.com/library/windows/apps/br207481) so that we can associate metadata with the file."},{"content":"Setting metadata lets you record the item's purpose, for example \"profile pic\".","pos":[2972,3051]},{"content":"You can also add the file to the MRU without metadata by calling <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Add(IStorageItem)<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207480)</ept>.","pos":[3052,3199],"source":" You can also add the file to the MRU without metadata by calling [**Add(IStorageItem)**](https://msdn.microsoft.com/library/windows/apps/br207480)."},{"content":"When you add an item to the MRU, the method returns a uniquely identifying string, called a token, which is used to retrieve the item.","pos":[3200,3334]},{"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>   You'll need the token to retrieve an item from the MRU, so persist it somewhere.","pos":[3340,3430],"source":"**Tip**   You'll need the token to retrieve an item from the MRU, so persist it somewhere."},{"content":"For more info about app data, see <bpt id=\"p1\">[</bpt>Managing application data<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465109)</ept>.","pos":[3431,3551],"source":" For more info about app data, see [Managing application data](https://msdn.microsoft.com/library/windows/apps/hh465109)."},{"content":"Use a token to retrieve an item from the MRU","pos":[3563,3607]},{"content":"Use the retrieval method most appropriate for the item you want to retrieve.","pos":[3609,3685]},{"pos":[3691,3874],"content":"Retrieve a file as a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> by using <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetFileAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br207486)</ept>.","source":"Retrieve a file as a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) by using [**GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br207486)."},{"pos":[3879,4068],"content":"Retrieve a folder as a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFolder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227230)</ept> by using <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetFolderAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br207489)</ept>.","source":"Retrieve a folder as a [**StorageFolder**](https://msdn.microsoft.com/library/windows/apps/br227230) by using [**GetFolderAsync**](https://msdn.microsoft.com/library/windows/apps/br207489)."},{"pos":[4073,4301],"content":"Retrieve a generic <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IStorageItem<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227129)</ept>, which can represent either a file or folder, by using <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetItemAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br207492)</ept>.","source":"Retrieve a generic [**IStorageItem**](https://msdn.microsoft.com/library/windows/apps/br227129), which can represent either a file or folder, by using [**GetItemAsync**](https://msdn.microsoft.com/library/windows/apps/br207492)."},{"content":"Here's how to get back the file we just added.","pos":[4303,4349]},{"content":"Here's how to iterate all the entries to get tokens and then items.","pos":[4428,4495]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AccessListEntryView<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227349)</ept> lets you iterate entries in the MRU.","pos":[4812,4936],"source":"The [**AccessListEntryView**](https://msdn.microsoft.com/library/windows/apps/br227349) lets you iterate entries in the MRU."},{"content":"These entries are <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AccessListEntry<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227348)</ept> structures that contain the token and metadata for an item.","pos":[4937,5094],"source":" These entries are [**AccessListEntry**](https://msdn.microsoft.com/library/windows/apps/br227348) structures that contain the token and metadata for an item."},{"content":"Removing items from the MRU when it's full","pos":[5099,5141]},{"content":"When the MRU's 25-item limit is reached and you try to add a new item, the item that was accessed the longest time ago is automatically removed.","pos":[5143,5287]},{"content":"So, you never need to remove an item before you add a new one.","pos":[5288,5350]},{"content":"Future-access list","pos":[5355,5373]},{"content":"As well as an MRU, your app also has a future-access list.","pos":[5375,5433]},{"content":"By picking files and folders, your user grants your app permission to access items that might not be accessible otherwise.","pos":[5434,5556]},{"content":"If you add these items to your future-access list then you'll retain that permission when your app wants to access those items again later.","pos":[5557,5696]},{"content":"Your app's future-access list is represented by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageItemAccessList<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207459)</ept> class, which you obtain from the static <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageApplicationPermissions.FutureAccessList<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br207457)</ept> property.","pos":[5697,5995],"source":" Your app's future-access list is represented by the [**StorageItemAccessList**](https://msdn.microsoft.com/library/windows/apps/br207459) class, which you obtain from the static [**StorageApplicationPermissions.FutureAccessList**](https://msdn.microsoft.com/library/windows/apps/br207457) property."},{"content":"When a user picks an item, consider adding it to your future-access list as well as your MRU.","pos":[5997,6090]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FutureAccessList<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207457)</ept> can hold up to 1000 items.","pos":[6096,6207],"source":"The [**FutureAccessList**](https://msdn.microsoft.com/library/windows/apps/br207457) can hold up to 1000 items."},{"content":"Remember: it can hold folders as well as files, so that's a lot of folders.","pos":[6208,6283]},{"content":"The platform never removes items from the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FutureAccessList<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207457)</ept> for you.","pos":[6288,6419],"source":"The platform never removes items from the [**FutureAccessList**](https://msdn.microsoft.com/library/windows/apps/br207457) for you."},{"content":"When you reach the 1000-item limit, you can't add another until you make room with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Remove<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207497)</ept> method.","pos":[6420,6585],"source":" When you reach the 1000-item limit, you can't add another until you make room with the [**Remove**](https://msdn.microsoft.com/library/windows/apps/br207497) method."}],"content":"# Track recently used files and folders\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n** Important APIs **\n\n- [**MostRecentlyUsedList**](https://msdn.microsoft.com/library/windows/apps/br207458)\n- [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/hh738369)\n\nTrack files that your user accesses frequently by adding them to your app's most recently used list (MRU). The platform manages the MRU for you by sorting items based on when they were last accessed, and by removing the oldest item when the list's 25-item limit is reached. All apps have their own MRU.\n\nYour app's MRU is represented by the [**StorageItemMostRecentlyUsedList**](https://msdn.microsoft.com/library/windows/apps/br207475) class, which you obtain from the static [**StorageApplicationPermissions.MostRecentlyUsedList**](https://msdn.microsoft.com/library/windows/apps/br207458) property. MRU items are stored as [**IStorageItem**](https://msdn.microsoft.com/library/windows/apps/br227129) objects, so both [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) objects (which represent files) and [**StorageFolder**](https://msdn.microsoft.com/library/windows/apps/br227230) objects (which represent folders) can be added to the MRU.\n\n**Note**  Also see the [File picker sample](http://go.microsoft.com/fwlink/p/?linkid=619994) and the [File access sample](http://go.microsoft.com/fwlink/p/?linkid=619995).\n\n \n\n## Prerequisites\n\n-   **Understand async programming for Universal Windows Platform (UWP) apps**\n\n    You can learn how to write asynchronous apps in C\\# or Visual Basic, see [Call asynchronous APIs in C\\# or Visual Basic](https://msdn.microsoft.com/library/windows/apps/mt187337). To learn how to write asynchronous apps in C++, see [Asynchronous programming in C++](https://msdn.microsoft.com/library/windows/apps/mt187334).\n\n-   **Access permissions to the location**\n\n    See [File access permissions](file-access-permissions.md).\n\n-   [Open files and folders with a picker](quickstart-using-file-and-folder-pickers.md)\n\n    Picked files are often the same files that users return to again and again.\n\n ## Add a picked file to the MRU\n\n-   The files that your user picks are often files that they return to repeatedly. So consider adding picked files to your app's MRU as soon as they are picked. Here's how.\n\n    ```CSharp\n    ...\n    \n    Windows.Storage.StorageFile file = await picker.PickSingleFileAsync();\n\n    var mru = Windows.Storage.AccessCache.StorageApplicationPermissions.MostRecentlyUsedList;\n    string mruToken = mru.Add(file, \"profile pic\");\n    ```\n    \n    [**StorageItemMostRecentlyUsedList.Add**](https://msdn.microsoft.com/library/windows/apps/br207476) is overloaded. In the example, we use [**Add(IStorageItem, String)**](https://msdn.microsoft.com/library/windows/apps/br207481) so that we can associate metadata with the file. Setting metadata lets you record the item's purpose, for example \"profile pic\". You can also add the file to the MRU without metadata by calling [**Add(IStorageItem)**](https://msdn.microsoft.com/library/windows/apps/br207480). When you add an item to the MRU, the method returns a uniquely identifying string, called a token, which is used to retrieve the item.\n\n    **Tip**   You'll need the token to retrieve an item from the MRU, so persist it somewhere. For more info about app data, see [Managing application data](https://msdn.microsoft.com/library/windows/apps/hh465109).\n\n     \n\n## Use a token to retrieve an item from the MRU\n\nUse the retrieval method most appropriate for the item you want to retrieve.\n\n-   Retrieve a file as a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) by using [**GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br207486).\n-   Retrieve a folder as a [**StorageFolder**](https://msdn.microsoft.com/library/windows/apps/br227230) by using [**GetFolderAsync**](https://msdn.microsoft.com/library/windows/apps/br207489).\n-   Retrieve a generic [**IStorageItem**](https://msdn.microsoft.com/library/windows/apps/br227129), which can represent either a file or folder, by using [**GetItemAsync**](https://msdn.microsoft.com/library/windows/apps/br207492).\n\nHere's how to get back the file we just added.\n\n```csharp\nStorageFile retrievedFile = await mru.GetFileAsync(mruToken);\n```\n\nHere's how to iterate all the entries to get tokens and then items.\n\n```csharp\nforeach (Windows.Storage.AccessCache.AccessListEntry entry in mru.Entries)\n{\n    string mruToken = entry.Token;\n    string mruMetadata = entry.Metadata;\n    Windows.Storage.IStorageItem item = await mru.GetItemAsync(mruToken);\n    // The type of item will tell you whether it's a file or a folder.\n}\n```\n\nThe [**AccessListEntryView**](https://msdn.microsoft.com/library/windows/apps/br227349) lets you iterate entries in the MRU. These entries are [**AccessListEntry**](https://msdn.microsoft.com/library/windows/apps/br227348) structures that contain the token and metadata for an item.\n\n## Removing items from the MRU when it's full\n\nWhen the MRU's 25-item limit is reached and you try to add a new item, the item that was accessed the longest time ago is automatically removed. So, you never need to remove an item before you add a new one.\n\n## Future-access list\n\nAs well as an MRU, your app also has a future-access list. By picking files and folders, your user grants your app permission to access items that might not be accessible otherwise. If you add these items to your future-access list then you'll retain that permission when your app wants to access those items again later. Your app's future-access list is represented by the [**StorageItemAccessList**](https://msdn.microsoft.com/library/windows/apps/br207459) class, which you obtain from the static [**StorageApplicationPermissions.FutureAccessList**](https://msdn.microsoft.com/library/windows/apps/br207457) property.\n\nWhen a user picks an item, consider adding it to your future-access list as well as your MRU.\n\n-   The [**FutureAccessList**](https://msdn.microsoft.com/library/windows/apps/br207457) can hold up to 1000 items. Remember: it can hold folders as well as files, so that's a lot of folders.\n-   The platform never removes items from the [**FutureAccessList**](https://msdn.microsoft.com/library/windows/apps/br207457) for you. When you reach the 1000-item limit, you can't add another until you make room with the [**Remove**](https://msdn.microsoft.com/library/windows/apps/br207497) method.\n\n \n\n \n\n\n\n"}