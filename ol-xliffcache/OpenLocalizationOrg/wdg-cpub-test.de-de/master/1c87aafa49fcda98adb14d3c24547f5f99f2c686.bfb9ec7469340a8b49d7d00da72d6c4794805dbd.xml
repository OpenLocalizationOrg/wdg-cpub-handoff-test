{"nodes":[{"content":"Print from your app","pos":[2,21]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[23,61]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[62,157],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[163,177]},{"content":"Windows.Graphics.Printing","pos":[189,214]},{"content":"Windows.UI.Xaml.Printing","pos":[283,307]},{"content":"PrintDocument","pos":[376,389]},{"content":"Learn how to print documents from a Universal Windows app.","pos":[452,510]},{"content":"This topic also shows how to print specific pages.","pos":[511,561]},{"content":"For more advanced changes to the print preview UI, see <bpt id=\"p1\">[</bpt>Customize the print preview UI<ept id=\"p1\">](customize-the-print-preview-ui.md)</ept>.","pos":[562,685],"source":" For more advanced changes to the print preview UI, see [Customize the print preview UI](customize-the-print-preview-ui.md)."},{"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>  Most of the examples in this topic are based on the print sample.","pos":[687,761],"source":"**Tip**  Most of the examples in this topic are based on the print sample."},{"content":"To see the full code, download the <bpt id=\"p1\">[</bpt>Universal Windows Platform (UWP) print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept> from the <bpt id=\"p2\">[</bpt>Windows-universal-samples repo<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=619979)</ept> on GitHub.","pos":[762,995],"source":" To see the full code, download the [Universal Windows Platform (UWP) print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) from the [Windows-universal-samples repo](http://go.microsoft.com/fwlink/p/?LinkId=619979) on GitHub."},{"content":"Register for printing","pos":[1000,1021]},{"content":"The first step to add printing to your app is to register for the Print contract.","pos":[1023,1104]},{"content":"Your app must do this on every screen from which you want your customer to be able to print.","pos":[1105,1197]},{"content":"Only the screen that is displayed to the user can be registered for printing.","pos":[1198,1275]},{"content":"If one screen of your app has registered for printing, it must unregister for printing when it exits.","pos":[1276,1377]},{"content":"If it is replaced by another screen, the next screen must register for a new Print contract when it opens.","pos":[1378,1484]},{"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>  If you need to support printing from more than one page in your app, you can put this print code in a common helper class and have your app pages reuse it.","pos":[1486,1650],"source":"**Tip**  If you need to support printing from more than one page in your app, you can put this print code in a common helper class and have your app pages reuse it."},{"content":"For an example of how to do this, see the <ph id=\"ph1\">`PrintHelper`</ph> class in the <bpt id=\"p1\">[</bpt>UWP print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept>.","pos":[1651,1788],"source":" For an example of how to do this, see the `PrintHelper` class in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)."},{"content":"First, declare the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintManager<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226426)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PrintDocument<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR243314)</ept>.","pos":[1790,1968],"source":"First, declare the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) and [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314)."},{"content":"The <bpt id=\"p1\">**</bpt>PrintManager<ept id=\"p1\">**</ept> type is in the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Windows.Graphics.Printing<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR226489)</ept> namespace along with types to support other Windows printing functionality.","pos":[1969,2170],"source":" The **PrintManager** type is in the [**Windows.Graphics.Printing**](https://msdn.microsoft.com/library/windows/apps/BR226489) namespace along with types to support other Windows printing functionality."},{"content":"The <bpt id=\"p1\">**</bpt>PrintDocument<ept id=\"p1\">**</ept> type is in the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Windows.UI.Xaml.Printing<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR243325)</ept> namespace along with other types that support preparing XAML content for printing.","pos":[2171,2379],"source":" The **PrintDocument** type is in the [**Windows.UI.Xaml.Printing**](https://msdn.microsoft.com/library/windows/apps/BR243325) namespace along with other types that support preparing XAML content for printing."},{"content":"You can make it easier to write your printing code by adding the following <bpt id=\"p1\">**</bpt>using<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Imports<ept id=\"p2\">**</ept> statements to your page.","pos":[2380,2504],"source":" You can make it easier to write your printing code by adding the following **using** or **Imports** statements to your page."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintDocument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR243314)</ept> class is used to handle much of the interaction between the app and the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PrintManager<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR226426)</ept>, but it exposes several callbacks of its own.","pos":[2576,2852],"source":"The [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314) class is used to handle much of the interaction between the app and the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426), but it exposes several callbacks of its own."},{"content":"During registration, create instances of <bpt id=\"p1\">**</bpt>PrintManager<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>PrintDocument<ept id=\"p2\">**</ept> and register handlers for their printing events.","pos":[2853,2981],"source":" During registration, create instances of **PrintManager** and **PrintDocument** and register handlers for their printing events."},{"pos":[2983,3121],"content":"In the <bpt id=\"p1\">[</bpt>UWP print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept>, registration is performed by the <ph id=\"ph1\">`RegisterForPrinting`</ph> method.","source":"In the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984), registration is performed by the `RegisterForPrinting` method."},{"pos":[3549,3657],"content":"When the user goes to a page that supports, it initiates the registration within the <ph id=\"ph1\">`OnNavigatedTo`</ph> method.","source":"When the user goes to a page that supports, it initiates the registration within the `OnNavigatedTo` method."},{"content":"When the user leaves the page, disconnect the printing event handlers.","pos":[4156,4226]},{"content":"If you have a multiple-page app and don't disconnect printing, an exception is thrown when the user leaves the page and then comes back to it.","pos":[4227,4369]},{"content":"Create a print button","pos":[4539,4560]},{"content":"Add a print button to your app's screen where you'd like it to appear.","pos":[4562,4632]},{"content":"Make sure that it doesn't interfere with the content that you want to print.","pos":[4633,4709]},{"content":"Next, add an event handler to your app's code to handle the click event.","pos":[4806,4878]},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ShowPrintUIAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.printmanager.showprintuiasync)</ept> method to start printing from your app.","pos":[4879,5054],"source":" Use the [**ShowPrintUIAsync**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.printmanager.showprintuiasync) method to start printing from your app."},{"content":"<bpt id=\"p1\">**</bpt>ShowPrintUIAsync<ept id=\"p1\">**</ept> is an asynchronous method that displays the appropriate printing window.","pos":[5055,5148],"source":"**ShowPrintUIAsync** is an asynchronous method that displays the appropriate printing window."},{"content":"If printing can't be performed at that time, the method will throw an exception.","pos":[5149,5229]},{"content":"We recommend catching these exceptions and letting the user know when printing can't proceed, as shown here.","pos":[5230,5338]},{"content":"In this example, a print window is displayed in the event handler for a button click.","pos":[5884,5969]},{"content":"If the method throws an exception (because printing can't be performed at that time), a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ContentDialog<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn633972)</ept> control informs the user of the situation.","pos":[5970,6178],"source":" If the method throws an exception (because printing can't be performed at that time), a [**ContentDialog**](https://msdn.microsoft.com/library/windows/apps/Dn633972) control informs the user of the situation."},{"content":"Format your app's content","pos":[6183,6208]},{"content":"When <bpt id=\"p1\">**</bpt>ShowPrintUIAsync<ept id=\"p1\">**</ept> is called, the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>PrintTaskRequested<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br206597)</ept> event is raised.","pos":[6210,6350],"source":"When **ShowPrintUIAsync** is called, the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event is raised."},{"content":"The <bpt id=\"p1\">**</bpt>PrintTaskRequested<ept id=\"p1\">**</ept> event handler shown in this step creates a <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>PrintTask<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR226436)</ept> by calling the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>PrintTaskRequest.CreatePrintTask<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR226436request_createprinttask)</ept> method and passes the title for the print page and the name of a <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>PrintTaskSourceRequestedHandler<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.printtask.source)</ept> delegate.","pos":[6351,6834],"source":" The **PrintTaskRequested** event handler shown in this step creates a [**PrintTask**](https://msdn.microsoft.com/library/windows/apps/BR226436) by calling the [**PrintTaskRequest.CreatePrintTask**](https://msdn.microsoft.com/library/windows/apps/BR226436request_createprinttask) method and passes the title for the print page and the name of a [**PrintTaskSourceRequestedHandler**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.printtask.source) delegate."},{"content":"Notice that in this example, the <bpt id=\"p1\">**</bpt>PrintTaskSourceRequestedHandler<ept id=\"p1\">**</ept> is defined inline.","pos":[6835,6922],"source":" Notice that in this example, the **PrintTaskSourceRequestedHandler** is defined inline."},{"content":"The <bpt id=\"p1\">**</bpt>PrintTaskSourceRequestedHandler<ept id=\"p1\">**</ept> provides the formatted content for printing and is described later.","pos":[6923,7030],"source":" The **PrintTaskSourceRequestedHandler** provides the formatted content for printing and is described later."},{"content":"In this example, a completion handler is also defined to catch errors.","pos":[7032,7102]},{"content":"It's a good idea to handle completion events because then your app can let the user know if an error occurred and provide possible solutions.","pos":[7103,7244]},{"content":"Likewise, your app could use the completion event to indicate subsequent steps for the user to take after the print job is successful.","pos":[7245,7379]},{"content":"After the print task is created, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintManager<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226426)</ept> requests a collection of print pages to show in the print preview UI by raising the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Paginate<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.paginate)</ept> event.","pos":[8228,8544],"source":"After the print task is created, the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) requests a collection of print pages to show in the print preview UI by raising the [**Paginate**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.paginate) event."},{"content":"This corresponds with the <bpt id=\"p1\">**</bpt>Paginate<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>IPrintPreviewPageCollection<ept id=\"p2\">**</ept> interface.","pos":[8545,8640],"source":" This corresponds with the **Paginate** method of the **IPrintPreviewPageCollection** interface."},{"content":"The event handler you created during registration will be called at this time.","pos":[8641,8719]},{"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>  If the user changes print settings, the paginate event handler will be called again to allow you to reflow the content.","pos":[8721,8855],"source":"**Important**  If the user changes print settings, the paginate event handler will be called again to allow you to reflow the content."},{"content":"For the best user experience, we recommend checking the settings before you reflow the content and avoid reinitializing the paginated content when it's not necessary.","pos":[8856,9022]},{"content":"In the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Paginate<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.paginate)</ept> event handler (the <ph id=\"ph1\">`CreatePrintPreviewPages`</ph> method in the <bpt id=\"p3\">[</bpt>UWP print sample<ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept>), create the pages to show in the print preview UI and to send to the printer.","pos":[9024,9348],"source":"In the [**Paginate**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.paginate) event handler (the `CreatePrintPreviewPages` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)), create the pages to show in the print preview UI and to send to the printer."},{"content":"The code you use to prepare your app's content for printing is specific to your app and the content you print.","pos":[9349,9459]},{"content":"Refer to the <bpt id=\"p1\">[</bpt>UWP print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept> source code to see how it formats its content for printing.","pos":[9460,9600],"source":" Refer to the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) source code to see how it formats its content for printing."},{"content":"When a particular page is to be shown in the print preview window, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintManager<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226426)</ept> raises the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetPreviewPage<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.getpreviewpage)</ept> event.","pos":[11166,11455],"source":"When a particular page is to be shown in the print preview window, the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) raises the [**GetPreviewPage**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.getpreviewpage) event."},{"content":"This corresponds with the <bpt id=\"p1\">**</bpt>MakePage<ept id=\"p1\">**</ept> method of the <bpt id=\"p2\">**</bpt>IPrintPreviewPageCollection<ept id=\"p2\">**</ept> interface.","pos":[11456,11551],"source":" This corresponds with the **MakePage** method of the **IPrintPreviewPageCollection** interface."},{"content":"The event handler you created during registration will be called at this time.","pos":[11552,11630]},{"pos":[11632,11935],"content":"In the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPreviewPage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.getpreviewpage)</ept> event handler (the <ph id=\"ph1\">`GetPrintPreviewPage`</ph> method in the <bpt id=\"p3\">[</bpt>UWP print sample<ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept>), set the appropriate page on the print document.","source":"In the [**GetPreviewPage**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.getpreviewpage) event handler (the `GetPrintPreviewPage` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)), set the appropriate page on the print document."},{"content":"Finally, once the user clicks the print button, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintManager<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR226426)</ept> requests the final collection of pages to send to the printer by calling the <bpt id=\"p3\">**</bpt>MakeDocument<ept id=\"p3\">**</ept> method of the <bpt id=\"p4\">**</bpt>IDocumentPageSource<ept id=\"p4\">**</ept> interface.","pos":[12171,12442],"source":"Finally, once the user clicks the print button, the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) requests the final collection of pages to send to the printer by calling the **MakeDocument** method of the **IDocumentPageSource** interface."},{"content":"In XAML, this raises the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AddPages<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.addpages)</ept> event.","pos":[12443,12586],"source":" In XAML, this raises the [**AddPages**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.addpages) event."},{"content":"The event handler you created during registration will be called at this time.","pos":[12587,12665]},{"content":"In the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AddPages<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.addpages)</ept> event handler (the <ph id=\"ph1\">`AddPrintPages`</ph> method in the <bpt id=\"p3\">[</bpt>UWP print sample<ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept>), add pages from the page collection to the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>PrintDocument<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR243314)</ept> object to be sent to the printer.","pos":[12667,13058],"source":"In the [**AddPages**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.addpages) event handler (the `AddPrintPages` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)), add pages from the page collection to the [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314) object to be sent to the printer."},{"content":"If a user specifies particular pages or a range of pages to print, you use that information here to add only the pages that will actually be sent to the printer.","pos":[13059,13220]},{"content":"Prepare print options","pos":[13732,13753]},{"content":"Next prepare print options.","pos":[13755,13782]},{"content":"As an example, this section will describe how to set the page range option to allow printing of specific pages.","pos":[13783,13894]},{"content":"For more advanced options, see <bpt id=\"p1\">[</bpt>Customize the print preview UI<ept id=\"p1\">](customize-the-print-preview-ui.md)</ept>.","pos":[13895,13994],"source":" For more advanced options, see [Customize the print preview UI](customize-the-print-preview-ui.md)."},{"content":"This step creates a new print option, defines a list of values that the option supports, and then adds the option to the print preview UI.","pos":[13996,14134]},{"content":"The page range option has these settings:","pos":[14135,14176]},{"content":"Option name","pos":[14180,14191]},{"content":"Action","pos":[14203,14209]},{"content":"Print all","pos":[14251,14260]},{"content":"Print all pages in the document.","pos":[14272,14304]},{"content":"Print Selection","pos":[14311,14326]},{"content":"Print only the content the user selected.","pos":[14332,14373]},{"content":"Print Range","pos":[14381,14392]},{"content":"Display an edit control into which the user can enter the pages to print.","pos":[14402,14475]},{"pos":[14480,14714],"content":"First, modify the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PrintTaskRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br206597)</ept> event handler to add the code to get a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PrintTaskOptionDetails<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/Hh701256)</ept> object.","source":"First, modify the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler to add the code to get a [**PrintTaskOptionDetails**](https://msdn.microsoft.com/library/windows/apps/Hh701256) object."},{"content":"Clear the list of options that are shown in the print preview UI and add the options that you want to display when the user wants to print from the app.","pos":[14844,14996]},{"pos":[14998,15141],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The options appear in the print preview UI in the same order they are appended, with the first option shown at the top of the window.","source":"**Note**  The options appear in the print preview UI in the same order they are appended, with the first option shown at the top of the window."},{"content":"Create the new print option and initialize the list of option values.","pos":[15508,15577]},{"content":"Add your custom print option and assign the event handler.","pos":[15889,15947]},{"content":"The custom option is appended last so that it appears at the bottom of the list of options.","pos":[15948,16039]},{"content":"But you can put it anywhere in the list, custom print options don't need to be added last.","pos":[16040,16130]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CreateTextOption<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.optiondetails.printtaskoptiondetails.createtextoption)</ept> method creates the <bpt id=\"p3\">**</bpt>Range<ept id=\"p3\">**</ept> text box.","pos":[16490,16684],"source":"The [**CreateTextOption**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.optiondetails.printtaskoptiondetails.createtextoption) method creates the **Range** text box."},{"content":"This is where the user enters the specific pages they want to print when they select the <bpt id=\"p1\">**</bpt>Print Range<ept id=\"p1\">**</ept> option.","pos":[16685,16797],"source":" This is where the user enters the specific pages they want to print when they select the **Print Range** option."},{"content":"Handle print option changes","pos":[16802,16829]},{"content":"The <bpt id=\"p1\">**</bpt>OptionChanged<ept id=\"p1\">**</ept> event handler does two things.","pos":[16831,16883],"source":"The **OptionChanged** event handler does two things."},{"content":"First, it shows and hides the text edit field for the page range depending on the page range option that the user selected.","pos":[16884,17007]},{"content":"Second, it tests the text entered into the page range text box to make sure that it represents a valid page range for the document.","pos":[17008,17139]},{"pos":[17141,17258],"content":"This example shows how the <bpt id=\"p1\">[</bpt>UWP print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept> handles change events.","source":"This example shows how the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) handles change events."},{"pos":[19711,19909],"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>  See the <ph id=\"ph1\">`GetPagesInRange`</ph> method in the <bpt id=\"p2\">[</bpt>UWP print sample<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept> for details on how to parse the page range the user enters in the Range text box.","source":"**Tip**  See the `GetPagesInRange` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) for details on how to parse the page range the user enters in the Range text box."},{"content":"Preview selected pages","pos":[19914,19936]},{"content":"How you format your app's content for printing depends on the nature of your app and its content.","pos":[19938,20035]},{"content":"The <bpt id=\"p1\">[</bpt>UWP print sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619984)</ept> uses a print helper class to format its content for printing.","pos":[20036,20169],"source":" The [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) uses a print helper class to format its content for printing."},{"content":"When printing a subset of the pages, there are several ways to show the content in the print preview.","pos":[20171,20272]},{"content":"Regardless of the method you chose to show the page range in the print preview, the printed output must contain only the selected pages.","pos":[20273,20409]},{"content":"Show all the pages in the print preview whether a page range is specified or not, leaving the user to know which pages will actually be printed.","pos":[20415,20559]},{"content":"Show only the pages selected by the user's page range in the print preview, updating the display whenever the user changes the page range.","pos":[20564,20702]},{"content":"Show all the pages in print preview, but grey out the pages that are not in page range selected by the user.","pos":[20707,20815]},{"content":"Related topics","pos":[20820,20834]},{"content":"Design guidelines for printing","pos":[20839,20869]},{"content":"//Build 2015 video: Developing apps that print in Windows 10","pos":[20932,20992]},{"content":"UWP print sample","pos":[21047,21063]}],"content":"# Print from your app\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n** Important APIs **\n\n-   [**Windows.Graphics.Printing**](https://msdn.microsoft.com/library/windows/apps/BR226489)\n-   [**Windows.UI.Xaml.Printing**](https://msdn.microsoft.com/library/windows/apps/BR243325)\n-   [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314)\n\nLearn how to print documents from a Universal Windows app. This topic also shows how to print specific pages. For more advanced changes to the print preview UI, see [Customize the print preview UI](customize-the-print-preview-ui.md).\n\n**Tip**  Most of the examples in this topic are based on the print sample. To see the full code, download the [Universal Windows Platform (UWP) print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) from the [Windows-universal-samples repo](http://go.microsoft.com/fwlink/p/?LinkId=619979) on GitHub.\n\n## Register for printing\n\nThe first step to add printing to your app is to register for the Print contract. Your app must do this on every screen from which you want your customer to be able to print. Only the screen that is displayed to the user can be registered for printing. If one screen of your app has registered for printing, it must unregister for printing when it exits. If it is replaced by another screen, the next screen must register for a new Print contract when it opens.\n\n**Tip**  If you need to support printing from more than one page in your app, you can put this print code in a common helper class and have your app pages reuse it. For an example of how to do this, see the `PrintHelper` class in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984).\n\nFirst, declare the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) and [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314). The **PrintManager** type is in the [**Windows.Graphics.Printing**](https://msdn.microsoft.com/library/windows/apps/BR226489) namespace along with types to support other Windows printing functionality. The **PrintDocument** type is in the [**Windows.UI.Xaml.Printing**](https://msdn.microsoft.com/library/windows/apps/BR243325) namespace along with other types that support preparing XAML content for printing. You can make it easier to write your printing code by adding the following **using** or **Imports** statements to your page.\n\n```csharp\nusing Windows.UI.Xaml;\nusing Windows.UI.Xaml.Controls;\n```\n\nThe [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314) class is used to handle much of the interaction between the app and the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426), but it exposes several callbacks of its own. During registration, create instances of **PrintManager** and **PrintDocument** and register handlers for their printing events.\n\nIn the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984), registration is performed by the `RegisterForPrinting` method.\n\n```csharp\npublic virtual void RegisterForPrinting()\n{\n   printDocument = new PrintDocument();\n   printDocumentSource = printDocument.DocumentSource;\n   printDocument.Paginate += CreatePrintPreviewPages;\n   printDocument.GetPreviewPage += GetPrintPreviewPage;\n   printDocument.AddPages += AddPrintPages;\n\n   PrintManager printMan = PrintManager.GetForCurrentView();\n   printMan.PrintTaskRequested += PrintTaskRequested;\n}\n```\n\nWhen the user goes to a page that supports, it initiates the registration within the `OnNavigatedTo` method.\n\n```csharp\nprotected override void OnNavigatedTo(NavigationEventArgs e)\n{\n   // Initalize common helper class and register for printing\n   printHelper = new PrintHelper(this);\n   printHelper.RegisterForPrinting();\n\n   // Initialize print content for this scenario\n   printHelper.PreparePrintContent(new PageToPrint());\n\n   // Tell the user how to print\n   MainPage.Current.NotifyUser(\"Print contract registered with customization, use the Print button to print.\", NotifyType.StatusMessage);\n}\n```\n\nWhen the user leaves the page, disconnect the printing event handlers. If you have a multiple-page app and don't disconnect printing, an exception is thrown when the user leaves the page and then comes back to it.\n\n```csharp\nprotected override void OnNavigatedFrom(NavigationEventArgs e)\n{\n   if (printHelper != null)\n   {\n         printHelper.UnregisterForPrinting();\n   }\n}\n```\n## Create a print button\n\nAdd a print button to your app's screen where you'd like it to appear. Make sure that it doesn't interfere with the content that you want to print.\n\n```xml\n<Button x:Name=\"InvokePrintingButton\" Content=\"Print\" Click=\"OnPrintButtonClick\"/>\n```\n\nNext, add an event handler to your app's code to handle the click event. Use the [**ShowPrintUIAsync**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.printmanager.showprintuiasync) method to start printing from your app. **ShowPrintUIAsync** is an asynchronous method that displays the appropriate printing window. If printing can't be performed at that time, the method will throw an exception. We recommend catching these exceptions and letting the user know when printing can't proceed, as shown here.\n\n```csharp\nasync private void OnPrintButtonClick(object sender, RoutedEventArgs e)\n{\n    try\n    {\n        // Show print UI\n        await Windows.Graphics.Printing.PrintManager.ShowPrintUIAsync();\n\n    }\n    catch\n    {\n        // Printing cannot proceed at this time\n        ContentDialog noPrintingDialog = new ContentDialog()\n        {\n            Title = \"Printing error\",\n            Content = \"\\nSorry, printing can&#39;t proceed at this time.\", PrimaryButtonText = \"OK\"\n        };\n        await noPrintingDialog.ShowAsync();\n    }\n}\n```\n\nIn this example, a print window is displayed in the event handler for a button click. If the method throws an exception (because printing can't be performed at that time), a [**ContentDialog**](https://msdn.microsoft.com/library/windows/apps/Dn633972) control informs the user of the situation.\n\n## Format your app's content\n\nWhen **ShowPrintUIAsync** is called, the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event is raised. The **PrintTaskRequested** event handler shown in this step creates a [**PrintTask**](https://msdn.microsoft.com/library/windows/apps/BR226436) by calling the [**PrintTaskRequest.CreatePrintTask**](https://msdn.microsoft.com/library/windows/apps/BR226436request_createprinttask) method and passes the title for the print page and the name of a [**PrintTaskSourceRequestedHandler**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.printtask.source) delegate. Notice that in this example, the **PrintTaskSourceRequestedHandler** is defined inline. The **PrintTaskSourceRequestedHandler** provides the formatted content for printing and is described later.\n\nIn this example, a completion handler is also defined to catch errors. It's a good idea to handle completion events because then your app can let the user know if an error occurred and provide possible solutions. Likewise, your app could use the completion event to indicate subsequent steps for the user to take after the print job is successful.\n\n```csharp\nprotected virtual void PrintTaskRequested(PrintManager sender, PrintTaskRequestedEventArgs e)\n{\n   PrintTask printTask = null;\n   printTask = e.Request.CreatePrintTask(\"C# Printing SDK Sample\", sourceRequested =>\n   {\n         // Print Task event handler is invoked when the print job is completed.\n         printTask.Completed += async (s, args) =>\n         {\n            // Notify the user when the print operation fails.\n            if (args.Completion == PrintTaskCompletion.Failed)\n            {\n               await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>\n               {\n                     MainPage.Current.NotifyUser(\"Failed to print.\", NotifyType.ErrorMessage);\n               });\n            }\n         };\n\n         sourceRequested.SetSource(printDocumentSource);\n   });\n}\n```\n\nAfter the print task is created, the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) requests a collection of print pages to show in the print preview UI by raising the [**Paginate**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.paginate) event. This corresponds with the **Paginate** method of the **IPrintPreviewPageCollection** interface. The event handler you created during registration will be called at this time.\n\n**Important**  If the user changes print settings, the paginate event handler will be called again to allow you to reflow the content. For the best user experience, we recommend checking the settings before you reflow the content and avoid reinitializing the paginated content when it's not necessary.\n\nIn the [**Paginate**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.paginate) event handler (the `CreatePrintPreviewPages` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)), create the pages to show in the print preview UI and to send to the printer. The code you use to prepare your app's content for printing is specific to your app and the content you print. Refer to the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) source code to see how it formats its content for printing.\n\n```csharp\nprotected virtual void CreatePrintPreviewPages(object sender, PaginateEventArgs e)\n{\n   // Clear the cache of preview pages\n   printPreviewPages.Clear();\n\n   // Clear the print canvas of preview pages\n   PrintCanvas.Children.Clear();\n\n   // This variable keeps track of the last RichTextBlockOverflow element that was added to a page which will be printed\n   RichTextBlockOverflow lastRTBOOnPage;\n\n   // Get the PrintTaskOptions\n   PrintTaskOptions printingOptions = ((PrintTaskOptions)e.PrintTaskOptions);\n\n   // Get the page description to deterimine how big the page is\n   PrintPageDescription pageDescription = printingOptions.GetPageDescription(0);\n\n   // We know there is at least one page to be printed. passing null as the first parameter to\n   // AddOnePrintPreviewPage tells the function to add the first page.\n   lastRTBOOnPage = AddOnePrintPreviewPage(null, pageDescription);\n\n   // We know there are more pages to be added as long as the last RichTextBoxOverflow added to a print preview\n   // page has extra content\n   while (lastRTBOOnPage.HasOverflowContent &amp;&amp; lastRTBOOnPage.Visibility == Windows.UI.Xaml.Visibility.Visible)\n   {\n         lastRTBOOnPage = AddOnePrintPreviewPage(lastRTBOOnPage, pageDescription);\n   }\n\n   if (PreviewPagesCreated != null)\n   {\n         PreviewPagesCreated.Invoke(printPreviewPages, null);\n   }\n\n   PrintDocument printDoc = (PrintDocument)sender;\n\n   // Report the number of preview pages created\n   printDoc.SetPreviewPageCount(printPreviewPages.Count, PreviewPageCountType.Intermediate);\n}\n```\n\nWhen a particular page is to be shown in the print preview window, the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) raises the [**GetPreviewPage**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.getpreviewpage) event. This corresponds with the **MakePage** method of the **IPrintPreviewPageCollection** interface. The event handler you created during registration will be called at this time.\n\nIn the [**GetPreviewPage**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.getpreviewpage) event handler (the `GetPrintPreviewPage` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)), set the appropriate page on the print document.\n\n```csharp\nprotected virtual void GetPrintPreviewPage(object sender, GetPreviewPageEventArgs e)\n{\n   PrintDocument printDoc = (PrintDocument)sender;\n   printDoc.SetPreviewPage(e.PageNumber, printPreviewPages[e.PageNumber - 1]);\n}\n```\n\nFinally, once the user clicks the print button, the [**PrintManager**](https://msdn.microsoft.com/library/windows/apps/BR226426) requests the final collection of pages to send to the printer by calling the **MakeDocument** method of the **IDocumentPageSource** interface. In XAML, this raises the [**AddPages**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.addpages) event. The event handler you created during registration will be called at this time.\n\nIn the [**AddPages**](https://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.printing.printdocument.addpages) event handler (the `AddPrintPages` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)), add pages from the page collection to the [**PrintDocument**](https://msdn.microsoft.com/library/windows/apps/BR243314) object to be sent to the printer. If a user specifies particular pages or a range of pages to print, you use that information here to add only the pages that will actually be sent to the printer.\n\n```csharp\nprotected virtual void AddPrintPages(object sender, AddPagesEventArgs e)\n{\n   // Loop over all of the preview pages and add each one to  add each page to be printied\n   for (int i = 0; i < printPreviewPages.Count; i++)\n   {\n         // We should have all pages ready at this point...\n         printDocument.AddPage(printPreviewPages[i]);\n   }\n\n   PrintDocument printDoc = (PrintDocument)sender;\n\n   // Indicate that all of the print pages have been provided\n   printDoc.AddPagesComplete();\n}\n```\n\n## Prepare print options\n\nNext prepare print options. As an example, this section will describe how to set the page range option to allow printing of specific pages. For more advanced options, see [Customize the print preview UI](customize-the-print-preview-ui.md).\n\nThis step creates a new print option, defines a list of values that the option supports, and then adds the option to the print preview UI. The page range option has these settings:\n\n| Option name          | Action | \n|----------------------|--------|\n| **Print all**        | Print all pages in the document. |\n| **Print Selection**  | Print only the content the user selected. | \n| **Print Range**      | Display an edit control into which the user can enter the pages to print. |\n \nFirst, modify the [**PrintTaskRequested**](https://msdn.microsoft.com/library/windows/apps/br206597) event handler to add the code to get a [**PrintTaskOptionDetails**](https://msdn.microsoft.com/library/windows/apps/Hh701256) object.\n\n```csharp\nPrintTaskOptionDetails printDetailedOptions = PrintTaskOptionDetails.GetFromPrintTaskOptions(printTask.Options);\n```\n\nClear the list of options that are shown in the print preview UI and add the options that you want to display when the user wants to print from the app.\n\n**Note**  The options appear in the print preview UI in the same order they are appended, with the first option shown at the top of the window.\n\n```csharp\nIList<string> displayedOptions = printDetailedOptions.DisplayedOptions;\n\ndisplayedOptions.Clear();\ndisplayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Copies);\ndisplayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.Orientation);\ndisplayedOptions.Add(Windows.Graphics.Printing.StandardPrintTaskOptions.ColorMode);\n```\n\nCreate the new print option and initialize the list of option values.\n\n```csharp\n// Create a new list option\nPrintCustomItemListOptionDetails pageFormat = printDetailedOptions.CreateItemListOption(\"PageRange\", \"Page Range\");\npageFormat.AddItem(\"PrintAll\", \"Print all\");\npageFormat.AddItem(\"PrintSelection\", \"Print Selection\");\npageFormat.AddItem(\"PrintRange\", \"Print Range\");\n```\n\nAdd your custom print option and assign the event handler. The custom option is appended last so that it appears at the bottom of the list of options. But you can put it anywhere in the list, custom print options don't need to be added last.\n\n```csharp\n// Add the custom option to the option list\ndisplayedOptions.Add(\"PageRange\");\n\n// Create new edit option\nPrintCustomTextOptionDetails pageRangeEdit = printDetailedOptions.CreateTextOption(\"PageRangeEdit\", \"Range\");\n\n// Register the handler for the option change event\nprintDetailedOptions.OptionChanged += printDetailedOptions_OptionChanged;\n```\n\nThe [**CreateTextOption**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing.optiondetails.printtaskoptiondetails.createtextoption) method creates the **Range** text box. This is where the user enters the specific pages they want to print when they select the **Print Range** option.\n\n## Handle print option changes\n\nThe **OptionChanged** event handler does two things. First, it shows and hides the text edit field for the page range depending on the page range option that the user selected. Second, it tests the text entered into the page range text box to make sure that it represents a valid page range for the document.\n\nThis example shows how the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) handles change events.\n\n```csharp\nasync void printDetailedOptions_OptionChanged(PrintTaskOptionDetails sender, PrintTaskOptionChangedEventArgs args)\n{\n   if (args.OptionId == null)\n   {\n         return;\n   }\n\n   string optionId = args.OptionId.ToString();\n\n   // Handle change in Page Range Option\n   if (optionId == \"PageRange\")\n   {\n         IPrintOptionDetails pageRange = sender.Options[optionId];\n         string pageRangeValue = pageRange.Value.ToString();\n\n         selectionMode = false;\n\n         switch (pageRangeValue)\n         {\n            case \"PrintRange\":\n               // Add PageRangeEdit custom option to the option list\n               sender.DisplayedOptions.Add(\"PageRangeEdit\");\n               pageRangeEditVisible = true;\n               await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>\n               {\n                     ShowContent(null);\n               });\n               break;\n            case \"PrintSelection\":\n               await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>\n               {\n                     Scenario4PageRange page = (Scenario4PageRange)scenarioPage;\n                     PageToPrint pageContent = (PageToPrint)page.PrintFrame.Content;\n                     ShowContent(pageContent.TextContentBlock.SelectedText);\n               });\n               RemovePageRangeEdit(sender);\n               break;\n            default:\n               await scenarioPage.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>\n               {\n                     ShowContent(null);\n               });\n               RemovePageRangeEdit(sender);\n               break;\n         }\n\n         Refresh();\n   }\n   else if (optionId == \"PageRangeEdit\")\n   {\n         IPrintOptionDetails pageRange = sender.Options[optionId];\n         // Expected range format (p1,p2...)*, (p3-p9)* ...\n         if (!Regex.IsMatch(pageRange.Value.ToString(), @\"^\\s*\\d+\\s*(\\-\\s*\\d+\\s*)?(\\,\\s*\\d+\\s*(\\-\\s*\\d+\\s*)?)*$\"))\n         {\n            pageRange.ErrorText = \"Invalid Page Range (eg: 1-3, 5)\";\n         }\n         else\n         {\n            pageRange.ErrorText = string.Empty;\n            try\n            {\n               GetPagesInRange(pageRange.Value.ToString());\n               Refresh();\n            }\n            catch (InvalidPageException ipex)\n            {\n               pageRange.ErrorText = ipex.Message;\n            }\n         }\n   }\n}\n```\n\n**Tip**  See the `GetPagesInRange` method in the [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) for details on how to parse the page range the user enters in the Range text box.\n\n## Preview selected pages\n\nHow you format your app's content for printing depends on the nature of your app and its content. The [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984) uses a print helper class to format its content for printing.\n\nWhen printing a subset of the pages, there are several ways to show the content in the print preview. Regardless of the method you chose to show the page range in the print preview, the printed output must contain only the selected pages.\n\n-   Show all the pages in the print preview whether a page range is specified or not, leaving the user to know which pages will actually be printed.\n-   Show only the pages selected by the user's page range in the print preview, updating the display whenever the user changes the page range.\n-   Show all the pages in print preview, but grey out the pages that are not in page range selected by the user.\n\n## Related topics\n\n* [Design guidelines for printing](https://msdn.microsoft.com/library/windows/apps/Hh868178)\n* [//Build 2015 video: Developing apps that print in Windows 10](https://channel9.msdn.com/Events/Build/2015/2-94)\n* [UWP print sample](http://go.microsoft.com/fwlink/p/?LinkId=619984)\n"}