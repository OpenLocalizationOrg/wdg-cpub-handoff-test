{"nodes":[{"pos":[17,146],"content":"Provide deep links from the background app service in Cortana to launch the app to the foreground in a specific state or context.","needQuote":true,"needEscape":true,"nodes":[{"content":"Provide deep links from the background app service in Cortana to launch the app to the foreground in a specific state or context.","pos":[0,129]}]},{"pos":[154,196],"content":"Deep link from Cortana to a background app","needQuote":true,"needEscape":true,"nodes":[{"content":"Deep link from Cortana to a background app","pos":[0,42]}]},{"content":"Deep link from Cortana to a background app","pos":[311,353]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[356,394]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[395,490],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[495,509]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[520,558]},{"content":"Voice Command Definition (VCD) elements and attributes v1.2","pos":[627,686]},{"pos":[749,882],"content":"Provide deep links from the background app service in <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> to launch the app to the foreground in a specific state or context.","source":"Provide deep links from the background app service in **Cortana** to launch the app to the foreground in a specific state or context."},{"content":"A deep link is displayed by default on the <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> completion screen, but you can display deep links on various other screens.","pos":[884,1014],"source":"A deep link is displayed by default on the **Cortana** completion screen, but you can display deep links on various other screens."},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Interact with a background app in Cortana<ept id=\"p1\">](interact-with-a-background-app-in-cortana.md)</ept>.","pos":[1015,1124],"source":" For more info, see [Interact with a background app in Cortana](interact-with-a-background-app-in-cortana.md)."},{"content":"Prerequisites:","pos":[1128,1142]},{"content":"This topic builds on <bpt id=\"p1\">[</bpt>Interact with a background app in Cortana<ept id=\"p1\">](interact-with-a-background-app-in-cortana.md)</ept>.","pos":[1148,1259],"source":"This topic builds on [Interact with a background app in Cortana](interact-with-a-background-app-in-cortana.md)."},{"content":"We continue using a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> to demonstrate various <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> features.","pos":[1260,1383],"source":" We continue using a trip planning and management app named **Adventure Works** to demonstrate various **Cortana** features."},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[1385,1538]},{"content":"Create your first app","pos":[1545,1566]},{"pos":[1630,1747],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>","source":"Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)"},{"content":"User experience guidelines:","pos":[1751,1778]},{"pos":[1784,2092],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app.","source":"See [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[2178,2186],"content":"Overview"},{"pos":[2189,2238],"content":"Users can access your app through <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> by:","source":"Users can access your app through **Cortana** by:"},{"pos":[2244,2399],"content":"Launching it as a foreground app (see <bpt id=\"p1\">[</bpt>Launch a foreground app with voice commands in Cortana<ept id=\"p1\">](launch-a-foreground-app-with-voice-commands-in-cortana.md)</ept>).","source":"Launching it as a foreground app (see [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md))."},{"pos":[2404,2586],"content":"Exposing specific functionality as a background app service (see <bpt id=\"p1\">[</bpt>Launch a background app with voice commands in Cortana<ept id=\"p1\">](launch-a-background-app-with-voice-commands-in-cortana.md)</ept>).","source":"Exposing specific functionality as a background app service (see [Launch a background app with voice commands in Cortana](launch-a-background-app-with-voice-commands-in-cortana.md))."},{"content":"Deep linking to specific pages, content, and state or context.","pos":[2591,2653]},{"content":"We discuss the last item here.","pos":[2655,2685]},{"content":"Deep linking is useful when Cortana and your app service are a gateway to the full app (instead of requiring the user to launch your app through the Start menu), or for providing access to richer detail and functionality within your app that is not possible through Cortana.","pos":[2687,2961]},{"content":"Deep linking is another way to increase usability and access to your app.","pos":[2962,3035]},{"content":"There are three ways to provide deep links:","pos":[3037,3080]},{"pos":[3086,3144],"content":"A \"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" link on various <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> screens.","source":"A \"Go to &lt;app&gt;\" link on various **Cortana** screens."},{"pos":[3149,3214],"content":"A link embedded in a content tile on various <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> screens.","source":"A link embedded in a content tile on various **Cortana** screens."},{"content":"The app service programmatically launches the foreground app.","pos":[3219,3280]},{"pos":[3282,3381],"content":"Both <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> and the background app service are terminated when the foreground app is launched.","source":"Both **Cortana** and the background app service are terminated when the foreground app is launched."},{"pos":[3506,3535],"content":"\"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" deep link","source":"\"Go to &lt;app&gt;\" deep link"},{"pos":[3538,3635],"content":"<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> can expose a \"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" deep link below the content tile on various screens.","source":"**Cortana** can expose a \"Go to &lt;app&gt;\" deep link below the content tile on various screens."},{"content":"cortana background app completion screen","pos":[3639,3679]},{"content":"You can provide a launch argument for this link to open your app with similar context as the app service.","pos":[3720,3825]},{"content":"If you don't provide a launch argument, the app is launched to the main screen.","pos":[3826,3905]},{"content":"Here, we add an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> parameter with a value of \"Las Vegas\" to a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandResponse<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> object used in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>ReportSuccessAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept> call of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>VoiceCommandServiceConnection<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept>.","pos":[3907,4341],"source":"Here, we add an [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter with a value of \"Las Vegas\" to a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object used in the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204)."},{"content":"object","pos":[4342,4348]},{"pos":[4946,4968],"content":"Content tile deep link"},{"pos":[4971,5047],"content":"You can provide full content tile deep links on various <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> screens.","source":"You can provide full content tile deep links on various **Cortana** screens."},{"content":"cortana background app hand-off screen","pos":[5051,5089]},{"content":"Like the \"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" links, you can provide a launch argument to open your app with similar context as the app service.","pos":[5143,5270],"source":"Like the \"Go to &lt;app&gt;\" links, you can provide a launch argument to open your app with similar context as the app service."},{"content":"If you don't provide a launch argument, the content tile is not linked to your app.","pos":[5271,5354]},{"pos":[5356,5807],"content":"Here, we add two content tiles with different <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> parameter values to a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandContentTile<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974168)</ept> list used in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>ReportSuccessAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept> call of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>VoiceCommandServiceConnection<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> object.","source":"Here, we add two content tiles with different [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter values to a [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/dn974168) list used in the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) object."},{"pos":[7096,7118],"content":"Programmatic deep link"},{"content":"You can also programmatically launch your app with a launch argument to open your app with similar context as the app service.","pos":[7121,7247]},{"content":"If you don't provide a launch argument, the app is launched to the main screen.","pos":[7248,7327]},{"pos":[7329,7773],"content":"Here, we add an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> parameter with a value of \"Las Vegas\" to a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandResponse<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> object used in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>RequestAppLaunchAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn706581)</ept> call of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>VoiceCommandServiceConnection<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> object.","source":"Here, we add an [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter with a value of \"Las Vegas\" to a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object used in the [**RequestAppLaunchAsync**](https://msdn.microsoft.com/library/windows/apps/dn706581) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) object."},{"pos":[8234,8246],"content":"App manifest"},{"pos":[8249,8403],"content":"To enable deep linking to your app, you must declare the <ph id=\"ph1\">`windows.personalAssistantLaunch`</ph> extension in the Package.appxmanifest file of your app project.","source":"To enable deep linking to your app, you must declare the `windows.personalAssistantLaunch` extension in the Package.appxmanifest file of your app project."},{"pos":[8405,8502],"content":"Here, we declare the <ph id=\"ph1\">`windows.personalAssistantLaunch`</ph> extension for the <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> app.","source":"Here, we declare the `windows.personalAssistantLaunch` extension for the **Adventure Works** app."},{"pos":[8928,8945],"content":"Protocol contract"},{"content":"Your app is launched to the foreground through Uniform Resource Identifier (URI) activation using a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Protocol<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224693)</ept> contract.","pos":[8948,9130],"source":"Your app is launched to the foreground through Uniform Resource Identifier (URI) activation using a [**Protocol**](https://msdn.microsoft.com/library/windows/apps/br224693) contract."},{"content":"Your app must override your app's <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnActivated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242330)</ept> event and check for an <bpt id=\"p3\">**</bpt>ActivationKind<ept id=\"p3\">**</ept> of <bpt id=\"p4\">**</bpt>Protocol<ept id=\"p4\">**</ept>.","pos":[9131,9299],"source":" Your app must override your app's [**OnActivated**](https://msdn.microsoft.com/library/windows/apps/br242330) event and check for an **ActivationKind** of **Protocol**."},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Handle URI activation<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt228339)</ept>.","pos":[9300,9401],"source":" For more info, see [Handle URI activation](https://msdn.microsoft.com/library/windows/apps/mt228339)."},{"content":"Here, we decode the URI provided by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ProtocolActivatedEventArgs<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224742)</ept> to access the launch argument.","pos":[9403,9564],"source":"Here, we decode the URI provided by the [**ProtocolActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224742) to access the launch argument."},{"content":"For this example, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Uri<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224746)</ept> is set to \"windows.personalassistantlaunch:?LaunchContext=Las Vegas\".","pos":[9565,9724],"source":" For this example, the [**Uri**](https://msdn.microsoft.com/library/windows/apps/br224746) is set to \"windows.personalassistantlaunch:?LaunchContext=Las Vegas\"."},{"pos":[10408,10424],"content":"Related articles"},{"content":"Developers","pos":[10429,10439]},{"content":"Cortana interactions","pos":[10445,10465]},{"content":"VCD elements and attributes v1.2","pos":[10497,10529]},{"content":"Designers","pos":[10594,10603]},{"content":"Cortana design guidelines","pos":[10609,10634]},{"content":"Speech design guidelines","pos":[10697,10721]},{"content":"Samples","pos":[10784,10791]},{"content":"Cortana voice command sample","pos":[10797,10825]}],"content":"---\nDescription: Provide deep links from the background app service in Cortana to launch the app to the foreground in a specific state or context.\ntitle: Deep link from Cortana to a background app\nms.assetid: BE811A87-8821-476A-90E4-2E20D37E4043\nlabel: Deep link to a background app\ntemplate: detail.hbs\n---\n\n# Deep link from Cortana to a background app\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**Voice Command Definition (VCD) elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\nProvide deep links from the background app service in **Cortana** to launch the app to the foreground in a specific state or context.\n\nA deep link is displayed by default on the **Cortana** completion screen, but you can display deep links on various other screens. For more info, see [Interact with a background app in Cortana](interact-with-a-background-app-in-cortana.md).\n\n**Prerequisites:  **\n\nThis topic builds on [Interact with a background app in Cortana](interact-with-a-background-app-in-cortana.md). We continue using a trip planning and management app named **Adventure Works** to demonstrate various **Cortana** features.\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Overview\"></span><span id=\"overview\"></span><span id=\"OVERVIEW\"></span>Overview\n\n\nUsers can access your app through **Cortana** by:\n\n-   Launching it as a foreground app (see [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md)).\n-   Exposing specific functionality as a background app service (see [Launch a background app with voice commands in Cortana](launch-a-background-app-with-voice-commands-in-cortana.md)).\n-   Deep linking to specific pages, content, and state or context.\n\nWe discuss the last item here.\n\nDeep linking is useful when Cortana and your app service are a gateway to the full app (instead of requiring the user to launch your app through the Start menu), or for providing access to richer detail and functionality within your app that is not possible through Cortana. Deep linking is another way to increase usability and access to your app.\n\nThere are three ways to provide deep links:\n\n-   A \"Go to &lt;app&gt;\" link on various **Cortana** screens.\n-   A link embedded in a content tile on various **Cortana** screens.\n-   The app service programmatically launches the foreground app.\n\nBoth **Cortana** and the background app service are terminated when the foreground app is launched.\n\n## <span id=\"Go_to__app__deep_link\"></span><span id=\"go_to__app__deep_link\"></span><span id=\"GO_TO__APP__DEEP_LINK\"></span>\"Go to &lt;app&gt;\" deep link\n\n\n**Cortana** can expose a \"Go to &lt;app&gt;\" deep link below the content tile on various screens.\n\n![cortana background app completion screen](images/cortana-completion-screen.png)\n\nYou can provide a launch argument for this link to open your app with similar context as the app service. If you don't provide a launch argument, the app is launched to the main screen.\n\nHere, we add an [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter with a value of \"Las Vegas\" to a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object used in the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204). object\n\n```CSharp\nvar userMessage = new VoiceCommandUserMessage();\nstring keepingTripToDestination = string.Format(\n  cortanaResourceMap.GetValue(\"KeepingTripToDestination\", \n    cortanaContext).ValueAsString, destination);\nuserMessage.DisplayMessage = userMessage.SpokenMessage = \n  keepingTripToDestination;\n\nresponse = VoiceCommandResponse.CreateResponse(userMessage);\nresponse.AppLaunchArgument = “Las Vegas”;\nawait voiceServiceConnection.ReportSuccessAsync(response);\n```\n\n## <span id=\"Content_tile_deep_link\"></span><span id=\"content_tile_deep_link\"></span><span id=\"CONTENT_TILE_DEEP_LINK\"></span>Content tile deep link\n\n\nYou can provide full content tile deep links on various **Cortana** screens.\n\n![cortana background app hand-off screen ](images/cortana-backgroundapp-progress-result.png)\n\nLike the \"Go to &lt;app&gt;\" links, you can provide a launch argument to open your app with similar context as the app service. If you don't provide a launch argument, the content tile is not linked to your app.\n\nHere, we add two content tiles with different [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter values to a [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/dn974168) list used in the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) object.\n\n```CSharp\nvar userMessage = new VoiceCommandUserMessage();\nuserMessage.DisplayMessage = \"Here are your trips.\";\nuserMessage.SpokenMessage = \n  \"You have two trips to Vegas coming up.\";\n\nvar destinationsContentTiles = new List<VoiceCommandContentTile>();\n\nvar destinationTile1 = new VoiceCommandContentTile();\ndestinationTile1.ContentTileType = \n  VoiceCommandContentTileType.TitleWith68x68IconAndText;\ndestinationTile1.AppLaunchArgument = “id_Vegas_001\";\ndestinationTile1.Title = \"Las Vegas Tech Conference\";\ndestinationTile1.TextLine1 = \"May 15th 2015\";\ndestinationsContentTiles.Add(destinationTile1);\n\nvar destinationTile2 = new VoiceCommandContentTile();\ndestinationTile2.ContentTileType = \n  VoiceCommandContentTileType.TitleWith68x68IconAndText;\ndestinationTile2.AppLaunchArgument = “id_Vegas_002\";\ndestinationTile2.Title = \"Fun in Vegas\";\ndestinationTile2.TextLine1 = \"August 24th 2015\";\ndestinationsContentTiles.Add(destinationTile2);\n\nvar response = \n  VoiceCommandResponse.CreateResponse(userMessage, destinationsContentTiles);\n\nresponse.AppLaunchArgument = “destination=Las Vegas\";\n    \nawait voiceServiceConnection.ReportSuccessAsync(response);\n```\n\n## <span id=\"Programmatic_deep_link\"></span><span id=\"programmatic_deep_link\"></span><span id=\"PROGRAMMATIC_DEEP_LINK\"></span>Programmatic deep link\n\n\nYou can also programmatically launch your app with a launch argument to open your app with similar context as the app service. If you don't provide a launch argument, the app is launched to the main screen.\n\nHere, we add an [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter with a value of \"Las Vegas\" to a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object used in the [**RequestAppLaunchAsync**](https://msdn.microsoft.com/library/windows/apps/dn706581) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) object.\n\n```CSharp\nvar userMessage = new VoiceCommandUserMessage();\nuserMessage.DisplayMessage = \"Here are your trips.\";\nuserMessage.SpokenMessage = \n  \"You have one trip to Vegas coming up.\";\n\nresponse = VoiceCommandResponse.CreateResponse(userMessage);\nresponse.AppLaunchArgument = “Las Vegas”;\nawait  VoiceCommandServiceConnection.RequestAppLaunchAsync(response);\n```\n\n## <span id=\"App_manifest\"></span><span id=\"app_manifest\"></span><span id=\"APP_MANIFEST\"></span>App manifest\n\n\nTo enable deep linking to your app, you must declare the `windows.personalAssistantLaunch` extension in the Package.appxmanifest file of your app project.\n\nHere, we declare the `windows.personalAssistantLaunch` extension for the **Adventure Works** app.\n\n```XML\n<Extensions>\n  <uap:Extension Category=\"windows.appService\" \n    EntryPoint=\"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService\">\n    <uap:AppService Name=\"AdventureWorksVoiceCommandService\"/>\n  </uap:Extension>\n  <uap:Extension Category=\"windows.personalAssistantLaunch\"/> \n</Extensions>\n```\n\n## <span id=\"Protocol_contract\"></span><span id=\"protocol_contract\"></span><span id=\"PROTOCOL_CONTRACT\"></span>Protocol contract\n\n\nYour app is launched to the foreground through Uniform Resource Identifier (URI) activation using a [**Protocol**](https://msdn.microsoft.com/library/windows/apps/br224693) contract. Your app must override your app's [**OnActivated**](https://msdn.microsoft.com/library/windows/apps/br242330) event and check for an **ActivationKind** of **Protocol**. For more info, see [Handle URI activation](https://msdn.microsoft.com/library/windows/apps/mt228339).\n\nHere, we decode the URI provided by the [**ProtocolActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224742) to access the launch argument. For this example, the [**Uri**](https://msdn.microsoft.com/library/windows/apps/br224746) is set to \"windows.personalassistantlaunch:?LaunchContext=Las Vegas\".\n\n```CSharp\nif (args.Kind == ActivationKind.Protocol)\n  {\n    var commandArgs = args as ProtocolActivatedEventArgs;\n    Windows.Foundation.WwwFormUrlDecoder decoder = \n      new Windows.Foundation.WwwFormUrlDecoder(commandArgs.Uri.Query);\n    var destination = decoder.GetFirstValueByName(\"LaunchContext\");\n\n    navigationCommand = new ViewModel.TripVoiceCommand(\n      \"protocolLaunch\",\n      \"text\",\n      \"destination\",\n      destination);\n\n    navigationToPageType = typeof(View.TripDetails);\n\n    rootFrame.Navigate(navigationToPageType, navigationCommand);\n\n    // Ensure the current window is active.\n    Window.Current.Activate();\n  }\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}