{"nodes":[{"pos":[85,213],"content":"This article shows how to read and write image metadata properties and how to geotag files using the GeotagHelper utility class.","needQuote":true,"needEscape":true,"nodes":[{"content":"This article shows how to read and write image metadata properties and how to geotag files using the GeotagHelper utility class.","pos":[0,128]}]},{"pos":[221,235],"content":"Image Metadata","needQuote":true,"needEscape":true,"nodes":[{"content":"Image Metadata","pos":[0,14]}]},{"content":"Image Metadata","pos":[243,257]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[259,297]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[298,393],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"pos":[396,588],"content":"This article shows how to read and write image metadata properties and how to geotag files using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GeotagHelper<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn903683)</ept> utility class.","source":"This article shows how to read and write image metadata properties and how to geotag files using the [**GeotagHelper**](https://msdn.microsoft.com/library/windows/apps/dn903683) utility class."},{"content":"Image properties","pos":[593,609]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile.Properties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227225)</ept> property returns a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageItemContentProperties<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh770642)</ept> object that provides access to content-related information about the file.","pos":[611,888],"source":"The [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225) property returns a [**StorageItemContentProperties**](https://msdn.microsoft.com/library/windows/apps/hh770642) object that provides access to content-related information about the file."},{"content":"Get the image-specific properties by calling <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetImagePropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh770646)</ept>.","pos":[889,1022],"source":" Get the image-specific properties by calling [**GetImagePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh770646)."},{"content":"The returned <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ImageProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207718)</ept> object exposes members that contain basic image metadata fields, like the title of the image and the capture date.","pos":[1023,1230],"source":" The returned [**ImageProperties**](https://msdn.microsoft.com/library/windows/apps/br207718) object exposes members that contain basic image metadata fields, like the title of the image and the capture date."},{"pos":[1242,1260],"content":"GetImageProperties"},{"content":"To access a larger set of file metadata, use the Windows Property System, a set of file metadata properties that can be retrieved with a unique string identifier.","pos":[1331,1493]},{"content":"Create a list of strings and add the identifier for each property you want to retrieve.","pos":[1494,1581]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ImageProperties.RetrievePropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br207732)</ept> method takes this list of strings and returns a dictionary of key/value pairs where the key is the property identifier and the value is the property value.","pos":[1582,1845],"source":" The [**ImageProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br207732) method takes this list of strings and returns a dictionary of key/value pairs where the key is the property identifier and the value is the property value."},{"pos":[1857,1877],"content":"GetWindowsProperties"},{"pos":[1954,2137],"content":"For a complete list of Windows Properties, including the identifiers and type for each property, see <bpt id=\"p1\">[</bpt>Windows Properties<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/dd561977)</ept>.","source":"For a complete list of Windows Properties, including the identifiers and type for each property, see [Windows Properties](https://msdn.microsoft.com/library/windows/desktop/dd561977)."},{"content":"Some properties are only supported for certain file containers and image codecs.","pos":[2143,2223]},{"content":"For a listing of the image metadata supported for each image type, see <bpt id=\"p1\">[</bpt>Photo Metadata Policies<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/ee872003)</ept>.","pos":[2224,2382],"source":" For a listing of the image metadata supported for each image type, see [Photo Metadata Policies](https://msdn.microsoft.com/library/windows/desktop/ee872003)."},{"content":"Because properties that are unsupported may return a null value when retrieved, always check for null before using a returned metadata value.","pos":[2388,2529]},{"content":"Geotag helper","pos":[2534,2547]},{"pos":[2549,2818],"content":"GeotagHelper is a utility class that makes it easy to tag images with geographic data using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Devices.Geolocation<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225603)</ept> APIs directly, without having to manually parse or construct the metadata format.","source":"GeotagHelper is a utility class that makes it easy to tag images with geographic data using the [**Windows.Devices.Geolocation**](https://msdn.microsoft.com/library/windows/apps/br225603) APIs directly, without having to manually parse or construct the metadata format."},{"pos":[2820,3296],"content":"If you already have a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geopoint<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn263675)</ept> object representing the location you want to tag in the image, either from a previous use of the geolocation APIs or some other source, you can set the geotag data by calling <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GeotagHelper.SetGeotagAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn903685)</ept> and passing in a <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>StorageFile<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> and the <bpt id=\"p7\">**</bpt>Geopoint<ept id=\"p7\">**</ept>.","source":"If you already have a [**Geopoint**](https://msdn.microsoft.com/library/windows/apps/dn263675) object representing the location you want to tag in the image, either from a previous use of the geolocation APIs or some other source, you can set the geotag data by calling [**GeotagHelper.SetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903685) and passing in a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) and the **Geopoint**."},{"pos":[3308,3327],"content":"SetGeoDataFromPoint"},{"pos":[3399,3725],"content":"To set the geotag data using the device's current location, create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geolocator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225534)</ept> object and call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GeotagHelper.SetGeotagFromGeolocatorAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn903686)</ept> passing in the <bpt id=\"p5\">**</bpt>Geolocator<ept id=\"p5\">**</ept> and the file to be tagged.","source":"To set the geotag data using the device's current location, create a new [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object and call [**GeotagHelper.SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) passing in the **Geolocator** and the file to be tagged."},{"pos":[3737,3761],"content":"SetGeoDataFromGeolocator"},{"pos":[3842,4032],"content":"You must include the <bpt id=\"p1\">**</bpt>location<ept id=\"p1\">**</ept> device capability in your app manifest in order to use the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>SetGeotagFromGeolocatorAsync<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn903686)</ept> API.","source":"You must include the **location** device capability in your app manifest in order to use the [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) API."},{"pos":[4038,4316],"content":"You must call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn859152)</ept> before calling <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SetGeotagFromGeolocatorAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn903686)</ept> to ensure the user has granted your app permission to use their location.","source":"You must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) before calling [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) to ensure the user has granted your app permission to use their location."},{"pos":[4322,4450],"content":"For more information on the geolocation APIs, see <bpt id=\"p1\">[</bpt>Maps and location<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt219699)</ept>.","source":"For more information on the geolocation APIs, see [Maps and location](https://msdn.microsoft.com/library/windows/apps/mt219699)."},{"pos":[4452,4608],"content":"To get a GeoPoint representing the geotagged location of an image file, call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetGeotagAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn903684)</ept>.","source":"To get a GeoPoint representing the geotagged location of an image file, call [**GetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903684)."},{"pos":[4620,4630],"content":"GetGeoData"},{"content":"Decode and encode image metadata","pos":[4696,4728]},{"content":"The most advanced way of working with image data is to read and write the properties on the stream level using a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapDecoder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br226176)</ept> or a <bpt id=\"p3\">[</bpt>BitmapEncoder<ept id=\"p3\">](bitmapencoder-options-reference.md)</ept>.","pos":[4730,4978],"source":"The most advanced way of working with image data is to read and write the properties on the stream level using a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) or a [BitmapEncoder](bitmapencoder-options-reference.md)."},{"content":"For these operations you can use Windows Properties to specify the data you are reading or writing, but you can also use the metadata query language provided by the Windows Imaging Component (WIC) to specify the path to a requested property.","pos":[4979,5220]},{"content":"Reading image metadata using this technique requires you to have a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapDecoder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br226176)</ept> that was created with the source image file stream.","pos":[5222,5418],"source":"Reading image metadata using this technique requires you to have a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) that was created with the source image file stream."},{"content":"For information on how to do this, see <bpt id=\"p1\">[</bpt>Imaging<ept id=\"p1\">](imaging.md)</ept>.","pos":[5419,5480],"source":" For information on how to do this, see [Imaging](imaging.md)."},{"content":"Once you have the decoder, create a list of strings and add a new entry for each metadata property you want to retrieve, using either the Windows Property identifier string or a WIC metadata query.","pos":[5482,5679]},{"content":"Call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapPropertiesView.GetPropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br226250)</ept> method on the decoder's <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>BitmapProperties<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br226248)</ept> member to request the specified properties.","pos":[5680,5941],"source":" Call the [**BitmapPropertiesView.GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) method on the decoder's [**BitmapProperties**](https://msdn.microsoft.com/library/windows/apps/br226248) member to request the specified properties."},{"content":"The properties are returned in a dictionary of key/value pairs containing the property name or path and the property value.","pos":[5942,6065]},{"pos":[6077,6094],"content":"ReadImageMetadata"},{"pos":[6168,6357],"content":"For information on the WIC metadata query language and the properties supported, see <bpt id=\"p1\">[</bpt>WIC image format native metadata queries<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/ee719904)</ept>.","source":"For information on the WIC metadata query language and the properties supported, see [WIC image format native metadata queries](https://msdn.microsoft.com/library/windows/desktop/ee719904)."},{"content":"Many metadata properties are only supported by a subset of image types.","pos":[6363,6434]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br226250)</ept> will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the decoder and 0x88982F81 if the image does not support metadata at all.","pos":[6435,6713],"source":"[**GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the decoder and 0x88982F81 if the image does not support metadata at all."},{"content":"The constants associated with these error codes are WINCODEC\\_ERR\\_PROPERTYNOTSUPPORTED and WINCODEC\\_ERR\\_UNSUPPORTEDOPERATION and are defined in the winerror.h header file.","pos":[6714,6888]},{"pos":[6893,7087],"content":"Because an image may or may not contain a value for a particular property, use the <bpt id=\"p1\">**</bpt>IDictionary.ContainsKey<ept id=\"p1\">**</ept> to verify that a property is present in the results before attempting to access it.","source":"Because an image may or may not contain a value for a particular property, use the **IDictionary.ContainsKey** to verify that a property is present in the results before attempting to access it."},{"pos":[7089,7193],"content":"Writing image metadata to the stream requires a <bpt id=\"p1\">**</bpt>BitmapEncoder<ept id=\"p1\">**</ept> associated with the image output file.","source":"Writing image metadata to the stream requires a **BitmapEncoder** associated with the image output file."},{"content":"Create a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapPropertySet<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh974338)</ept> object to contain the property values you want set.","pos":[7195,7337],"source":"Create a [**BitmapPropertySet**](https://msdn.microsoft.com/library/windows/apps/hh974338) object to contain the property values you want set."},{"content":"Create a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapTypedValue<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700687)</ept> object to represent the property value.","pos":[7338,7467],"source":" Create a [**BitmapTypedValue**](https://msdn.microsoft.com/library/windows/apps/hh700687) object to represent the property value."},{"content":"This object uses an <bpt id=\"p1\">**</bpt>object<ept id=\"p1\">**</ept> as the value and member of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>PropertyType<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br225871)</ept> enumeration that defines the type of the value.","pos":[7468,7654],"source":" This object uses an **object** as the value and member of the [**PropertyType**](https://msdn.microsoft.com/library/windows/apps/br225871) enumeration that defines the type of the value."},{"content":"Add the <bpt id=\"p1\">**</bpt>BitmapTypedValue<ept id=\"p1\">**</ept> to the <bpt id=\"p2\">**</bpt>BitmapPropertySet<ept id=\"p2\">**</ept> and then call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>BitmapProperties.SetPropertiesAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br226252)</ept> to cause the encoder to write the properties to the stream.","pos":[7655,7886],"source":" Add the **BitmapTypedValue** to the **BitmapPropertySet** and then call [**BitmapProperties.SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) to cause the encoder to write the properties to the stream."},{"pos":[7898,7916],"content":"WriteImageMetadata"},{"pos":[7991,8348],"content":"For details on which properties are supported for which image file types, see <bpt id=\"p1\">[</bpt>Windows Properties<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/dd561977)</ept>, <bpt id=\"p2\">[</bpt>Photo Metadata Policies<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/desktop/ee872003)</ept>, and <bpt id=\"p3\">[</bpt>WIC image format native metadata queries<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/desktop/ee719904)</ept>.","source":"For details on which properties are supported for which image file types, see [Windows Properties](https://msdn.microsoft.com/library/windows/desktop/dd561977), [Photo Metadata Policies](https://msdn.microsoft.com/library/windows/desktop/ee872003), and [WIC image format native metadata queries](https://msdn.microsoft.com/library/windows/desktop/ee719904)."},{"pos":[8354,8571],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetPropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br226252)</ept> will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the encoder.","source":"[**SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the encoder."},{"content":"Related topics","pos":[8576,8590]},{"content":"Imaging","pos":[8595,8602]}],"content":"---\nauthor: drewbatgit\nms.assetid: D5D98044-7221-4C2A-9724-56E59F341AB0\ndescription: This article shows how to read and write image metadata properties and how to geotag files using the GeotagHelper utility class.\ntitle: Image Metadata\n---\n\n# Image Metadata\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nThis article shows how to read and write image metadata properties and how to geotag files using the [**GeotagHelper**](https://msdn.microsoft.com/library/windows/apps/dn903683) utility class.\n\n## Image properties\n\nThe [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225) property returns a [**StorageItemContentProperties**](https://msdn.microsoft.com/library/windows/apps/hh770642) object that provides access to content-related information about the file. Get the image-specific properties by calling [**GetImagePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh770646). The returned [**ImageProperties**](https://msdn.microsoft.com/library/windows/apps/br207718) object exposes members that contain basic image metadata fields, like the title of the image and the capture date.\n\n[!code-cs[GetImageProperties](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetGetImageProperties)]\n\nTo access a larger set of file metadata, use the Windows Property System, a set of file metadata properties that can be retrieved with a unique string identifier. Create a list of strings and add the identifier for each property you want to retrieve. The [**ImageProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br207732) method takes this list of strings and returns a dictionary of key/value pairs where the key is the property identifier and the value is the property value.\n\n[!code-cs[GetWindowsProperties](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetGetWindowsProperties)]\n\n-   For a complete list of Windows Properties, including the identifiers and type for each property, see [Windows Properties](https://msdn.microsoft.com/library/windows/desktop/dd561977).\n\n-   Some properties are only supported for certain file containers and image codecs. For a listing of the image metadata supported for each image type, see [Photo Metadata Policies](https://msdn.microsoft.com/library/windows/desktop/ee872003).\n\n-   Because properties that are unsupported may return a null value when retrieved, always check for null before using a returned metadata value.\n\n## Geotag helper\n\nGeotagHelper is a utility class that makes it easy to tag images with geographic data using the [**Windows.Devices.Geolocation**](https://msdn.microsoft.com/library/windows/apps/br225603) APIs directly, without having to manually parse or construct the metadata format.\n\nIf you already have a [**Geopoint**](https://msdn.microsoft.com/library/windows/apps/dn263675) object representing the location you want to tag in the image, either from a previous use of the geolocation APIs or some other source, you can set the geotag data by calling [**GeotagHelper.SetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903685) and passing in a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) and the **Geopoint**.\n\n[!code-cs[SetGeoDataFromPoint](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetSetGeoDataFromPoint)]\n\nTo set the geotag data using the device's current location, create a new [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object and call [**GeotagHelper.SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) passing in the **Geolocator** and the file to be tagged.\n\n[!code-cs[SetGeoDataFromGeolocator](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetSetGeoDataFromGeolocator)]\n\n-   You must include the **location** device capability in your app manifest in order to use the [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) API.\n\n-   You must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) before calling [**SetGeotagFromGeolocatorAsync**](https://msdn.microsoft.com/library/windows/apps/dn903686) to ensure the user has granted your app permission to use their location.\n\n-   For more information on the geolocation APIs, see [Maps and location](https://msdn.microsoft.com/library/windows/apps/mt219699).\n\nTo get a GeoPoint representing the geotagged location of an image file, call [**GetGeotagAsync**](https://msdn.microsoft.com/library/windows/apps/dn903684).\n\n[!code-cs[GetGeoData](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetGetGeoData)]\n\n## Decode and encode image metadata\n\nThe most advanced way of working with image data is to read and write the properties on the stream level using a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) or a [BitmapEncoder](bitmapencoder-options-reference.md). For these operations you can use Windows Properties to specify the data you are reading or writing, but you can also use the metadata query language provided by the Windows Imaging Component (WIC) to specify the path to a requested property.\n\nReading image metadata using this technique requires you to have a [**BitmapDecoder**](https://msdn.microsoft.com/library/windows/apps/br226176) that was created with the source image file stream. For information on how to do this, see [Imaging](imaging.md).\n\nOnce you have the decoder, create a list of strings and add a new entry for each metadata property you want to retrieve, using either the Windows Property identifier string or a WIC metadata query. Call the [**BitmapPropertiesView.GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) method on the decoder's [**BitmapProperties**](https://msdn.microsoft.com/library/windows/apps/br226248) member to request the specified properties. The properties are returned in a dictionary of key/value pairs containing the property name or path and the property value.\n\n[!code-cs[ReadImageMetadata](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetReadImageMetadata)]\n\n-   For information on the WIC metadata query language and the properties supported, see [WIC image format native metadata queries](https://msdn.microsoft.com/library/windows/desktop/ee719904).\n\n-   Many metadata properties are only supported by a subset of image types. [**GetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226250) will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the decoder and 0x88982F81 if the image does not support metadata at all. The constants associated with these error codes are WINCODEC\\_ERR\\_PROPERTYNOTSUPPORTED and WINCODEC\\_ERR\\_UNSUPPORTEDOPERATION and are defined in the winerror.h header file.\n-   Because an image may or may not contain a value for a particular property, use the **IDictionary.ContainsKey** to verify that a property is present in the results before attempting to access it.\n\nWriting image metadata to the stream requires a **BitmapEncoder** associated with the image output file.\n\nCreate a [**BitmapPropertySet**](https://msdn.microsoft.com/library/windows/apps/hh974338) object to contain the property values you want set. Create a [**BitmapTypedValue**](https://msdn.microsoft.com/library/windows/apps/hh700687) object to represent the property value. This object uses an **object** as the value and member of the [**PropertyType**](https://msdn.microsoft.com/library/windows/apps/br225871) enumeration that defines the type of the value. Add the **BitmapTypedValue** to the **BitmapPropertySet** and then call [**BitmapProperties.SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) to cause the encoder to write the properties to the stream.\n\n[!code-cs[WriteImageMetadata](./code/ImagingWin10/cs/MainPage.xaml.cs#SnippetWriteImageMetadata)]\n\n-   For details on which properties are supported for which image file types, see [Windows Properties](https://msdn.microsoft.com/library/windows/desktop/dd561977), [Photo Metadata Policies](https://msdn.microsoft.com/library/windows/desktop/ee872003), and [WIC image format native metadata queries](https://msdn.microsoft.com/library/windows/desktop/ee719904).\n\n-   [**SetPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br226252) will fail with the error code 0x88982F41 if one of the requested properties is not supported by the image associated with the encoder.\n\n## Related topics\n\n* [Imaging](imaging.md)\n \n\n \n\n\n\n\n"}