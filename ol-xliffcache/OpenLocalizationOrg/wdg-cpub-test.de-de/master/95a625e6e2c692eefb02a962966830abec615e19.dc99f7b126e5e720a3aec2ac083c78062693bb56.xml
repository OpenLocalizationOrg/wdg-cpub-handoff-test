{"nodes":[{"pos":[17,258],"content":"In addition to using voice commands within Cortana to access system features, you can also extend Cortana with features and functionality from a background app using voice commands that specify an action or command to execute within the app.","needQuote":true,"needEscape":true,"nodes":[{"content":"In addition to using voice commands within Cortana to access system features, you can also extend Cortana with features and functionality from a background app using voice commands that specify an action or command to execute within the app.","pos":[0,241]}]},{"pos":[266,320],"content":"Launch a background app with voice commands in Cortana","needQuote":true,"needEscape":true,"nodes":[{"content":"Launch a background app with voice commands in Cortana","pos":[0,54]}]},{"content":"Launch a background app with voice commands in Cortana","pos":[429,483]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[486,524]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[525,620],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[625,639]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[650,688]},{"content":"VCD elements and attributes v1.2","pos":[757,789]},{"content":"In addition to using voice commands within <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> to access system features, you can also extend <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> with features and functionality from a background app using voice commands that specify an action or command to execute within the app.","pos":[852,1101],"source":"In addition to using voice commands within **Cortana** to access system features, you can also extend **Cortana** with features and functionality from a background app using voice commands that specify an action or command to execute within the app."},{"content":"When an app handles a voice command in the background, it can display feedback on the <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> canvas and communicate with the user using the <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> voice.","pos":[1102,1265],"source":" When an app handles a voice command in the background, it can display feedback on the **Cortana** canvas and communicate with the user using the **Cortana** voice."},{"content":"Note","pos":[1269,1273]},{"content":"A voice command is a single utterance with a specific intent, defined in a Voice Command Definition (VCD) file, directed at an installed app through <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept>.","pos":[1278,1439],"source":"A voice command is a single utterance with a specific intent, defined in a Voice Command Definition (VCD) file, directed at an installed app through **Cortana**."},{"content":"A voice command definition can vary in complexity.","pos":[1441,1491]},{"content":"It can support anything from a single, constrained utterance to a collection of more flexible, natural language utterances, all denoting the same intent.","pos":[1492,1645]},{"content":"A VCD file defines one or more voice commands, each with a unique intent.","pos":[1647,1720]},{"content":"The target app can be launched in the foreground (the app takes focus) or activated in the background (<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> retains focus but provides results from the app), depending on the complexity of the interaction.","pos":[1722,1934],"source":"The target app can be launched in the foreground (the app takes focus) or activated in the background (**Cortana** retains focus but provides results from the app), depending on the complexity of the interaction."},{"content":"For example, voice commands that require additional context or user input (such as sending a message to a specific contact) are best handled in a foreground app, while basic commands can be handled in <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> through a background app.","pos":[1935,2173],"source":" For example, voice commands that require additional context or user input (such as sending a message to a specific contact) are best handled in a foreground app, while basic commands can be handled in **Cortana** through a background app."},{"pos":[2178,2368],"content":"We demonstrate these features here with a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">[</bpt>Cortana voice command sample<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkID=619899)</ept>.","source":"We demonstrate these features here with a trip planning and management app named **Adventure Works** from the [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)."},{"pos":[2370,2459],"content":"Here's an overview of the <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> app integrated with the <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> canvas.","source":"Here's an overview of the **Adventure Works** app integrated with the **Cortana** canvas."},{"content":"cortana canvas overview","pos":[2463,2486]},{"pos":[2519,2648],"content":"To view an <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> trip without <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept>, a user would launch the app and navigate to the <bpt id=\"p3\">**</bpt>Upcoming trips<ept id=\"p3\">**</ept> page.","source":"To view an **Adventure Works** trip without **Cortana**, a user would launch the app and navigate to the **Upcoming trips** page."},{"content":"Using voice commands through <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> to launch your app in the background, the user can instead just say, \"Adventure Works, when is my trip to Las Vegas?\".","pos":[2650,2809],"source":"Using voice commands through **Cortana** to launch your app in the background, the user can instead just say, \"Adventure Works, when is my trip to Las Vegas?\"."},{"content":"Your app handles the command and <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> displays results along with your app icon and other app info, if provided.","pos":[2810,2929],"source":" Your app handles the command and **Cortana** displays results along with your app icon and other app info, if provided."},{"content":"Here's an example of a basic trip query and <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> result screen that both shows and speaks \"Your next trip to Las Vegas is on August 1st\".","pos":[2930,3074],"source":" Here's an example of a basic trip query and **Cortana** result screen that both shows and speaks \"Your next trip to Las Vegas is on August 1st\"."},{"content":"a basic query and result screen using the adventure works app in the background","pos":[3078,3157]},{"pos":[3201,3360],"content":"These are the basic steps to add voice-command functionality and extend <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> with background functionality from your app using speech or keyboard input:","source":"These are the basic steps to add voice-command functionality and extend **Cortana** with background functionality from your app using speech or keyboard input:"},{"pos":[3366,3537],"content":"Create an app service (see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.ApplicationModel.AppService<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn921731)</ept>) that <bpt id=\"p3\">**</bpt>Cortana<ept id=\"p3\">**</ept> invokes in the background.","source":"Create an app service (see [**Windows.ApplicationModel.AppService**](https://msdn.microsoft.com/library/windows/apps/dn921731)) that **Cortana** invokes in the background."},{"content":"Create a VCD file.","pos":[3542,3560]},{"content":"This is an XML document that defines all the spoken commands that the user can say to initiate actions or invoke commands when activating your app.","pos":[3561,3708]},{"content":"See <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD elements and attributes v1.2<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept>.","pos":[3709,3810],"source":" See [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)."},{"content":"Register the command sets in the VCD file when the app is launched.","pos":[3815,3882]},{"content":"Handle the background activation of the app service and the execution of the voice command.","pos":[3887,3978]},{"pos":[3983,4066],"content":"Display and speak the appropriate feedback to the voice command within <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept>.","source":"Display and speak the appropriate feedback to the voice command within **Cortana**."},{"content":"**Prerequisites:  **","pos":[4068,4088]},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[4090,4243]},{"content":"Create your first app","pos":[4250,4271]},{"pos":[4335,4452],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>","source":"Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)"},{"content":"**User experience guidelines:  **","pos":[4454,4487]},{"pos":[4489,4797],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app.","source":"See [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[5042,5103],"content":"Create a new solution with a primary project in Visual Studio"},{"content":"Launch Microsoft Visual Studio 2015.","pos":[5110,5146]},{"content":"The Visual Studio 2015 Start page appears.","pos":[5152,5194]},{"pos":[5200,5254],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>.","source":"On the **File** menu, select **New** &gt; **Project**."},{"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog appears.","pos":[5260,5295],"source":"The **New Project** dialog appears."},{"content":"The left pane of the dialog lets you select the type of templates to display.","pos":[5296,5373]},{"content":"In the left pane, expand <bpt id=\"p1\">**</bpt>Installed <ph id=\"ph1\">&amp;gt;</ph> Templates <ph id=\"ph2\">&amp;gt;</ph> Visual C# <ph id=\"ph3\">&amp;gt;</ph> Windows<ept id=\"p1\">**</ept>, then pick the <bpt id=\"p2\">**</bpt>Universal<ept id=\"p2\">**</ept> template group.","pos":[5379,5505],"source":"In the left pane, expand **Installed &gt; Templates &gt; Visual C# &gt; Windows**, then pick the **Universal** template group."},{"content":"The dialog's center pane displays a list of project templates for Universal Windows Platform (UWP) apps.","pos":[5506,5610]},{"pos":[5615,5689],"content":"In the center pane, select the <bpt id=\"p1\">**</bpt>Blank App (Universal Windows)<ept id=\"p1\">**</ept> template.","source":"In the center pane, select the **Blank App (Universal Windows)** template."},{"content":"The <bpt id=\"p1\">**</bpt>Blank App<ept id=\"p1\">**</ept> template creates a minimal UWP app that compiles and runs, but contains no user-interface controls or data.","pos":[5695,5820],"source":"The **Blank App** template creates a minimal UWP app that compiles and runs, but contains no user-interface controls or data."},{"content":"You add controls to the app over the course of this tutorial.","pos":[5821,5882]},{"pos":[5888,5937],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> text box, type your project name.","source":"In the **Name** text box, type your project name."},{"pos":[5942,5977],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the project.","source":"Click **OK** to create the project."},{"pos":[5983,6073],"content":"Microsoft Visual Studio creates your project and displays it in the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>.","source":"Microsoft Visual Studio creates your project and displays it in the **Solution Explorer**."},{"pos":[6222,6251],"content":"Create an app service project"},{"content":"Right-click your Solution name, select Add-<ph id=\"ph1\">&amp;gt;</ph>New Project, and then select <bpt id=\"p1\">**</bpt>Windows Runtime Component<ept id=\"p1\">**</ept>.","pos":[6258,6364],"source":"Right-click your Solution name, select Add-&gt;New Project, and then select **Windows Runtime Component**."},{"content":"This is the component that will implement the app service (see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.ApplicationModel.AppService<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn921731)</ept>).","pos":[6365,6529],"source":" This is the component that will implement the app service (see [**Windows.ApplicationModel.AppService**](https://msdn.microsoft.com/library/windows/apps/dn921731))."},{"pos":[6534,6616],"content":"Type a name for the project (for example, \"VoiceCommandService\") and click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Type a name for the project (for example, \"VoiceCommandService\") and click **OK**."},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, select the \"VoiceCommandService\" project and rename the \"Class1.cs\" file generated by Visual Studio.","pos":[6621,6747],"source":"In **Solution Explorer**, select the \"VoiceCommandService\" project and rename the \"Class1.cs\" file generated by Visual Studio."},{"content":"For example, \"YourAppVoiceCommandService.cs\".","pos":[6748,6793]},{"content":"In the \"YourAppVoiceCommandService.cs\" file, add the following using directive.","pos":[6798,6877]},{"content":"Create a new class that implements the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IBackgroundTask<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224794)</ept> interface.","pos":[6998,7127],"source":"Create a new class that implements the [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794) interface."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224811)</ept> method of this class is the required entry point, called when <bpt id=\"p3\">**</bpt>Cortana<ept id=\"p3\">**</ept> recognizes the voice command.","pos":[7128,7303],"source":" The [**Run**](https://msdn.microsoft.com/library/windows/apps/br224811) method of this class is the required entry point, called when **Cortana** recognizes the voice command."},{"pos":[7309,7440],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The background task class itself, and all other classes in the background task project, need to be sealed public classes.","source":"**Note**  The background task class itself, and all other classes in the background task project, need to be sealed public classes."},{"pos":[7453,7522],"content":"Here's a basic background task class for the <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> app.","source":"Here's a basic background task class for the **Adventure Works** app."},{"content":"Note that we've renamed the default namespace assigned by Visual Studio.","pos":[7528,7600]},{"pos":[8319,8389],"content":"Declare your background task as an <bpt id=\"p1\">**</bpt>AppService<ept id=\"p1\">**</ept> in the app manifest.","source":"Declare your background task as an **AppService** in the app manifest."},{"pos":[8399,8494],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right click the \"Package.appxmanifest\" file and select <bpt id=\"p2\">**</bpt>View Code<ept id=\"p2\">**</ept>.","source":"In **Solution Explorer**, right click the \"Package.appxmanifest\" file and select **View Code**."},{"pos":[8503,8600],"content":"Find the <bpt id=\"p1\">[</bpt>****Application****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn934738)</ept> element.","source":"Find the [****Application****](https://msdn.microsoft.com/library/windows/apps/dn934738) element."},{"pos":[8609,8798],"content":"Add an <bpt id=\"p1\">[</bpt>****Extensions****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn934720)</ept> element to the <bpt id=\"p2\">[</bpt>****Application****<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn934738)</ept> element.","source":"Add an [****Extensions****](https://msdn.microsoft.com/library/windows/apps/dn934720) element to the [****Application****](https://msdn.microsoft.com/library/windows/apps/dn934738) element."},{"pos":[8807,8997],"content":"Add a <bpt id=\"p1\">[</bpt>****uap:Extension****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986788)</ept> element to the <bpt id=\"p2\">[</bpt>****Extensions****<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn934720)</ept> element.","source":"Add a [****uap:Extension****](https://msdn.microsoft.com/library/windows/apps/dn986788) element to the [****Extensions****](https://msdn.microsoft.com/library/windows/apps/dn934720) element."},{"pos":[9006,9140],"content":"Add a <bpt id=\"p1\">**</bpt>Category<ept id=\"p1\">**</ept> attribute to the <bpt id=\"p2\">**</bpt>uap:Extension<ept id=\"p2\">**</ept> element and set the value of the <bpt id=\"p3\">**</bpt>Category<ept id=\"p3\">**</ept> attribute to \"windows.appService\".","source":"Add a **Category** attribute to the **uap:Extension** element and set the value of the **Category** attribute to \"windows.appService\"."},{"pos":[9149,9464],"content":"Add an <bpt id=\"p1\">**</bpt>EntryPoint<ept id=\"p1\">**</ept> attribute to the <bpt id=\"p2\">**</bpt>uap:Extension<ept id=\"p2\">**</ept> element and set the value of the <bpt id=\"p3\">**</bpt>EntryPoint<ept id=\"p3\">**</ept> attribute to the name of the class that implements <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>IBackgroundTask<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br224794)</ept>, in this case \"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService\".","source":"Add an **EntryPoint** attribute to the **uap:Extension** element and set the value of the **EntryPoint** attribute to the name of the class that implements [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794), in this case \"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService\"."},{"pos":[9473,9603],"content":"Add a <bpt id=\"p1\">[</bpt>****uap:AppService****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn934779)</ept> element to the <bpt id=\"p2\">**</bpt>uap:Extension<ept id=\"p2\">**</ept> element.","source":"Add a [****uap:AppService****](https://msdn.microsoft.com/library/windows/apps/dn934779) element to the **uap:Extension** element."},{"pos":[9612,9859],"content":"Add a <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> attribute to the <bpt id=\"p2\">[</bpt>****uap:AppService****<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn934779)</ept> element and set the value of the <bpt id=\"p3\">**</bpt>Name<ept id=\"p3\">**</ept> attribute to a name for the app service, in this case \"AdventureWorksVoiceCommandService\".","source":"Add a **Name** attribute to the [****uap:AppService****](https://msdn.microsoft.com/library/windows/apps/dn934779) element and set the value of the **Name** attribute to a name for the app service, in this case \"AdventureWorksVoiceCommandService\"."},{"pos":[10522,10539],"content":"Create a VCD file"},{"pos":[10546,10658],"content":"In Visual Studio, right-click your primary project name, select Add-<ph id=\"ph1\">&amp;gt;</ph>New Item, and then select <bpt id=\"p1\">**</bpt>Text File<ept id=\"p1\">**</ept>.","source":"In Visual Studio, right-click your primary project name, select Add-&gt;New Item, and then select **Text File**."},{"content":"Type a name for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file and be sure to append the \".xml\" file extension.","pos":[10663,10804],"source":"Type a name for the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file and be sure to append the \".xml\" file extension."},{"content":"For example, \"AdventureWorksCommands.xml\".","pos":[10805,10847]},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[10848,10862],"source":" Click **Add**."},{"pos":[10867,10977],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, select the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VCD<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file.","source":"In **Solution Explorer**, select the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file."},{"pos":[10982,11112],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set <bpt id=\"p2\">**</bpt>Build action<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Content<ept id=\"p3\">**</ept>, and then set <bpt id=\"p4\">**</bpt>Copy to output directory<ept id=\"p4\">**</ept> to <bpt id=\"p5\">**</bpt>Copy if newer<ept id=\"p5\">**</ept>.","source":"In the **Properties** window, set **Build action** to **Content**, and then set **Copy to output directory** to **Copy if newer**."},{"pos":[11225,11242],"content":"Edit the VCD file"},{"pos":[11245,11353],"content":"For each language supported by your app, create a <bpt id=\"p1\">**</bpt>CommandSet<ept id=\"p1\">**</ept> of voice commands that your app can handle.","source":"For each language supported by your app, create a **CommandSet** of voice commands that your app can handle."},{"pos":[11355,11489],"content":"Each <bpt id=\"p1\">**</bpt>Command<ept id=\"p1\">**</ept> declared in a <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VCD<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file must include this information:","source":"Each **Command** declared in a [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file must include this information:"},{"content":"A command Name used by the application to identify the voice command at runtime","pos":[11495,11574]},{"content":"An <bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept> element that contains a phrase describing how a user can invoke the command.","pos":[11579,11670],"source":"An **Example** element that contains a phrase describing how a user can invoke the command."},{"content":"<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> shows this example when the user says \"What can I say?\", \"Help\", or they tap <bpt id=\"p2\">**</bpt>See more<ept id=\"p2\">**</ept>.","pos":[11671,11773],"source":"**Cortana** shows this example when the user says \"What can I say?\", \"Help\", or they tap **See more**."},{"content":"see","pos":[11779,11782]},{"content":"A <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element that contains the words or phrases that your app recognizes to initiate a command.","pos":[11788,11894],"source":"A **ListenFor** element that contains the words or phrases that your app recognizes to initiate a command."},{"content":"Each command needs to have at least one <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element.","pos":[11895,11957],"source":" Each command needs to have at least one **ListenFor** element."},{"pos":[11962,12076],"content":"A <bpt id=\"p1\">**</bpt>Feedback<ept id=\"p1\">**</ept> element that contains the text for <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> to display and speak as the application is launched.","source":"A **Feedback** element that contains the text for **Cortana** to display and speak as the application is launched."},{"pos":[12081,12180],"content":"A <bpt id=\"p1\">**</bpt>VoiceCommandService<ept id=\"p1\">**</ept> element to indicate the voice command launches the app in the background.","source":"A **VoiceCommandService** element to indicate the voice command launches the app in the background."},{"pos":[12182,12314],"content":"For more detail, see the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD elements and attributes v1.2<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> reference.","source":"For more detail, see the [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593) reference."},{"content":"You can specify multiple language versions for the commands used to activate your app and execute a command.","pos":[12316,12424]},{"content":"You can create multiple <bpt id=\"p1\">[</bpt>****CommandSet****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> elements, each with a different <bpt id=\"p2\">[</bpt>****xml:lang****<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> attribute to allow your app to be used in different markets.","pos":[12425,12697],"source":" You can create multiple [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) elements, each with a different [****xml:lang****](https://msdn.microsoft.com/library/windows/apps/dn722331) attribute to allow your app to be used in different markets."},{"content":"For example, an app for the United States might have a <bpt id=\"p1\">[</bpt>****CommandSet****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> for English and a <bpt id=\"p2\">[</bpt>****CommandSet****<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> for Spanish.","pos":[12698,12941],"source":" For example, an app for the United States might have a [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) for English and a [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) for Spanish."},{"content":"Caution","pos":[12945,12952]},{"content":"To activate an app and initiate an action using a voice command, the app must register a VCD file that contains a <bpt id=\"p1\">[</bpt>****CommandSet****<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> with a language that matches the speech language that the user selected on their device.","pos":[12957,13238],"source":"To activate an app and initiate an action using a voice command, the app must register a VCD file that contains a [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) with a language that matches the speech language that the user selected on their device."},{"content":"This language is set by the user on the device Settings <ph id=\"ph1\">&amp;gt;</ph> System <ph id=\"ph2\">&amp;gt;</ph> Speech <ph id=\"ph3\">&amp;gt;</ph> Speech Language screen.","pos":[13239,13347],"source":" This language is set by the user on the device Settings &gt; System &gt; Speech &gt; Speech Language screen."},{"pos":[13352,13495],"content":"Here's a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file that defines a voice command for the <bpt id=\"p3\">**</bpt>Adventure Works<ept id=\"p3\">**</ept> app.","source":"Here's a [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file that defines a voice command for the **Adventure Works** app."},{"pos":[13497,13957],"content":"For this example, <bpt id=\"p1\">**</bpt>CommandPrefix<ept id=\"p1\">**</ept> is set to \"Adventure Works\", <bpt id=\"p2\">**</bpt>Command<ept id=\"p2\">**</ept> is set to \"whenIsTripToDestination\", <bpt id=\"p3\">**</bpt>ListenFor<ept id=\"p3\">**</ept> specifies the text that can be recognized (with a reference to a <bpt id=\"p4\">**</bpt>PhraseList<ept id=\"p4\">**</ept> element that constrains the recognized destinations), <bpt id=\"p5\">**</bpt>VoiceCommandService<ept id=\"p5\">**</ept> indicates that the voice command is handled by an app service in the background, and <bpt id=\"p6\">**</bpt>Feedback<ept id=\"p6\">**</ept> specifies what the user will hear when <bpt id=\"p7\">**</bpt>Cortana<ept id=\"p7\">**</ept> launches the app service.","source":"For this example, **CommandPrefix** is set to \"Adventure Works\", **Command** is set to \"whenIsTripToDestination\", **ListenFor** specifies the text that can be recognized (with a reference to a **PhraseList** element that constrains the recognized destinations), **VoiceCommandService** indicates that the voice command is handled by an app service in the background, and **Feedback** specifies what the user will hear when **Cortana** launches the app service."},{"content":"The value of the <bpt id=\"p1\">**</bpt>Target<ept id=\"p1\">**</ept> attribute of the <bpt id=\"p2\">**</bpt>VoiceCommandService<ept id=\"p2\">**</ept> element needs to be the name of the app service as specified in the <bpt id=\"p3\">[</bpt>****uap:AppService****<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn934779)</ept> element of the package.appxmanifest.","pos":[13959,14215],"source":"The value of the **Target** attribute of the **VoiceCommandService** element needs to be the name of the app service as specified in the [****uap:AppService****](https://msdn.microsoft.com/library/windows/apps/dn934779) element of the package.appxmanifest."},{"content":"In this example, the name of the app service is \"AdventureWorksVoiceCommandService\".","pos":[14216,14300]},{"pos":[14302,14443],"content":"The \"whenIsTripToDestination\" command has a <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element with a reference to a <bpt id=\"p2\">**</bpt>PhraseList<ept id=\"p2\">**</ept> for a constrained set of destinations.","source":"The \"whenIsTripToDestination\" command has a **ListenFor** element with a reference to a **PhraseList** for a constrained set of destinations."},{"content":"<bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> elements cannot be programmatically modified.","pos":[14445,14504],"source":"**ListenFor** elements cannot be programmatically modified."},{"content":"However, <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> elements associated with <bpt id=\"p2\">**</bpt>ListenFor<ept id=\"p2\">**</ept> elements can be programmatically modified.","pos":[14505,14610],"source":" However, **PhraseList** elements associated with **ListenFor** elements can be programmatically modified."},{"content":"Applications should modify the content of the <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> at runtime based on the data set generated as the user uses the app.","pos":[14611,14740],"source":" Applications should modify the content of the **PhraseList** at runtime based on the data set generated as the user uses the app."},{"content":"See <bpt id=\"p1\">[</bpt>Dynamically modify Voice Command Definition (VCD) phrase lists<ept id=\"p1\">](dynamically-modify-voice-command-definition--vcd--phrase-lists.md)</ept>.","pos":[14741,14877],"source":" See [Dynamically modify Voice Command Definition (VCD) phrase lists](dynamically-modify-voice-command-definition--vcd--phrase-lists.md)."},{"pos":[16853,16877],"content":"Install the VCD commands"},{"content":"Your app must run once to install the command sets in the VCD.","pos":[16880,16942]},{"pos":[16944,17236],"content":"When your app is activated, call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>InstallCommandDefinitionsFromStorageFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn708205)</ept> in the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>OnLaunched<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept> handler to register the commands that the system should listen for.","source":"When your app is activated, call [**InstallCommandDefinitionsFromStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn708205) in the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) handler to register the commands that the system should listen for."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If a device backup occurs and your app reinstalls automatically, voice command data is not preserved.","pos":[17238,17349],"source":"**Note**  If a device backup occurs and your app reinstalls automatically, voice command data is not preserved."},{"content":"To ensure the voice command data for your app stays intact, consider initializing your VCD file each time your app launches or activates, or store a setting that indicates if the VCD is currently installed and check the setting each time your app launches or activates.","pos":[17350,17619]},{"pos":[17624,17742],"content":"In this example, we first define a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> object.","source":"In this example, we first define a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object."},{"pos":[17744,17894],"content":"We then call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227272)</ept> to initialize it with our \"AdventureWorksCommands.xml\" file.","source":"We then call [**GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227272) to initialize it with our \"AdventureWorksCommands.xml\" file."},{"pos":[17896,18112],"content":"This <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> object is then passed to <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>InstallCommandDefinitionsFromStorageFileAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn708205)</ept>.","source":"This [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object is then passed to [**InstallCommandDefinitionsFromStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn708205)."},{"pos":[18774,18817],"content":"Handle the voice command in the app service"},{"content":"Specify in the app service how your app responds to voice-command activations after it has launched and the voice command sets have been installed.","pos":[18820,18967]},{"content":"Take a service deferral so your app service is not terminated while handling the voice command.","pos":[18973,19068]},{"content":"Confirm that your background task is running as an app service activated by a voice command.","pos":[19073,19165]},{"pos":[19175,19415],"content":"Cast the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IBackgroundTaskInstance.TriggerDetails<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224802)</ept> to <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.ApplicationModel.AppService.AppServiceTriggerDetails<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn921727)</ept>.","source":"Cast the [**IBackgroundTaskInstance.TriggerDetails**](https://msdn.microsoft.com/library/windows/apps/br224802) to [**Windows.ApplicationModel.AppService.AppServiceTriggerDetails**](https://msdn.microsoft.com/library/windows/apps/dn921727)."},{"pos":[19424,19609],"content":"Check that <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IBackgroundTaskInstance.TriggerDetails.Name<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224807)</ept> is the name of the app service in the \"Package.appxmanifest\" file.","source":"Check that [**IBackgroundTaskInstance.TriggerDetails.Name**](https://msdn.microsoft.com/library/windows/apps/br224807) is the name of the app service in the \"Package.appxmanifest\" file."},{"pos":[19615,19873],"content":"Use <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IBackgroundTaskInstance.TriggerDetails<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224802)</ept> to create a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandServiceConnection<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> to <bpt id=\"p5\">**</bpt>Cortana<ept id=\"p5\">**</ept> to retrieve the voice command.","source":"Use [**IBackgroundTaskInstance.TriggerDetails**](https://msdn.microsoft.com/library/windows/apps/br224802) to create a [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) to **Cortana** to retrieve the voice command."},{"pos":[19878,20170],"content":"Register an event handler for <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandServiceConnection<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept>.<bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandCompleted<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn706584)</ept> to receive notification when the app service is closed due to a user cancellation.","source":"Register an event handler for [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204).[**VoiceCommandCompleted**](https://msdn.microsoft.com/library/windows/apps/dn706584) to receive notification when the app service is closed due to a user cancellation."},{"pos":[20175,20390],"content":"Register an event handler for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IBackgroundTaskInstance.Canceled<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224798)</ept> to receive notification when the app service is closed due to an unexpected failure.","source":"Register an event handler for the [**IBackgroundTaskInstance.Canceled**](https://msdn.microsoft.com/library/windows/apps/br224798) to receive notification when the app service is closed due to an unexpected failure."},{"content":"Determine the name of the command and what was spoken.","pos":[20395,20449]},{"pos":[20459,20672],"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommand<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974162)</ept>.<bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>CommandName<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn706589)</ept> property to determine the name of the voice command.","source":"Use the [**VoiceCommand**](https://msdn.microsoft.com/library/windows/apps/dn974162).[**CommandName**](https://msdn.microsoft.com/library/windows/apps/dn706589) property to determine the name of the voice command."},{"pos":[20681,20976],"content":"To determine what the user said, check the value of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Text<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn631441)</ept> or the semantic properties of the recognized phrase in the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SpeechRecognitionSemanticInterpretation<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn631443)</ept> dictionary.","source":"To determine what the user said, check the value of [**Text**](https://msdn.microsoft.com/library/windows/apps/dn631441) or the semantic properties of the recognized phrase in the [**SpeechRecognitionSemanticInterpretation**](https://msdn.microsoft.com/library/windows/apps/dn631443) dictionary."},{"content":"Take the appropriate action in your app service.","pos":[20982,21030]},{"pos":[21035,21104],"content":"Display and speak the feedback to the voice command with <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept>.","source":"Display and speak the feedback to the voice command with **Cortana**."},{"content":"Determine the strings that you want <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> to display and speak to the user in response to the voice command and create a <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VoiceCommandResponse<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> object.","pos":[21114,21333],"source":"Determine the strings that you want **Cortana** to display and speak to the user in response to the voice command and create a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object."},{"content":"For guidance on how to select the feedback strings that <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> shows and speaks, see <bpt id=\"p2\">[</bpt>Cortana design guidelines<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept>.","pos":[21334,21510],"source":" For guidance on how to select the feedback strings that **Cortana** shows and speaks, see [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)."},{"pos":[21519,21909],"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandServiceConnection<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> instance to report progress or completion to <bpt id=\"p3\">**</bpt>Cortana<ept id=\"p3\">**</ept> by calling <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>ReportProgressAsync<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn706579)</ept> or <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>ReportSuccessAsync<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept> with the <bpt id=\"p8\">**</bpt>VoiceCommandServiceConnection<ept id=\"p8\">**</ept> object.","source":"Use the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) instance to report progress or completion to **Cortana** by calling [**ReportProgressAsync**](https://msdn.microsoft.com/library/windows/apps/dn706579) or [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) with the **VoiceCommandServiceConnection** object."},{"content":"For this example, we refer back to the VCD in Step 3: Edit the VCD file.","pos":[21915,21987]},{"content":"Once launched, the app service has .5 seconds to call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ReportSuccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept>.","pos":[26902,27039],"source":"Once launched, the app service has .5 seconds to call [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580)."},{"content":"<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> uses the data provided by the app to show and say the feedback specified in the VCD file.","pos":[27040,27141],"source":"**Cortana** uses the data provided by the app to show and say the feedback specified in the VCD file."},{"content":"If the app takes longer than .5 seconds to make the call, <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> inserts a hand-off screen, as shown here.","pos":[27142,27253],"source":" If the app takes longer than .5 seconds to make the call, **Cortana** inserts a hand-off screen, as shown here."},{"content":"<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> displays the hand-off screen until the application calls <bpt id=\"p2\">**</bpt>ReportSuccessAsync<ept id=\"p2\">**</ept>, or for up to 5 seconds.","pos":[27254,27370],"source":"**Cortana** displays the hand-off screen until the application calls **ReportSuccessAsync**, or for up to 5 seconds."},{"content":"If the app service doesn’t call <bpt id=\"p1\">**</bpt>ReportSuccessAsync<ept id=\"p1\">**</ept>, or any of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VoiceCommandServiceConnection<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> methods that provide <bpt id=\"p4\">**</bpt>Cortana<ept id=\"p4\">**</ept> with information, the user receives an error message and the app service is cancelled.","pos":[27371,27654],"source":" If the app service doesn’t call **ReportSuccessAsync**, or any of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) methods that provide **Cortana** with information, the user receives an error message and the app service is cancelled."},{"content":"a basic query with progress and result screens using the adventure works app in the background","pos":[27658,27752]},{"pos":[27946,27973],"content":"Image resources and scaling"},{"content":"UWP apps can automatically select the most appropriate image based on specific settings and device capabilities (high contrast, effective pixels, locale, and so on).","pos":[27976,28141]},{"content":"All you need to do is provide the images and ensure you use the appropriate naming convention and folder organization within the app project for the different resource versions.","pos":[28142,28319]},{"content":"If you don't provide the recommended resource versions, accessibility, localization, and image quality can suffer, depending on the user's preferences, abilities, device type, and location.","pos":[28320,28509]},{"pos":[28511,28683],"content":"For more detail on image resources for high contrast and scale factors, see <bpt id=\"p1\">[</bpt>Guidelines for tile and icon assets<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt412102)</ept>.","source":"For more detail on image resources for high contrast and scale factors, see [Guidelines for tile and icon assets](https://msdn.microsoft.com/library/windows/apps/mt412102)."},{"content":"You name resources using qualifiers.","pos":[28685,28721]},{"content":"Resource qualifiers are folder and filename modifiers that identify the context in which a particular version of a resource should be used.","pos":[28722,28861]},{"content":"The standard naming convention is \"foldername/qualifiername-value\\[\\_qualifiername-value\\]/filename.qualifiername-value\\[\\_qualifiername-value\\].ext\".","pos":[28863,29013]},{"content":"For example: images/en-US/logo.scale-100\\_contrast-white.png is simply referred to in code using the root folder and the filename: images/logo.png.","pos":[29014,29161]},{"content":"See <bpt id=\"p1\">[</bpt>Guidelines for files, data, and globalization<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn611859)</ept> and <bpt id=\"p2\">[</bpt>How to name resources using qualifiers<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324)</ept>.","pos":[29162,29380],"source":" See [Guidelines for files, data, and globalization](https://msdn.microsoft.com/library/windows/apps/dn611859) and [How to name resources using qualifiers](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324)."},{"content":"We recommend that you mark the default language on string resource files (such as \"en-US\\\\resources.resw\") and the default scale factor on images (such as \"logo.scale-100.png\"), even if you do not currently plan to provide localized or multiple resolution resources.","pos":[29382,29648]},{"content":"However, you should provide assets for 100, 200, and 400 scale factors.","pos":[29649,29720]},{"content":"Important","pos":[29724,29733]},{"content":"Valid icon sizes for the <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> content tile are:","pos":[29738,29792],"source":"Valid icon sizes for the **Cortana** content tile are:"},{"content":"68w x 68h","pos":[29798,29807]},{"content":"68w x 92h","pos":[29812,29821]},{"content":"280w x 140h","pos":[29826,29837]},{"content":"The content tile is not validated until a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandResponse<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> is passed to the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandServiceConnection<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept>.","pos":[29839,30077],"source":"The content tile is not validated until a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) is passed to the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204)."},{"content":"If you pass a <bpt id=\"p1\">**</bpt>VoiceCommandResponse<ept id=\"p1\">**</ept> object to <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> that contains a content tile with an image that does not adhere to these size ratios, an exception might occur.","pos":[30078,30250],"source":" If you pass a **VoiceCommandResponse** object to **Cortana** that contains a content tile with an image that does not adhere to these size ratios, an exception might occur."},{"content":"In this example from the <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> app (VoiceCommandService\\\\AdventureWorksVoiceCommandService.cs), we specify a simple grey square (\"GreyTile.png\") as the app logo on the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VoiceCommandContentTile<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn974168)</ept> using the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>TitleWith68x68IconAndText<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn974169)</ept> tile template.","pos":[30255,30639],"source":"In this example from the **Adventure Works** app (VoiceCommandService\\\\AdventureWorksVoiceCommandService.cs), we specify a simple grey square (\"GreyTile.png\") as the app logo on the [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/dn974168) using the [**TitleWith68x68IconAndText**](https://msdn.microsoft.com/library/windows/apps/dn974169) tile template."},{"content":"The logo variants are located in VoiceCommandService\\\\Images, and are retrieved using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetFileFromApplicationUriAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701741)</ept> method.","pos":[30640,30832],"source":" The logo variants are located in VoiceCommandService\\\\Images, and are retrieved using the [**GetFileFromApplicationUriAsync**](https://msdn.microsoft.com/library/windows/apps/hh701741) method."},{"pos":[31185,31201],"content":"Related articles"},{"content":"Developers","pos":[31206,31216]},{"content":"Cortana interactions","pos":[31222,31242]},{"content":"Define custom recognition constraints","pos":[31272,31309]},{"content":"Interact with a background app in Cortana","pos":[31356,31397]},{"content":"VCD elements and attributes v1.2","pos":[31450,31482]},{"content":"Quickstart: Using file or image resources","pos":[31547,31588]},{"pos":[31655,31772],"content":"<bpt id=\"p1\">[</bpt>How to name resources using qualifiers<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">**</bpt>Designers<ept id=\"p2\">**</ept>","source":"[How to name resources using qualifiers](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324)\n**Designers**"},{"content":"Cortana design guidelines","pos":[31776,31801]},{"content":"Speech design guidelines","pos":[31864,31888]},{"content":"Responsive design 101 for UWP apps","pos":[31951,31985]},{"pos":[32047,32154],"content":"<bpt id=\"p1\">[</bpt>Guidelines for tile and icon assets<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt412102)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">**</bpt>Samples<ept id=\"p2\">**</ept>","source":"[Guidelines for tile and icon assets](https://msdn.microsoft.com/library/windows/apps/mt412102)\n**Samples**"},{"content":"Cortana voice command sample","pos":[32158,32186]}],"content":"---\nDescription: In addition to using voice commands within Cortana to access system features, you can also extend Cortana with features and functionality from a background app using voice commands that specify an action or command to execute within the app.\ntitle: Launch a background app with voice commands in Cortana\nms.assetid: DF5B530C-57DD-4CA5-B3BE-1A0B3695C9C6\nlabel: Launch a background app\ntemplate: detail.hbs\n---\n\n# Launch a background app with voice commands in Cortana\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\nIn addition to using voice commands within **Cortana** to access system features, you can also extend **Cortana** with features and functionality from a background app using voice commands that specify an action or command to execute within the app. When an app handles a voice command in the background, it can display feedback on the **Cortana** canvas and communicate with the user using the **Cortana** voice.\n\n**Note**  \nA voice command is a single utterance with a specific intent, defined in a Voice Command Definition (VCD) file, directed at an installed app through **Cortana**.\n\nA voice command definition can vary in complexity. It can support anything from a single, constrained utterance to a collection of more flexible, natural language utterances, all denoting the same intent.\n\nA VCD file defines one or more voice commands, each with a unique intent.\n\nThe target app can be launched in the foreground (the app takes focus) or activated in the background (**Cortana** retains focus but provides results from the app), depending on the complexity of the interaction. For example, voice commands that require additional context or user input (such as sending a message to a specific contact) are best handled in a foreground app, while basic commands can be handled in **Cortana** through a background app.\n\n \n\nWe demonstrate these features here with a trip planning and management app named **Adventure Works** from the [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899).\n\nHere's an overview of the **Adventure Works** app integrated with the **Cortana** canvas.\n\n![cortana canvas overview ](images/cortana-overview.png)\n\nTo view an **Adventure Works** trip without **Cortana**, a user would launch the app and navigate to the **Upcoming trips** page.\n\nUsing voice commands through **Cortana** to launch your app in the background, the user can instead just say, \"Adventure Works, when is my trip to Las Vegas?\". Your app handles the command and **Cortana** displays results along with your app icon and other app info, if provided. Here's an example of a basic trip query and **Cortana** result screen that both shows and speaks \"Your next trip to Las Vegas is on August 1st\".\n\n![a basic query and result screen using the adventure works app in the background](images/cortana-backgroundapp-result.png)\n\nThese are the basic steps to add voice-command functionality and extend **Cortana** with background functionality from your app using speech or keyboard input:\n\n1.  Create an app service (see [**Windows.ApplicationModel.AppService**](https://msdn.microsoft.com/library/windows/apps/dn921731)) that **Cortana** invokes in the background.\n2.  Create a VCD file. This is an XML document that defines all the spoken commands that the user can say to initiate actions or invoke commands when activating your app. See [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593).\n3.  Register the command sets in the VCD file when the app is launched.\n4.  Handle the background activation of the app service and the execution of the voice command.\n5.  Display and speak the appropriate feedback to the voice command within **Cortana**.\n\n**Prerequisites:  **\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Create_a_new_solution_with_a_primary_project_in_Visual_Studio\"></span><span id=\"create_a_new_solution_with_a_primary_project_in_visual_studio\"></span><span id=\"CREATE_A_NEW_SOLUTION_WITH_A_PRIMARY_PROJECT_IN_VISUAL_STUDIO\"></span>Create a new solution with a primary project in Visual Studio\n\n\n1.  Launch Microsoft Visual Studio 2015.\n\n    The Visual Studio 2015 Start page appears.\n\n2.  On the **File** menu, select **New** &gt; **Project**.\n\n    The **New Project** dialog appears. The left pane of the dialog lets you select the type of templates to display.\n\n3.  In the left pane, expand **Installed &gt; Templates &gt; Visual C# &gt; Windows**, then pick the **Universal** template group. The dialog's center pane displays a list of project templates for Universal Windows Platform (UWP) apps.\n4.  In the center pane, select the **Blank App (Universal Windows)** template.\n\n    The **Blank App** template creates a minimal UWP app that compiles and runs, but contains no user-interface controls or data. You add controls to the app over the course of this tutorial.\n\n5.  In the **Name** text box, type your project name.\n6.  Click **OK** to create the project.\n\n    Microsoft Visual Studio creates your project and displays it in the **Solution Explorer**.\n\n## <span id=\"Create_an_app_service_project\"></span><span id=\"create_an_app_service_project\"></span><span id=\"CREATE_AN_APP_SERVICE_PROJECT\"></span>Create an app service project\n\n\n1.  Right-click your Solution name, select Add-&gt;New Project, and then select **Windows Runtime Component**. This is the component that will implement the app service (see [**Windows.ApplicationModel.AppService**](https://msdn.microsoft.com/library/windows/apps/dn921731)).\n2.  Type a name for the project (for example, \"VoiceCommandService\") and click **OK**.\n3.  In **Solution Explorer**, select the \"VoiceCommandService\" project and rename the \"Class1.cs\" file generated by Visual Studio. For example, \"YourAppVoiceCommandService.cs\".\n4.  In the \"YourAppVoiceCommandService.cs\" file, add the following using directive.\n```    CSharp\nusing Windows.ApplicationModel.Background;</code></pre></td>\n    </tr>\n    </tbody>\n    </table>\n```\n\n5.  Create a new class that implements the [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794) interface. The [**Run**](https://msdn.microsoft.com/library/windows/apps/br224811) method of this class is the required entry point, called when **Cortana** recognizes the voice command.\n\n    **Note**  The background task class itself, and all other classes in the background task project, need to be sealed public classes.\n\n     \n\n    Here's a basic background task class for the **Adventure Works** app.\n\n    Note that we've renamed the default namespace assigned by Visual Studio.\n\n    <span codelanguage=\"CSharp\"></span>\n```    CSharp\n    <colgroup>\n    <col width=\"100%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">C#</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\nusing Windows.ApplicationModel.Background;\n\n    namespace AdventureWorks.VoiceCommands\n    {\n      public sealed class AdventureWorksVoiceCommandService : IBackgroundTask\n      {\n        public void Run(IBackgroundTaskInstance taskInstance)\n        {\n          BackgroundTaskDeferral _deferral = taskInstance.GetDeferral();\n        \n          //\n          // TODO: Insert code \n          //\n          //\n        \n          _deferral.Complete();\n        }        \n      }\n    }\n```\n\n6.  Declare your background task as an **AppService** in the app manifest.\n\n    1.  In **Solution Explorer**, right click the \"Package.appxmanifest\" file and select **View Code**.\n    2.  Find the [****Application****](https://msdn.microsoft.com/library/windows/apps/dn934738) element.\n    3.  Add an [****Extensions****](https://msdn.microsoft.com/library/windows/apps/dn934720) element to the [****Application****](https://msdn.microsoft.com/library/windows/apps/dn934738) element.\n    4.  Add a [****uap:Extension****](https://msdn.microsoft.com/library/windows/apps/dn986788) element to the [****Extensions****](https://msdn.microsoft.com/library/windows/apps/dn934720) element.\n    5.  Add a **Category** attribute to the **uap:Extension** element and set the value of the **Category** attribute to \"windows.appService\".\n    6.  Add an **EntryPoint** attribute to the **uap:Extension** element and set the value of the **EntryPoint** attribute to the name of the class that implements [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794), in this case \"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService\".\n    7.  Add a [****uap:AppService****](https://msdn.microsoft.com/library/windows/apps/dn934779) element to the **uap:Extension** element.\n    8.  Add a **Name** attribute to the [****uap:AppService****](https://msdn.microsoft.com/library/windows/apps/dn934779) element and set the value of the **Name** attribute to a name for the app service, in this case \"AdventureWorksVoiceCommandService\".\n```        XML\n<Package>\n          <Applications>\n            <Application>\n\n              <Extensions>\n                <uap:Extension Category=\"windows.appService\" \n                  EntryPoint=\"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService\">\n                  <uap:AppService Name=\"AdventureWorksVoiceCommandService\"/>\n                </uap:Extension>\n                <uap:Extension Category=\"windows.personalAssistantLaunch\"/>\n              </Extensions>\n\n            <Application>\n          <Applications>\n        </Package>\n```\n\n## <span id=\"Create_a_VCD_file\"></span><span id=\"create_a_vcd_file\"></span><span id=\"CREATE_A_VCD_FILE\"></span>Create a VCD file\n\n\n1.  In Visual Studio, right-click your primary project name, select Add-&gt;New Item, and then select **Text File**.\n2.  Type a name for the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file and be sure to append the \".xml\" file extension. For example, \"AdventureWorksCommands.xml\". Click **Add**.\n3.  In **Solution Explorer**, select the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file.\n4.  In the **Properties** window, set **Build action** to **Content**, and then set **Copy to output directory** to **Copy if newer**.\n\n## <span id=\"Edit_the_VCD_file\"></span><span id=\"edit_the_vcd_file\"></span><span id=\"EDIT_THE_VCD_FILE\"></span>Edit the VCD file\n\n\nFor each language supported by your app, create a **CommandSet** of voice commands that your app can handle.\n\nEach **Command** declared in a [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file must include this information:\n\n-   A command Name used by the application to identify the voice command at runtime\n-   An **Example** element that contains a phrase describing how a user can invoke the command. **Cortana** shows this example when the user says \"What can I say?\", \"Help\", or they tap **See more**.\n\n    see\n\n-   A **ListenFor** element that contains the words or phrases that your app recognizes to initiate a command. Each command needs to have at least one **ListenFor** element.\n-   A **Feedback** element that contains the text for **Cortana** to display and speak as the application is launched.\n-   A **VoiceCommandService** element to indicate the voice command launches the app in the background.\n\nFor more detail, see the [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593) reference.\n\nYou can specify multiple language versions for the commands used to activate your app and execute a command. You can create multiple [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) elements, each with a different [****xml:lang****](https://msdn.microsoft.com/library/windows/apps/dn722331) attribute to allow your app to be used in different markets. For example, an app for the United States might have a [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) for English and a [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) for Spanish.\n\n**Caution**  \nTo activate an app and initiate an action using a voice command, the app must register a VCD file that contains a [****CommandSet****](https://msdn.microsoft.com/library/windows/apps/dn722331) with a language that matches the speech language that the user selected on their device. This language is set by the user on the device Settings &gt; System &gt; Speech &gt; Speech Language screen.\n\n \n\nHere's a [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file that defines a voice command for the **Adventure Works** app.\n\nFor this example, **CommandPrefix** is set to \"Adventure Works\", **Command** is set to \"whenIsTripToDestination\", **ListenFor** specifies the text that can be recognized (with a reference to a **PhraseList** element that constrains the recognized destinations), **VoiceCommandService** indicates that the voice command is handled by an app service in the background, and **Feedback** specifies what the user will hear when **Cortana** launches the app service.\n\nThe value of the **Target** attribute of the **VoiceCommandService** element needs to be the name of the app service as specified in the [****uap:AppService****](https://msdn.microsoft.com/library/windows/apps/dn934779) element of the package.appxmanifest. In this example, the name of the app service is \"AdventureWorksVoiceCommandService\".\n\nThe \"whenIsTripToDestination\" command has a **ListenFor** element with a reference to a **PhraseList** for a constrained set of destinations.\n\n**ListenFor** elements cannot be programmatically modified. However, **PhraseList** elements associated with **ListenFor** elements can be programmatically modified. Applications should modify the content of the **PhraseList** at runtime based on the data set generated as the user uses the app. See [Dynamically modify Voice Command Definition (VCD) phrase lists](dynamically-modify-voice-command-definition--vcd--phrase-lists.md).\n\n```XML\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.2\">\n  <CommandSet xml:lang=\"en-us\" Name=\"AdventureWorksCommandSet_en-us\">\n    <AppName> Adventure Works </AppName>\n    <Example> Show trip to London </Example>\n\n    <Command Name=\"showTripToDestination\">\n      <Example> Show trip to London </Example>\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\"> show [my] trip to {destination} </ListenFor>\n      <ListenFor RequireAppName=\"ExplicitlySpecified\"> show [my] {builtin:AppName} trip to {destination} </ListenFor>\n      <Feedback> Showing trip to {destination} </Feedback>\n      <Navigate />\n    </Command>\n\n    <Command Name=\"whenIsTripToDestination\">\n      <Example> When is my trip to Las Vegas?</Example>\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\"> when is [my] trip to {destination}</ListenFor>\n      <ListenFor RequireAppName=\"ExplicitlySpecified\"> when is [my] {builtin:AppName} trip to {destination} </ListenFor>\n      <Feedback> Looking for trip to {destination}</Feedback>\n      <VoiceCommandService Target=\"AdventureWorksVoiceCommandService\"/>\n    </Command>\n    \n    <Command Name=\"cancelTripToDestination\">\n      <Example> Cancel my trip to Las Vegas </Example>\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\"> cancel [my] trip to {destination}</ListenFor>\n      <ListenFor RequireAppName=\"ExplicitlySpecified\"> cancel [my] {builtin:AppName} trip to {destination} </ListenFor>\n      <Feedback> Cancelling trip to {destination}</Feedback>\n    <VoiceCommandService Target=\"AdventureWorksVoiceCommandService\"/>\n    </Command>\n\n    <PhraseList Label=\"destination\">\n      <Item>London</Item>\n      <Item>Las Vegas</Item>\n      <Item>Melbourne</Item>\n      <Item>Yosemite National Park</Item>\n    </PhraseList>\n  </CommandSet>\n</VoiceCommands>\n```\n\n## <span id=\"Install_the_VCD_commands\"></span><span id=\"install_the_vcd_commands\"></span><span id=\"INSTALL_THE_VCD_COMMANDS\"></span>Install the VCD commands\n\n\nYour app must run once to install the command sets in the VCD.\n\nWhen your app is activated, call [**InstallCommandDefinitionsFromStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn708205) in the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) handler to register the commands that the system should listen for.\n\n**Note**  If a device backup occurs and your app reinstalls automatically, voice command data is not preserved. To ensure the voice command data for your app stays intact, consider initializing your VCD file each time your app launches or activates, or store a setting that indicates if the VCD is currently installed and check the setting each time your app launches or activates.\n\n \n\nIn this example, we first define a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object.\n\nWe then call [**GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227272) to initialize it with our \"AdventureWorksCommands.xml\" file.\n\nThis [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object is then passed to [**InstallCommandDefinitionsFromStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn708205).\n\n```CSharp\ntry\n{\n    // Install the VCD. \n    StorageFile vcdStorageFile = \n        await Package.Current.InstalledLocation.GetFileAsync(\n        @\"AdventureWorksCommands.xml\");\n\n    await \n        Windows.ApplicationModel.VoiceCommands.VoiceCommandDefinitionManager.\n        InstallCommandDefinitionsFromStorageFileAsync(vcdStorageFile);\n}\ncatch (Exception ex)\n{\n    System.Diagnostics.Debug.WriteLine(\n      \"Installing Voice Commands Failed: \" + ex.ToString());\n}\n```\n\n## <span id=\"Handle_the_voice_command_in_the_app_service\"></span><span id=\"handle_the_voice_command_in_the_app_service\"></span><span id=\"HANDLE_THE_VOICE_COMMAND_IN_THE_APP_SERVICE\"></span>Handle the voice command in the app service\n\n\nSpecify in the app service how your app responds to voice-command activations after it has launched and the voice command sets have been installed.\n\n1.  Take a service deferral so your app service is not terminated while handling the voice command.\n2.  Confirm that your background task is running as an app service activated by a voice command.\n\n    1.  Cast the [**IBackgroundTaskInstance.TriggerDetails**](https://msdn.microsoft.com/library/windows/apps/br224802) to [**Windows.ApplicationModel.AppService.AppServiceTriggerDetails**](https://msdn.microsoft.com/library/windows/apps/dn921727).\n    2.  Check that [**IBackgroundTaskInstance.TriggerDetails.Name**](https://msdn.microsoft.com/library/windows/apps/br224807) is the name of the app service in the \"Package.appxmanifest\" file.\n\n3.  Use [**IBackgroundTaskInstance.TriggerDetails**](https://msdn.microsoft.com/library/windows/apps/br224802) to create a [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) to **Cortana** to retrieve the voice command.\n4.  Register an event handler for [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204).[**VoiceCommandCompleted**](https://msdn.microsoft.com/library/windows/apps/dn706584) to receive notification when the app service is closed due to a user cancellation.\n5.  Register an event handler for the [**IBackgroundTaskInstance.Canceled**](https://msdn.microsoft.com/library/windows/apps/br224798) to receive notification when the app service is closed due to an unexpected failure.\n6.  Determine the name of the command and what was spoken.\n\n    1.  Use the [**VoiceCommand**](https://msdn.microsoft.com/library/windows/apps/dn974162).[**CommandName**](https://msdn.microsoft.com/library/windows/apps/dn706589) property to determine the name of the voice command.\n    2.  To determine what the user said, check the value of [**Text**](https://msdn.microsoft.com/library/windows/apps/dn631441) or the semantic properties of the recognized phrase in the [**SpeechRecognitionSemanticInterpretation**](https://msdn.microsoft.com/library/windows/apps/dn631443) dictionary.\n\n7.  Take the appropriate action in your app service.\n8.  Display and speak the feedback to the voice command with **Cortana**.\n\n    1.  Determine the strings that you want **Cortana** to display and speak to the user in response to the voice command and create a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object. For guidance on how to select the feedback strings that **Cortana** shows and speaks, see [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233).\n    2.  Use the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) instance to report progress or completion to **Cortana** by calling [**ReportProgressAsync**](https://msdn.microsoft.com/library/windows/apps/dn706579) or [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) with the **VoiceCommandServiceConnection** object.\n\n    For this example, we refer back to the VCD in Step 3: Edit the VCD file.\n\n```    CSharp\npublic sealed class VoiceCommandService : IBackgroundTask\n    {\n      private BackgroundTaskDeferral serviceDeferral;\n      VoiceCommandServiceConnection voiceServiceConnection;\n\n      public async void Run(IBackgroundTaskInstance taskInstance)\n      {\n      //Take a service deferral so the service isn&#39;t terminated.\n        this.serviceDeferral = taskInstance.GetDeferral();\n\n        taskInstance.Canceled += OnTaskCanceled;\n\n        var triggerDetails = \n          taskInstance.TriggerDetails as AppServiceTriggerDetails;\n\n        if (triggerDetails != null &amp;&amp; \n          triggerDetails.Name == \"AdventureWorksVoiceServiceEndpoint\")\n        {\n          try\n          {\n            voiceServiceConnection = \n              VoiceCommandServiceConnection.FromAppServiceTriggerDetails(\n                triggerDetails);\n\n            voiceServiceConnection.VoiceCommandCompleted += \n              VoiceCommandCompleted;\n\n            VoiceCommand voiceCommand = await\n            voiceServiceConnection.GetVoiceCommandAsync();\n\n            switch (voiceCommand.CommandName)\n            {\n              case \"whenIsTripToDestination\":\n              {\n                var destination = \n                  voiceCommand.Properties[\"destination\"][0];\n                SendCompletionMessageForDestination(destination);\n                break;\n              }\n\n              // As a last resort, launch the app in the foreground.\n              default:\n                LaunchAppInForeground();\n                break;\n            }\n          }\n          finally\n          {\n            if (this.serviceDeferral != null)\n            {\n              // Complete the service deferral.\n              this.serviceDeferral.Complete();\n            }\n          }\n        }\n      }\n\n      private void VoiceCommandCompleted(\n        VoiceCommandServiceConnection sender, \n        VoiceCommandCompletedEventArgs args)\n      {\n        if (this.serviceDeferral != null)\n        {\n          // Insert your code here.\n          // Complete the service deferral.\n          this.serviceDeferral.Complete();\n        }\n      }\n\n      private async void SendCompletionMessageForDestination(\n        string destination)\n      {\n        // Take action and determine when the next trip to destination\n        // Insert code here.\n        \n        // Replace the hardcoded strings used here with strings \n        // appropriate for your application.\n\n        // First, create the VoiceCommandUserMessage with the strings \n        // that Cortana will show and speak.\n        var userMessage = new VoiceCommandUserMessage();\n        userMessage.DisplayMessage = \"Here’s your trip.\";\n        userMessage.SpokenMessage = \"Your trip to Vegas is on August 3rd.\";\n\n        // Optionally, present visual information about the answer.\n        // For this example, create a VoiceCommandContentTile with an \n        // icon and a string.\n        var destinationsContentTiles = new List<VoiceCommandContentTile>();\n\n        var destinationTile = new VoiceCommandContentTile();\n        destinationTile.ContentTileType = \n          VoiceCommandContentTileType.TitleWith68x68IconAndText;\n        // The user can tap on the visual content to launch the app. \n        // Pass in a launch argument to enable the app to deep link to a \n        // page relevant to the item displayed on the content tile.\n        destinationTile.AppLaunchArgument = \n          string.Format(\"destination={0}”, “Las Vegas\");\n        destinationTile.Title = \"Las Vegas\";\n        destinationTile.TextLine1 = \"August 3rd 2015\";\n        destinationsContentTiles.Add(destinationTile);\n\n        // Create the VoiceCommandResponse from the userMessage and list    \n        // of content tiles.\n        var response = \n          VoiceCommandResponse.CreateResponse(\n            userMessage, destinationsContentTiles);\n\n        // Cortana will present a “Go to app_name” link that the user \n        // can tap to launch the app. \n        // Pass in a launch to enable the app to deep link to a page \n        // relevant to the voice command.\n        response.AppLaunchArgument = \n          string.Format(\"destination={0}”, “Las Vegas\");\n        \n        // Ask Cortana to display the user message and content tile and \n        // also speak the user message.\n        await voiceServiceConnection.ReportSuccessAsync(response);\n      }\n\n      private async void LaunchAppInForeground()\n      {\n        var userMessage = new VoiceCommandUserMessage();\n        userMessage.SpokenMessage = \"Launching Adventure Works\";\n\n        var response = VoiceCommandResponse.CreateResponse(userMessage);\n\n        // When launching the app in the foreground, pass an app \n        // specific launch parameter to indicate what page to show.\n        response.AppLaunchArgument = \"showAllTrips=true\";\n\n        await voiceServiceConnection.RequestAppLaunchAsync(response);\n      }\n    }\n```\n\nOnce launched, the app service has .5 seconds to call [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580). **Cortana** uses the data provided by the app to show and say the feedback specified in the VCD file. If the app takes longer than .5 seconds to make the call, **Cortana** inserts a hand-off screen, as shown here. **Cortana** displays the hand-off screen until the application calls **ReportSuccessAsync**, or for up to 5 seconds. If the app service doesn’t call **ReportSuccessAsync**, or any of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) methods that provide **Cortana** with information, the user receives an error message and the app service is cancelled.\n\n![a basic query with progress and result screens using the adventure works app in the background](images/cortana-backgroundapp-progress-result.png)\n\n## <span id=\"Image_resources_and_scaling\"></span><span id=\"image_resources_and_scaling\"></span><span id=\"IMAGE_RESOURCES_AND_SCALING\"></span>Image resources and scaling\n\n\nUWP apps can automatically select the most appropriate image based on specific settings and device capabilities (high contrast, effective pixels, locale, and so on). All you need to do is provide the images and ensure you use the appropriate naming convention and folder organization within the app project for the different resource versions. If you don't provide the recommended resource versions, accessibility, localization, and image quality can suffer, depending on the user's preferences, abilities, device type, and location.\n\nFor more detail on image resources for high contrast and scale factors, see [Guidelines for tile and icon assets](https://msdn.microsoft.com/library/windows/apps/mt412102).\n\nYou name resources using qualifiers. Resource qualifiers are folder and filename modifiers that identify the context in which a particular version of a resource should be used.\n\nThe standard naming convention is \"foldername/qualifiername-value\\[\\_qualifiername-value\\]/filename.qualifiername-value\\[\\_qualifiername-value\\].ext\". For example: images/en-US/logo.scale-100\\_contrast-white.png is simply referred to in code using the root folder and the filename: images/logo.png. See [Guidelines for files, data, and globalization](https://msdn.microsoft.com/library/windows/apps/dn611859) and [How to name resources using qualifiers](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324).\n\nWe recommend that you mark the default language on string resource files (such as \"en-US\\\\resources.resw\") and the default scale factor on images (such as \"logo.scale-100.png\"), even if you do not currently plan to provide localized or multiple resolution resources. However, you should provide assets for 100, 200, and 400 scale factors.\n\n**Important**  \nValid icon sizes for the **Cortana** content tile are:\n\n-   68w x 68h\n-   68w x 92h\n-   280w x 140h\n\nThe content tile is not validated until a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) is passed to the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204). If you pass a **VoiceCommandResponse** object to **Cortana** that contains a content tile with an image that does not adhere to these size ratios, an exception might occur.\n\n \n\nIn this example from the **Adventure Works** app (VoiceCommandService\\\\AdventureWorksVoiceCommandService.cs), we specify a simple grey square (\"GreyTile.png\") as the app logo on the [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/dn974168) using the [**TitleWith68x68IconAndText**](https://msdn.microsoft.com/library/windows/apps/dn974169) tile template. The logo variants are located in VoiceCommandService\\\\Images, and are retrieved using the [**GetFileFromApplicationUriAsync**](https://msdn.microsoft.com/library/windows/apps/hh701741) method.\n\n```CSharp\nvar destinationTile = new VoiceCommandContentTile();\n\ndestinationTile.ContentTileType = \n  VoiceCommandContentTileType.TitleWith68x68IconAndText;\ndestinationTile.Image = \n  await StorageFile.GetFileFromApplicationUriAsync(\n    new Uri(\"ms-appx:///AdventureWorks.VoiceCommands/Images/GreyTile.png\"));\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [Define custom recognition constraints](define-custom-recognition-constraints.md)\n* [Interact with a background app in Cortana](interact-with-a-background-app-in-cortana.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n* [Quickstart: Using file or image resources](https://msdn.microsoft.com/library/windows/apps/xaml/hh965325)\n* [How to name resources using qualifiers](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324)\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n* [Responsive design 101 for UWP apps](https://msdn.microsoft.com/library/windows/apps/dn958435)\n* [Guidelines for tile and icon assets](https://msdn.microsoft.com/library/windows/apps/mt412102)\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}