{"nodes":[{"pos":[17,160],"content":"Describes the concept of automation peers for Microsoft UI Automation, and how you can provide automation support for your own custom UI class.","needQuote":true,"needEscape":true,"nodes":[{"content":"Describes the concept of automation peers for Microsoft UI Automation, and how you can provide automation support for your own custom UI class.","pos":[0,143]}]},{"pos":[168,191],"content":"Custom automation peers","needQuote":true,"needEscape":true,"nodes":[{"content":"Custom automation peers","pos":[0,23]}]},{"content":"Custom automation peers","pos":[300,323]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[325,363]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[364,459],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Describes the concept of automation peers for Microsoft UI Automation, and how you can provide automation support for your own custom UI class.","pos":[462,605]},{"content":"UI Automation provides a framework that automation clients can use to examine or operate the user interfaces of a variety of UI platforms and frameworks.","pos":[607,760]},{"content":"If you are writing a Universal Windows Platform (UWP) app, the classes that you use for your UI already provide UI Automation support.","pos":[761,895]},{"content":"You can derive from existing, non-sealed classes to define a new kind of UI control or support class.","pos":[896,997]},{"content":"In the process of doing so, your class might add behavior that should have accessibility support but that the default UI Automation support does not cover.","pos":[998,1153]},{"content":"In this case, you should extend the existing UI Automation support by deriving from the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept> class that the base implementation used, adding any necessary support to your peer implementation, and informing the Universal Windows Platform (UWP) control infrastructure that it should create your new peer.","pos":[1154,1530],"source":" In this case, you should extend the existing UI Automation support by deriving from the [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) class that the base implementation used, adding any necessary support to your peer implementation, and informing the Universal Windows Platform (UWP) control infrastructure that it should create your new peer."},{"content":"UI Automation enables not only accessibility applications and assistive technologies, such as screen readers, but also quality-assurance (test) code.","pos":[1532,1681]},{"content":"In either scenario, UI Automation clients can examine user-interface elements and simulate user interaction with your app from other code outside your app.","pos":[1682,1837]},{"content":"For info about UI Automation across all platforms and in its wider meaning, see <bpt id=\"p1\">[</bpt>UI Automation Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee684076)</ept>.","pos":[1838,2004],"source":" For info about UI Automation across all platforms and in its wider meaning, see [UI Automation Overview](https://msdn.microsoft.com/library/windows/desktop/Ee684076)."},{"content":"There are two distinct audiences who use the UI Automation framework.","pos":[2006,2075]},{"content":"UI Automation <bpt id=\"p1\">*</bpt>clients<ept id=\"p1\">*</ept> call UI Automation APIs to learn about all of the UI that is currently displayed to the user.","pos":[2081,2198],"source":"UI Automation *clients* call UI Automation APIs to learn about all of the UI that is currently displayed to the user."},{"content":"For example, an assistive technology such as a screen reader acts as a UI Automation client.","pos":[2199,2291]},{"content":"The UI is presented as a tree of automation elements that are related.","pos":[2292,2362]},{"content":"The UI Automation client might be interested in just one app at a time, or in the entire tree.","pos":[2363,2457]},{"content":"The UI Automation client can use UI Automation APIs to navigate the tree and to read or change information in the automation elements.","pos":[2458,2592]},{"content":"UI Automation <bpt id=\"p1\">*</bpt>providers<ept id=\"p1\">*</ept> contribute information to the UI Automation tree, by implementing APIs that expose the elements in the UI that they introduced as part of their app.","pos":[2597,2771],"source":"UI Automation *providers* contribute information to the UI Automation tree, by implementing APIs that expose the elements in the UI that they introduced as part of their app."},{"content":"When you create a new control, you should now act as a participant in the UI Automation provider scenario.","pos":[2772,2878]},{"content":"As a provider, you should ensure that all UI Automation clients can use the UI Automation framework to interact with your control for both accessibility and testing purposes.","pos":[2879,3053]},{"content":"Typically there are parallel APIs in the UI Automation framework: one API for UI Automation clients and another, similarly named API for UI Automation providers.","pos":[3055,3216]},{"content":"For the most part, this topic covers the APIs for the UI Automation provider, and specifically the classes and interfaces that enable provider extensibility in that UI framework.","pos":[3217,3395]},{"content":"Occasionally we mention UI Automation APIs that the UI Automation clients use, to provide some perspective, or provide a lookup table that correlates the client and provider APIs.","pos":[3396,3575]},{"content":"For more info about the client perspective, see <bpt id=\"p1\">[</bpt>UI Automation Client Programmer's Guide<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee684021)</ept>.","pos":[3576,3727],"source":" For more info about the client perspective, see [UI Automation Client Programmer's Guide](https://msdn.microsoft.com/library/windows/desktop/Ee684021)."},{"content":"Note","pos":[3731,3735]},{"content":"UI Automation clients don't typically use managed code and aren't typically implemented as a UWP app (they are usually desktop apps).","pos":[3740,3873]},{"content":"UI Automation is based on a standard and not a specific implementation or framework.","pos":[3874,3958]},{"content":"Many existing UI Automation clients, including assistive technology products such as screen readers, use Component Object Model (COM) interfaces to interact with UI Automation, the system, and the apps that run in child windows.","pos":[3959,4187]},{"content":"For more info on the COM interfaces and how to write a UI Automation client using COM, see <bpt id=\"p1\">[</bpt>UI Automation Fundamentals<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee684007)</ept>.","pos":[4188,4369],"source":" For more info on the COM interfaces and how to write a UI Automation client using COM, see [UI Automation Fundamentals](https://msdn.microsoft.com/library/windows/desktop/Ee684007)."},{"pos":[4671,4751],"content":"Determining the existing state of UI Automation support for your custom UI class"},{"content":"Before you attempt to implement an automation peer for a custom control, you should test whether the base class and its automation peer already provides the accessibility or automation support that you need.","pos":[5131,5338]},{"content":"In many cases, the combination of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept> implementations, specific peers, and the patterns they implement can provide a basic but satisfactory accessibility experience.","pos":[5339,5599],"source":" In many cases, the combination of the [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) implementations, specific peers, and the patterns they implement can provide a basic but satisfactory accessibility experience."},{"content":"Whether this is true depends on how many changes you made to the object model exposure to your control versus its base class.","pos":[5600,5725]},{"content":"Also, this depends on whether your additions to base class functionality correlate to new UI elements in the template contract or to the visual appearance of the control.","pos":[5726,5896]},{"content":"In some cases your changes might introduce new aspects of user experience that require additional accessibility support.","pos":[5897,6017]},{"content":"Even if using the existing base peer class provides the basic accessibility support, it is still a best practice to define a peer so that you can report precise <bpt id=\"p1\">**</bpt>ClassName<ept id=\"p1\">**</ept> information to UI Automation for automated testing scenarios.","pos":[6019,6255],"source":"Even if using the existing base peer class provides the basic accessibility support, it is still a best practice to define a peer so that you can report precise **ClassName** information to UI Automation for automated testing scenarios."},{"content":"This consideration is especially important if you are writing a control that is intended for third-party consumption.","pos":[6256,6373]},{"pos":[6507,6530],"content":"Automation peer classes"},{"content":"The UWP builds on existing UI Automation techniques and conventions used by previous managed-code UI frameworks such as Windows Forms, Windows Presentation Foundation (WPF) and Microsoft Silverlight.","pos":[6688,6887]},{"content":"Many of the control classes and their function and purpose also have their origin in a previous UI framework.","pos":[6888,6997]},{"content":"By convention, peer class names begin with the control class name and end with \"AutomationPeer\".","pos":[6999,7095]},{"content":"For example, <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ButtonAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242458)</ept> is the peer class for the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Button<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209265)</ept> control class.","pos":[7096,7305],"source":" For example, [**ButtonAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242458) is the peer class for the [**Button**](https://msdn.microsoft.com/library/windows/apps/BR209265) control class."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  For purposes of this topic, we treat the properties that are related to accessibility as being more important when you implement a control peer.","pos":[7307,7461],"source":"**Note**  For purposes of this topic, we treat the properties that are related to accessibility as being more important when you implement a control peer."},{"content":"But for a more general concept of UI Automation support, you should implement a peer in accordance with recommendations as documented by the <bpt id=\"p1\">[</bpt>UI Automation Provider Programmer's Guide<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671596)</ept> and <bpt id=\"p2\">[</bpt>UI Automation Fundamentals<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/desktop/Ee684007)</ept>.","pos":[7462,7802],"source":" But for a more general concept of UI Automation support, you should implement a peer in accordance with recommendations as documented by the [UI Automation Provider Programmer's Guide](https://msdn.microsoft.com/library/windows/desktop/Ee671596) and [UI Automation Fundamentals](https://msdn.microsoft.com/library/windows/desktop/Ee684007)."},{"content":"Those topics don't cover the specific <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept> APIs that you would use to provide the information in the UWP framework for UI Automation, but they do describe the properties that identify your class or provide other information or interaction.","pos":[7803,8116],"source":" Those topics don't cover the specific [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) APIs that you would use to provide the information in the UWP framework for UI Automation, but they do describe the properties that identify your class or provide other information or interaction."},{"pos":[8277,8310],"content":"Peers, patterns and control types"},{"content":"A <bpt id=\"p1\">*</bpt>control pattern<ept id=\"p1\">*</ept> is an interface implementation that exposes a particular aspect of a control's functionality to a UI Automation client.","pos":[8502,8641],"source":"A *control pattern* is an interface implementation that exposes a particular aspect of a control's functionality to a UI Automation client."},{"content":"UI Automation clients use the properties and methods exposed through a control pattern to retrieve information about capabilities of the control, or to manipulate the control's behavior at run time.","pos":[8642,8840]},{"content":"Control patterns provide a way to categorize and expose a control's functionality independent of the control type or the appearance of the control.","pos":[8842,8989]},{"content":"For example, a control that presents a tabular interface uses the <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept> control pattern to expose the number of rows and columns in the table, and to enable a UI Automation client to retrieve items from the table.","pos":[8990,9206],"source":" For example, a control that presents a tabular interface uses the **Grid** control pattern to expose the number of rows and columns in the table, and to enable a UI Automation client to retrieve items from the table."},{"content":"As other examples, the UI Automation client can use the <bpt id=\"p1\">**</bpt>Invoke<ept id=\"p1\">**</ept> control pattern for controls that can be invoked, such as buttons, and the <bpt id=\"p2\">**</bpt>Scroll<ept id=\"p2\">**</ept> control pattern for controls that have scroll bars, such as list boxes, list views, or combo boxes.","pos":[9207,9459],"source":" As other examples, the UI Automation client can use the **Invoke** control pattern for controls that can be invoked, such as buttons, and the **Scroll** control pattern for controls that have scroll bars, such as list boxes, list views, or combo boxes."},{"content":"Each control pattern represents a separate type of functionality, and control patterns can be combined to describe the full set of functionality supported by a particular control.","pos":[9460,9639]},{"content":"Control patterns relate to UI as interfaces relate to COM objects.","pos":[9641,9707]},{"content":"In COM, you can query an object to ask what interfaces it supports and then use those interfaces to access functionality.","pos":[9708,9829]},{"content":"In UI Automation, UI Automation clients can query a UI Automation element to find out which control patterns it supports, and then interact with the element and its peered control through the properties, methods, events, and structures exposed by the supported control patterns.","pos":[9830,10108]},{"content":"One of the main purposes of an automation peer is to report to a UI Automation client which control patterns the UI element can support through its peer.","pos":[10110,10263]},{"content":"To do this, UI Automation providers implement new peers that change the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPattern<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern)</ept> method behavior by overriding the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetPatternCore<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> method.","pos":[10264,10557],"source":" To do this, UI Automation providers implement new peers that change the [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) method behavior by overriding the [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) method."},{"content":"UI Automation clients make calls that the UI Automation provider maps to calling <bpt id=\"p1\">**</bpt>GetPattern<ept id=\"p1\">**</ept>.","pos":[10558,10654],"source":" UI Automation clients make calls that the UI Automation provider maps to calling **GetPattern**."},{"content":"UI Automation clients query for each specific pattern that they want to interact with.","pos":[10655,10741]},{"content":"If the peer supports the pattern, it returns an object reference to itself; otherwise it returns <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept>.","pos":[10742,10848],"source":" If the peer supports the pattern, it returns an object reference to itself; otherwise it returns **null**."},{"content":"If the return is not <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept>, the UI Automation client expects that it can call APIs of the pattern interface as a client, in order to interact with that control pattern.","pos":[10849,11020],"source":" If the return is not **null**, the UI Automation client expects that it can call APIs of the pattern interface as a client, in order to interact with that control pattern."},{"content":"A <bpt id=\"p1\">*</bpt>control type<ept id=\"p1\">*</ept> is a way to broadly define the functionality of a control that the peer represents.","pos":[11022,11122],"source":"A *control type* is a way to broadly define the functionality of a control that the peer represents."},{"content":"This is a different concept than a control pattern because while a pattern informs UI Automation what info it can get or what actions it can perform through a particular interface, the control type exists one level above that.","pos":[11123,11349]},{"content":"Each control type has guidance about these aspects of UI Automation:","pos":[11350,11418]},{"content":"UI Automation control patterns: A control type might support more than one pattern, each of which represents a different classification of info or interaction.","pos":[11424,11583]},{"content":"Each control type has a set of control patterns that the control must support, a set that is optional, and a set that the control must not support.","pos":[11584,11731]},{"content":"UI Automation property values: Each control type has a set of properties that the control must support.","pos":[11736,11839]},{"content":"These are the general properties, as described in <bpt id=\"p1\">[</bpt>UI Automation Properties Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671594)</ept>, not the ones that are pattern-specific.","pos":[11840,12027],"source":" These are the general properties, as described in [UI Automation Properties Overview](https://msdn.microsoft.com/library/windows/desktop/Ee671594), not the ones that are pattern-specific."},{"content":"UI Automation events: Each control type has a set of events that the control must support.","pos":[12032,12122]},{"content":"Again these are general, not pattern-specific, as described in <bpt id=\"p1\">[</bpt>UI Automation Events Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671221)</ept>.","pos":[12123,12279],"source":" Again these are general, not pattern-specific, as described in [UI Automation Events Overview](https://msdn.microsoft.com/library/windows/desktop/Ee671221)."},{"content":"UI Automation tree structure: Each control type defines how the control must appear in the UI Automation tree structure.","pos":[12284,12404]},{"content":"Regardless of how automation peers for the framework are implemented, UI Automation client functionality isn't tied to the UWP, and in fact it's likely that existing UI Automation clients such as assistive technologies will use other programming models, such as COM.","pos":[12406,12672]},{"content":"In COM, clients can <bpt id=\"p1\">**</bpt>QueryInterface<ept id=\"p1\">**</ept> for the COM control pattern interface that implements the requested pattern or the general UI Automation framework for properties, events or tree examination.","pos":[12673,12870],"source":" In COM, clients can **QueryInterface** for the COM control pattern interface that implements the requested pattern or the general UI Automation framework for properties, events or tree examination."},{"content":"For the patterns, the UI Automation framework marshals that interface code across into UWP code running against the app's UI Automation provider and the relevant peer.","pos":[12871,13038]},{"content":"When you implement control patterns for a managed-code framework such as a Windows Store app using C# or Microsoft Visual Basic, you can use .NET Framework interfaces to represent these patterns instead of using the COM interface representation.","pos":[13040,13285]},{"content":"For example, the UI Automation pattern interface for a Microsoft .NET provider implementation of the <bpt id=\"p1\">**</bpt>Invoke<ept id=\"p1\">**</ept> pattern is <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>IInvokeProvider<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR242582)</ept>.","pos":[13286,13489],"source":" For example, the UI Automation pattern interface for a Microsoft .NET provider implementation of the **Invoke** pattern is [**IInvokeProvider**](https://msdn.microsoft.com/library/windows/apps/BR242582)."},{"content":"For a list of control patterns, provider interfaces, and their purpose, see <bpt id=\"p1\">[</bpt>Control patterns and interfaces<ept id=\"p1\">](control-patterns-and-interfaces.md)</ept>.","pos":[13491,13637],"source":"For a list of control patterns, provider interfaces, and their purpose, see [Control patterns and interfaces](control-patterns-and-interfaces.md)."},{"content":"For the list of the control types, see <bpt id=\"p1\">[</bpt>UI Automation Control Types Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671197)</ept>.","pos":[13638,13777],"source":" For the list of the control types, see [UI Automation Control Types Overview](https://msdn.microsoft.com/library/windows/desktop/Ee671197)."},{"pos":[13978,14024],"content":"Guidance for how to implement control patterns"},{"content":"The control patterns and what they're intended for are part of a larger definition of the UI Automation framework, and don't just apply to the accessibility support for a Windows Store app.","pos":[14026,14215]},{"content":"When you implement a control pattern you should make sure you're implementing it in a way that matches the guidance as documented on MSDN and also in the UI Automation specification.","pos":[14216,14398]},{"content":"If you're looking for guidance, you can generally use the MSDN topics and won't need to refer to the specification.","pos":[14399,14514]},{"content":"Guidance for each pattern is documented here: <bpt id=\"p1\">[</bpt>Implementing UI Automation Control Patterns<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671292)</ept>.","pos":[14515,14668],"source":" Guidance for each pattern is documented here: [Implementing UI Automation Control Patterns](https://msdn.microsoft.com/library/windows/desktop/Ee671292)."},{"content":"You'll notice that each topic under this area has an \"Implementation Guidelines and Conventions\" section and \"Required Members\" section.","pos":[14669,14805]},{"content":"The guidance usually refers to specific APIs of the relevant control pattern interface in the <bpt id=\"p1\">[</bpt>Control Pattern Interfaces for Providers<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671201)</ept> reference.","pos":[14806,15014],"source":" The guidance usually refers to specific APIs of the relevant control pattern interface in the [Control Pattern Interfaces for Providers](https://msdn.microsoft.com/library/windows/desktop/Ee671201) reference."},{"content":"Those interfaces are the native/COM interfaces (and their APIs use COM-style syntax).","pos":[15015,15100]},{"content":"But everything you see there has an equivalent in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.UI.Xaml.Automation.Provider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209225)</ept> namespace.","pos":[15101,15265],"source":" But everything you see there has an equivalent in the [**Windows.UI.Xaml.Automation.Provider**](https://msdn.microsoft.com/library/windows/apps/BR209225) namespace."},{"content":"If you're using the default automation peers and expanding on their behavior, those peers have already been written in conformance to UI Automation guidelines.","pos":[15267,15426]},{"content":"If they support control patterns, you can rely on that pattern support conforming with guidance at <bpt id=\"p1\">[</bpt>Implementing UI Automation Control Patterns<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671292)</ept>.","pos":[15427,15633],"source":" If they support control patterns, you can rely on that pattern support conforming with guidance at [Implementing UI Automation Control Patterns](https://msdn.microsoft.com/library/windows/desktop/Ee671292)."},{"content":"If a control peer reports that it's representative of a control type defined by UI Automation, then the guidance documented at <bpt id=\"p1\">[</bpt>Supporting UI Automation Control Types<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671633)</ept> has been followed by that peer.","pos":[15634,15894],"source":" If a control peer reports that it's representative of a control type defined by UI Automation, then the guidance documented at [Supporting UI Automation Control Types](https://msdn.microsoft.com/library/windows/desktop/Ee671633) has been followed by that peer."},{"content":"Nevertheless you might need additional guidance for control patterns or control types in order to follow the UI Automation recommendations in your peer implementation.","pos":[15896,16063]},{"content":"That would be particularly true if you're implementing pattern or control type support that doesn't yet exist as a default implementation in a UWP control.","pos":[16064,16219]},{"content":"For example, the pattern for annotations isn't implemented in any of the default XAML controls.","pos":[16220,16315]},{"content":"But you might have an app that uses annotations extensively and therefore you want to surface that functionality to be accessible.","pos":[16316,16446]},{"content":"For this scenario, your peer should implement <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IAnnotationProvider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh738493)</ept> and should probably report itself as the <bpt id=\"p3\">**</bpt>Document<ept id=\"p3\">**</ept> control type with appropriate properties to indicate that your documents support annotation.","pos":[16447,16723],"source":" For this scenario, your peer should implement [**IAnnotationProvider**](https://msdn.microsoft.com/library/windows/apps/Hh738493) and should probably report itself as the **Document** control type with appropriate properties to indicate that your documents support annotation."},{"content":"We recommend that you use the guidance that you see for the patterns under <bpt id=\"p1\">[</bpt>Implementing UI Automation Control Patterns<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671292)</ept> or control types under <bpt id=\"p2\">[</bpt>Supporting UI Automation Control Types<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/desktop/Ee671633)</ept> as orientation and general guidance.","pos":[16725,17068],"source":"We recommend that you use the guidance that you see for the patterns under [Implementing UI Automation Control Patterns](https://msdn.microsoft.com/library/windows/desktop/Ee671292) or control types under [Supporting UI Automation Control Types](https://msdn.microsoft.com/library/windows/desktop/Ee671633) as orientation and general guidance."},{"content":"You might even try following some of the API links for descriptions and remarks as to the purpose of the APIs.","pos":[17069,17179]},{"content":"But for syntax specifics that are needed for UWP app programming, find the equivalent API within the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.UI.Xaml.Automation.Provider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209225)</ept> namespace and use those reference pages for more info.","pos":[17180,17435],"source":" But for syntax specifics that are needed for UWP app programming, find the equivalent API within the [**Windows.UI.Xaml.Automation.Provider**](https://msdn.microsoft.com/library/windows/apps/BR209225) namespace and use those reference pages for more info."},{"pos":[17590,17622],"content":"Built-in automation peer classes"},{"content":"In general, elements implement an automation peer class if they accept UI activity from the user, or if they contain information needed by users of assistive technologies that represent the interactive or meaningful UI of apps.","pos":[17810,18037]},{"content":"Not all UWP visual elements have automation peers.","pos":[18038,18088]},{"content":"Examples of classes that implement automation peers are <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Button<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209265)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>TextBox<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209683)</ept>.","pos":[18089,18292],"source":" Examples of classes that implement automation peers are [**Button**](https://msdn.microsoft.com/library/windows/apps/BR209265) and [**TextBox**](https://msdn.microsoft.com/library/windows/apps/BR209683)."},{"content":"Examples of classes that do not implement automation peers are <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Border<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209250)</ept> and classes based on <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Panel<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR227511)</ept>, such as <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Grid<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR242704)</ept> and <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>Canvas<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/BR209267)</ept>.","pos":[18293,18671],"source":" Examples of classes that do not implement automation peers are [**Border**](https://msdn.microsoft.com/library/windows/apps/BR209250) and classes based on [**Panel**](https://msdn.microsoft.com/library/windows/apps/BR227511), such as [**Grid**](https://msdn.microsoft.com/library/windows/apps/BR242704) and [**Canvas**](https://msdn.microsoft.com/library/windows/apps/BR209267)."},{"content":"A <bpt id=\"p1\">**</bpt>Panel<ept id=\"p1\">**</ept> has no peer because it is providing a layout behavior that is visual only.","pos":[18672,18758],"source":" A **Panel** has no peer because it is providing a layout behavior that is visual only."},{"content":"There is no accessibility-relevant way for the user to interact with a <bpt id=\"p1\">**</bpt>Panel<ept id=\"p1\">**</ept>.","pos":[18759,18840],"source":" There is no accessibility-relevant way for the user to interact with a **Panel**."},{"content":"Whatever child elements a <bpt id=\"p1\">**</bpt>Panel<ept id=\"p1\">**</ept> contains are instead reported to UI Automation trees as child elements of the next available parent in the tree that has a peer or element representation.","pos":[18841,19031],"source":" Whatever child elements a **Panel** contains are instead reported to UI Automation trees as child elements of the next available parent in the tree that has a peer or element representation."},{"pos":[19210,19250],"content":"UI Automation and UWP process boundaries"},{"content":"Typically, UI Automation client code that accesses a UWP app runs out-of-process.","pos":[19470,19551]},{"content":"The UI Automation framework infrastructure enables information to get across the process boundary.","pos":[19552,19650]},{"content":"This concept is explained in more detail in <bpt id=\"p1\">[</bpt>UI Automation Fundamentals<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee684007)</ept>.","pos":[19651,19785],"source":" This concept is explained in more detail in [UI Automation Fundamentals](https://msdn.microsoft.com/library/windows/desktop/Ee684007)."},{"pos":[19910,19932],"content":"OnCreateAutomationPeer"},{"content":"All classes that derive from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UIElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR208911)</ept> contain the protected virtual method <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>OnCreateAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)</ept>.","pos":[20080,20330],"source":"All classes that derive from [**UIElement**](https://msdn.microsoft.com/library/windows/apps/BR208911) contain the protected virtual method [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)."},{"content":"The object initialization sequence for automation peers calls <bpt id=\"p1\">**</bpt>OnCreateAutomationPeer<ept id=\"p1\">**</ept> to get the automation peer object for each control and thus to construct a UI Automation tree for run-time use.","pos":[20331,20531],"source":" The object initialization sequence for automation peers calls **OnCreateAutomationPeer** to get the automation peer object for each control and thus to construct a UI Automation tree for run-time use."},{"content":"UI Automation code can use the peer to get information about a controlâ€™s characteristics and features and to simulate interactive use by means of its control patterns.","pos":[20532,20699]},{"content":"A custom control that supports automation must override <bpt id=\"p1\">**</bpt>OnCreateAutomationPeer<ept id=\"p1\">**</ept> and return an instance of a class that derives from <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>AutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept>.","pos":[20700,20914],"source":" A custom control that supports automation must override **OnCreateAutomationPeer** and return an instance of a class that derives from [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185)."},{"content":"For example, if a custom control derives from the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ButtonBase<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227736)</ept> class, the object returned by <bpt id=\"p3\">**</bpt>OnCreateAutomationPeer<ept id=\"p3\">**</ept> should derive from <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>ButtonBaseAutomationPeer<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR242460)</ept>.","pos":[20915,21205],"source":" For example, if a custom control derives from the [**ButtonBase**](https://msdn.microsoft.com/library/windows/apps/BR227736) class, the object returned by **OnCreateAutomationPeer** should derive from [**ButtonBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242460)."},{"content":"If you're writing a custom control class and intend to also supply a new automation peer, you should override the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnCreateAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)</ept> method for your custom control so that it returns a new instance of your peer.","pos":[21207,21509],"source":"If you're writing a custom control class and intend to also supply a new automation peer, you should override the [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) method for your custom control so that it returns a new instance of your peer."},{"content":"Your peer class must derive directly or indirectly from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept>.","pos":[21510,21645],"source":" Your peer class must derive directly or indirectly from [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185)."},{"pos":[21647,21795],"content":"For example, the following code declares that the custom control <ph id=\"ph1\">`NumericUpDown`</ph> should use the peer <ph id=\"ph2\">`NumericUpDownPeer`</ph> for UI Automation purposes.","source":"For example, the following code declares that the custom control `NumericUpDown` should use the peer `NumericUpDownPeer` for UI Automation purposes."},{"content":"C","pos":[21930,21931]},{"content":"VB","pos":[22496,22498]},{"content":"C++","pos":[23066,23069]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>OnCreateAutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)</ept> implementation should do nothing more than initialize a new instance of your custom automation peer, passing the calling control as owner, and return that instance.","pos":[23457,23745],"source":"**Note**  The [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) implementation should do nothing more than initialize a new instance of your custom automation peer, passing the calling control as owner, and return that instance."},{"content":"Do not attempt additional logic in this method.","pos":[23746,23793]},{"content":"In particular, any logic that could potentially lead to destruction of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept> within the same call may result in unexpected runtime behavior.","pos":[23794,24011],"source":" In particular, any logic that could potentially lead to destruction of the [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) within the same call may result in unexpected runtime behavior."},{"pos":[24016,24297],"content":"In typical implementations of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnCreateAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)</ept>, the <bpt id=\"p3\">*</bpt>owner<ept id=\"p3\">*</ept> is specified as <bpt id=\"p4\">**</bpt>this<ept id=\"p4\">**</ept> or <bpt id=\"p5\">**</bpt>Me<ept id=\"p5\">**</ept> because the method override is in the same scope as the rest of the control class definition.","source":"In typical implementations of [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer), the *owner* is specified as **this** or **Me** because the method override is in the same scope as the rest of the control class definition."},{"content":"The actual peer class definition can be done in the same code file as the control or in a separate code file.","pos":[24299,24408]},{"content":"The peer definitions all exist in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.UI.Xaml.Automation.Peers<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242563)</ept> namespace that is a separate namespace from the controls that they provide peers for.","pos":[24409,24629],"source":" The peer definitions all exist in the [**Windows.UI.Xaml.Automation.Peers**](https://msdn.microsoft.com/library/windows/apps/BR242563) namespace that is a separate namespace from the controls that they provide peers for."},{"content":"You can choose to declare your peers in separate namespaces also, as long as you reference the necessary namespaces for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnCreateAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)</ept> method call.","pos":[24630,24876],"source":" You can choose to declare your peers in separate namespaces also, as long as you reference the necessary namespaces for the [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) method call."},{"pos":[25047,25083],"content":"Choosing the correct peer base class"},{"content":"Make sure that your <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept> is derived from a base class that gives you the best match for the existing peer logic of the control class you are deriving from.","pos":[25085,25314],"source":"Make sure that your [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) is derived from a base class that gives you the best match for the existing peer logic of the control class you are deriving from."},{"content":"In the case of the previous example, because <ph id=\"ph1\">`NumericUpDown`</ph> derives from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RangeBase<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227863)</ept>, there is a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RangeBaseAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242506)</ept> class available that you should base your peer on.","pos":[25315,25613],"source":" In the case of the previous example, because `NumericUpDown` derives from [**RangeBase**](https://msdn.microsoft.com/library/windows/apps/BR227863), there is a [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506) class available that you should base your peer on."},{"content":"By using the closest matching peer class in parallel to how you derive the control itself, you can avoid overriding at least some of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IRangeValueProvider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242590)</ept> functionality because the base peer class already implements it.","pos":[25614,25899],"source":" By using the closest matching peer class in parallel to how you derive the control itself, you can avoid overriding at least some of the [**IRangeValueProvider**](https://msdn.microsoft.com/library/windows/apps/BR242590) functionality because the base peer class already implements it."},{"content":"The base <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Control<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209390)</ept> class does not have a corresponding peer class.","pos":[25901,26029],"source":"The base [**Control**](https://msdn.microsoft.com/library/windows/apps/BR209390) class does not have a corresponding peer class."},{"content":"If you need a peer class to correspond to a custom control that derives from <bpt id=\"p1\">**</bpt>Control<ept id=\"p1\">**</ept>, derive the custom peer class from <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept>.","pos":[26030,26249],"source":" If you need a peer class to correspond to a custom control that derives from **Control**, derive the custom peer class from [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472)."},{"content":"If you derive from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ContentControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209365)</ept> directly, that class has no default automation peer behavior because there is no <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>OnCreateAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)</ept> implementation that references a peer class.","pos":[26251,26584],"source":"If you derive from [**ContentControl**](https://msdn.microsoft.com/library/windows/apps/BR209365) directly, that class has no default automation peer behavior because there is no [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) implementation that references a peer class."},{"content":"So make sure either to implement <bpt id=\"p1\">**</bpt>OnCreateAutomationPeer<ept id=\"p1\">**</ept> to use your own peer, or to use <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept> as the peer if that level of accessibility support is adequate for your control.","pos":[26585,26852],"source":" So make sure either to implement **OnCreateAutomationPeer** to use your own peer, or to use [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) as the peer if that level of accessibility support is adequate for your control."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  You don't typically derive from <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>AutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept> rather than <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept>.","pos":[26854,27082],"source":"**Note**  You don't typically derive from [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) rather than [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472)."},{"content":"If you did derive directly from <bpt id=\"p1\">**</bpt>AutomationPeer<ept id=\"p1\">**</ept> you'll need to duplicate a lot of basic accessibility support that would otherwise come from <bpt id=\"p2\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p2\">**</ept>.","pos":[27083,27262],"source":" If you did derive directly from **AutomationPeer** you'll need to duplicate a lot of basic accessibility support that would otherwise come from **FrameworkElementAutomationPeer**."},{"pos":[27435,27472],"content":"Initialization of a custom peer class"},{"content":"The automation peer should define a type-safe constructor that uses an instance of the owner control for base initialization.","pos":[27680,27805]},{"content":"In the next example, the implementation passes the <bpt id=\"p1\">*</bpt>owner<ept id=\"p1\">*</ept> value on to the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>RangeBaseAutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR242506)</ept> base, and ultimately it is the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept> that actually uses <bpt id=\"p6\">*</bpt>owner<ept id=\"p6\">*</ept> to set <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>FrameworkElementAutomationPeer.Owner<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/BR242472_owner)</ept>.","pos":[27806,28236],"source":" In the next example, the implementation passes the *owner* value on to the [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506) base, and ultimately it is the [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) that actually uses *owner* to set [**FrameworkElementAutomationPeer.Owner**](https://msdn.microsoft.com/library/windows/apps/BR242472_owner)."},{"content":"C","pos":[28371,28372]},{"content":"VB","pos":[28700,28702]},{"content":"C++","pos":[29031,29034]},{"content":"Core methods of AutomationPeer","pos":[29493,29523],"source":"Core methods of AutomationPeer\n"},{"content":"For UWP infrastructure reasons, the overridable methods of an automation peer are part of a pair of methods: the public access method that the UI Automation provider uses as a forwarding point for UI Automation clients, and the protected \"Core\" customization method that a UWP class can override to influence the behavior.","pos":[29703,30025]},{"content":"The method pair is wired together by default in such a way that the call to the access method always invokes the parallel \"Core\" method that has the provider implementation, or as a fallback, invokes a default implementation from the base classes.","pos":[30026,30273]},{"content":"When implementing a peer for a custom control, override any of the \"Core\" methods from the base automation peer class where you want to expose behavior that is unique to your custom control.","pos":[30275,30465]},{"content":"UI Automation code gets information about your control by calling public methods of the peer class.","pos":[30466,30565]},{"content":"To provide information about your control, override each method with a name that ends with \"Core\" when your control implementation and design creates accessibility scenarios or other UI Automation scenarios that differ from what's supported by the base automation peer class.","pos":[30566,30841]},{"pos":[30843,31044],"content":"At a minimum, whenever you define a new peer class, implement the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetClassNameCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getclassnamecore)</ept> method, as shown in the next example.","source":"At a minimum, whenever you define a new peer class, implement the [**GetClassNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclassnamecore) method, as shown in the next example."},{"content":"C","pos":[31179,31180]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  You might want to store the strings as constants rather than directly in the method body, but that is up to you.","pos":[31385,31507],"source":"**Note**  You might want to store the strings as constants rather than directly in the method body, but that is up to you."},{"content":"For <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetClassNameCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getclassnamecore)</ept>, you won't need to localize this string.","pos":[31508,31650],"source":" For [**GetClassNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclassnamecore), you won't need to localize this string."},{"content":"The <bpt id=\"p1\">**</bpt>LocalizedControlType<ept id=\"p1\">**</ept> property is used any time a localized string is needed by a UI Automation client, not <bpt id=\"p2\">**</bpt>ClassName<ept id=\"p2\">**</ept>.","pos":[31651,31780],"source":" The **LocalizedControlType** property is used any time a localized string is needed by a UI Automation client, not **ClassName**."},{"pos":[31918,31942],"content":"GetAutomationControlType"},{"content":"Some assistive technologies use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetAutomationControlType<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltype)</ept> value directly when reporting characteristics of the items in a UI Automation tree, as additional information beyond the UI Automation <bpt id=\"p3\">**</bpt>Name<ept id=\"p3\">**</ept>.","pos":[31944,32238],"source":"Some assistive technologies use the [**GetAutomationControlType**](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltype) value directly when reporting characteristics of the items in a UI Automation tree, as additional information beyond the UI Automation **Name**."},{"content":"If your control is significantly different from the control you are deriving from and you want to report a different control type from what is reported by the base peer class used by the control, you must implement a peer and override <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetAutomationControlTypeCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltypecore)</ept> in your peer implementation.","pos":[32239,32624],"source":" If your control is significantly different from the control you are deriving from and you want to report a different control type from what is reported by the base peer class used by the control, you must implement a peer and override [**GetAutomationControlTypeCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltypecore) in your peer implementation."},{"content":"This is particularly important if you derive from a generalized base class such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ItemsControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242803)</ept> or <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ContentControl<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209365)</ept>, where the base peer doesn't provide precise information about control type.","pos":[32625,32943],"source":" This is particularly important if you derive from a generalized base class such as [**ItemsControl**](https://msdn.microsoft.com/library/windows/apps/BR242803) or [**ContentControl**](https://msdn.microsoft.com/library/windows/apps/BR209365), where the base peer doesn't provide precise information about control type."},{"content":"Your implementation of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetAutomationControlTypeCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltypecore)</ept> describes your control by returning an <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>AutomationControlType<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209182)</ept> value.","pos":[32945,33221],"source":"Your implementation of [**GetAutomationControlTypeCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltypecore) describes your control by returning an [**AutomationControlType**](https://msdn.microsoft.com/library/windows/apps/BR209182) value."},{"content":"Although you can return <bpt id=\"p1\">**</bpt>AutomationControlType.Custom<ept id=\"p1\">**</ept>, you should return one of the more specific control types if it accurately describes your control's main scenarios.","pos":[33222,33394],"source":" Although you can return **AutomationControlType.Custom**, you should return one of the more specific control types if it accurately describes your control's main scenarios."},{"content":"Here's an example.","pos":[33395,33413]},{"content":"C","pos":[33548,33549]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Unless you specify <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>AutomationControlType.Custom<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR209182)</ept>, you don't have to implement <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>GetLocalizedControlTypeCore<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getlocalizedcontroltypecore)</ept> to provide a <bpt id=\"p6\">**</bpt>LocalizedControlType<ept id=\"p6\">**</ept> property value to clients.","pos":[33785,34120],"source":"**Note**  Unless you specify [**AutomationControlType.Custom**](https://msdn.microsoft.com/library/windows/apps/BR209182), you don't have to implement [**GetLocalizedControlTypeCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlocalizedcontroltypecore) to provide a **LocalizedControlType** property value to clients."},{"content":"UI Automation common infrastructure provides translated strings for every possible <bpt id=\"p1\">**</bpt>AutomationControlType<ept id=\"p1\">**</ept> value other than <bpt id=\"p2\">**</bpt>AutomationControlType.Custom<ept id=\"p2\">**</ept>.","pos":[34121,34280],"source":" UI Automation common infrastructure provides translated strings for every possible **AutomationControlType** value other than **AutomationControlType.Custom**."},{"pos":[34433,34462],"content":"GetPattern and GetPatternCore"},{"content":"A peer's implementation of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> returns the object that supports the pattern that is requested in the input parameter.","pos":[34464,34671],"source":"A peer's implementation of [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) returns the object that supports the pattern that is requested in the input parameter."},{"content":"Specifically, a UI Automation client calls a method that is forwarded to the provider's <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPattern<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern)</ept> method, and specifies a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PatternInterface<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242496)</ept> enumeration value that names the requested pattern.","pos":[34672,35002],"source":" Specifically, a UI Automation client calls a method that is forwarded to the provider's [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) method, and specifies a [**PatternInterface**](https://msdn.microsoft.com/library/windows/apps/BR242496) enumeration value that names the requested pattern."},{"content":"Your override of <bpt id=\"p1\">**</bpt>GetPatternCore<ept id=\"p1\">**</ept> should return the object that implements the specified pattern.","pos":[35003,35102],"source":" Your override of **GetPatternCore** should return the object that implements the specified pattern."},{"content":"That object is the peer itself, because the peer should implement the corresponding pattern interface any time that it reports that it supports a pattern.","pos":[35103,35257]},{"content":"If your peer does not have a custom implementation of a pattern, but you know that the peer's base does implement the pattern, you can call the base type's implementation of <bpt id=\"p1\">**</bpt>GetPatternCore<ept id=\"p1\">**</ept> from your <bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept>.","pos":[35258,35480],"source":" If your peer does not have a custom implementation of a pattern, but you know that the peer's base does implement the pattern, you can call the base type's implementation of **GetPatternCore** from your **GetPatternCore**."},{"content":"A peer's <bpt id=\"p1\">**</bpt>GetPatternCore<ept id=\"p1\">**</ept> should return <bpt id=\"p2\">**</bpt>null<ept id=\"p2\">**</ept> if a pattern is not supported by the peer.","pos":[35481,35574],"source":" A peer's **GetPatternCore** should return **null** if a pattern is not supported by the peer."},{"content":"However, instead of returning <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept> directly from your implementation, you would usually rely on the call to the base implementation to return <bpt id=\"p2\">**</bpt>null<ept id=\"p2\">**</ept> for any unsupported pattern.","pos":[35575,35758],"source":" However, instead of returning **null** directly from your implementation, you would usually rely on the call to the base implementation to return **null** for any unsupported pattern."},{"content":"When a pattern is supported, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> implementation can return <bpt id=\"p3\">**</bpt>this<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>Me<ept id=\"p4\">**</ept>.","pos":[35760,35932],"source":"When a pattern is supported, the [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) implementation can return **this** or **Me**."},{"content":"The expectation is that the UI Automation client will cast the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPattern<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern)</ept> return value to the requested pattern interface whenever it is not <bpt id=\"p3\">**</bpt>null<ept id=\"p3\">**</ept>.","pos":[35933,36158],"source":" The expectation is that the UI Automation client will cast the [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) return value to the requested pattern interface whenever it is not **null**."},{"content":"If a peer class inherits from another peer, and all necessary support and pattern reporting is already handled by the base class, implementing <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> isn't necessary.","pos":[36160,36413],"source":"If a peer class inherits from another peer, and all necessary support and pattern reporting is already handled by the base class, implementing [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) isn't necessary."},{"content":"For example, if you are implementing a range control that derives from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RangeBase<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227863)</ept>, and your peer derives from <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RangeBaseAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242506)</ept>, that peer returns itself for <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>PatternInterface.RangeValue<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR242496)</ept> and has working implementations of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>IRangeValueProvider<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/BR242590)</ept> interface that supports the pattern.","pos":[36414,36956],"source":" For example, if you are implementing a range control that derives from [**RangeBase**](https://msdn.microsoft.com/library/windows/apps/BR227863), and your peer derives from [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506), that peer returns itself for [**PatternInterface.RangeValue**](https://msdn.microsoft.com/library/windows/apps/BR242496) and has working implementations of the [**IRangeValueProvider**](https://msdn.microsoft.com/library/windows/apps/BR242590) interface that supports the pattern."},{"pos":[36958,37244],"content":"Although it is not the literal code, this example approximates the implementation of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> already present in <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RangeBaseAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242506)</ept>.","source":"Although it is not the literal code, this example approximates the implementation of [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) already present in [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506)."},{"content":"C","pos":[37379,37380]},{"pos":[37714,38081],"content":"If you are implementing a peer where you don't have all the support you need from a base peer class, or you want to change or add to the set of base-inherited patterns that your peer can support, then you should override <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> to enable UI Automation clients to use the patterns.","source":"If you are implementing a peer where you don't have all the support you need from a base peer class, or you want to change or add to the set of base-inherited patterns that your peer can support, then you should override [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) to enable UI Automation clients to use the patterns."},{"content":"For a list of the provider patterns that are available in the UWP implementation of UI Automation support, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.UI.Xaml.Automation.Provider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209225)</ept>.","pos":[38083,38294],"source":"For a list of the provider patterns that are available in the UWP implementation of UI Automation support, see [**Windows.UI.Xaml.Automation.Provider**](https://msdn.microsoft.com/library/windows/apps/BR209225)."},{"content":"Each such pattern has a corresponding value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PatternInterface<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242496)</ept> enumeration, which is how UI Automation clients request the pattern in a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetPattern<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern)</ept> call.","pos":[38295,38591],"source":" Each such pattern has a corresponding value of the [**PatternInterface**](https://msdn.microsoft.com/library/windows/apps/BR242496) enumeration, which is how UI Automation clients request the pattern in a [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) call."},{"content":"A peer can report that it supports more than one pattern.","pos":[38593,38650]},{"content":"If so, the override should include return path logic for each supported <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PatternInterface<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242496)</ept> value and return the peer in each matching case.","pos":[38651,38852],"source":" If so, the override should include return path logic for each supported [**PatternInterface**](https://msdn.microsoft.com/library/windows/apps/BR242496) value and return the peer in each matching case."},{"content":"It is expected that the caller will request only one interface at a time, and it is up to the caller to cast to the expected interface.","pos":[38853,38988]},{"content":"Here's an example of a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> override for a custom peer.","pos":[38990,39134],"source":"Here's an example of a [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) override for a custom peer."},{"content":"It reports the support for two patterns, <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IRangeValueProvider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242590)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IToggleProvider<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242653)</ept>.","pos":[39135,39344],"source":" It reports the support for two patterns, [**IRangeValueProvider**](https://msdn.microsoft.com/library/windows/apps/BR242590) and [**IToggleProvider**](https://msdn.microsoft.com/library/windows/apps/BR242653)."},{"content":"The control here is a media display control that can display as full-screen (the toggle mode) and that has a progress bar within which users can select a position (the range control).","pos":[39345,39528]},{"content":"This code came from the <bpt id=\"p1\">[</bpt>XAML accessibility sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=238570)</ept>.","pos":[39529,39630],"source":" This code came from the [XAML accessibility sample](http://go.microsoft.com/fwlink/p/?linkid=238570)."},{"content":"C","pos":[39765,39766]},{"pos":[40331,40367],"content":"Forwarding patterns from subelements"},{"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> method implementation can also specify a subelement or part as a pattern provider for its host.","pos":[40369,40560],"source":"A [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) method implementation can also specify a subelement or part as a pattern provider for its host."},{"content":"This example mimics how <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ItemsControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242803)</ept> transfers scroll-pattern handling to the peer of its internal <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ScrollViewer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209527)</ept> control.","pos":[40561,40809],"source":" This example mimics how [**ItemsControl**](https://msdn.microsoft.com/library/windows/apps/BR242803) transfers scroll-pattern handling to the peer of its internal [**ScrollViewer**](https://msdn.microsoft.com/library/windows/apps/BR209527) control."},{"content":"To specify a subelement for pattern handling, this code gets the subelement object, creates a peer for the subelement by using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElement.CreatePeerForElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242472_createpeerforelement)</ept> method, and returns the new peer.","pos":[40810,41097],"source":" To specify a subelement for pattern handling, this code gets the subelement object, creates a peer for the subelement by using the [**FrameworkElement.CreatePeerForElement**](https://msdn.microsoft.com/library/windows/apps/BR242472_createpeerforelement) method, and returns the new peer."},{"content":"C","pos":[41232,41233]},{"pos":[42354,42372],"content":"Other Core methods"},{"content":"Your control may need to support keyboard equivalents for primary scenarios; for more info about why this might be necessary, see <bpt id=\"p1\">[</bpt>Keyboard accessibility<ept id=\"p1\">](keyboard-accessibility.md)</ept>.","pos":[42374,42556],"source":"Your control may need to support keyboard equivalents for primary scenarios; for more info about why this might be necessary, see [Keyboard accessibility](keyboard-accessibility.md)."},{"content":"Implementing the key support is necessarily part of the control code and not the peer code because that is part of a control's logic, but your peer class should override the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetAcceleratorKeyCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getacceleratorkeycore)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetAccessKeyCore<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getaccesskeycore)</ept> methods to report to UI Automation clients which keys are used.","pos":[42557,43004],"source":" Implementing the key support is necessarily part of the control code and not the peer code because that is part of a control's logic, but your peer class should override the [**GetAcceleratorKeyCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getacceleratorkeycore) and [**GetAccessKeyCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getaccesskeycore) methods to report to UI Automation clients which keys are used."},{"content":"Consider that the strings that report key information might need to be localized, and should therefore come from resources, not hard-coded strings.","pos":[43005,43152]},{"content":"If you are providing a peer for a class that supports a collection, it's best to derive from both functional classes and peer classes that already have that kind of collection support.","pos":[43154,43338]},{"content":"If you can't do so, peers for controls that maintain child collections may have to override the collection-related peer method <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetChildrenCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildrencore)</ept> to properly report the parent-child relationships to the UI Automation tree.","pos":[43339,43638],"source":" If you can't do so, peers for controls that maintain child collections may have to override the collection-related peer method [**GetChildrenCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildrencore) to properly report the parent-child relationships to the UI Automation tree."},{"content":"Implement the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IsContentElementCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_iscontentelementcore)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IsControlElementCore<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_iscontrolelementcore)</ept> methods to indicate whether your control contains data content or fulfills an interactive role in the user interface (or both).","pos":[43640,43997],"source":"Implement the [**IsContentElementCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_iscontentelementcore) and [**IsControlElementCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_iscontrolelementcore) methods to indicate whether your control contains data content or fulfills an interactive role in the user interface (or both)."},{"content":"By default, both methods return <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[43998,44039],"source":" By default, both methods return **true**."},{"content":"These settings improve the usability of assistive technologies such as screen readers, which may use these methods to filter the automation tree.","pos":[44040,44185]},{"content":"If your <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPatternCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore)</ept> method transfers pattern handling to a subelement peer, the subelement peer's <bpt id=\"p3\">**</bpt>IsControlElementCore<ept id=\"p3\">**</ept> method can return <bpt id=\"p4\">**</bpt>false<ept id=\"p4\">**</ept> to hide the subelement peer from the automation tree.","pos":[44186,44472],"source":" If your [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) method transfers pattern handling to a subelement peer, the subelement peer's **IsControlElementCore** method can return **false** to hide the subelement peer from the automation tree."},{"content":"Some controls may support labeling scenarios, where a text label part supplies information for a non-text part, or a control is intended to be in a known labeling relationship with another control in the UI.","pos":[44474,44681]},{"content":"If it's possible to provide a useful class-based behavior, you can override <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetLabeledByCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getlabeledbycore)</ept> to provide this behavior.","pos":[44682,44881],"source":" If it's possible to provide a useful class-based behavior, you can override [**GetLabeledByCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlabeledbycore) to provide this behavior."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetBoundingRectangleCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getboundingrectanglecore)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetClickablePointCore<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getclickablepointcore)</ept> are used mainly for automated testing scenarios.","pos":[44883,45157],"source":"[**GetBoundingRectangleCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getboundingrectanglecore) and [**GetClickablePointCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclickablepointcore) are used mainly for automated testing scenarios."},{"content":"If you want to support automated testing for your control, you might want to override these methods.","pos":[45158,45258]},{"content":"This might be desired for range-type controls, where you can't suggest just a single point because where the user clicks in coordinate space has a different effect on a range.","pos":[45259,45434]},{"content":"For example, the default <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ScrollBar<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209745)</ept> automation peer overrides <bpt id=\"p3\">**</bpt>GetClickablePointCore<ept id=\"p3\">**</ept> to return a \"not a number\" <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Point<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR225870)</ept> value.","pos":[45435,45689],"source":" For example, the default [**ScrollBar**](https://msdn.microsoft.com/library/windows/apps/BR209745) automation peer overrides **GetClickablePointCore** to return a \"not a number\" [**Point**](https://msdn.microsoft.com/library/windows/apps/BR225870) value."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetLiveSettingCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getlivesettingcore)</ept> influences the control default for the <bpt id=\"p3\">**</bpt>LiveSetting<ept id=\"p3\">**</ept> value for UI Automation.","pos":[45691,45872],"source":"[**GetLiveSettingCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlivesettingcore) influences the control default for the **LiveSetting** value for UI Automation."},{"content":"You might want to override this if you want your control to return a value other than <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationLiveSetting.Off<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/JJ191519)</ept>.","pos":[45873,46049],"source":" You might want to override this if you want your control to return a value other than [**AutomationLiveSetting.Off**](https://msdn.microsoft.com/library/windows/apps/JJ191519)."},{"content":"For more info on what <bpt id=\"p1\">**</bpt>LiveSetting<ept id=\"p1\">**</ept> represents, see <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>AutomationProperties.LiveSetting<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/JJ191516)</ept>.","pos":[46050,46201],"source":" For more info on what **LiveSetting** represents, see [**AutomationProperties.LiveSetting**](https://msdn.microsoft.com/library/windows/apps/JJ191516)."},{"content":"You might override <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetOrientationCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getorientationcore)</ept> if your control has a settable orientation property that can map to <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>AutomationOrientation<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209184)</ept>.","pos":[46203,46478],"source":"You might override [**GetOrientationCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getorientationcore) if your control has a settable orientation property that can map to [**AutomationOrientation**](https://msdn.microsoft.com/library/windows/apps/BR209184)."},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ScrollBarAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242522)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SliderAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242546)</ept> classes do this.","pos":[46479,46676],"source":" The [**ScrollBarAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242522) and [**SliderAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242546) classes do this."},{"pos":[46898,46951],"content":"Base implementation in FrameworkElementAutomationPeer"},{"pos":[46953,47223],"content":"The base implementation of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept> provides some UI Automation information that can be interpreted from various layout and behavior properties that are defined at the framework level.","source":"The base implementation of [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) provides some UI Automation information that can be interpreted from various layout and behavior properties that are defined at the framework level."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetBoundingRectangleCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getboundingrectanglecore)</ept>: Returns a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Rect<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR225994)</ept> structure based on the known layout characteristics.","pos":[47229,47475],"source":"[**GetBoundingRectangleCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getboundingrectanglecore): Returns a [**Rect**](https://msdn.microsoft.com/library/windows/apps/BR225994) structure based on the known layout characteristics."},{"content":"Returns a 0-value <bpt id=\"p1\">**</bpt>Rect<ept id=\"p1\">**</ept> if <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>IsOffscreen<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreen)</ept> is <bpt id=\"p4\">**</bpt>true<ept id=\"p4\">**</ept>.","pos":[47476,47606],"source":" Returns a 0-value **Rect** if [**IsOffscreen**](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreen) is **true**."},{"pos":[47611,47905],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetClickablePointCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getclickablepointcore)</ept>: Returns a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Point<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR225870)</ept> structure based on the known layout characteristics, as long as there is a nonzero <bpt id=\"p5\">**</bpt>BoundingRectangle<ept id=\"p5\">**</ept>.","source":"[**GetClickablePointCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclickablepointcore): Returns a [**Point**](https://msdn.microsoft.com/library/windows/apps/BR225870) structure based on the known layout characteristics, as long as there is a nonzero **BoundingRectangle**."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetNameCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore)</ept>: More extensive behavior than can be summarized here; see <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetNameCore<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore)</ept>.","pos":[47910,48144],"source":"[**GetNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore): More extensive behavior than can be summarized here; see [**GetNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore)."},{"content":"Basically, it attempts a string conversion on any known content of a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ContentControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209365)</ept> or related classes that have content.","pos":[48145,48330],"source":" Basically, it attempts a string conversion on any known content of a [**ContentControl**](https://msdn.microsoft.com/library/windows/apps/BR209365) or related classes that have content."},{"content":"Also, if there is a value for <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LabeledBy<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh759769)</ept>, that item's <bpt id=\"p3\">**</bpt>Name<ept id=\"p3\">**</ept> value is used as the <bpt id=\"p4\">**</bpt>Name<ept id=\"p4\">**</ept>.","pos":[48331,48487],"source":" Also, if there is a value for [**LabeledBy**](https://msdn.microsoft.com/library/windows/apps/Hh759769), that item's **Name** value is used as the **Name**."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>HasKeyboardFocusCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_haskeyboardfocuscore)</ept>: Evaluated based on the owner's <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>FocusState<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209390_focusstate)</ept> and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>IsEnabled<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled)</ept> properties.","pos":[48492,48815],"source":"[**HasKeyboardFocusCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_haskeyboardfocuscore): Evaluated based on the owner's [**FocusState**](https://msdn.microsoft.com/library/windows/apps/BR209390_focusstate) and [**IsEnabled**](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled) properties."},{"content":"Elements that aren't controls always return <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>.","pos":[48816,48870],"source":" Elements that aren't controls always return **false**."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IsEnabledCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_isenabledcore)</ept>: Evaluated based on the owner's <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IsEnabled<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled)</ept> property if it is a <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Control<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR209390)</ept>.","pos":[48875,49175],"source":"[**IsEnabledCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_isenabledcore): Evaluated based on the owner's [**IsEnabled**](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled) property if it is a [**Control**](https://msdn.microsoft.com/library/windows/apps/BR209390)."},{"content":"Elements that aren't controls always return <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[49176,49229],"source":" Elements that aren't controls always return **true**."},{"content":"This doesn't mean that the owner is enabled in the conventional interaction sense; it means that the peer is enabled despite the owner not having an <bpt id=\"p1\">**</bpt>IsEnabled<ept id=\"p1\">**</ept> property.","pos":[49230,49402],"source":" This doesn't mean that the owner is enabled in the conventional interaction sense; it means that the peer is enabled despite the owner not having an **IsEnabled** property."},{"pos":[49407,49650],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IsKeyboardFocusableCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_iskeyboardfocusablecore)</ept>: Returns <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept> if owner is a <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Control<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/BR209390)</ept>; otherwise it is <bpt id=\"p6\">**</bpt>false<ept id=\"p6\">**</ept>.","source":"[**IsKeyboardFocusableCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_iskeyboardfocusablecore): Returns **true** if owner is a [**Control**](https://msdn.microsoft.com/library/windows/apps/BR209390); otherwise it is **false**."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IsOffscreenCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreencore)</ept>: A <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Visibility<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR208911_visibility)</ept> of <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Hidden<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR209006)</ept> on the owner element or any of its parents equates to a <bpt id=\"p7\">**</bpt>true<ept id=\"p7\">**</ept> value for <bpt id=\"p8\">[</bpt><bpt id=\"p9\">**</bpt>IsOffscreen<ept id=\"p9\">**</ept><ept id=\"p8\">](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreen)</ept>.","pos":[49655,50077],"source":"[**IsOffscreenCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreencore): A [**Visibility**](https://msdn.microsoft.com/library/windows/apps/BR208911_visibility) of [**Hidden**](https://msdn.microsoft.com/library/windows/apps/BR209006) on the owner element or any of its parents equates to a **true** value for [**IsOffscreen**](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreen)."},{"content":"Exception: a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Popup<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227842)</ept> object can be visible even if its owner's parents are not.","pos":[50078,50219],"source":" Exception: a [**Popup**](https://msdn.microsoft.com/library/windows/apps/BR227842) object can be visible even if its owner's parents are not."},{"pos":[50224,50397],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetFocusCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_setfocuscore)</ept>: Calls <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Focus<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209390_focus)</ept>.","source":"[**SetFocusCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_setfocuscore): Calls [**Focus**](https://msdn.microsoft.com/library/windows/apps/BR209390_focus)."},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetParent<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getparent)</ept>: Calls <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>FrameworkElement.Parent<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR208739)</ept> from the owner, and looks up the appropriate peer.","pos":[50402,50631],"source":"[**GetParent**](https://msdn.microsoft.com/library/windows/apps/BR209185_getparent): Calls [**FrameworkElement.Parent**](https://msdn.microsoft.com/library/windows/apps/BR208739) from the owner, and looks up the appropriate peer."},{"content":"This isn't an override pair with a \"Core\" method, so you can't change this behavior.","pos":[50632,50716]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Default UWP peers implement a behavior by using internal native code that implements the UWP, not necessarily by using actual UWP code.","pos":[50718,50863],"source":"**Note**  Default UWP peers implement a behavior by using internal native code that implements the UWP, not necessarily by using actual UWP code."},{"content":"You won't be able to see the code or logic of the implementation through common language runtime (CLR) reflection or other techniques.","pos":[50864,50998]},{"content":"You also won't see distinct reference pages for subclass-specific overrides of base peer behavior.","pos":[50999,51097]},{"content":"For example, there might be additional behavior for <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetNameCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore)</ept> of a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>TextBoxAutomationPeer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242550)</ept>, which won't be described on the <bpt id=\"p5\">**</bpt>AutomationPeer.GetNameCore<ept id=\"p5\">**</ept> reference page, and there is no reference page for <bpt id=\"p6\">**</bpt>TextBoxAutomationPeer.GetNameCore<ept id=\"p6\">**</ept>.","pos":[51098,51482],"source":" For example, there might be additional behavior for [**GetNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore) of a [**TextBoxAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242550), which won't be described on the **AutomationPeer.GetNameCore** reference page, and there is no reference page for **TextBoxAutomationPeer.GetNameCore**."},{"content":"There isn't even a <bpt id=\"p1\">**</bpt>TextBoxAutomationPeer.GetNameCore<ept id=\"p1\">**</ept> reference page.","pos":[51483,51555],"source":" There isn't even a **TextBoxAutomationPeer.GetNameCore** reference page."},{"content":"Instead, read the reference topic for the most immediate peer class, and look for implementation notes in the Remarks section.","pos":[51556,51682]},{"pos":[51834,51864],"content":"Peers and AutomationProperties"},{"content":"Your automation peer should provide appropriate default values for your control's accessibility-related information.","pos":[52044,52160]},{"content":"Note that any app code that uses the control can override some of that behavior by including <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209081)</ept> attached-property values on control instances.","pos":[52161,52385],"source":" Note that any app code that uses the control can override some of that behavior by including [**AutomationProperties**](https://msdn.microsoft.com/library/windows/apps/BR209081) attached-property values on control instances."},{"content":"Callers can do this either for the default controls or for custom controls.","pos":[52386,52461]},{"content":"For example, the following XAML creates a button that has two customized UI Automation properties:","pos":[52462,52560]},{"pos":[52673,52873],"content":"For more info about <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209081)</ept> attached properties, see <bpt id=\"p3\">[</bpt>Basic accessibility information<ept id=\"p3\">](basic-accessibility-information.md)</ept>.","source":"For more info about [**AutomationProperties**](https://msdn.microsoft.com/library/windows/apps/BR209081) attached properties, see [Basic accessibility information](basic-accessibility-information.md)."},{"content":"Some of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationPeer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185)</ept> methods exist because of the general contract of how UI Automation providers are expected to report information, but these methods are not typically implemented in control peers.","pos":[52875,53144],"source":"Some of the [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) methods exist because of the general contract of how UI Automation providers are expected to report information, but these methods are not typically implemented in control peers."},{"content":"This is because that info is expected to be provided by <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209081)</ept> values applied to the app code that uses the controls in a specific UI.","pos":[53145,53357],"source":" This is because that info is expected to be provided by [**AutomationProperties**](https://msdn.microsoft.com/library/windows/apps/BR209081) values applied to the app code that uses the controls in a specific UI."},{"content":"For example, most apps would define the labeling relationship between two different controls in the UI by applying a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties.LabeledBy<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh759769)</ept> value.","pos":[53358,53576],"source":" For example, most apps would define the labeling relationship between two different controls in the UI by applying a [**AutomationProperties.LabeledBy**](https://msdn.microsoft.com/library/windows/apps/Hh759769) value."},{"content":"However, <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LabeledByCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getlabeledbycore)</ept> is implemented in certain peers that represent data or item relationships in a control, such as using a header part to label a data-field part, labeling items with their containers, or similar scenarios.","pos":[53577,53884],"source":" However, [**LabeledByCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlabeledbycore) is implemented in certain peers that represent data or item relationships in a control, such as using a header part to label a data-field part, labeling items with their containers, or similar scenarios."},{"pos":[54010,54031],"content":"Implementing patterns"},{"content":"Let's look at how to write a peer for a control that implements an expand-collapse behavior by implementing the control pattern interface for expand-collapse.","pos":[54179,54337]},{"content":"The peer should enable the accessibility for the expand-collapse behavior by returning itself whenever <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetPattern<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern)</ept> is called with a value of <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PatternInterface.ExpandCollapse<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242496)</ept>.","pos":[54338,54649],"source":" The peer should enable the accessibility for the expand-collapse behavior by returning itself whenever [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) is called with a value of [**PatternInterface.ExpandCollapse**](https://msdn.microsoft.com/library/windows/apps/BR242496)."},{"content":"The peer should then inherit the provider interface for that pattern (<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IExpandCollapseProvider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671242)</ept>) and provide implementations for each of the members of that provider interface.","pos":[54650,54891],"source":" The peer should then inherit the provider interface for that pattern ([**IExpandCollapseProvider**](https://msdn.microsoft.com/library/windows/desktop/Ee671242)) and provide implementations for each of the members of that provider interface."},{"content":"In this case the interface has three members to override: <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Expand<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242570)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Collapse<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242569)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>ExpandCollapseState<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/BR242570collapsestate)</ept>.","pos":[54892,55193],"source":" In this case the interface has three members to override: [**Expand**](https://msdn.microsoft.com/library/windows/apps/BR242570), [**Collapse**](https://msdn.microsoft.com/library/windows/apps/BR242569), [**ExpandCollapseState**](https://msdn.microsoft.com/library/windows/apps/BR242570collapsestate)."},{"content":"It's helpful to plan ahead for accessibility in the API design of the class itself.","pos":[55195,55278]},{"content":"Whenever you have a behavior that is potentially requested either as a result of typical interactions with a user who is working in the UI or through an automation provider pattern, provide a single method that either the UI response or the automation pattern can call.","pos":[55279,55548]},{"content":"For example, if your control has button parts that have wired event handlers that can expand or collapse the control, and has keyboard equivalents for those actions, have these event handlers call the same method that you call from within the body of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Expand<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242570)</ept> or <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Collapse<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR242569)</ept> implementations for <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>IExpandCollapseProvider<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/desktop/Ee671242)</ept> in the peer.","pos":[55549,56074],"source":" For example, if your control has button parts that have wired event handlers that can expand or collapse the control, and has keyboard equivalents for those actions, have these event handlers call the same method that you call from within the body of the [**Expand**](https://msdn.microsoft.com/library/windows/apps/BR242570) or [**Collapse**](https://msdn.microsoft.com/library/windows/apps/BR242569) implementations for [**IExpandCollapseProvider**](https://msdn.microsoft.com/library/windows/desktop/Ee671242) in the peer."},{"content":"Using a common logic method can also be a useful way to make sure that your control's visual states are updated to show logical state in a uniform way, regardless of how the behavior was invoked.","pos":[56075,56270]},{"content":"A typical implementation is that the provider APIs first call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Owner<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242472_owner)</ept> for access to the control instance at run time.","pos":[56272,56457],"source":"A typical implementation is that the provider APIs first call [**Owner**](https://msdn.microsoft.com/library/windows/apps/BR242472_owner) for access to the control instance at run time."},{"content":"Then the necessary behavior methods can be called on that object.","pos":[56458,56523]},{"content":"C","pos":[56658,56659]},{"content":"An alternate implementation is that the control itself can reference its peer.","pos":[57028,57106]},{"content":"This is a common pattern if you are raising automation events from the control, because the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RaiseAutomationEvent<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_raiseautomationevent)</ept> method is a peer method.","pos":[57107,57329],"source":" This is a common pattern if you are raising automation events from the control, because the [**RaiseAutomationEvent**](https://msdn.microsoft.com/library/windows/apps/BR209185_raiseautomationevent) method is a peer method."},{"pos":[57448,57468],"content":"UI Automation events"},{"content":"UI Automation events fall into the following categories.","pos":[57608,57664]},{"content":"Event","pos":[57668,57673]},{"content":"Description","pos":[57687,57698]},{"content":"Property change","pos":[58874,58889]},{"content":"Fires when a property on a UI Automation element or control pattern changes.","pos":[58893,58969]},{"content":"For example, if a client needs to monitor an app's check box control, it can register to listen for a property change event on the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ToggleState<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242653_togglestate)</ept> property.","pos":[58970,59198],"source":" For example, if a client needs to monitor an app's check box control, it can register to listen for a property change event on the [**ToggleState**](https://msdn.microsoft.com/library/windows/apps/BR242653_togglestate) property."},{"content":"When the check box control is checked or unchecked, the provider fires the event and the client can act as necessary.","pos":[59199,59316]},{"content":"Element action","pos":[59498,59512]},{"pos":[59517,59671],"content":"Fires when a change in the UI results from user or programmatic activity; for example, when a button is clicked or invoked through the <bpt id=\"p1\">**</bpt>Invoke<ept id=\"p1\">**</ept> pattern.","source":"Fires when a change in the UI results from user or programmatic activity; for example, when a button is clicked or invoked through the **Invoke** pattern."},{"content":"Structure change","pos":[60101,60117]},{"content":"Fires when the structure of the UI Automation tree changes.","pos":[60120,60179]},{"content":"The structure changes when new UI items become visible, hidden, or removed on the desktop.","pos":[60180,60270]},{"content":"Global change","pos":[60704,60717]},{"content":"Fires when actions of global interest to the client occur, such as when the focus shifts from one element to another, or when a child window closes.","pos":[60723,60871]},{"content":"Some events do not necessarily mean that the state of the UI has changed.","pos":[60872,60945]},{"content":"For example, if the user tabs to a text-entry field and then clicks a button to update the field, a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TextChanged<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209683_textchanged)</ept> event fires even if the user did not actually change the text.","pos":[60946,61196],"source":" For example, if the user tabs to a text-entry field and then clicks a button to update the field, a [**TextChanged**](https://msdn.microsoft.com/library/windows/apps/BR209683_textchanged) event fires even if the user did not actually change the text."},{"content":"When processing an event, it may be necessary for a client application to check whether anything has actually changed before taking action.","pos":[61197,61336]},{"pos":[61488,61516],"content":"AutomationEvents identifiers"},{"content":"UI Automation events are identified by <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationEvents<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209183)</ept> values.","pos":[61518,61645],"source":"UI Automation events are identified by [**AutomationEvents**](https://msdn.microsoft.com/library/windows/apps/BR209183) values."},{"content":"The values of the enumeration uniquely identify the kind of event.","pos":[61646,61712]},{"pos":[61817,61831],"content":"Raising events"},{"content":"UI Automation clients can subscribe to automation events.","pos":[61833,61890]},{"content":"In the automation peer model, peers for custom controls must report changes to control state that are relevant to accessibility by calling the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RaiseAutomationEvent<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_raiseautomationevent)</ept> method.","pos":[61891,62147],"source":" In the automation peer model, peers for custom controls must report changes to control state that are relevant to accessibility by calling the [**RaiseAutomationEvent**](https://msdn.microsoft.com/library/windows/apps/BR209185_raiseautomationevent) method."},{"content":"Similarly, when a key UI Automation property value changes, custom control peers should call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RaisePropertyChangedEvent<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_raisepropertychangedevent)</ept> method.","pos":[62148,62368],"source":" Similarly, when a key UI Automation property value changes, custom control peers should call the [**RaisePropertyChangedEvent**](https://msdn.microsoft.com/library/windows/apps/BR209185_raisepropertychangedevent) method."},{"content":"The next code example shows how to get the peer object from within the control definition code and call a method to fire an event from that peer.","pos":[62370,62515]},{"content":"As an optimization, the code determines whether there are any listeners for this event type.","pos":[62516,62608]},{"content":"Firing the event and creating the peer object only when there are listeners avoids unnecessary overhead and helps the control remain responsive.","pos":[62609,62753]},{"content":"C","pos":[62888,62889]},{"content":"Peer navigation","pos":[63504,63519],"source":"Peer navigation\n"},{"content":"After locating an automation peer, a UI Automation client can navigate the peer structure of an app by calling the peer object's <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetChildren<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildren)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>GetParent<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getparent)</ept> methods.","pos":[63639,63952],"source":"After locating an automation peer, a UI Automation client can navigate the peer structure of an app by calling the peer object's [**GetChildren**](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildren) and [**GetParent**](https://msdn.microsoft.com/library/windows/apps/BR209185_getparent) methods."},{"content":"Navigation among UI elements within a control is supported by the peer's implementation of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetChildrenCore<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildrencore)</ept> method.","pos":[63953,64151],"source":" Navigation among UI elements within a control is supported by the peer's implementation of the [**GetChildrenCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildrencore) method."},{"content":"The UI Automation system calls this method to build up a tree of subelements contained within a control; for example, list items in a list box.","pos":[64152,64295]},{"content":"The default <bpt id=\"p1\">**</bpt>GetChildrenCore<ept id=\"p1\">**</ept> method in <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>FrameworkElementAutomationPeer<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/BR242472)</ept> traverses the visual tree of elements to build the tree of automation peers.","pos":[64296,64509],"source":" The default **GetChildrenCore** method in [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) traverses the visual tree of elements to build the tree of automation peers."},{"content":"Custom controls can override this method to expose a different representation of child elements to automation clients, returning the automation peers of elements that convey information or allow user interaction.","pos":[64510,64722]},{"pos":[64910,64953],"content":"Native automation support for text patterns"},{"content":"Some of the default UWP app automation peers provide control pattern support for the text pattern (<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PatternInterface.Text<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242496)</ept>).","pos":[65185,65371],"source":"Some of the default UWP app automation peers provide control pattern support for the text pattern ([**PatternInterface.Text**](https://msdn.microsoft.com/library/windows/apps/BR242496))."},{"content":"But they provide this support through native methods, and the peers involved won't note the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ITextProvider<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR242627)</ept> interface in the (managed) inheritance.","pos":[65372,65581],"source":" But they provide this support through native methods, and the peers involved won't note the [**ITextProvider**](https://msdn.microsoft.com/library/windows/apps/BR242627) interface in the (managed) inheritance."},{"content":"Still, if a managed or non-managed UI Automation client queries the peer for patterns, it will report support for the text pattern, and provide behavior for parts of the pattern when client APIs are called.","pos":[65582,65788]},{"content":"If you intend to derive from one of the UWP app text controls and also create a custom peer that derives from one of the text-related peers, check the Remarks sections for the peer to learn more about any native-level support for patterns.","pos":[65790,66029]},{"content":"You can access the native base behavior in your custom peer if you call the base implementation from your managed provider interface implementations, but it's difficult to modify what the base implementation does because the native interfaces on both the peer and its owner control aren't exposed.","pos":[66030,66327]},{"content":"Generally you should either use the base implementations as-is (call base only) or completely replace the functionality with your own managed code and don't call the base implementation.","pos":[66328,66514]},{"content":"The latter is an advanced scenario, you'll need good familiarity with the text services framework being used by your control in order to support the accessibility requirements when using that framework.","pos":[66515,66717]},{"pos":[66890,66928],"content":"AutomationProperties.AccessibilityView"},{"content":"In addition to providing a custom peer, you can also adjust the tree view representation for any control instance, by setting <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties.AccessibilityView<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview)</ept> in XAML.","pos":[67140,67395],"source":"In addition to providing a custom peer, you can also adjust the tree view representation for any control instance, by setting [**AutomationProperties.AccessibilityView**](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview) in XAML."},{"content":"This isn't implemented as part of a peer class, but we'll mention it here because it's germane to overall accessibility support either for custom controls or for templates you customize.","pos":[67396,67582]},{"content":"The main scenario for using <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties.AccessibilityView<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview)</ept> is to deliberately omit certain controls in a template from the UI Automation views, because they don't meaningfully contribute to the accessibility view of the entire control.","pos":[67584,67909],"source":"The main scenario for using [**AutomationProperties.AccessibilityView**](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview) is to deliberately omit certain controls in a template from the UI Automation views, because they don't meaningfully contribute to the accessibility view of the entire control."},{"content":"To prevent this, set <bpt id=\"p1\">**</bpt>AutomationProperties.AccessibilityView<ept id=\"p1\">**</ept> to \"Raw\".","pos":[67910,67983],"source":" To prevent this, set **AutomationProperties.AccessibilityView** to \"Raw\"."},{"content":"For more info, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AutomationProperties.AccessibilityView<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview)</ept>.","pos":[67984,68124],"source":" For more info, see [**AutomationProperties.AccessibilityView**](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview)."},{"pos":[68306,68347],"content":"Throwing exceptions from automation peers"},{"content":"The APIs that you are implementing for your automation peer support are permitted to throw exceptions.","pos":[68571,68673]},{"content":"It's expected any UI Automation clients that are listening are robust enough to continue on after most exceptions are thrown.","pos":[68674,68799]},{"content":"In all likelihood that listener is looking at an all-up automation tree that includes apps other than your own, and it's an unacceptable client design to bring down the entire client just because one area of the tree threw a peer-based exception when the client called its APIs.","pos":[68800,69078]},{"content":"For parameters that are passed in to your peer, it's acceptable to validate the input, and for example throw <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ArgumentNullException<ept id=\"p2\">**</ept><ept id=\"p1\">](T:System.ArgumentNullException)</ept> if it was passed <bpt id=\"p3\">**</bpt>null<ept id=\"p3\">**</ept> and that's not a valid value for your implementation.","pos":[69080,69328],"source":"For parameters that are passed in to your peer, it's acceptable to validate the input, and for example throw [**ArgumentNullException**](T:System.ArgumentNullException) if it was passed **null** and that's not a valid value for your implementation."},{"content":"However, if there are subsequent operations performed by your peer, remember that the peer's interactions with the hosting control have something of an asynchronous character to them.","pos":[69329,69512]},{"content":"Anything a peer does won't necessarily block the UI thread in the control (and it probably shouldn't).","pos":[69513,69615]},{"content":"So you could have situations where an object was available or had certain properties when the peer was created or when an automation peer method was first called, but in the meantime the control state has changed.","pos":[69616,69829]},{"content":"For these cases, there are two dedicated exceptions that a provider can throw:","pos":[69830,69908]},{"content":"Throw <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ElementNotAvailableException<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh673741)</ept> if you're unable to access either the peer's owner or a related peer element based on the original info your API was passed.","pos":[69914,70137],"source":"Throw [**ElementNotAvailableException**](https://msdn.microsoft.com/library/windows/apps/Hh673741) if you're unable to access either the peer's owner or a related peer element based on the original info your API was passed."},{"content":"For example, you might have a peer that's trying to run its methods but the owner has since been removed from the UI, such as a modal dialog that's been closed.","pos":[70138,70298]},{"content":"For a non-.NET client, this maps to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UIA\\_E\\_ELEMENTNOTAVAILABLE<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671218)</ept>.","pos":[70299,70430],"source":" For a non-.NET client, this maps to [**UIA\\_E\\_ELEMENTNOTAVAILABLE**](https://msdn.microsoft.com/library/windows/desktop/Ee671218)."},{"content":"Throw <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ElementNotEnabledException<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Hh673748)</ept> if there still is an owner, but that owner is in a mode such as <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IsEnabled<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled)</ept><ph id=\"ph1\">`=`</ph><bpt id=\"p5\">**</bpt>false<ept id=\"p5\">**</ept> that's blocking some of the specific programmatic changes that your peer is trying to accomplish.","pos":[70435,70789],"source":"Throw [**ElementNotEnabledException**](https://msdn.microsoft.com/library/windows/apps/Hh673748) if there still is an owner, but that owner is in a mode such as [**IsEnabled**](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled)`=`**false** that's blocking some of the specific programmatic changes that your peer is trying to accomplish."},{"content":"For a non-.NET client, this maps to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UIA\\_E\\_ELEMENTNOTENABLED<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/Ee671218)</ept>.","pos":[70790,70919],"source":" For a non-.NET client, this maps to [**UIA\\_E\\_ELEMENTNOTENABLED**](https://msdn.microsoft.com/library/windows/desktop/Ee671218)."},{"content":"Beyond this, peers should be relatively conservative regarding exceptions that they throw from their peer support.","pos":[70921,71035]},{"content":"Most clients won't be able to handle exceptions from peers and turn these into actionable choices that their users can make when interacting with the client.","pos":[71036,71193]},{"content":"So sometimes a no-op, and catching exceptions without rethrowing within your peer implementations, is a better strategy than is throwing exceptions every time something the peer tries to do doesn't work.","pos":[71194,71397]},{"content":"Consider also that most UI Automation clients aren't written in managed code.","pos":[71398,71475]},{"content":"Most are written in COM and are just checking for <bpt id=\"p1\">**</bpt>S\\_OK<ept id=\"p1\">**</ept> in an <bpt id=\"p2\">**</bpt>HRESULT<ept id=\"p2\">**</ept> whenever they call a UI Automation client method that ends up accessing your peer.","pos":[71476,71636],"source":" Most are written in COM and are just checking for **S\\_OK** in an **HRESULT** whenever they call a UI Automation client method that ends up accessing your peer."},{"content":"Related topics","pos":[71638,71652]},{"content":"Accessibility","pos":[71705,71718]},{"content":"XAML accessibility sample","pos":[71741,71766]},{"content":"FrameworkElementAutomationPeer","pos":[71822,71852]},{"content":"AutomationPeer","pos":[71919,71933]},{"content":"OnCreateAutomationPeer","pos":[72000,72022]},{"content":"Control patterns and interfaces","pos":[72110,72141]}],"content":"---\nDescription: Describes the concept of automation peers for Microsoft UI Automation, and how you can provide automation support for your own custom UI class.\ntitle: Custom automation peers\nms.assetid: AA8DA53B-FE6E-40AC-9F0A-CB09637C87B4\nlabel: Custom automation peers\ntemplate: detail.hbs\n---\n\n# Custom automation peers\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nDescribes the concept of automation peers for Microsoft UI Automation, and how you can provide automation support for your own custom UI class.\n\nUI Automation provides a framework that automation clients can use to examine or operate the user interfaces of a variety of UI platforms and frameworks. If you are writing a Universal Windows Platform (UWP) app, the classes that you use for your UI already provide UI Automation support. You can derive from existing, non-sealed classes to define a new kind of UI control or support class. In the process of doing so, your class might add behavior that should have accessibility support but that the default UI Automation support does not cover. In this case, you should extend the existing UI Automation support by deriving from the [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) class that the base implementation used, adding any necessary support to your peer implementation, and informing the Universal Windows Platform (UWP) control infrastructure that it should create your new peer.\n\nUI Automation enables not only accessibility applications and assistive technologies, such as screen readers, but also quality-assurance (test) code. In either scenario, UI Automation clients can examine user-interface elements and simulate user interaction with your app from other code outside your app. For info about UI Automation across all platforms and in its wider meaning, see [UI Automation Overview](https://msdn.microsoft.com/library/windows/desktop/Ee684076).\n\nThere are two distinct audiences who use the UI Automation framework.\n\n-   UI Automation *clients* call UI Automation APIs to learn about all of the UI that is currently displayed to the user. For example, an assistive technology such as a screen reader acts as a UI Automation client. The UI is presented as a tree of automation elements that are related. The UI Automation client might be interested in just one app at a time, or in the entire tree. The UI Automation client can use UI Automation APIs to navigate the tree and to read or change information in the automation elements.\n-   UI Automation *providers* contribute information to the UI Automation tree, by implementing APIs that expose the elements in the UI that they introduced as part of their app. When you create a new control, you should now act as a participant in the UI Automation provider scenario. As a provider, you should ensure that all UI Automation clients can use the UI Automation framework to interact with your control for both accessibility and testing purposes.\n\nTypically there are parallel APIs in the UI Automation framework: one API for UI Automation clients and another, similarly named API for UI Automation providers. For the most part, this topic covers the APIs for the UI Automation provider, and specifically the classes and interfaces that enable provider extensibility in that UI framework. Occasionally we mention UI Automation APIs that the UI Automation clients use, to provide some perspective, or provide a lookup table that correlates the client and provider APIs. For more info about the client perspective, see [UI Automation Client Programmer's Guide](https://msdn.microsoft.com/library/windows/desktop/Ee684021).\n\n**Note**  \nUI Automation clients don't typically use managed code and aren't typically implemented as a UWP app (they are usually desktop apps). UI Automation is based on a standard and not a specific implementation or framework. Many existing UI Automation clients, including assistive technology products such as screen readers, use Component Object Model (COM) interfaces to interact with UI Automation, the system, and the apps that run in child windows. For more info on the COM interfaces and how to write a UI Automation client using COM, see [UI Automation Fundamentals](https://msdn.microsoft.com/library/windows/desktop/Ee684007).\n\n \n\n<span id=\"Determining_the_existing_state_of_UI_Automation_support_for_your_custom_UI_class\"></span><span id=\"determining_the_existing_state_of_ui_automation_support_for_your_custom_ui_class\"></span><span id=\"DETERMINING_THE_EXISTING_STATE_OF_UI_AUTOMATION_SUPPORT_FOR_YOUR_CUSTOM_UI_CLASS\"></span>Determining the existing state of UI Automation support for your custom UI class\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nBefore you attempt to implement an automation peer for a custom control, you should test whether the base class and its automation peer already provides the accessibility or automation support that you need. In many cases, the combination of the [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) implementations, specific peers, and the patterns they implement can provide a basic but satisfactory accessibility experience. Whether this is true depends on how many changes you made to the object model exposure to your control versus its base class. Also, this depends on whether your additions to base class functionality correlate to new UI elements in the template contract or to the visual appearance of the control. In some cases your changes might introduce new aspects of user experience that require additional accessibility support.\n\nEven if using the existing base peer class provides the basic accessibility support, it is still a best practice to define a peer so that you can report precise **ClassName** information to UI Automation for automated testing scenarios. This consideration is especially important if you are writing a control that is intended for third-party consumption.\n\n<span id=\"Automation_peer_classes__\"></span><span id=\"automation_peer_classes__\"></span><span id=\"AUTOMATION_PEER_CLASSES__\"></span>Automation peer classes\n-----------------------------------------------------------------------------------------------------------------------------------------------------------\n\nThe UWP builds on existing UI Automation techniques and conventions used by previous managed-code UI frameworks such as Windows Forms, Windows Presentation Foundation (WPF) and Microsoft Silverlight. Many of the control classes and their function and purpose also have their origin in a previous UI framework.\n\nBy convention, peer class names begin with the control class name and end with \"AutomationPeer\". For example, [**ButtonAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242458) is the peer class for the [**Button**](https://msdn.microsoft.com/library/windows/apps/BR209265) control class.\n\n**Note**  For purposes of this topic, we treat the properties that are related to accessibility as being more important when you implement a control peer. But for a more general concept of UI Automation support, you should implement a peer in accordance with recommendations as documented by the [UI Automation Provider Programmer's Guide](https://msdn.microsoft.com/library/windows/desktop/Ee671596) and [UI Automation Fundamentals](https://msdn.microsoft.com/library/windows/desktop/Ee684007). Those topics don't cover the specific [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) APIs that you would use to provide the information in the UWP framework for UI Automation, but they do describe the properties that identify your class or provide other information or interaction.\n\n \n\n<span id=\"Peers__patterns_and_control_types\"></span><span id=\"peers__patterns_and_control_types\"></span><span id=\"PEERS__PATTERNS_AND_CONTROL_TYPES\"></span>Peers, patterns and control types\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nA *control pattern* is an interface implementation that exposes a particular aspect of a control's functionality to a UI Automation client. UI Automation clients use the properties and methods exposed through a control pattern to retrieve information about capabilities of the control, or to manipulate the control's behavior at run time.\n\nControl patterns provide a way to categorize and expose a control's functionality independent of the control type or the appearance of the control. For example, a control that presents a tabular interface uses the **Grid** control pattern to expose the number of rows and columns in the table, and to enable a UI Automation client to retrieve items from the table. As other examples, the UI Automation client can use the **Invoke** control pattern for controls that can be invoked, such as buttons, and the **Scroll** control pattern for controls that have scroll bars, such as list boxes, list views, or combo boxes. Each control pattern represents a separate type of functionality, and control patterns can be combined to describe the full set of functionality supported by a particular control.\n\nControl patterns relate to UI as interfaces relate to COM objects. In COM, you can query an object to ask what interfaces it supports and then use those interfaces to access functionality. In UI Automation, UI Automation clients can query a UI Automation element to find out which control patterns it supports, and then interact with the element and its peered control through the properties, methods, events, and structures exposed by the supported control patterns.\n\nOne of the main purposes of an automation peer is to report to a UI Automation client which control patterns the UI element can support through its peer. To do this, UI Automation providers implement new peers that change the [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) method behavior by overriding the [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) method. UI Automation clients make calls that the UI Automation provider maps to calling **GetPattern**. UI Automation clients query for each specific pattern that they want to interact with. If the peer supports the pattern, it returns an object reference to itself; otherwise it returns **null**. If the return is not **null**, the UI Automation client expects that it can call APIs of the pattern interface as a client, in order to interact with that control pattern.\n\nA *control type* is a way to broadly define the functionality of a control that the peer represents. This is a different concept than a control pattern because while a pattern informs UI Automation what info it can get or what actions it can perform through a particular interface, the control type exists one level above that. Each control type has guidance about these aspects of UI Automation:\n\n-   UI Automation control patterns: A control type might support more than one pattern, each of which represents a different classification of info or interaction. Each control type has a set of control patterns that the control must support, a set that is optional, and a set that the control must not support.\n-   UI Automation property values: Each control type has a set of properties that the control must support. These are the general properties, as described in [UI Automation Properties Overview](https://msdn.microsoft.com/library/windows/desktop/Ee671594), not the ones that are pattern-specific.\n-   UI Automation events: Each control type has a set of events that the control must support. Again these are general, not pattern-specific, as described in [UI Automation Events Overview](https://msdn.microsoft.com/library/windows/desktop/Ee671221).\n-   UI Automation tree structure: Each control type defines how the control must appear in the UI Automation tree structure.\n\nRegardless of how automation peers for the framework are implemented, UI Automation client functionality isn't tied to the UWP, and in fact it's likely that existing UI Automation clients such as assistive technologies will use other programming models, such as COM. In COM, clients can **QueryInterface** for the COM control pattern interface that implements the requested pattern or the general UI Automation framework for properties, events or tree examination. For the patterns, the UI Automation framework marshals that interface code across into UWP code running against the app's UI Automation provider and the relevant peer.\n\nWhen you implement control patterns for a managed-code framework such as a Windows Store app using C# or Microsoft Visual Basic, you can use .NET Framework interfaces to represent these patterns instead of using the COM interface representation. For example, the UI Automation pattern interface for a Microsoft .NET provider implementation of the **Invoke** pattern is [**IInvokeProvider**](https://msdn.microsoft.com/library/windows/apps/BR242582).\n\nFor a list of control patterns, provider interfaces, and their purpose, see [Control patterns and interfaces](control-patterns-and-interfaces.md). For the list of the control types, see [UI Automation Control Types Overview](https://msdn.microsoft.com/library/windows/desktop/Ee671197).\n\n### <span id=\"Guidance_for_how_to_implement_control_patterns\"></span><span id=\"guidance_for_how_to_implement_control_patterns\"></span><span id=\"GUIDANCE_FOR_HOW_TO_IMPLEMENT_CONTROL_PATTERNS\"></span>Guidance for how to implement control patterns\n\nThe control patterns and what they're intended for are part of a larger definition of the UI Automation framework, and don't just apply to the accessibility support for a Windows Store app. When you implement a control pattern you should make sure you're implementing it in a way that matches the guidance as documented on MSDN and also in the UI Automation specification. If you're looking for guidance, you can generally use the MSDN topics and won't need to refer to the specification. Guidance for each pattern is documented here: [Implementing UI Automation Control Patterns](https://msdn.microsoft.com/library/windows/desktop/Ee671292). You'll notice that each topic under this area has an \"Implementation Guidelines and Conventions\" section and \"Required Members\" section. The guidance usually refers to specific APIs of the relevant control pattern interface in the [Control Pattern Interfaces for Providers](https://msdn.microsoft.com/library/windows/desktop/Ee671201) reference. Those interfaces are the native/COM interfaces (and their APIs use COM-style syntax). But everything you see there has an equivalent in the [**Windows.UI.Xaml.Automation.Provider**](https://msdn.microsoft.com/library/windows/apps/BR209225) namespace.\n\nIf you're using the default automation peers and expanding on their behavior, those peers have already been written in conformance to UI Automation guidelines. If they support control patterns, you can rely on that pattern support conforming with guidance at [Implementing UI Automation Control Patterns](https://msdn.microsoft.com/library/windows/desktop/Ee671292). If a control peer reports that it's representative of a control type defined by UI Automation, then the guidance documented at [Supporting UI Automation Control Types](https://msdn.microsoft.com/library/windows/desktop/Ee671633) has been followed by that peer.\n\nNevertheless you might need additional guidance for control patterns or control types in order to follow the UI Automation recommendations in your peer implementation. That would be particularly true if you're implementing pattern or control type support that doesn't yet exist as a default implementation in a UWP control. For example, the pattern for annotations isn't implemented in any of the default XAML controls. But you might have an app that uses annotations extensively and therefore you want to surface that functionality to be accessible. For this scenario, your peer should implement [**IAnnotationProvider**](https://msdn.microsoft.com/library/windows/apps/Hh738493) and should probably report itself as the **Document** control type with appropriate properties to indicate that your documents support annotation.\n\nWe recommend that you use the guidance that you see for the patterns under [Implementing UI Automation Control Patterns](https://msdn.microsoft.com/library/windows/desktop/Ee671292) or control types under [Supporting UI Automation Control Types](https://msdn.microsoft.com/library/windows/desktop/Ee671633) as orientation and general guidance. You might even try following some of the API links for descriptions and remarks as to the purpose of the APIs. But for syntax specifics that are needed for UWP app programming, find the equivalent API within the [**Windows.UI.Xaml.Automation.Provider**](https://msdn.microsoft.com/library/windows/apps/BR209225) namespace and use those reference pages for more info.\n\n<span id=\"Built-in_automation_peer_classes\"></span><span id=\"built-in_automation_peer_classes\"></span><span id=\"BUILT-IN_AUTOMATION_PEER_CLASSES\"></span>Built-in automation peer classes\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nIn general, elements implement an automation peer class if they accept UI activity from the user, or if they contain information needed by users of assistive technologies that represent the interactive or meaningful UI of apps. Not all UWP visual elements have automation peers. Examples of classes that implement automation peers are [**Button**](https://msdn.microsoft.com/library/windows/apps/BR209265) and [**TextBox**](https://msdn.microsoft.com/library/windows/apps/BR209683). Examples of classes that do not implement automation peers are [**Border**](https://msdn.microsoft.com/library/windows/apps/BR209250) and classes based on [**Panel**](https://msdn.microsoft.com/library/windows/apps/BR227511), such as [**Grid**](https://msdn.microsoft.com/library/windows/apps/BR242704) and [**Canvas**](https://msdn.microsoft.com/library/windows/apps/BR209267). A **Panel** has no peer because it is providing a layout behavior that is visual only. There is no accessibility-relevant way for the user to interact with a **Panel**. Whatever child elements a **Panel** contains are instead reported to UI Automation trees as child elements of the next available parent in the tree that has a peer or element representation.\n\n<span id=\"UI_Automation_and_UWP_process_boundaries\"></span><span id=\"ui_automation_and_uwp_process_boundaries\"></span><span id=\"UI_AUTOMATION_AND_UWP_PROCESS_BOUNDARIES\"></span>UI Automation and UWP process boundaries\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nTypically, UI Automation client code that accesses a UWP app runs out-of-process. The UI Automation framework infrastructure enables information to get across the process boundary. This concept is explained in more detail in [UI Automation Fundamentals](https://msdn.microsoft.com/library/windows/desktop/Ee684007).\n\n<span id=\"OnCreateAutomationPeer\"></span><span id=\"oncreateautomationpeer\"></span><span id=\"ONCREATEAUTOMATIONPEER\"></span>OnCreateAutomationPeer\n-------------------------------------------------------------------------------------------------------------------------------------------------\n\nAll classes that derive from [**UIElement**](https://msdn.microsoft.com/library/windows/apps/BR208911) contain the protected virtual method [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer). The object initialization sequence for automation peers calls **OnCreateAutomationPeer** to get the automation peer object for each control and thus to construct a UI Automation tree for run-time use. UI Automation code can use the peer to get information about a controlâ€™s characteristics and features and to simulate interactive use by means of its control patterns. A custom control that supports automation must override **OnCreateAutomationPeer** and return an instance of a class that derives from [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185). For example, if a custom control derives from the [**ButtonBase**](https://msdn.microsoft.com/library/windows/apps/BR227736) class, the object returned by **OnCreateAutomationPeer** should derive from [**ButtonBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242460).\n\nIf you're writing a custom control class and intend to also supply a new automation peer, you should override the [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) method for your custom control so that it returns a new instance of your peer. Your peer class must derive directly or indirectly from [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185).\n\nFor example, the following code declares that the custom control `NumericUpDown` should use the peer `NumericUpDownPeer` for UI Automation purposes.\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>using Windows.UI.Xaml.Automation.Peers;\n...\npublic class NumericUpDown : RangeBase {\n    public NumericUpDown() {\n    // other initialization; DefaultStyleKey etc.\n    }\n    ...\n    protected override AutomationPeer OnCreateAutomationPeer()\n    {\n        return new NumericUpDownAutomationPeer(this);\n    }\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n<span codelanguage=\"VisualBasic\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">VB</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>Public Class NumericUpDown\n    Inherits RangeBase\n    &#39; other initialization; DefaultStyleKey etc.\n       Public Sub New()\n       End Sub\n       Protected Overrides Function OnCreateAutomationPeer() As AutomationPeer\n              Return New NumericUpDownAutomationPeer(Me)\n       End Function\nEnd Class</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n<span codelanguage=\"ManagedCPlusPlus\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C++</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>//.h\npublic ref class NumericUpDown sealed : Windows::UI::Xaml::Controls::Primitives::RangeBase \n{\n// other initialization not shown\nprotected: \n    virtual AutomationPeer^ OnCreateAutomationPeer() override \n    { \n         return ref new NumericUpDown(this); \n    } \n};</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n**Note**  The [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) implementation should do nothing more than initialize a new instance of your custom automation peer, passing the calling control as owner, and return that instance. Do not attempt additional logic in this method. In particular, any logic that could potentially lead to destruction of the [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) within the same call may result in unexpected runtime behavior.\n\n \n\nIn typical implementations of [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer), the *owner* is specified as **this** or **Me** because the method override is in the same scope as the rest of the control class definition.\n\nThe actual peer class definition can be done in the same code file as the control or in a separate code file. The peer definitions all exist in the [**Windows.UI.Xaml.Automation.Peers**](https://msdn.microsoft.com/library/windows/apps/BR242563) namespace that is a separate namespace from the controls that they provide peers for. You can choose to declare your peers in separate namespaces also, as long as you reference the necessary namespaces for the [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) method call.\n\n### <span id=\"Choosing_the_correct_peer_base_class\"></span><span id=\"choosing_the_correct_peer_base_class\"></span><span id=\"CHOOSING_THE_CORRECT_PEER_BASE_CLASS\"></span>Choosing the correct peer base class\n\nMake sure that your [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) is derived from a base class that gives you the best match for the existing peer logic of the control class you are deriving from. In the case of the previous example, because `NumericUpDown` derives from [**RangeBase**](https://msdn.microsoft.com/library/windows/apps/BR227863), there is a [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506) class available that you should base your peer on. By using the closest matching peer class in parallel to how you derive the control itself, you can avoid overriding at least some of the [**IRangeValueProvider**](https://msdn.microsoft.com/library/windows/apps/BR242590) functionality because the base peer class already implements it.\n\nThe base [**Control**](https://msdn.microsoft.com/library/windows/apps/BR209390) class does not have a corresponding peer class. If you need a peer class to correspond to a custom control that derives from **Control**, derive the custom peer class from [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472).\n\nIf you derive from [**ContentControl**](https://msdn.microsoft.com/library/windows/apps/BR209365) directly, that class has no default automation peer behavior because there is no [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer) implementation that references a peer class. So make sure either to implement **OnCreateAutomationPeer** to use your own peer, or to use [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) as the peer if that level of accessibility support is adequate for your control.\n\n**Note**  You don't typically derive from [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) rather than [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472). If you did derive directly from **AutomationPeer** you'll need to duplicate a lot of basic accessibility support that would otherwise come from **FrameworkElementAutomationPeer**.\n\n \n\n<span id=\"Initialization_of_a_custom_peer_class\"></span><span id=\"initialization_of_a_custom_peer_class\"></span><span id=\"INITIALIZATION_OF_A_CUSTOM_PEER_CLASS\"></span>Initialization of a custom peer class\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nThe automation peer should define a type-safe constructor that uses an instance of the owner control for base initialization. In the next example, the implementation passes the *owner* value on to the [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506) base, and ultimately it is the [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) that actually uses *owner* to set [**FrameworkElementAutomationPeer.Owner**](https://msdn.microsoft.com/library/windows/apps/BR242472_owner).\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>public NumericUpDownAutomationPeer(NumericUpDown owner): base(owner)\n{}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n<span codelanguage=\"VisualBasic\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">VB</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>Public Sub New(owner As NumericUpDown)\n    MyBase.New(owner)\nEnd Sub</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n<span codelanguage=\"ManagedCPlusPlus\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C++</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>//.h\npublic ref class NumericUpDownAutomationPeer sealed :  Windows::UI::Xaml::Automation::Peers::RangeBaseAutomationPeer \n//.cpp\npublic:  \n    NumericUpDownAutomationPeer(NumericUpDown^ owner);</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n<span id=\"Core_methods_of_AutomationPeer\"></span><span id=\"core_methods_of_automationpeer\"></span><span id=\"CORE_METHODS_OF_AUTOMATIONPEER\"></span>Core methods of AutomationPeer\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nFor UWP infrastructure reasons, the overridable methods of an automation peer are part of a pair of methods: the public access method that the UI Automation provider uses as a forwarding point for UI Automation clients, and the protected \"Core\" customization method that a UWP class can override to influence the behavior. The method pair is wired together by default in such a way that the call to the access method always invokes the parallel \"Core\" method that has the provider implementation, or as a fallback, invokes a default implementation from the base classes.\n\nWhen implementing a peer for a custom control, override any of the \"Core\" methods from the base automation peer class where you want to expose behavior that is unique to your custom control. UI Automation code gets information about your control by calling public methods of the peer class. To provide information about your control, override each method with a name that ends with \"Core\" when your control implementation and design creates accessibility scenarios or other UI Automation scenarios that differ from what's supported by the base automation peer class.\n\nAt a minimum, whenever you define a new peer class, implement the [**GetClassNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclassnamecore) method, as shown in the next example.\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>protected override string GetClassNameCore()\n{\n    return &quot;NumericUpDown&quot;;\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n**Note**  You might want to store the strings as constants rather than directly in the method body, but that is up to you. For [**GetClassNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclassnamecore), you won't need to localize this string. The **LocalizedControlType** property is used any time a localized string is needed by a UI Automation client, not **ClassName**.\n\n \n\n### <span id=\"GetAutomationControlType\"></span><span id=\"getautomationcontroltype\"></span><span id=\"GETAUTOMATIONCONTROLTYPE\"></span>GetAutomationControlType\n\nSome assistive technologies use the [**GetAutomationControlType**](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltype) value directly when reporting characteristics of the items in a UI Automation tree, as additional information beyond the UI Automation **Name**. If your control is significantly different from the control you are deriving from and you want to report a different control type from what is reported by the base peer class used by the control, you must implement a peer and override [**GetAutomationControlTypeCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltypecore) in your peer implementation. This is particularly important if you derive from a generalized base class such as [**ItemsControl**](https://msdn.microsoft.com/library/windows/apps/BR242803) or [**ContentControl**](https://msdn.microsoft.com/library/windows/apps/BR209365), where the base peer doesn't provide precise information about control type.\n\nYour implementation of [**GetAutomationControlTypeCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getautomationcontroltypecore) describes your control by returning an [**AutomationControlType**](https://msdn.microsoft.com/library/windows/apps/BR209182) value. Although you can return **AutomationControlType.Custom**, you should return one of the more specific control types if it accurately describes your control's main scenarios. Here's an example.\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>protected override AutomationControlType GetAutomationControlTypeCore()\n{\n    return AutomationControlType.Spinner;\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n**Note**  Unless you specify [**AutomationControlType.Custom**](https://msdn.microsoft.com/library/windows/apps/BR209182), you don't have to implement [**GetLocalizedControlTypeCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlocalizedcontroltypecore) to provide a **LocalizedControlType** property value to clients. UI Automation common infrastructure provides translated strings for every possible **AutomationControlType** value other than **AutomationControlType.Custom**.\n\n \n\n### <span id=\"GetPattern_and_GetPatternCore\"></span><span id=\"getpattern_and_getpatterncore\"></span><span id=\"GETPATTERN_AND_GETPATTERNCORE\"></span>GetPattern and GetPatternCore\n\nA peer's implementation of [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) returns the object that supports the pattern that is requested in the input parameter. Specifically, a UI Automation client calls a method that is forwarded to the provider's [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) method, and specifies a [**PatternInterface**](https://msdn.microsoft.com/library/windows/apps/BR242496) enumeration value that names the requested pattern. Your override of **GetPatternCore** should return the object that implements the specified pattern. That object is the peer itself, because the peer should implement the corresponding pattern interface any time that it reports that it supports a pattern. If your peer does not have a custom implementation of a pattern, but you know that the peer's base does implement the pattern, you can call the base type's implementation of **GetPatternCore** from your **GetPatternCore**. A peer's **GetPatternCore** should return **null** if a pattern is not supported by the peer. However, instead of returning **null** directly from your implementation, you would usually rely on the call to the base implementation to return **null** for any unsupported pattern.\n\nWhen a pattern is supported, the [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) implementation can return **this** or **Me**. The expectation is that the UI Automation client will cast the [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) return value to the requested pattern interface whenever it is not **null**.\n\nIf a peer class inherits from another peer, and all necessary support and pattern reporting is already handled by the base class, implementing [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) isn't necessary. For example, if you are implementing a range control that derives from [**RangeBase**](https://msdn.microsoft.com/library/windows/apps/BR227863), and your peer derives from [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506), that peer returns itself for [**PatternInterface.RangeValue**](https://msdn.microsoft.com/library/windows/apps/BR242496) and has working implementations of the [**IRangeValueProvider**](https://msdn.microsoft.com/library/windows/apps/BR242590) interface that supports the pattern.\n\nAlthough it is not the literal code, this example approximates the implementation of [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) already present in [**RangeBaseAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242506).\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>protected override object GetPatternCore(PatternInterface patternInterface)\n{\n    if (patternInterface == PatternInterface.RangeValue)\n    {\n        return this;\n    }\n    return base.GetPattern(patternInterface);\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\nIf you are implementing a peer where you don't have all the support you need from a base peer class, or you want to change or add to the set of base-inherited patterns that your peer can support, then you should override [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) to enable UI Automation clients to use the patterns.\n\nFor a list of the provider patterns that are available in the UWP implementation of UI Automation support, see [**Windows.UI.Xaml.Automation.Provider**](https://msdn.microsoft.com/library/windows/apps/BR209225). Each such pattern has a corresponding value of the [**PatternInterface**](https://msdn.microsoft.com/library/windows/apps/BR242496) enumeration, which is how UI Automation clients request the pattern in a [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) call.\n\nA peer can report that it supports more than one pattern. If so, the override should include return path logic for each supported [**PatternInterface**](https://msdn.microsoft.com/library/windows/apps/BR242496) value and return the peer in each matching case. It is expected that the caller will request only one interface at a time, and it is up to the caller to cast to the expected interface.\n\nHere's an example of a [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) override for a custom peer. It reports the support for two patterns, [**IRangeValueProvider**](https://msdn.microsoft.com/library/windows/apps/BR242590) and [**IToggleProvider**](https://msdn.microsoft.com/library/windows/apps/BR242653). The control here is a media display control that can display as full-screen (the toggle mode) and that has a progress bar within which users can select a position (the range control). This code came from the [XAML accessibility sample](http://go.microsoft.com/fwlink/p/?linkid=238570).\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>protected override object GetPatternCore(PatternInterface patternInterface)\n{\n    if (patternInterface == PatternInterface.RangeValue)\n    {\n        return this;\n    }\n    else if (patternInterface == PatternInterface.Toggle)\n    {\n        return this;\n    }\n    return null;\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n### <span id=\"Forwarding_patterns_from_subelements\"></span><span id=\"forwarding_patterns_from_subelements\"></span><span id=\"FORWARDING_PATTERNS_FROM_SUBELEMENTS\"></span>Forwarding patterns from subelements\n\nA [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) method implementation can also specify a subelement or part as a pattern provider for its host. This example mimics how [**ItemsControl**](https://msdn.microsoft.com/library/windows/apps/BR242803) transfers scroll-pattern handling to the peer of its internal [**ScrollViewer**](https://msdn.microsoft.com/library/windows/apps/BR209527) control. To specify a subelement for pattern handling, this code gets the subelement object, creates a peer for the subelement by using the [**FrameworkElement.CreatePeerForElement**](https://msdn.microsoft.com/library/windows/apps/BR242472_createpeerforelement) method, and returns the new peer.\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>protected override object GetPatternCore(PatternInterface patternInterface)\n{\n    if (patternInterface == PatternInterface.Scroll)\n    {\n        ItemsControl owner = (ItemsControl) base.Owner;\n        UIElement itemsHost = owner.ItemsHost;\n        ScrollViewer element = null;\n        while (itemsHost != owner)\n        {\n            itemsHost = VisualTreeHelper.GetParent(itemsHost) as UIElement;\n            element = itemsHost as ScrollViewer;\n            if (element != null)\n            {\n                break;\n            }\n        }\n        if (element != null)\n        {\n            AutomationPeer peer = FrameworkElementAutomationPeer.CreatePeerForElement(element);\n            if ((peer != null) &amp;&amp; (peer is IScrollProvider))\n            {\n                return (IScrollProvider) peer;\n            }\n        }\n    }\n    return base.GetPatternCore(patternInterface);\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n### <span id=\"Other_Core_methods\"></span><span id=\"other_core_methods\"></span><span id=\"OTHER_CORE_METHODS\"></span>Other Core methods\n\nYour control may need to support keyboard equivalents for primary scenarios; for more info about why this might be necessary, see [Keyboard accessibility](keyboard-accessibility.md). Implementing the key support is necessarily part of the control code and not the peer code because that is part of a control's logic, but your peer class should override the [**GetAcceleratorKeyCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getacceleratorkeycore) and [**GetAccessKeyCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getaccesskeycore) methods to report to UI Automation clients which keys are used. Consider that the strings that report key information might need to be localized, and should therefore come from resources, not hard-coded strings.\n\nIf you are providing a peer for a class that supports a collection, it's best to derive from both functional classes and peer classes that already have that kind of collection support. If you can't do so, peers for controls that maintain child collections may have to override the collection-related peer method [**GetChildrenCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildrencore) to properly report the parent-child relationships to the UI Automation tree.\n\nImplement the [**IsContentElementCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_iscontentelementcore) and [**IsControlElementCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_iscontrolelementcore) methods to indicate whether your control contains data content or fulfills an interactive role in the user interface (or both). By default, both methods return **true**. These settings improve the usability of assistive technologies such as screen readers, which may use these methods to filter the automation tree. If your [**GetPatternCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpatterncore) method transfers pattern handling to a subelement peer, the subelement peer's **IsControlElementCore** method can return **false** to hide the subelement peer from the automation tree.\n\nSome controls may support labeling scenarios, where a text label part supplies information for a non-text part, or a control is intended to be in a known labeling relationship with another control in the UI. If it's possible to provide a useful class-based behavior, you can override [**GetLabeledByCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlabeledbycore) to provide this behavior.\n\n[**GetBoundingRectangleCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getboundingrectanglecore) and [**GetClickablePointCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclickablepointcore) are used mainly for automated testing scenarios. If you want to support automated testing for your control, you might want to override these methods. This might be desired for range-type controls, where you can't suggest just a single point because where the user clicks in coordinate space has a different effect on a range. For example, the default [**ScrollBar**](https://msdn.microsoft.com/library/windows/apps/BR209745) automation peer overrides **GetClickablePointCore** to return a \"not a number\" [**Point**](https://msdn.microsoft.com/library/windows/apps/BR225870) value.\n\n[**GetLiveSettingCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlivesettingcore) influences the control default for the **LiveSetting** value for UI Automation. You might want to override this if you want your control to return a value other than [**AutomationLiveSetting.Off**](https://msdn.microsoft.com/library/windows/apps/JJ191519). For more info on what **LiveSetting** represents, see [**AutomationProperties.LiveSetting**](https://msdn.microsoft.com/library/windows/apps/JJ191516).\n\nYou might override [**GetOrientationCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getorientationcore) if your control has a settable orientation property that can map to [**AutomationOrientation**](https://msdn.microsoft.com/library/windows/apps/BR209184). The [**ScrollBarAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242522) and [**SliderAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242546) classes do this.\n\n### <span id=\"Base_implementation_in_FrameworkElementAutomationPeer\"></span><span id=\"base_implementation_in_frameworkelementautomationpeer\"></span><span id=\"BASE_IMPLEMENTATION_IN_FRAMEWORKELEMENTAUTOMATIONPEER\"></span>Base implementation in FrameworkElementAutomationPeer\n\nThe base implementation of [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) provides some UI Automation information that can be interpreted from various layout and behavior properties that are defined at the framework level.\n\n-   [**GetBoundingRectangleCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getboundingrectanglecore): Returns a [**Rect**](https://msdn.microsoft.com/library/windows/apps/BR225994) structure based on the known layout characteristics. Returns a 0-value **Rect** if [**IsOffscreen**](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreen) is **true**.\n-   [**GetClickablePointCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getclickablepointcore): Returns a [**Point**](https://msdn.microsoft.com/library/windows/apps/BR225870) structure based on the known layout characteristics, as long as there is a nonzero **BoundingRectangle**.\n-   [**GetNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore): More extensive behavior than can be summarized here; see [**GetNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore). Basically, it attempts a string conversion on any known content of a [**ContentControl**](https://msdn.microsoft.com/library/windows/apps/BR209365) or related classes that have content. Also, if there is a value for [**LabeledBy**](https://msdn.microsoft.com/library/windows/apps/Hh759769), that item's **Name** value is used as the **Name**.\n-   [**HasKeyboardFocusCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_haskeyboardfocuscore): Evaluated based on the owner's [**FocusState**](https://msdn.microsoft.com/library/windows/apps/BR209390_focusstate) and [**IsEnabled**](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled) properties. Elements that aren't controls always return **false**.\n-   [**IsEnabledCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_isenabledcore): Evaluated based on the owner's [**IsEnabled**](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled) property if it is a [**Control**](https://msdn.microsoft.com/library/windows/apps/BR209390). Elements that aren't controls always return **true**. This doesn't mean that the owner is enabled in the conventional interaction sense; it means that the peer is enabled despite the owner not having an **IsEnabled** property.\n-   [**IsKeyboardFocusableCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_iskeyboardfocusablecore): Returns **true** if owner is a [**Control**](https://msdn.microsoft.com/library/windows/apps/BR209390); otherwise it is **false**.\n-   [**IsOffscreenCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreencore): A [**Visibility**](https://msdn.microsoft.com/library/windows/apps/BR208911_visibility) of [**Hidden**](https://msdn.microsoft.com/library/windows/apps/BR209006) on the owner element or any of its parents equates to a **true** value for [**IsOffscreen**](https://msdn.microsoft.com/library/windows/apps/BR209185_isoffscreen). Exception: a [**Popup**](https://msdn.microsoft.com/library/windows/apps/BR227842) object can be visible even if its owner's parents are not.\n-   [**SetFocusCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_setfocuscore): Calls [**Focus**](https://msdn.microsoft.com/library/windows/apps/BR209390_focus).\n-   [**GetParent**](https://msdn.microsoft.com/library/windows/apps/BR209185_getparent): Calls [**FrameworkElement.Parent**](https://msdn.microsoft.com/library/windows/apps/BR208739) from the owner, and looks up the appropriate peer. This isn't an override pair with a \"Core\" method, so you can't change this behavior.\n\n**Note**  Default UWP peers implement a behavior by using internal native code that implements the UWP, not necessarily by using actual UWP code. You won't be able to see the code or logic of the implementation through common language runtime (CLR) reflection or other techniques. You also won't see distinct reference pages for subclass-specific overrides of base peer behavior. For example, there might be additional behavior for [**GetNameCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getnamecore) of a [**TextBoxAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242550), which won't be described on the **AutomationPeer.GetNameCore** reference page, and there is no reference page for **TextBoxAutomationPeer.GetNameCore**. There isn't even a **TextBoxAutomationPeer.GetNameCore** reference page. Instead, read the reference topic for the most immediate peer class, and look for implementation notes in the Remarks section.\n\n \n\n<span id=\"Peers_and_AutomationProperties\"></span><span id=\"peers_and_automationproperties\"></span><span id=\"PEERS_AND_AUTOMATIONPROPERTIES\"></span>Peers and AutomationProperties\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nYour automation peer should provide appropriate default values for your control's accessibility-related information. Note that any app code that uses the control can override some of that behavior by including [**AutomationProperties**](https://msdn.microsoft.com/library/windows/apps/BR209081) attached-property values on control instances. Callers can do this either for the default controls or for custom controls. For example, the following XAML creates a button that has two customized UI Automation properties: `<Button AutomationProperties.Name=\"Special\"      AutomationProperties.HelpText=\"This is a special button.\"/>`\n\nFor more info about [**AutomationProperties**](https://msdn.microsoft.com/library/windows/apps/BR209081) attached properties, see [Basic accessibility information](basic-accessibility-information.md).\n\nSome of the [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185) methods exist because of the general contract of how UI Automation providers are expected to report information, but these methods are not typically implemented in control peers. This is because that info is expected to be provided by [**AutomationProperties**](https://msdn.microsoft.com/library/windows/apps/BR209081) values applied to the app code that uses the controls in a specific UI. For example, most apps would define the labeling relationship between two different controls in the UI by applying a [**AutomationProperties.LabeledBy**](https://msdn.microsoft.com/library/windows/apps/Hh759769) value. However, [**LabeledByCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getlabeledbycore) is implemented in certain peers that represent data or item relationships in a control, such as using a header part to label a data-field part, labeling items with their containers, or similar scenarios.\n\n<span id=\"_Implementing_patterns\"></span><span id=\"_implementing_patterns\"></span><span id=\"_IMPLEMENTING_PATTERNS\"></span> Implementing patterns\n-------------------------------------------------------------------------------------------------------------------------------------------------\n\nLet's look at how to write a peer for a control that implements an expand-collapse behavior by implementing the control pattern interface for expand-collapse. The peer should enable the accessibility for the expand-collapse behavior by returning itself whenever [**GetPattern**](https://msdn.microsoft.com/library/windows/apps/BR209185_getpattern) is called with a value of [**PatternInterface.ExpandCollapse**](https://msdn.microsoft.com/library/windows/apps/BR242496). The peer should then inherit the provider interface for that pattern ([**IExpandCollapseProvider**](https://msdn.microsoft.com/library/windows/desktop/Ee671242)) and provide implementations for each of the members of that provider interface. In this case the interface has three members to override: [**Expand**](https://msdn.microsoft.com/library/windows/apps/BR242570), [**Collapse**](https://msdn.microsoft.com/library/windows/apps/BR242569), [**ExpandCollapseState**](https://msdn.microsoft.com/library/windows/apps/BR242570collapsestate).\n\nIt's helpful to plan ahead for accessibility in the API design of the class itself. Whenever you have a behavior that is potentially requested either as a result of typical interactions with a user who is working in the UI or through an automation provider pattern, provide a single method that either the UI response or the automation pattern can call. For example, if your control has button parts that have wired event handlers that can expand or collapse the control, and has keyboard equivalents for those actions, have these event handlers call the same method that you call from within the body of the [**Expand**](https://msdn.microsoft.com/library/windows/apps/BR242570) or [**Collapse**](https://msdn.microsoft.com/library/windows/apps/BR242569) implementations for [**IExpandCollapseProvider**](https://msdn.microsoft.com/library/windows/desktop/Ee671242) in the peer. Using a common logic method can also be a useful way to make sure that your control's visual states are updated to show logical state in a uniform way, regardless of how the behavior was invoked.\n\nA typical implementation is that the provider APIs first call [**Owner**](https://msdn.microsoft.com/library/windows/apps/BR242472_owner) for access to the control instance at run time. Then the necessary behavior methods can be called on that object.\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>public class IndexCardAutomationPeer : FrameworkElementAutomationPeer, IExpandCollapseProvider {\n    private IndexCard ownerIndexCard;\n    public IndexCardAutomationPeer(IndexCard owner) : base(owner) \n    { \n         ownerIndexCard = owner;\n    } \n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\nAn alternate implementation is that the control itself can reference its peer. This is a common pattern if you are raising automation events from the control, because the [**RaiseAutomationEvent**](https://msdn.microsoft.com/library/windows/apps/BR209185_raiseautomationevent) method is a peer method.\n\n<span id=\"UI_Automation_events\"></span><span id=\"ui_automation_events\"></span><span id=\"UI_AUTOMATION_EVENTS\"></span>UI Automation events\n-----------------------------------------------------------------------------------------------------------------------------------------\n\nUI Automation events fall into the following categories.\n\n| Event            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Property change  | Fires when a property on a UI Automation element or control pattern changes. For example, if a client needs to monitor an app's check box control, it can register to listen for a property change event on the [**ToggleState**](https://msdn.microsoft.com/library/windows/apps/BR242653_togglestate) property. When the check box control is checked or unchecked, the provider fires the event and the client can act as necessary.                                                                                                                                                                                  |\n| Element action   | Fires when a change in the UI results from user or programmatic activity; for example, when a button is clicked or invoked through the **Invoke** pattern.                                                                                                                                                                                                                                                                                                                                                                                                                                          |\n| Structure change | Fires when the structure of the UI Automation tree changes. The structure changes when new UI items become visible, hidden, or removed on the desktop.                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n| Global change    | Fires when actions of global interest to the client occur, such as when the focus shifts from one element to another, or when a child window closes. Some events do not necessarily mean that the state of the UI has changed. For example, if the user tabs to a text-entry field and then clicks a button to update the field, a [**TextChanged**](https://msdn.microsoft.com/library/windows/apps/BR209683_textchanged) event fires even if the user did not actually change the text. When processing an event, it may be necessary for a client application to check whether anything has actually changed before taking action. |\n\n \n\n### <span id=\"AutomationEvents_identifiers\"></span><span id=\"automationevents_identifiers\"></span><span id=\"AUTOMATIONEVENTS_IDENTIFIERS\"></span>AutomationEvents identifiers\n\nUI Automation events are identified by [**AutomationEvents**](https://msdn.microsoft.com/library/windows/apps/BR209183) values. The values of the enumeration uniquely identify the kind of event.\n\n### <span id=\"Raising_events\"></span><span id=\"raising_events\"></span><span id=\"RAISING_EVENTS\"></span>Raising events\n\nUI Automation clients can subscribe to automation events. In the automation peer model, peers for custom controls must report changes to control state that are relevant to accessibility by calling the [**RaiseAutomationEvent**](https://msdn.microsoft.com/library/windows/apps/BR209185_raiseautomationevent) method. Similarly, when a key UI Automation property value changes, custom control peers should call the [**RaisePropertyChangedEvent**](https://msdn.microsoft.com/library/windows/apps/BR209185_raisepropertychangedevent) method.\n\nThe next code example shows how to get the peer object from within the control definition code and call a method to fire an event from that peer. As an optimization, the code determines whether there are any listeners for this event type. Firing the event and creating the peer object only when there are listeners avoids unnecessary overhead and helps the control remain responsive.\n\n<span codelanguage=\"CSharp\"></span>\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre><code>if (AutomationPeer.ListenerExists(AutomationEvents.PropertyChanged))\n{\n    NumericUpDownAutomationPeer peer =\n        FrameworkElementAutomationPeer.FromElement(nudCtrl) as NumericUpDownAutomationPeer;\n    if (peer != null)\n    {\n        peer.RaisePropertyChangedEvent(\n            RangeValuePatternIdentifiers.ValueProperty,\n            (double)oldValue,\n            (double)newValue);\n    }\n}</code></pre></td>\n</tr>\n</tbody>\n</table>\n\n<span id=\"Peer_navigation\"></span><span id=\"peer_navigation\"></span><span id=\"PEER_NAVIGATION\"></span>Peer navigation\n---------------------------------------------------------------------------------------------------------------------\n\nAfter locating an automation peer, a UI Automation client can navigate the peer structure of an app by calling the peer object's [**GetChildren**](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildren) and [**GetParent**](https://msdn.microsoft.com/library/windows/apps/BR209185_getparent) methods. Navigation among UI elements within a control is supported by the peer's implementation of the [**GetChildrenCore**](https://msdn.microsoft.com/library/windows/apps/BR209185_getchildrencore) method. The UI Automation system calls this method to build up a tree of subelements contained within a control; for example, list items in a list box. The default **GetChildrenCore** method in [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472) traverses the visual tree of elements to build the tree of automation peers. Custom controls can override this method to expose a different representation of child elements to automation clients, returning the automation peers of elements that convey information or allow user interaction.\n\n<span id=\"Native_automation_support_for_text_patterns\"></span><span id=\"native_automation_support_for_text_patterns\"></span><span id=\"NATIVE_AUTOMATION_SUPPORT_FOR_TEXT_PATTERNS\"></span>Native automation support for text patterns\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nSome of the default UWP app automation peers provide control pattern support for the text pattern ([**PatternInterface.Text**](https://msdn.microsoft.com/library/windows/apps/BR242496)). But they provide this support through native methods, and the peers involved won't note the [**ITextProvider**](https://msdn.microsoft.com/library/windows/apps/BR242627) interface in the (managed) inheritance. Still, if a managed or non-managed UI Automation client queries the peer for patterns, it will report support for the text pattern, and provide behavior for parts of the pattern when client APIs are called.\n\nIf you intend to derive from one of the UWP app text controls and also create a custom peer that derives from one of the text-related peers, check the Remarks sections for the peer to learn more about any native-level support for patterns. You can access the native base behavior in your custom peer if you call the base implementation from your managed provider interface implementations, but it's difficult to modify what the base implementation does because the native interfaces on both the peer and its owner control aren't exposed. Generally you should either use the base implementations as-is (call base only) or completely replace the functionality with your own managed code and don't call the base implementation. The latter is an advanced scenario, you'll need good familiarity with the text services framework being used by your control in order to support the accessibility requirements when using that framework.\n\n<span id=\"AutomationProperties.AccessibilityView\"></span><span id=\"automationproperties.accessibilityview\"></span><span id=\"AUTOMATIONPROPERTIES.ACCESSIBILITYVIEW\"></span>AutomationProperties.AccessibilityView\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nIn addition to providing a custom peer, you can also adjust the tree view representation for any control instance, by setting [**AutomationProperties.AccessibilityView**](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview) in XAML. This isn't implemented as part of a peer class, but we'll mention it here because it's germane to overall accessibility support either for custom controls or for templates you customize.\n\nThe main scenario for using [**AutomationProperties.AccessibilityView**](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview) is to deliberately omit certain controls in a template from the UI Automation views, because they don't meaningfully contribute to the accessibility view of the entire control. To prevent this, set **AutomationProperties.AccessibilityView** to \"Raw\". For more info, see [**AutomationProperties.AccessibilityView**](https://msdn.microsoft.com/library/windows/apps/BR209081_accessibilityview).\n\n<span id=\"Throwing_exceptions_from_automation_peers\"></span><span id=\"throwing_exceptions_from_automation_peers\"></span><span id=\"THROWING_EXCEPTIONS_FROM_AUTOMATION_PEERS\"></span>Throwing exceptions from automation peers\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nThe APIs that you are implementing for your automation peer support are permitted to throw exceptions. It's expected any UI Automation clients that are listening are robust enough to continue on after most exceptions are thrown. In all likelihood that listener is looking at an all-up automation tree that includes apps other than your own, and it's an unacceptable client design to bring down the entire client just because one area of the tree threw a peer-based exception when the client called its APIs.\n\nFor parameters that are passed in to your peer, it's acceptable to validate the input, and for example throw [**ArgumentNullException**](T:System.ArgumentNullException) if it was passed **null** and that's not a valid value for your implementation. However, if there are subsequent operations performed by your peer, remember that the peer's interactions with the hosting control have something of an asynchronous character to them. Anything a peer does won't necessarily block the UI thread in the control (and it probably shouldn't). So you could have situations where an object was available or had certain properties when the peer was created or when an automation peer method was first called, but in the meantime the control state has changed. For these cases, there are two dedicated exceptions that a provider can throw:\n\n-   Throw [**ElementNotAvailableException**](https://msdn.microsoft.com/library/windows/apps/Hh673741) if you're unable to access either the peer's owner or a related peer element based on the original info your API was passed. For example, you might have a peer that's trying to run its methods but the owner has since been removed from the UI, such as a modal dialog that's been closed. For a non-.NET client, this maps to [**UIA\\_E\\_ELEMENTNOTAVAILABLE**](https://msdn.microsoft.com/library/windows/desktop/Ee671218).\n-   Throw [**ElementNotEnabledException**](https://msdn.microsoft.com/library/windows/apps/Hh673748) if there still is an owner, but that owner is in a mode such as [**IsEnabled**](https://msdn.microsoft.com/library/windows/apps/BR209390_isenabled)`=`**false** that's blocking some of the specific programmatic changes that your peer is trying to accomplish. For a non-.NET client, this maps to [**UIA\\_E\\_ELEMENTNOTENABLED**](https://msdn.microsoft.com/library/windows/desktop/Ee671218).\n\nBeyond this, peers should be relatively conservative regarding exceptions that they throw from their peer support. Most clients won't be able to handle exceptions from peers and turn these into actionable choices that their users can make when interacting with the client. So sometimes a no-op, and catching exceptions without rethrowing within your peer implementations, is a better strategy than is throwing exceptions every time something the peer tries to do doesn't work. Consider also that most UI Automation clients aren't written in managed code. Most are written in COM and are just checking for **S\\_OK** in an **HRESULT** whenever they call a UI Automation client method that ends up accessing your peer.\n\nRelated topics\n-----------------------------------------------\n\n* [Accessibility](accessibility.md)\n* [XAML accessibility sample](http://go.microsoft.com/fwlink/p/?linkid=238570)\n* [**FrameworkElementAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR242472)\n* [**AutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR209185)\n* [**OnCreateAutomationPeer**](https://msdn.microsoft.com/library/windows/apps/BR208911_oncreateautomationpeer)\n* [Control patterns and interfaces](control-patterns-and-interfaces.md)\n \n\n \n\n\n\n"}