{"nodes":[{"pos":[17,115],"content":"This article explains how to support the Share contract in a Universal Windows Platform (UWP) app.","needQuote":true,"needEscape":true,"nodes":[{"content":"This article explains how to support the Share contract in a Universal Windows Platform (UWP) app.","pos":[0,98]}]},{"pos":[123,133],"content":"Share data","needQuote":true,"needEscape":true,"nodes":[{"content":"Share data","pos":[0,10]}]},{"content":"Share data","pos":[190,200]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[202,240]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[241,336],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"This article explains how to support the Share contract in a Universal Windows Platform (UWP) app.","pos":[338,436]},{"content":"The Share contract is an easy way to quickly share data, such as text, links, photos, and videos, between apps.","pos":[437,548]},{"content":"For example, a user might want to share a webpage with their friends using a social networking app, or save a link in a notes app to refer to later.","pos":[549,697]},{"content":"Set up an event handler","pos":[702,725]},{"content":"Add a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataRequested<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">DataRequested]</ept> event handler to be called whenever a user invokes share.","pos":[727,825],"source":"Add a [**DataRequested**][DataRequested] event handler to be called whenever a user invokes share."},{"content":"This can occur either when the user taps a control in your app (such as a button or app bar command) or automatically in a specific scenario (if the user finishes a level and gets a high score, for example).","pos":[826,1033]},{"pos":[1045,1049],"content":"Main"},{"content":"When a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataRequested<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">DataRequested]</ept> event occurs, your app receives a <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>DataRequest<ept id=\"p5\">**</ept><ept id=\"p4\">]</ept><bpt id=\"p6\">[</bpt><ept id=\"p6\">DataRequest]</ept> object.","pos":[1114,1228],"source":"When a [**DataRequested**][DataRequested] event occurs, your app receives a [**DataRequest**][DataRequest] object."},{"content":"This contains a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataPackage<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">DataPackage]</ept> that you can use to provide the content that the user wants to share.","pos":[1229,1345],"source":" This contains a [**DataPackage**][DataPackage] that you can use to provide the content that the user wants to share."},{"content":"You must provide a title and data to share.","pos":[1346,1389]},{"content":"A description is optional, but recommended.","pos":[1390,1433]},{"pos":[1445,1449],"content":"Main"},{"content":"Choose data","pos":[1516,1527]},{"content":"You can share various types of data, including:","pos":[1529,1576]},{"content":"Plain text","pos":[1582,1592]},{"content":"Uniform Resource Identifiers (URIs)","pos":[1597,1632]},{"content":"HTML","pos":[1637,1641]},{"content":"Formatted text","pos":[1646,1660]},{"content":"Bitmaps","pos":[1665,1672]},{"content":"Plain text","pos":[1677,1687]},{"content":"Files","pos":[1692,1697]},{"content":"Custom developer-defined data","pos":[1702,1731]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataPackage<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">DataPackage]</ept> object can contain one or more of these formats, in any combination.","pos":[1733,1836],"source":"The [**DataPackage**][DataPackage] object can contain one or more of these formats, in any combination."},{"content":"The following example demonstrates sharing text.","pos":[1837,1885]},{"pos":[1897,1901],"content":"Main"},{"content":"Set properties","pos":[1965,1979]},{"content":"When you package data for sharing, you can supply a variety of properties that provide additional information about the content being shared.","pos":[1981,2122]},{"content":"These properties help target apps improve the user experience.","pos":[2123,2185]},{"content":"For example, a description helps when the user is sharing content with more than one app.","pos":[2186,2275]},{"content":"Adding a thumbnail when sharing an image or a link to a web page provides a visual reference to the user.","pos":[2276,2381]},{"content":"For more information, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataPackage.DataPackagePropertySet<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">DataPackagePropertySet]</ept>.","pos":[2382,2473],"source":" For more information, see [**DataPackage.DataPackagePropertySet**][DataPackagePropertySet]."},{"content":"All properties except the title are optional.","pos":[2475,2520]},{"content":"The title property is mandatory and must be set.","pos":[2521,2569]},{"pos":[2581,2585],"content":"Main"},{"content":"Launch the share UI","pos":[2652,2671]},{"content":"A UI for sharing is provided by the system.","pos":[2673,2716]},{"content":"To launch it, call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ShowShareUI<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">ShowShareUi]</ept> method.","pos":[2717,2778],"source":" To launch it, call the [**ShowShareUI**][ShowShareUi] method."},{"pos":[2790,2794],"content":"Main"},{"content":"Handle errors","pos":[2854,2867]},{"content":"In most cases, sharing content is a straightforward process.","pos":[2869,2929]},{"content":"However, there's always a chance that something unexpected could happen.","pos":[2930,3002]},{"content":"For example, the app might require the user to select content for sharing but the user didn't select any.","pos":[3003,3108]},{"content":"To handle these situations, use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FailWithDisplayText<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">FailWithDisplayText]</ept> method, which will display a message to the user if something goes wrong.","pos":[3109,3265],"source":" To handle these situations, use the [**FailWithDisplayText**][FailWithDisplayText] method, which will display a message to the user if something goes wrong."},{"content":"Delay share with delegates","pos":[3270,3296]},{"content":"Sometimes, it might not make sense to prepare the data that the user wants to share right away.","pos":[3298,3393]},{"content":"For example, if your app supports sending a large image file in several different possible formats, it's inefficient to create all those images before the user makes their selection.","pos":[3394,3576]},{"content":"To solve this problem, a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataPackage<ept id=\"p2\">**</ept><ept id=\"p1\">]</ept><bpt id=\"p3\">[</bpt><ept id=\"p3\">DataPackage]</ept> can contain a delegate — a function that is called when the receiving app requests data.","pos":[3578,3722],"source":"To solve this problem, a [**DataPackage**][DataPackage] can contain a delegate — a function that is called when the receiving app requests data."},{"content":"We recommend using a delegate any time that the data a user wants to share is resource-intensive.","pos":[3723,3820]},{"content":"Related topics","pos":[4934,4948]},{"content":"Receive data","pos":[4952,4964]}],"content":"---\ndescription: This article explains how to support the Share contract in a Universal Windows Platform (UWP) app.\ntitle: Share data\nms.assetid: 32287F5E-EB86-4B98-97FF-8F6228D06782\n---\n\n# Share data\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis article explains how to support the Share contract in a Universal Windows Platform (UWP) app. The Share contract is an easy way to quickly share data, such as text, links, photos, and videos, between apps. For example, a user might want to share a webpage with their friends using a social networking app, or save a link in a notes app to refer to later.\n\n## Set up an event handler\n\nAdd a [**DataRequested**][DataRequested] event handler to be called whenever a user invokes share. This can occur either when the user taps a control in your app (such as a button or app bar command) or automatically in a specific scenario (if the user finishes a level and gets a high score, for example).\n\n[!code-cs[Main](./code/share_data/cs/MainPage.xaml.cs#SnippetPrepareToShare)]\n\nWhen a [**DataRequested**][DataRequested] event occurs, your app receives a [**DataRequest**][DataRequest] object. This contains a [**DataPackage**][DataPackage] that you can use to provide the content that the user wants to share. You must provide a title and data to share. A description is optional, but recommended.\n\n[!code-cs[Main](./code/share_data/cs/MainPage.xaml.cs#SnippetCreateRequest)]\n\n## Choose data\n\nYou can share various types of data, including:\n\n-   Plain text\n-   Uniform Resource Identifiers (URIs)\n-   HTML\n-   Formatted text\n-   Bitmaps\n-   Plain text\n-   Files\n-   Custom developer-defined data\n\nThe [**DataPackage**][DataPackage] object can contain one or more of these formats, in any combination. The following example demonstrates sharing text.\n\n[!code-cs[Main](./code/share_data/cs/MainPage.xaml.cs#SnippetSetContent)]\n\n## Set properties\n\nWhen you package data for sharing, you can supply a variety of properties that provide additional information about the content being shared. These properties help target apps improve the user experience. For example, a description helps when the user is sharing content with more than one app. Adding a thumbnail when sharing an image or a link to a web page provides a visual reference to the user. For more information, see [**DataPackage.DataPackagePropertySet**][DataPackagePropertySet].\n\nAll properties except the title are optional. The title property is mandatory and must be set.\n\n[!code-cs[Main](./code/share_data/cs/MainPage.xaml.cs#SnippetSetProperties)]\n\n## Launch the share UI\n\nA UI for sharing is provided by the system. To launch it, call the [**ShowShareUI**][ShowShareUi] method.\n\n[!code-cs[Main](./code/share_data/cs/MainPage.xaml.cs#SnippetShowUI)]\n\n## Handle errors\n\nIn most cases, sharing content is a straightforward process. However, there's always a chance that something unexpected could happen. For example, the app might require the user to select content for sharing but the user didn't select any. To handle these situations, use the [**FailWithDisplayText**][FailWithDisplayText] method, which will display a message to the user if something goes wrong.\n\n## Delay share with delegates\n\nSometimes, it might not make sense to prepare the data that the user wants to share right away. For example, if your app supports sending a large image file in several different possible formats, it's inefficient to create all those images before the user makes their selection.\n\nTo solve this problem, a [**DataPackage**][DataPackage] can contain a delegate — a function that is called when the receiving app requests data. We recommend using a delegate any time that the data a user wants to share is resource-intensive.\n\n<!-- For some reason, this snippet was inline in the WDCML topic. Suggest moving to VS project with rest of snippets. -->\n```cs\nasync void OnDeferredImageRequestedHandler(DataProviderRequest request)\n{\n    // Provide updated bitmap data using delayed rendering\n    if (this.imageStream != null)\n    {\n        DataProviderDeferral deferral = request.GetDeferral();\n        InMemoryRandomAccessStream inMemoryStream = new InMemoryRandomAccessStream();\n\n        // Decode the image.\n        BitmapDecoder imageDecoder = await BitmapDecoder.CreateAsync(this.imageStream);\n\n        // Re-encode the image at 50% width and height.\n        BitmapEncoder imageEncoder = await BitmapEncoder.CreateForTranscodingAsync(inMemoryStream, imageDecoder);\n        imageEncoder.BitmapTransform.ScaledWidth = (uint)(imageDecoder.OrientedPixelHeight * 0.5);\n        imageEncoder.BitmapTransform.ScaledHeight = (uint)(imageDecoder.OrientedPixelHeight * 0.5);\n        await imageEncoder.FlushAsync();\n\n        request.SetData(RandomAccessStreamReference.CreateFromStream(inMemoryStream));\n        deferral.Complete();\n    }\n}\n```\n\n## Related topics\n* [Receive data](receive-data.md)\n\n\n<!-- LINKS -->\n* [DataPackage]: https://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.datatransfer.datapackage.aspx \n* [DataPackagePropertySet]: https://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.datatransfer.datapackagepropertyset.aspx \n* [DataRequest]: https://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.datatransfer.datarequest.aspx \n* [DataRequested]: https://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.datatransfer.datatransfermanager.datarequested.aspx \n* [FailWithDisplayText]: https://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.datatransfer.datarequest.failwithdisplaytext.aspx\n* [ShowShareUi]: https://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.datatransfer.datatransfermanager.showshareui.aspx\n \n\n"}