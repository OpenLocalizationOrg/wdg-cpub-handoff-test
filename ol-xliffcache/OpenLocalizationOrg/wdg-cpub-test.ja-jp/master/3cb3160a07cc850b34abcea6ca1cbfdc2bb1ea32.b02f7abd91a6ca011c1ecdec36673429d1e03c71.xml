{"nodes":[{"pos":[11,43],"content":"Run a background task on a timer","needQuote":true,"needEscape":true,"nodes":[{"content":"Run a background task on a timer","pos":[0,32]}]},{"pos":[57,141],"content":"Learn how to schedule a one-time background task, or run a periodic background task.","needQuote":true,"needEscape":true,"nodes":[{"content":"Learn how to schedule a one-time background task, or run a periodic background task.","pos":[0,84]}]},{"content":"Run a background task on a timer","pos":[198,230]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[233,271]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[272,367],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[372,386]},{"content":"BackgroundTaskBuilder","pos":[397,418]},{"content":"TimeTrigger","pos":[487,498]},{"content":"RequestAccessAsync","pos":[567,585]},{"content":"Learn how to schedule a one-time background task, or run a periodic background task.","pos":[648,732]},{"content":"This example assumes that you have a background task that needs to run periodically, or at a specific time, to support your app.","pos":[738,866]},{"content":"A background task will only run using a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TimeTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224843)</ept> if you have called <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RequestAccessAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept>.","pos":[867,1085],"source":" A background task will only run using a [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843) if you have called [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485)."},{"content":"This topic assumes you have already created a background task class, including the Run method that is used as the background task entry point.","pos":[1090,1232]},{"content":"To get started quickly building a background task, see <bpt id=\"p1\">[</bpt>Create and register a background task<ept id=\"p1\">](create-and-register-a-background-task.md)</ept>.","pos":[1233,1370],"source":" To get started quickly building a background task, see [Create and register a background task](create-and-register-a-background-task.md)."},{"content":"For more in-depth information on conditions and triggers, see <bpt id=\"p1\">[</bpt>Support your app with background tasks<ept id=\"p1\">](support-your-app-with-background-tasks.md)</ept>.","pos":[1371,1517],"source":" For more in-depth information on conditions and triggers, see [Support your app with background tasks](support-your-app-with-background-tasks.md)."},{"content":"Create a time trigger","pos":[1522,1543]},{"content":"Create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TimeTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224843)</ept>.","pos":[1550,1639],"source":"Create a new [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843)."},{"content":"The second parameter, <bpt id=\"p1\">*</bpt>OneShot<ept id=\"p1\">*</ept>, specifies whether the background task will run once or keep running periodically.","pos":[1640,1754],"source":" The second parameter, *OneShot*, specifies whether the background task will run once or keep running periodically."},{"content":"If <bpt id=\"p1\">*</bpt>OneShot<ept id=\"p1\">*</ept> is set to true, the first parameter (<bpt id=\"p2\">*</bpt>FreshnessTime<ept id=\"p2\">*</ept>) specifies the number of minutes to wait before scheduling the background task.","pos":[1755,1900],"source":" If *OneShot* is set to true, the first parameter (*FreshnessTime*) specifies the number of minutes to wait before scheduling the background task."},{"content":"If <bpt id=\"p1\">*</bpt>OneShot<ept id=\"p1\">*</ept> is set to false, <bpt id=\"p2\">*</bpt>FreshnessTime<ept id=\"p2\">*</ept> specifies the frequency by which the background task will run.","pos":[1901,2009],"source":" If *OneShot* is set to false, *FreshnessTime* specifies the frequency by which the background task will run."},{"content":"The built-in timer for Universal Windows Platform (UWP) apps runs background tasks in 15-minute intervals.","pos":[2015,2121]},{"pos":[2131,2282],"content":"If <bpt id=\"p1\">*</bpt>FreshnessTime<ept id=\"p1\">*</ept> is set to 15 minutes and <bpt id=\"p2\">*</bpt>OneShot<ept id=\"p2\">*</ept> is true, the task will run once starting between 0 and 15 minutes from the time it is registered.","source":"If *FreshnessTime* is set to 15 minutes and *OneShot* is true, the task will run once starting between 0 and 15 minutes from the time it is registered."},{"pos":[2292,2456],"content":"If <bpt id=\"p1\">*</bpt>FreshnessTime<ept id=\"p1\">*</ept> is set to 15 minutes and <bpt id=\"p2\">*</bpt>OneShot<ept id=\"p2\">*</ept> is false, the task will run every 15 minutes starting between 0 and 15 minutes from the time it is registered.","source":"If *FreshnessTime* is set to 15 minutes and *OneShot* is false, the task will run every 15 minutes starting between 0 and 15 minutes from the time it is registered."},{"pos":[2462,2594],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If <bpt id=\"p2\">*</bpt>FreshnessTime<ept id=\"p2\">*</ept> is set to less than 15 minutes, an exception is thrown when attempting to register the background task.","source":"**Note**  If *FreshnessTime* is set to less than 15 minutes, an exception is thrown when attempting to register the background task."},{"content":"For example, this trigger will cause a background task to run once an hour:","pos":[2607,2682]},{"content":"(Optional) Add a condition","pos":[2903,2929]},{"content":"If necessary, create a background task condition to control when the task runs.","pos":[2936,3015]},{"content":"A condition prevents the background task from running until the condition is met - for more information, see <bpt id=\"p1\">[</bpt>Set conditions for running a background task<ept id=\"p1\">](set-conditions-for-running-a-background-task.md)</ept>.","pos":[3016,3221],"source":" A condition prevents the background task from running until the condition is met - for more information, see [Set conditions for running a background task](set-conditions-for-running-a-background-task.md)."},{"content":"In this example the condition is set to <bpt id=\"p1\">**</bpt>UserPresent<ept id=\"p1\">**</ept> so that, once triggered, the task only runs once the user is active.","pos":[3227,3351],"source":"In this example the condition is set to **UserPresent** so that, once triggered, the task only runs once the user is active."},{"content":"For a list of possible conditions, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemConditionType<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224835)</ept>.","pos":[3352,3475],"source":" For a list of possible conditions, see [**SystemConditionType**](https://msdn.microsoft.com/library/windows/apps/br224835)."},{"content":"Call RequestAccessAsync()","pos":[3757,3782]},{"pos":[3789,4000],"content":"Before trying to register the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TimeTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224843)</ept> background task, call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RequestAccessAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700494)</ept>.","source":"Before trying to register the [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843) background task, call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700494)."},{"content":"Register the background task","pos":[4202,4230]},{"content":"Register the background task by calling your background task registration function.","pos":[4237,4320]},{"content":"For more information on registering background tasks, see <bpt id=\"p1\">[</bpt>Register a background task<ept id=\"p1\">](register-a-background-task.md)</ept>.","pos":[4321,4439],"source":" For more information on registering background tasks, see [Register a background task](register-a-background-task.md)."},{"content":"The following code registers the background task:","pos":[4445,4494]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Background task registration parameters are validated at the time of registration.","pos":[5090,5182],"source":"**Note**  Background task registration parameters are validated at the time of registration."},{"content":"An error is returned if any of the registration parameters are invalid.","pos":[5183,5254]},{"content":"Ensure that your app gracefully handles scenarios where background task registration fails - if instead your app depends on having a valid registration object after attempting to register a task, it may crash.","pos":[5255,5464]},{"content":"Remarks","pos":[5473,5480]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Starting with Windows 10, it is no longer necessary for the user to add your app to the lock screen in order to utilize background tasks.","pos":[5484,5631],"source":"**Note**  Starting with Windows 10, it is no longer necessary for the user to add your app to the lock screen in order to utilize background tasks."},{"content":"For guidance on the types of background task triggers, see <bpt id=\"p1\">[</bpt>Support your app with background tasks<ept id=\"p1\">](support-your-app-with-background-tasks.md)</ept>.","pos":[5632,5775],"source":" For guidance on the types of background task triggers, see [Support your app with background tasks](support-your-app-with-background-tasks.md)."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps.","pos":[5779,5877],"source":"**Note**  This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps."},{"content":"If you’re developing for Windows 8.x or Windows Phone 8.x, see the <bpt id=\"p1\">[</bpt>archived documentation<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>.","pos":[5878,6019],"source":" If you’re developing for Windows 8.x or Windows Phone 8.x, see the [archived documentation](http://go.microsoft.com/fwlink/p/?linkid=619132)."},{"content":"Related topics","pos":[6025,6039]},{"content":"Create and register a background task","pos":[6045,6082]},{"content":"Declare background tasks in the application manifest","pos":[6129,6181]},{"content":"Handle a cancelled background task","pos":[6243,6277]},{"content":"Monitor background task progress and completion","pos":[6321,6368]},{"content":"Register a background task","pos":[6425,6451]},{"content":"Respond to system events with background tasks","pos":[6487,6533]},{"content":"Set conditions for running a background task","pos":[6589,6633]},{"content":"Update a live tile from a background task","pos":[6687,6728]},{"content":"Use a maintenance trigger","pos":[6779,6804]},{"content":"Guidelines for background tasks","pos":[6839,6870]},{"content":"Debug a background task","pos":[6912,6935]},{"content":"How to trigger suspend, resume, and background events in Windows Store apps (when debugging)","pos":[6968,7060]}],"content":"---\ntitle: Run a background task on a timer\ndescription: Learn how to schedule a one-time background task, or run a periodic background task.\nms.assetid: 0B7F0BFF-535A-471E-AC87-783C740A61E9\n---\n\n# Run a background task on a timer\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**BackgroundTaskBuilder**](https://msdn.microsoft.com/library/windows/apps/br224768)\n-   [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843)\n-   [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700494)\n\nLearn how to schedule a one-time background task, or run a periodic background task.\n\n-   This example assumes that you have a background task that needs to run periodically, or at a specific time, to support your app. A background task will only run using a [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843) if you have called [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485).\n-   This topic assumes you have already created a background task class, including the Run method that is used as the background task entry point. To get started quickly building a background task, see [Create and register a background task](create-and-register-a-background-task.md). For more in-depth information on conditions and triggers, see [Support your app with background tasks](support-your-app-with-background-tasks.md).\n\n## Create a time trigger\n\n\n-   Create a new [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843). The second parameter, *OneShot*, specifies whether the background task will run once or keep running periodically. If *OneShot* is set to true, the first parameter (*FreshnessTime*) specifies the number of minutes to wait before scheduling the background task. If *OneShot* is set to false, *FreshnessTime* specifies the frequency by which the background task will run.\n\n    The built-in timer for Universal Windows Platform (UWP) apps runs background tasks in 15-minute intervals.\n\n    -   If *FreshnessTime* is set to 15 minutes and *OneShot* is true, the task will run once starting between 0 and 15 minutes from the time it is registered.\n\n    -   If *FreshnessTime* is set to 15 minutes and *OneShot* is false, the task will run every 15 minutes starting between 0 and 15 minutes from the time it is registered.\n\n    **Note**  If *FreshnessTime* is set to less than 15 minutes, an exception is thrown when attempting to register the background task.\n\n     \n\n    For example, this trigger will cause a background task to run once an hour:\n\n    > [!div class=\"tabbedCodeSnippets\"]\n    > ```cs\n    > TimeTrigger hourlyTrigger = new TimeTrigger(60, false);\n    > ```\n    > ```cpp\n    > TimeTrigger ^ hourlyTrigger = ref new TimeTrigger(60, false);\n    > ```\n\n## (Optional) Add a condition\n\n\n-   If necessary, create a background task condition to control when the task runs. A condition prevents the background task from running until the condition is met - for more information, see [Set conditions for running a background task](set-conditions-for-running-a-background-task.md).\n\n    In this example the condition is set to **UserPresent** so that, once triggered, the task only runs once the user is active. For a list of possible conditions, see [**SystemConditionType**](https://msdn.microsoft.com/library/windows/apps/br224835).\n\n    > [!div class=\"tabbedCodeSnippets\"]\n    > ```cs\n    > SystemCondition userCondition = new SystemCondition(SystemConditionType.UserPresent);\n    > ```\n    > ```cpp\n    > SystemCondition ^ userCondition = ref new SystemCondition(SystemConditionType::UserPresent)\n    > ```\n\n##  Call RequestAccessAsync()\n\n\n-   Before trying to register the [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843) background task, call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700494).\n\n    > [!div class=\"tabbedCodeSnippets\"]\n    > ```cs\n    > BackgroundExecutionManager.RequestAccessAsync();\n    > ```\n    > ```cpp\n    > BackgroundExecutionManager::RequestAccessAsync();\n    > ```\n\n## Register the background task\n\n\n-   Register the background task by calling your background task registration function. For more information on registering background tasks, see [Register a background task](register-a-background-task.md).\n\n    The following code registers the background task:\n\n    > > [!div class=\"tabbedCodeSnippets\"]\n    > ```cs\n    > string entryPoint = “Tasks.ExampleBackgroundTaskClass”;\n    > string taskName   = “Example hourly background task”;\n    > \n    > BackgroundTaskRegistration task = RegisterBackgroundTask(entryPoint, taskName, hourlyTrigger, userCondition);\n    > ```\n    > ```cpp\n    > String ^ entryPoint = “Tasks.ExampleBackgroundTaskClass”;\n    > String ^ taskName   = “Example hourly background task”;\n    > \n    > BackgroundTaskRegistration ^ task = RegisterBackgroundTask(entryPoint, taskName, hourlyTrigger, userCondition);\n    > ```\n    \n    > **Note**  Background task registration parameters are validated at the time of registration. An error is returned if any of the registration parameters are invalid. Ensure that your app gracefully handles scenarios where background task registration fails - if instead your app depends on having a valid registration object after attempting to register a task, it may crash.\n\n   \n## Remarks\n\n> **Note**  Starting with Windows 10, it is no longer necessary for the user to add your app to the lock screen in order to utilize background tasks. For guidance on the types of background task triggers, see [Support your app with background tasks](support-your-app-with-background-tasks.md).\n\n> **Note**  This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps. If you’re developing for Windows 8.x or Windows Phone 8.x, see the [archived documentation](http://go.microsoft.com/fwlink/p/?linkid=619132).\n\n\n## Related topics\n\n\n* [Create and register a background task](create-and-register-a-background-task.md)\n* [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md)\n* [Handle a cancelled background task](handle-a-cancelled-background-task.md)\n* [Monitor background task progress and completion](monitor-background-task-progress-and-completion.md)\n* [Register a background task](register-a-background-task.md)\n* [Respond to system events with background tasks](respond-to-system-events-with-background-tasks.md)\n* [Set conditions for running a background task](set-conditions-for-running-a-background-task.md)\n* [Update a live tile from a background task](update-a-live-tile-from-a-background-task.md)\n* [Use a maintenance trigger](use-a-maintenance-trigger.md)\n* [Guidelines for background tasks](guidelines-for-background-tasks.md)\n\n* [Debug a background task](debug-a-background-task.md)\n* [How to trigger suspend, resume, and background events in Windows Store apps (when debugging)](http://go.microsoft.com/fwlink/p/?linkid=254345)\n\n \n\n \n\n\n\n"}