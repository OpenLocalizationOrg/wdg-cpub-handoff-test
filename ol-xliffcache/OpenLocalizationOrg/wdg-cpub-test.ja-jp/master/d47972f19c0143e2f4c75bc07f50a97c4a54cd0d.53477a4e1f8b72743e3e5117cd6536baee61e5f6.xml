{"nodes":[{"pos":[11,92],"content":"Upgrade Surface devices to Windows 10 with Microsoft Deployment Toolkit (Surface)","needQuote":true,"needEscape":true,"nodes":[{"content":"Upgrade Surface devices to Windows 10 with Microsoft Deployment Toolkit (Surface)","pos":[0,81]}]},{"pos":[106,186],"content":"Find out how to perform a Windows 10 upgrade deployment to your Surface devices.","needQuote":true,"needEscape":true,"nodes":[{"content":"Find out how to perform a Windows 10 upgrade deployment to your Surface devices.","pos":[0,80]}]},{"pos":[198,241],"content":"windows 10 surface, upgrade, customize, mdt","needQuote":true,"needEscape":true,"nodes":[{"content":"windows 10 surface, upgrade, customize, mdt","pos":[0,43]}]},{"content":"Upgrade Surface devices to Windows 10 with Microsoft Deployment Toolkit","pos":[343,414]},{"content":"Applies to","pos":[421,431]},{"content":"Surface Pro 3","pos":[434,447]},{"content":"Surface 3","pos":[450,459]},{"content":"Surface Pro 2","pos":[462,475]},{"content":"Surface Pro","pos":[478,489]},{"content":"Windows 10","pos":[492,502]},{"content":"In addition to the traditional deployment method of reimaging devices, administrators that want to upgrade Surface devices that are running Windows 8.1 or Windows 10 have the option of deploying upgrades.","pos":[504,708]},{"content":"By performing an upgrade deployment, Windows 10 can be applied to devices without removing users, apps, or configuration.","pos":[709,830]},{"content":"The users of the deployed devices can simply continue using the devices with the same apps and settings that they used prior to the upgrade.","pos":[831,971]},{"content":"The process described in this article shows how to perform a Windows 10 upgrade deployment to Surface devices.","pos":[972,1082]},{"pos":[1084,1396],"content":"If you are not already familiar with the deployment of Windows or the Microsoft deployment tools and technologies, you should read <bpt id=\"p1\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p1\">](deploy-windows-10-to-surface-devices-with-mdt.md)</ept> and familiarize yourself with the traditional deployment method before you proceed.","source":"If you are not already familiar with the deployment of Windows or the Microsoft deployment tools and technologies, you should read [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md) and familiarize yourself with the traditional deployment method before you proceed."},{"content":"The upgrade concept","pos":[1403,1422]},{"content":"When you use the factory installation media to install Windows on a device, you are presented with two options or <bpt id=\"p1\">*</bpt>installation paths<ept id=\"p1\">*</ept> to install Windows on that device.","pos":[1424,1593],"source":"When you use the factory installation media to install Windows on a device, you are presented with two options or *installation paths* to install Windows on that device."},{"content":"The first of these installation paths – <bpt id=\"p1\">*</bpt>clean installation<ept id=\"p1\">*</ept> –  allows you to apply a factory image of Windows to that device, including all default settings.","pos":[1594,1752],"source":" The first of these installation paths – *clean installation* –  allows you to apply a factory image of Windows to that device, including all default settings."},{"content":"The second of these installation paths – <bpt id=\"p1\">*</bpt>upgrade<ept id=\"p1\">*</ept> – allows you to apply Windows to the device but retains the device’s users, apps, and settings.","pos":[1753,1899],"source":" The second of these installation paths – *upgrade* – allows you to apply Windows to the device but retains the device’s users, apps, and settings."},{"content":"When you perform a Windows deployment using traditional deployment methods, you follow an installation path that is very similar to a clean installation.","pos":[1901,2054]},{"content":"The primary difference between the clean installation and the traditional deployment method of <bpt id=\"p1\">*</bpt>reimaging<ept id=\"p1\">*</ept> is that with reimaging, you can apply an image that includes customizations.","pos":[2055,2238],"source":" The primary difference between the clean installation and the traditional deployment method of *reimaging* is that with reimaging, you can apply an image that includes customizations."},{"content":"Microsoft deployment technologies, such as the Microsoft Deployment Toolkit (MDT), expand the capabilities of the reimaging process by modifying the image during deployment.","pos":[2239,2412]},{"content":"For example, MDT is able to inject drivers for a specific hardware configuration during deployment, and with pre and post imaging scripts to perform a number of tasks, such as the installation of applications.","pos":[2413,2622]},{"content":"For versions of Windows prior to Windows 10, if you wanted to install a new version of Windows on your devices and preserve the configuration of those systems, you had to perform additional steps during your deployment.","pos":[2624,2843]},{"content":"For example, if you wanted to keep the data of users on the device, you had to back up user data with the User State Migration Tool (USMT) prior to the deployment and restore that data after the deployment had completed.","pos":[2844,3064]},{"content":"Introduced with Windows 10 and MDT 2013 Update 1, you can use the upgrade installation path directly with Microsoft deployment technologies such as the Microsoft Deployment Toolkit (MDT).","pos":[3066,3253]},{"content":"With an upgrade deployment you can use the same deployment technologies and process, but you can preserve users settings, and applications of the existing environment on the device.","pos":[3254,3435]},{"content":"Deployment tools and resources","pos":[3440,3470]},{"content":"Performing an upgrade deployment of Windows 10 requires the same tools and resources that are required for a traditional reimaging deployment.","pos":[3472,3614]},{"content":"You can read about the tools required, including detailed explanations and installation instructions, in <bpt id=\"p1\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p1\">](deploy-windows-10-to-surface-devices-with-mdt.md)</ept>.","pos":[3615,3818],"source":" You can read about the tools required, including detailed explanations and installation instructions, in [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md)."},{"content":"To proceed with the upgrade deployment described in this article, you will need the following tools installed and configured:","pos":[3819,3944]},{"content":"Microsoft Deployment Toolkit (MDT)","pos":[3949,3983]},{"pos":[4041,4212],"content":"<bpt id=\"p1\">[</bpt>Windows Assessment and Deployment Kit (Windows ADK)<ept id=\"p1\">](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#windowsadk)</ept>, which includes:","source":"[Windows Assessment and Deployment Kit (Windows ADK)](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#windowsadk), which includes:"},{"content":"Deployment Image Servicing and Management (DISM)","pos":[4218,4266]},{"content":"Windows Preinstallation Environment (Windows PE)","pos":[4272,4320]},{"content":"Windows System Image Manager (Windows SIM)","pos":[4326,4368]},{"content":"You will also need to have available the following resources:","pos":[4370,4431]},{"pos":[4435,4614],"content":"Windows 10 installation files, such as the installation media downloaded from the <bpt id=\"p1\">[</bpt>Volume Licensing Service Center<ept id=\"p1\">](https://www.microsoft.com/Licensing/servicecenter/default.aspx)</ept>","source":"Windows 10 installation files, such as the installation media downloaded from the [Volume Licensing Service Center](https://www.microsoft.com/Licensing/servicecenter/default.aspx)"},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Installation media for use with MDT must contain a Windows image in Windows Imaging Format (.wim).","pos":[4619,4738],"source":"**Note:**&nbsp;&nbsp;Installation media for use with MDT must contain a Windows image in Windows Imaging Format (.wim)."},{"content":"Installation media produced by the <bpt id=\"p1\">[</bpt>Get Windows 10<ept id=\"p1\">](https://www.microsoft.com/en-us/software-download/windows10/)</ept> page does not use a .wim file, instead using an Electronic Software Download (.esd) file, which is not compatible with MDT.","pos":[4739,4976],"source":" Installation media produced by the [Get Windows 10](https://www.microsoft.com/en-us/software-download/windows10/) page does not use a .wim file, instead using an Electronic Software Download (.esd) file, which is not compatible with MDT."},{"pos":[4979,5134],"content":"<bpt id=\"p1\">[</bpt>Surface firmware and drivers<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices)</ept> for Windows 10","source":"[Surface firmware and drivers](https://technet.microsoft.com/en-us/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices) for Windows 10"},{"content":"Application installation files for any applications you want to install, such as the Surface app","pos":[5137,5233]},{"content":"Prepare the upgrade deployment","pos":[5238,5268]},{"content":"Before you begin the process described in this section, you need to have installed and configured the deployment tools outlined in the previous <bpt id=\"p1\">[</bpt>Deployment tools and resources<ept id=\"p1\">](#deployment-tools-and-resources)</ept> section.","pos":[5270,5488],"source":"Before you begin the process described in this section, you need to have installed and configured the deployment tools outlined in the previous [Deployment tools and resources](#deployment-tools-and-resources) section."},{"content":"For instructions on how to install and configure the deployment tools, see the <bpt id=\"p1\">**</bpt>Install the deployment tools<ept id=\"p1\">**</ept> section in the <bpt id=\"p2\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p2\">](deploy-windows-10-to-surface-devices-with-mdt.md#install-the-deployment-tools)</ept> article.","pos":[5489,5751],"source":" For instructions on how to install and configure the deployment tools, see the **Install the deployment tools** section in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#install-the-deployment-tools) article."},{"content":"You will also have needed to create a deployment share with MDT, described in the section Create a Deployment Share in the aforementioned article.","pos":[5752,5898]},{"content":"Import Windows 10 installation files","pos":[5904,5940]},{"content":"Windows 10 installation files only need to be imported if you have not already done so in the deployment share.","pos":[5942,6053]},{"content":"To import Windows 10 installation files, follow the steps described in the <bpt id=\"p1\">**</bpt>Import Windows installation files<ept id=\"p1\">**</ept> section in the <bpt id=\"p2\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p2\">](deploy-windows-10-to-surface-devices-with-mdt.md#import-windows-installation-files)</ept> article.","pos":[6054,6322],"source":" To import Windows 10 installation files, follow the steps described in the **Import Windows installation files** section in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#import-windows-installation-files) article."},{"content":"Import Surface drivers","pos":[6328,6350]},{"content":"In the import process example shown in the <bpt id=\"p1\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p1\">](deploy-windows-10-to-surface-devices-with-mdt.md)</ept> article, drivers for Surface Pro 4 were imported for Windows 10.","pos":[6351,6556],"source":"In the import process example shown in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md) article, drivers for Surface Pro 4 were imported for Windows 10."},{"content":"To perform an upgrade deployment of Windows 10 to Surface Pro 3, drivers for Surface Pro 3 must also be imported.","pos":[6557,6670]},{"content":"To import the Surface drivers for Surface Pro 3, follow these steps:","pos":[6671,6739]},{"pos":[6744,6998],"content":"Download the Surface Pro 3 firmware and driver pack for Windows 10 archive file (.zip), SurfacePro3_Win10_xxxxxx.zip, from the <bpt id=\"p1\">[</bpt>Surface Pro 3 download page<ept id=\"p1\">](https://www.microsoft.com/en-US/download/details.aspx?id=38826)</ept> in the Microsoft Download Center.","source":"Download the Surface Pro 3 firmware and driver pack for Windows 10 archive file (.zip), SurfacePro3_Win10_xxxxxx.zip, from the [Surface Pro 3 download page](https://www.microsoft.com/en-US/download/details.aspx?id=38826) in the Microsoft Download Center."},{"content":"Extract the contents of the Surface Pro 3 firmware and driver pack archive file to a temporary folder.","pos":[7002,7104]},{"content":"Keep the driver files separate from other drivers or files.","pos":[7105,7164]},{"content":"Open the Deployment Workbench and expand the Deployment Shares node and your deployment share.","pos":[7168,7262]},{"content":"If you have not already created a folder structure by operating system version, you should do so next.","pos":[7267,7369]},{"content":"Under the <bpt id=\"p1\">**</bpt>Windows 10 x64<ept id=\"p1\">**</ept> folder, create a new folder for Surface Pro 3 drivers named <bpt id=\"p2\">**</bpt>Surface Pro 3<ept id=\"p2\">**</ept>.","pos":[7370,7477],"source":" Under the **Windows 10 x64** folder, create a new folder for Surface Pro 3 drivers named **Surface Pro 3**."},{"content":"Your Out-of-Box Drivers folder should resemble the following structure:","pos":[7478,7549]},{"content":"WinPE x86","pos":[7554,7563]},{"content":"WinPE x64","pos":[7568,7577]},{"content":"Windows 10 x64","pos":[7582,7596]},{"content":"Microsoft Corporation","pos":[7603,7624]},{"content":"Surface Pro 4","pos":[7633,7646]},{"content":"Surface Pro 3","pos":[7655,7668]},{"pos":[7672,7805],"content":"Right-click the <bpt id=\"p1\">**</bpt>Surface Pro 3<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>Import Drivers<ept id=\"p2\">**</ept> to start the Import Drivers Wizard, as shown in Figure 1.","source":"Right-click the **Surface Pro 3** folder, and then click **Import Drivers** to start the Import Drivers Wizard, as shown in Figure 1."},{"content":"Import Surface Pro 3 drivers for Windows 10","pos":[7811,7854]},{"content":"Figure 1.","pos":[7942,7951]},{"content":"Import Surface Pro 3 drivers for Windows 10","pos":[7952,7995]},{"content":"The Import Driver Wizard displays a series of steps, as follows:","pos":[8001,8065]},{"pos":[8070,8207],"content":"<bpt id=\"p1\">**</bpt>Specify Directory<ept id=\"p1\">**</ept> – Click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> and navigate to the folder where you extracted the Surface Pro 3 firmware and drivers in Step 1.","source":"**Specify Directory** – Click **Browse** and navigate to the folder where you extracted the Surface Pro 3 firmware and drivers in Step 1."},{"pos":[8212,8328],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin the import process.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin the import process."},{"pos":[8333,8421],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the drivers are imported, a progress bar is displayed on this page.","source":"**Progress** – While the drivers are imported, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the import process completes, the success of the process is displayed on this page.","pos":[8426,8533],"source":"**Confirmation** – When the import process completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete Import Drivers Wizard.","pos":[8534,8585],"source":" Click **Finish** to complete Import Drivers Wizard."},{"pos":[8589,8718],"content":"Select the <bpt id=\"p1\">**</bpt>Surface Pro 3<ept id=\"p1\">**</ept> folder and verify that the folder now contains the drivers that were imported, as shown in Figure 2.","source":"Select the **Surface Pro 3** folder and verify that the folder now contains the drivers that were imported, as shown in Figure 2."},{"content":"Drivers for Surface Pro 3 imported and organized in the MDT deployment share","pos":[8724,8800]},{"content":"Figure 2.","pos":[8921,8930]},{"content":"Drivers for Surface Pro 3 imported and organized in the MDT deployment share","pos":[8931,9007]},{"content":"Import applications","pos":[9014,9033]},{"content":"Installation of applications in an upgrade deployment is not always necessary because the applications from the previous environment will remain on the device.","pos":[9035,9194]},{"content":"(For example, in the <bpt id=\"p1\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p1\">](deploy-windows-10-to-surface-devices-with-mdt.md)</ept> article, the deployment includes Office 365 which is not required in an upgrade deployment where the user is already using Office 365 on the device.)","pos":[9195,9463],"source":" (For example, in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md) article, the deployment includes Office 365 which is not required in an upgrade deployment where the user is already using Office 365 on the device.)"},{"content":"There are still some circumstances where you will want to deploy an application, even during an upgrade deployment.","pos":[9465,9580]},{"content":"For example, you may have Surface Pro 3 devices on which you would like to add the Surface app.","pos":[9581,9676]},{"content":"To deploy the Surface app in an upgrade scenario use the same process as you would for a traditional deployment.","pos":[9677,9789]},{"content":"See the <bpt id=\"p1\">[</bpt>Deploy Surface app with Windows Store for Business<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/deploy-surface-app-with-windows-store-for-business)</ept> article for instructions on how to add the Surface app to an MDT task sequence.","pos":[9790,10032],"source":" See the [Deploy Surface app with Windows Store for Business](https://technet.microsoft.com/en-us/itpro/surface/deploy-surface-app-with-windows-store-for-business) article for instructions on how to add the Surface app to an MDT task sequence."},{"content":"Create the upgrade task sequence","pos":[10038,10070]},{"content":"After you have all of the resources in place to perform the deployment (including the installation files, Surface drivers, and application files), the next step is to create the upgrade task sequence.","pos":[10072,10272]},{"content":"This task sequence is a series of steps that will be performed on the device being upgraded that applies the new Windows environment, compatible drivers, and any applications you have specified.","pos":[10273,10467]},{"content":"Create the upgrade task sequence with the following process:","pos":[10469,10529]},{"pos":[10534,10709],"content":"In the Deployment Workbench under your Deployment Share, right-click the <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> folder, and then click <bpt id=\"p2\">**</bpt>New Task Sequence<ept id=\"p2\">**</ept> to start the New Task Sequence Wizard.","source":"In the Deployment Workbench under your Deployment Share, right-click the **Task Sequences** folder, and then click **New Task Sequence** to start the New Task Sequence Wizard."},{"content":"Use these steps to create the deployment task sequence with the New Task Sequence Wizard:","pos":[10713,10802]},{"pos":[10807,11102],"content":"<bpt id=\"p1\">**</bpt>General Settings<ept id=\"p1\">**</ept> – Enter an identifier for the deployment task sequence in the Task Sequence ID field, a name for the deployment task sequence in the Task Sequence Name field, and any comments for the deployment task sequence in the <bpt id=\"p2\">**</bpt>Task Sequence Comments<ept id=\"p2\">**</ept> field, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**General Settings** – Enter an identifier for the deployment task sequence in the Task Sequence ID field, a name for the deployment task sequence in the Task Sequence Name field, and any comments for the deployment task sequence in the **Task Sequence Comments** field, and then click **Next**."},{"pos":[11106,11218],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The <bpt id=\"p2\">**</bpt>Task Sequence ID<ept id=\"p2\">**</ept> field cannot contain spaces and can be a maximum of 16 characters.","source":"**Note:**&nbsp;&nbsp;The **Task Sequence ID** field cannot contain spaces and can be a maximum of 16 characters."},{"pos":[11223,11343],"content":"<bpt id=\"p1\">**</bpt>Select Template<ept id=\"p1\">**</ept> – Select <bpt id=\"p2\">**</bpt>Standard Client Upgrade Task Sequence<ept id=\"p2\">**</ept> from the drop-down menu, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Select Template** – Select **Standard Client Upgrade Task Sequence** from the drop-down menu, and then click **Next**."},{"pos":[11348,11448],"content":"<bpt id=\"p1\">**</bpt>Select OS<ept id=\"p1\">**</ept> – Navigate to and select the Windows image that you imported, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"**Select OS** – Navigate to and select the Windows image that you imported, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Specify Product Key<ept id=\"p1\">**</ept> – Select the product key entry that fits your organization’s licensing system.","pos":[11453,11555],"source":"**Specify Product Key** – Select the product key entry that fits your organization’s licensing system."},{"content":"The <bpt id=\"p1\">**</bpt>Do Not Specify a Product Key at This Time<ept id=\"p1\">**</ept> option can be used for systems that will be activated via Key Management Services (KMS) or Active Directory Based Activation (ADBA).","pos":[11556,11738],"source":" The **Do Not Specify a Product Key at This Time** option can be used for systems that will be activated via Key Management Services (KMS) or Active Directory Based Activation (ADBA)."},{"content":"A product key can be specified specifically if your organization uses Multiple Activation Keys (MAK).","pos":[11739,11840]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[11841,11856],"source":" Click **Next**."},{"pos":[11861,12106],"content":"<bpt id=\"p1\">**</bpt>OS Settings<ept id=\"p1\">**</ept> – Enter a name and organization for registration of Windows, and a home page URL for users when they browse the Internet in the <bpt id=\"p2\">**</bpt>Full Name<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Organization<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Internet Explorer Home Page<ept id=\"p4\">**</ept> fields, and then click <bpt id=\"p5\">**</bpt>Next<ept id=\"p5\">**</ept>.","source":"**OS Settings** – Enter a name and organization for registration of Windows, and a home page URL for users when they browse the Internet in the **Full Name**, **Organization**, and **Internet Explorer Home Page** fields, and then click **Next**."},{"pos":[12111,12259],"content":"<bpt id=\"p1\">**</bpt>Admin Password<ept id=\"p1\">**</ept> – Select <bpt id=\"p2\">**</bpt>Use the Specified Local Administrator Password<ept id=\"p2\">**</ept> and enter a password in the provided fields, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>.","source":"**Admin Password** – Select **Use the Specified Local Administrator Password** and enter a password in the provided fields, and then click **Next**."},{"pos":[12264,12391],"content":"<bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> – Review the specified configuration on this page before you click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to begin creation of the task sequence.","source":"**Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the task sequence."},{"pos":[12396,12494],"content":"<bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> – While the task sequence is being created, a progress bar is displayed on this page.","source":"**Progress** – While the task sequence is being created, a progress bar is displayed on this page."},{"content":"<bpt id=\"p1\">**</bpt>Confirmation<ept id=\"p1\">**</ept> – When the task sequence creation completes, the success of the process is displayed on this page.","pos":[12499,12614],"source":"**Confirmation** – When the task sequence creation completes, the success of the process is displayed on this page."},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept> to complete New Task Sequence Wizard.","pos":[12615,12669],"source":" Click **Finish** to complete New Task Sequence Wizard."},{"content":"After the task sequence is created, you can modify some additional settings to provide additional automation of the task sequence and require less interaction during deployment.","pos":[12671,12848]},{"content":"Follow these steps to modify the task sequence:","pos":[12849,12896]},{"pos":[12901,13016],"content":"Select the <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> folder, right-click the new task sequence you created, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"Select the **Task Sequences** folder, right-click the new task sequence you created, and then click **Properties**."},{"pos":[13020,13114],"content":"Select the <bpt id=\"p1\">**</bpt>Task Sequence<ept id=\"p1\">**</ept> tab to view the steps that are included in the new task sequence.","source":"Select the **Task Sequence** tab to view the steps that are included in the new task sequence."},{"pos":[13118,13228],"content":"Select the <bpt id=\"p1\">**</bpt>Windows Update (Pre-Application Installation)<ept id=\"p1\">**</ept> step, located under the <bpt id=\"p2\">**</bpt>State Restore<ept id=\"p2\">**</ept> folder.","source":"Select the **Windows Update (Pre-Application Installation)** step, located under the **State Restore** folder."},{"pos":[13232,13310],"content":"Click the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> tab, and then clear the <bpt id=\"p2\">**</bpt>Disable This Step<ept id=\"p2\">**</ept> check box.","source":"Click the **Options** tab, and then clear the **Disable This Step** check box."},{"pos":[13314,13403],"content":"Repeat Step 3 and Step 4 for the <bpt id=\"p1\">**</bpt>Windows Update (Post-Application Installation)<ept id=\"p1\">**</ept> step.","source":"Repeat Step 3 and Step 4 for the **Windows Update (Post-Application Installation)** step."},{"content":"Between the two Windows Update steps is an <bpt id=\"p1\">**</bpt>Install Applications<ept id=\"p1\">**</ept> step.","pos":[13407,13480],"source":"Between the two Windows Update steps is an **Install Applications** step."},{"content":"Select that step and then click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[13481,13521],"source":" Select that step and then click **Add**."},{"content":"Hover the mouse over <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> under the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> menu, and then choose <bpt id=\"p3\">**</bpt>Install Application<ept id=\"p3\">**</ept>.","pos":[13525,13622],"source":"Hover the mouse over **General** under the **Add** menu, and then choose **Install Application**."},{"content":"This will add a new step after the selected step for the installation of a specific application as shown in Figure 3.","pos":[13623,13740]},{"content":"A new Install Application step in the deployment task sequence","pos":[13746,13808]},{"content":"Figure 3.","pos":[13917,13926]},{"content":"A new Install Application step in the deployment task sequence","pos":[13927,13989]},{"pos":[13997,14116],"content":"On the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> tab of the new <bpt id=\"p2\">**</bpt>Install Application<ept id=\"p2\">**</ept> step, enter <bpt id=\"p3\">**</bpt>Install Surface App<ept id=\"p3\">**</ept> in the <bpt id=\"p4\">**</bpt>Name<ept id=\"p4\">**</ept> field.","source":"On the **Properties** tab of the new **Install Application** step, enter **Install Surface App** in the **Name** field."},{"pos":[14120,14268],"content":"Select <bpt id=\"p1\">**</bpt>Install a Single Application<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to view available applications that have been imported into the deployment share.","source":"Select **Install a Single Application**, and then click **Browse** to view available applications that have been imported into the deployment share."},{"pos":[14273,14349],"content":"Select <bpt id=\"p1\">**</bpt>Surface App<ept id=\"p1\">**</ept> from the list of applications, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Select **Surface App** from the list of applications, and then click **OK**."},{"pos":[14354,14438],"content":"Expand the <bpt id=\"p1\">**</bpt>Preinstall<ept id=\"p1\">**</ept> folder and select the <bpt id=\"p2\">**</bpt>Enable BitLocker (Offline)<ept id=\"p2\">**</ept> step.","source":"Expand the **Preinstall** folder and select the **Enable BitLocker (Offline)** step."},{"pos":[14443,14545],"content":"Open the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> menu again and choose <bpt id=\"p2\">**</bpt>Set Task Sequence Variable<ept id=\"p2\">**</ept> from under the <bpt id=\"p3\">**</bpt>General<ept id=\"p3\">**</ept> menu.","source":"Open the **Add** menu again and choose **Set Task Sequence Variable** from under the **General** menu."},{"pos":[14550,14678],"content":"On the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> tab of the new <bpt id=\"p2\">**</bpt>Set Task Sequence Variable<ept id=\"p2\">**</ept> step (as shown in Figure 4) configure the following options:","source":"On the **Properties** tab of the new **Set Task Sequence Variable** step (as shown in Figure 4) configure the following options:"},{"pos":[14684,14713],"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> – Set DriverGroup001","source":"**Name** – Set DriverGroup001"},{"pos":[14718,14761],"content":"<bpt id=\"p1\">**</bpt>Task Sequence Variable<ept id=\"p1\">**</ept> – DriverGroup001","source":"**Task Sequence Variable** – DriverGroup001"},{"pos":[14766,14807],"content":"<bpt id=\"p1\">**</bpt>Value<ept id=\"p1\">**</ept> – Windows 10 x64\\%Make%\\%Model%","source":"**Value** – Windows 10 x64\\%Make%\\%Model%"},{"content":"Configure a new Set Task Sequence Variable step in the deployment task sequence","pos":[14813,14892]},{"content":"Figure 4.","pos":[15018,15027]},{"content":"Configure a new Set Task Sequence Variable step in the deployment task sequence","pos":[15028,15107]},{"pos":[15116,15187],"content":"Select the <bpt id=\"p1\">**</bpt>Inject Drivers<ept id=\"p1\">**</ept> step, the next step in the task sequence.","source":"Select the **Inject Drivers** step, the next step in the task sequence."},{"pos":[15192,15304],"content":"On the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> tab of the <bpt id=\"p2\">**</bpt>Inject Drivers<ept id=\"p2\">**</ept> step (as shown in Figure 5) configure the following options:","source":"On the **Properties** tab of the **Inject Drivers** step (as shown in Figure 5) configure the following options:"},{"pos":[15309,15382],"content":"In the <bpt id=\"p1\">**</bpt>Choose a selection profile<ept id=\"p1\">**</ept> drop-down menu, select <bpt id=\"p2\">**</bpt>Nothing<ept id=\"p2\">**</ept>.","source":"In the **Choose a selection profile** drop-down menu, select **Nothing**."},{"pos":[15387,15455],"content":"Click the <bpt id=\"p1\">**</bpt>Install all drivers from the selection profile<ept id=\"p1\">**</ept> button.","source":"Click the **Install all drivers from the selection profile** button."},{"content":"Configure the deployment task sequence to not install drivers","pos":[15463,15524]},{"content":"Figure 5.","pos":[15632,15641]},{"content":"Configure the deployment task sequence to not install drivers","pos":[15642,15703]},{"pos":[15710,15807],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply changes to the task sequence and close the task sequence properties window.","source":"Click **OK** to apply changes to the task sequence and close the task sequence properties window."},{"content":"Steps 11 through 15 are very important to the deployment of Surface devices.","pos":[15809,15885]},{"content":"These steps instruct the task sequence to install only drivers that are organized into the correct folder using the organization for drivers from the <bpt id=\"p1\">[</bpt>Import Surface drivers<ept id=\"p1\">](#import-surface-drivers)</ept> section.","pos":[15886,16094],"source":" These steps instruct the task sequence to install only drivers that are organized into the correct folder using the organization for drivers from the [Import Surface drivers](#import-surface-drivers) section."},{"content":"Deployment share rules","pos":[16101,16123]},{"content":"To automate the upgrade process, the rules of the MDT deployment share need to be modified to suppress prompts for information from the user.","pos":[16125,16266]},{"content":"Unlike a traditional deployment, Bootstrap.ini does not need to be modified because the deployment process is not started from boot media.","pos":[16267,16405]},{"content":"Similarly, boot media does not need to be imported into WDS because it will not be booted over the network with PXE.","pos":[16406,16522]},{"pos":[16524,16738],"content":"To modify the deployment share rules and suppress the Windows Deployment Wizard prompts for information, copy and paste the following text into the text box on the <bpt id=\"p1\">**</bpt>Rules<ept id=\"p1\">**</ept> tab of your deployment share properties:","source":"To modify the deployment share rules and suppress the Windows Deployment Wizard prompts for information, copy and paste the following text into the text box on the **Rules** tab of your deployment share properties:"},{"pos":[17554,17815],"content":"For more information about the rules configured by this text, see the <bpt id=\"p1\">**</bpt>Configure deployment share rules<ept id=\"p1\">**</ept> section in the <bpt id=\"p2\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p2\">](deploy-windows-10-to-surface-devices-with-mdt.md#configure-deployment-share-rules)</ept> article.","source":"For more information about the rules configured by this text, see the **Configure deployment share rules** section in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#configure-deployment-share-rules) article."},{"content":"Update deployment share","pos":[17821,17844]},{"content":"To update the deployment share, right-click the deployment share in the Deployment Workbench and click <bpt id=\"p1\">**</bpt>Update Deployment Share<ept id=\"p1\">**</ept>, then proceed through the Update Deployment Share Wizard.","pos":[17846,18034],"source":"To update the deployment share, right-click the deployment share in the Deployment Workbench and click **Update Deployment Share**, then proceed through the Update Deployment Share Wizard."},{"content":"See the <bpt id=\"p1\">**</bpt>Update and import updated MDT boot media<ept id=\"p1\">**</ept> section of the <bpt id=\"p2\">[</bpt>Deploy Windows 10 to Surface devices with MDT<ept id=\"p2\">](deploy-windows-10-to-surface-devices-with-mdt.md#update-and-import-updated-mdt-boot-media)</ept> article for detailed steps.","pos":[18035,18269],"source":" See the **Update and import updated MDT boot media** section of the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#update-and-import-updated-mdt-boot-media) article for detailed steps."},{"content":"Run the upgrade deployment","pos":[18275,18301]},{"content":"Unlike a traditional deployment, the upgrade task sequence must be launched from within the Windows environment that will be upgraded.","pos":[18303,18437]},{"content":"This requires that a user on the device to be upgraded navigate to the deployment share over the network and launch a script, LiteTouch.vbs.","pos":[18438,18578]},{"content":"This script is the same script that displays the Windows Deployment Wizard in Windows PE in a traditional deployment.","pos":[18579,18696]},{"content":"In this scenario, Litetouch.vbs will run within Windows.","pos":[18697,18753]},{"content":"To perform the upgrade task sequence and deploy the upgrade to Windows 10 follow these steps:","pos":[18754,18847]},{"content":"Browse to the network location of your deployment share in File Explorer.","pos":[18852,18925]},{"pos":[18929,19070],"content":"Navigate to the <bpt id=\"p1\">**</bpt>Scripts<ept id=\"p1\">**</ept> folder, locate <bpt id=\"p2\">**</bpt>LiteTouch.vbs<ept id=\"p2\">**</ept>, and then double-click <bpt id=\"p3\">**</bpt>LiteTouch.vbs<ept id=\"p3\">**</ept> to start the Windows Deployment Wizard.","source":"Navigate to the **Scripts** folder, locate **LiteTouch.vbs**, and then double-click **LiteTouch.vbs** to start the Windows Deployment Wizard."},{"content":"Enter your credentials when prompted.","pos":[19074,19111]},{"content":"The upgrade task sequence for Surface Pro 3 devices will automatically start when the model of the device is detected and determined to match the deployment share rules.","pos":[19115,19284]},{"content":"The upgrade process will occur automatically and without user interaction.","pos":[19288,19362]},{"content":"The task sequence will automatically install the drivers for Surface Pro 3 and the Surface app, and will perform any outstanding Windows Updates.","pos":[19364,19509]},{"content":"When it completes, it will log out and be ready for the user to log on with the credentials they have always used for this device.","pos":[19510,19640]}],"content":"---\ntitle: Upgrade Surface devices to Windows 10 with Microsoft Deployment Toolkit (Surface)\ndescription: Find out how to perform a Windows 10 upgrade deployment to your Surface devices. \nkeywords: windows 10 surface, upgrade, customize, mdt\nms.prod: w10\nms.mktglfcycl: deploy\nms.pagetype: surface\nms.sitesec: library\nauthor: Scottmca\n---\n\n#  Upgrade Surface devices to Windows 10 with Microsoft Deployment Toolkit\n\n#### Applies to\n* Surface Pro 3\n* Surface 3\n* Surface Pro 2\n* Surface Pro\n* Windows 10\n\nIn addition to the traditional deployment method of reimaging devices, administrators that want to upgrade Surface devices that are running Windows 8.1 or Windows 10 have the option of deploying upgrades. By performing an upgrade deployment, Windows 10 can be applied to devices without removing users, apps, or configuration. The users of the deployed devices can simply continue using the devices with the same apps and settings that they used prior to the upgrade. The process described in this article shows how to perform a Windows 10 upgrade deployment to Surface devices.\n\nIf you are not already familiar with the deployment of Windows or the Microsoft deployment tools and technologies, you should read [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md) and familiarize yourself with the traditional deployment method before you proceed.\n\n#### The upgrade concept\n\nWhen you use the factory installation media to install Windows on a device, you are presented with two options or *installation paths* to install Windows on that device. The first of these installation paths – *clean installation* –  allows you to apply a factory image of Windows to that device, including all default settings. The second of these installation paths – *upgrade* – allows you to apply Windows to the device but retains the device’s users, apps, and settings.\n\nWhen you perform a Windows deployment using traditional deployment methods, you follow an installation path that is very similar to a clean installation. The primary difference between the clean installation and the traditional deployment method of *reimaging* is that with reimaging, you can apply an image that includes customizations. Microsoft deployment technologies, such as the Microsoft Deployment Toolkit (MDT), expand the capabilities of the reimaging process by modifying the image during deployment. For example, MDT is able to inject drivers for a specific hardware configuration during deployment, and with pre and post imaging scripts to perform a number of tasks, such as the installation of applications.\n\nFor versions of Windows prior to Windows 10, if you wanted to install a new version of Windows on your devices and preserve the configuration of those systems, you had to perform additional steps during your deployment. For example, if you wanted to keep the data of users on the device, you had to back up user data with the User State Migration Tool (USMT) prior to the deployment and restore that data after the deployment had completed.\n\nIntroduced with Windows 10 and MDT 2013 Update 1, you can use the upgrade installation path directly with Microsoft deployment technologies such as the Microsoft Deployment Toolkit (MDT). With an upgrade deployment you can use the same deployment technologies and process, but you can preserve users settings, and applications of the existing environment on the device.\n\n## Deployment tools and resources\n\nPerforming an upgrade deployment of Windows 10 requires the same tools and resources that are required for a traditional reimaging deployment. You can read about the tools required, including detailed explanations and installation instructions, in [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md). To proceed with the upgrade deployment described in this article, you will need the following tools installed and configured:\n\n* [Microsoft Deployment Toolkit (MDT)](https://technet.microsoft.com/en-us/windows/dn475741)\n* [Windows Assessment and Deployment Kit (Windows ADK)](https://developer.microsoft.com/en-us/windows/hardware/windows-assessment-deployment-kit#windowsadk), which includes:\n   * Deployment Image Servicing and Management (DISM)\n   * Windows Preinstallation Environment (Windows PE)\n   * Windows System Image Manager (Windows SIM)\n\nYou will also need to have available the following resources:\n\n* Windows 10 installation files, such as the installation media downloaded from the [Volume Licensing Service Center](https://www.microsoft.com/Licensing/servicecenter/default.aspx)\n   >**Note:**&nbsp;&nbsp;Installation media for use with MDT must contain a Windows image in Windows Imaging Format (.wim). Installation media produced by the [Get Windows 10](https://www.microsoft.com/en-us/software-download/windows10/) page does not use a .wim file, instead using an Electronic Software Download (.esd) file, which is not compatible with MDT.\n* [Surface firmware and drivers](https://technet.microsoft.com/en-us/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices) for Windows 10\n* Application installation files for any applications you want to install, such as the Surface app\n\n## Prepare the upgrade deployment\n\nBefore you begin the process described in this section, you need to have installed and configured the deployment tools outlined in the previous [Deployment tools and resources](#deployment-tools-and-resources) section. For instructions on how to install and configure the deployment tools, see the **Install the deployment tools** section in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#install-the-deployment-tools) article. You will also have needed to create a deployment share with MDT, described in the section Create a Deployment Share in the aforementioned article.\n\n### Import Windows 10 installation files\n\nWindows 10 installation files only need to be imported if you have not already done so in the deployment share. To import Windows 10 installation files, follow the steps described in the **Import Windows installation files** section in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#import-windows-installation-files) article.\n\n### Import Surface drivers\nIn the import process example shown in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md) article, drivers for Surface Pro 4 were imported for Windows 10. To perform an upgrade deployment of Windows 10 to Surface Pro 3, drivers for Surface Pro 3 must also be imported. To import the Surface drivers for Surface Pro 3, follow these steps:\n\n1. Download the Surface Pro 3 firmware and driver pack for Windows 10 archive file (.zip), SurfacePro3_Win10_xxxxxx.zip, from the [Surface Pro 3 download page](https://www.microsoft.com/en-US/download/details.aspx?id=38826) in the Microsoft Download Center.\n2. Extract the contents of the Surface Pro 3 firmware and driver pack archive file to a temporary folder. Keep the driver files separate from other drivers or files.\n3. Open the Deployment Workbench and expand the Deployment Shares node and your deployment share. \n4. If you have not already created a folder structure by operating system version, you should do so next. Under the **Windows 10 x64** folder, create a new folder for Surface Pro 3 drivers named **Surface Pro 3**. Your Out-of-Box Drivers folder should resemble the following structure:\n  * WinPE x86\n  * WinPE x64\n  * Windows 10 x64\n    * Microsoft Corporation\n      * Surface Pro 4\n      * Surface Pro 3\n5. Right-click the **Surface Pro 3** folder, and then click **Import Drivers** to start the Import Drivers Wizard, as shown in Figure 1.\n\n  ![Import Surface Pro 3 drivers for Windows 10](images\\surface-upgrademdt-fig1.png \"Import Surface Pro 3 drivers for Windows 10\")\n\n  *Figure 1. Import Surface Pro 3 drivers for Windows 10*\n\n6. The Import Driver Wizard displays a series of steps, as follows:\n  - **Specify Directory** – Click **Browse** and navigate to the folder where you extracted the Surface Pro 3 firmware and drivers in Step 1.\n  - **Summary** – Review the specified configuration on this page before you click **Next** to begin the import process.\n  - **Progress** – While the drivers are imported, a progress bar is displayed on this page.\n  - **Confirmation** – When the import process completes, the success of the process is displayed on this page. Click **Finish** to complete Import Drivers Wizard.\n7. Select the **Surface Pro 3** folder and verify that the folder now contains the drivers that were imported, as shown in Figure 2.\n\n  ![Drivers for Surface Pro 3 imported and organized in the MDT deployment share](images\\surface-upgrademdt-fig2.png \"Drivers for Surface Pro 3 imported and organized in the MDT deployment share\")\n\n  *Figure 2. Drivers for Surface Pro 3 imported and organized in the MDT deployment share*\n\n### Import applications\n\nInstallation of applications in an upgrade deployment is not always necessary because the applications from the previous environment will remain on the device. (For example, in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md) article, the deployment includes Office 365 which is not required in an upgrade deployment where the user is already using Office 365 on the device.)\n\nThere are still some circumstances where you will want to deploy an application, even during an upgrade deployment. For example, you may have Surface Pro 3 devices on which you would like to add the Surface app. To deploy the Surface app in an upgrade scenario use the same process as you would for a traditional deployment. See the [Deploy Surface app with Windows Store for Business](https://technet.microsoft.com/en-us/itpro/surface/deploy-surface-app-with-windows-store-for-business) article for instructions on how to add the Surface app to an MDT task sequence.\n\n### Create the upgrade task sequence\n\nAfter you have all of the resources in place to perform the deployment (including the installation files, Surface drivers, and application files), the next step is to create the upgrade task sequence. This task sequence is a series of steps that will be performed on the device being upgraded that applies the new Windows environment, compatible drivers, and any applications you have specified.\n\nCreate the upgrade task sequence with the following process:\n\n1. In the Deployment Workbench under your Deployment Share, right-click the **Task Sequences** folder, and then click **New Task Sequence** to start the New Task Sequence Wizard.\n2. Use these steps to create the deployment task sequence with the New Task Sequence Wizard:\n  - **General Settings** – Enter an identifier for the deployment task sequence in the Task Sequence ID field, a name for the deployment task sequence in the Task Sequence Name field, and any comments for the deployment task sequence in the **Task Sequence Comments** field, and then click **Next**.\n  >**Note:**&nbsp;&nbsp;The **Task Sequence ID** field cannot contain spaces and can be a maximum of 16 characters.\n  - **Select Template** – Select **Standard Client Upgrade Task Sequence** from the drop-down menu, and then click **Next**.\n  - **Select OS** – Navigate to and select the Windows image that you imported, and then click **Next**.\n  - **Specify Product Key** – Select the product key entry that fits your organization’s licensing system. The **Do Not Specify a Product Key at This Time** option can be used for systems that will be activated via Key Management Services (KMS) or Active Directory Based Activation (ADBA). A product key can be specified specifically if your organization uses Multiple Activation Keys (MAK). Click **Next**.\n  - **OS Settings** – Enter a name and organization for registration of Windows, and a home page URL for users when they browse the Internet in the **Full Name**, **Organization**, and **Internet Explorer Home Page** fields, and then click **Next**.\n  - **Admin Password** – Select **Use the Specified Local Administrator Password** and enter a password in the provided fields, and then click **Next**.\n  - **Summary** – Review the specified configuration on this page before you click **Next** to begin creation of the task sequence.\n  - **Progress** – While the task sequence is being created, a progress bar is displayed on this page.\n  - **Confirmation** – When the task sequence creation completes, the success of the process is displayed on this page. Click **Finish** to complete New Task Sequence Wizard.\n\nAfter the task sequence is created, you can modify some additional settings to provide additional automation of the task sequence and require less interaction during deployment. Follow these steps to modify the task sequence:\n\n1. Select the **Task Sequences** folder, right-click the new task sequence you created, and then click **Properties**.\n2. Select the **Task Sequence** tab to view the steps that are included in the new task sequence.\n3. Select the **Windows Update (Pre-Application Installation)** step, located under the **State Restore** folder.\n4. Click the **Options** tab, and then clear the **Disable This Step** check box.\n5. Repeat Step 3 and Step 4 for the **Windows Update (Post-Application Installation)** step.\n6. Between the two Windows Update steps is an **Install Applications** step. Select that step and then click **Add**.\n7. Hover the mouse over **General** under the **Add** menu, and then choose **Install Application**. This will add a new step after the selected step for the installation of a specific application as shown in Figure 3.\n\n  ![A new Install Application step in the deployment task sequence](images\\surface-upgrademdt-fig3.png \"A new Install Application step in the deployment task sequence\")\n  \n  *Figure 3. A new Install Application step in the deployment task sequence*\n  \n8. On the **Properties** tab of the new **Install Application** step, enter **Install Surface App** in the **Name** field.\n9. Select **Install a Single Application**, and then click **Browse** to view available applications that have been imported into the deployment share.\n10. Select **Surface App** from the list of applications, and then click **OK**.\n11. Expand the **Preinstall** folder and select the **Enable BitLocker (Offline)** step.\n12. Open the **Add** menu again and choose **Set Task Sequence Variable** from under the **General** menu.\n13. On the **Properties** tab of the new **Set Task Sequence Variable** step (as shown in Figure 4) configure the following options:\n\n  - **Name** – Set DriverGroup001\n  - **Task Sequence Variable** – DriverGroup001\n  - **Value** – Windows 10 x64\\%Make%\\%Model%\n\n  ![Configure a new Set Task Sequence Variable step in the deployment task sequence](images\\surface-upgrademdt-fig4.png \"Configure a new Set Task Sequence Variable step in the deployment task sequence\")\n  \n  *Figure 4. Configure a new Set Task Sequence Variable step in the deployment task sequence*\n  \n14. Select the **Inject Drivers** step, the next step in the task sequence.\n15. On the **Properties** tab of the **Inject Drivers** step (as shown in Figure 5) configure the following options:\n  * In the **Choose a selection profile** drop-down menu, select **Nothing**.\n  * Click the **Install all drivers from the selection profile** button.\n  \n  ![Configure the deployment task sequence to not install drivers](images\\surface-upgrademdt-fig5.png \"Configure the deployment task sequence to not install drivers\")\n  \n  *Figure 5. Configure the deployment task sequence to not install drivers*\n\n16. Click **OK** to apply changes to the task sequence and close the task sequence properties window.\n\nSteps 11 through 15 are very important to the deployment of Surface devices. These steps instruct the task sequence to install only drivers that are organized into the correct folder using the organization for drivers from the [Import Surface drivers](#import-surface-drivers) section. \n\n### Deployment share rules\n\nTo automate the upgrade process, the rules of the MDT deployment share need to be modified to suppress prompts for information from the user. Unlike a traditional deployment, Bootstrap.ini does not need to be modified because the deployment process is not started from boot media. Similarly, boot media does not need to be imported into WDS because it will not be booted over the network with PXE.\n\nTo modify the deployment share rules and suppress the Windows Deployment Wizard prompts for information, copy and paste the following text into the text box on the **Rules** tab of your deployment share properties:\n\n```\n[Settings]\nPriority=Model,Default\nProperties=MyCustomProperty\n\n[Surface Pro 4]\nSkipTaskSequence=YES\nTaskSequenceID=Win10SP4\n\n[Surface Pro 3]\nSkipTaskSequence=YES\nTaskSequenceID=Win10SP3Up\n\n[Default]\nOSInstall=Y\nSkipCapture=YES\nSkipAdminPassword=YES\nSkipProductKey=YES\nSkipComputerBackup=YES\nSkipBitLocker=YES\nSkipBDDWelcome=YES\nSkipUserData=YES\nUserDataLocation=AUTO\nSkipApplications=YES\nSkipPackageDisplay=YES\nSkipComputerName=YES\nSkipDomainMembership=YES\nJoinDomain=contoso.com\nDomainAdmin=MDT\nDomainAdminDomain=contoso\nDomainAdminPassword=P@ssw0rd\nSkipLocaleSelection=YES\nKeyboardLocale=en-US\nUserLocale=en-US\nUILanguage=en-US\nSkipTimeZone=YES\nTimeZoneName=Pacific Standard Time\nUserID=MDTUser\nUserDomain=STNDeployServer\nUserPassword=P@ssw0rd\nSkipSummary=YES\nSkipFinalSummary=YES\nFinishAction=LOGOFF\n```\n\n\n\nFor more information about the rules configured by this text, see the **Configure deployment share rules** section in the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#configure-deployment-share-rules) article.\n\n### Update deployment share\n\nTo update the deployment share, right-click the deployment share in the Deployment Workbench and click **Update Deployment Share**, then proceed through the Update Deployment Share Wizard. See the **Update and import updated MDT boot media** section of the [Deploy Windows 10 to Surface devices with MDT](deploy-windows-10-to-surface-devices-with-mdt.md#update-and-import-updated-mdt-boot-media) article for detailed steps.\n\n### Run the upgrade deployment\n\nUnlike a traditional deployment, the upgrade task sequence must be launched from within the Windows environment that will be upgraded. This requires that a user on the device to be upgraded navigate to the deployment share over the network and launch a script, LiteTouch.vbs. This script is the same script that displays the Windows Deployment Wizard in Windows PE in a traditional deployment. In this scenario, Litetouch.vbs will run within Windows. To perform the upgrade task sequence and deploy the upgrade to Windows 10 follow these steps:\n\n1. Browse to the network location of your deployment share in File Explorer.\n2. Navigate to the **Scripts** folder, locate **LiteTouch.vbs**, and then double-click **LiteTouch.vbs** to start the Windows Deployment Wizard.\n3. Enter your credentials when prompted.\n4. The upgrade task sequence for Surface Pro 3 devices will automatically start when the model of the device is detected and determined to match the deployment share rules.\n5. The upgrade process will occur automatically and without user interaction.\n\nThe task sequence will automatically install the drivers for Surface Pro 3 and the Surface app, and will perform any outstanding Windows Updates. When it completes, it will log out and be ready for the user to log on with the credentials they have always used for this device.\n"}