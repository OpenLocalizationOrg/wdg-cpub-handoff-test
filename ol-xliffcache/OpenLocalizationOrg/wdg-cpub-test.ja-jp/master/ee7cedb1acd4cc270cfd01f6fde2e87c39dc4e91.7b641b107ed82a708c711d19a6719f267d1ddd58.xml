{"nodes":[{"content":"Get file properties","pos":[2,21]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[23,61]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[62,157],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Important APIs","pos":[163,177]},{"content":"StorageFile.GetBasicPropertiesAsync","pos":[189,224]},{"content":"StorageFile.Properties","pos":[293,315]},{"content":"StorageItemContentProperties.RetrievePropertiesAsync","pos":[384,436]},{"pos":[499,656],"content":"Get properties—top-level, basic, and extended—for a file represented by a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> object.","source":"Get properties—top-level, basic, and extended—for a file represented by a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object."},{"pos":[658,751],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Also see the <bpt id=\"p2\">[</bpt>File access sample<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?linkid=619995)</ept>.","source":"**Note**  Also see the [File access sample](http://go.microsoft.com/fwlink/p/?linkid=619995)."},{"content":"Prerequisites","pos":[760,773]},{"content":"Understand async programming for Universal Windows Platform (UWP) apps","pos":[781,851]},{"content":"You can learn how to write asynchronous apps in C\\# or Visual Basic, see <bpt id=\"p1\">[</bpt>Call asynchronous APIs in C\\# or Visual Basic<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt187337)</ept>.","pos":[859,1038],"source":"You can learn how to write asynchronous apps in C\\# or Visual Basic, see [Call asynchronous APIs in C\\# or Visual Basic](https://msdn.microsoft.com/library/windows/apps/mt187337)."},{"content":"To learn how to write asynchronous apps in C++, see <bpt id=\"p1\">[</bpt>Asynchronous programming in C++<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt187334)</ept>.","pos":[1039,1183],"source":" To learn how to write asynchronous apps in C++, see [Asynchronous programming in C++](https://msdn.microsoft.com/library/windows/apps/mt187334)."},{"content":"Access permissions to the location","pos":[1191,1225]},{"content":"For example, the code in these examples require the <bpt id=\"p1\">**</bpt>picturesLibrary<ept id=\"p1\">**</ept> capability, but your location may require a different capability or no capability at all.","pos":[1233,1394],"source":"For example, the code in these examples require the **picturesLibrary** capability, but your location may require a different capability or no capability at all."},{"content":"To learn more, see <bpt id=\"p1\">[</bpt>File access permissions<ept id=\"p1\">](file-access-permissions.md)</ept>.","pos":[1395,1468],"source":" To learn more, see [File access permissions](file-access-permissions.md)."},{"content":"Getting a file's top-level properties","pos":[1473,1510]},{"content":"Many top-level file properties are accessible as members of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> class.","pos":[1512,1658],"source":"Many top-level file properties are accessible as members of the [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) class."},{"content":"These properties include the files attributes, content type, creation date, display name, file type, and so on.","pos":[1659,1770]},{"pos":[1772,1837],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Remember to declare the <bpt id=\"p2\">**</bpt>picturesLibrary<ept id=\"p2\">**</ept> capability.","source":"**Note**  Remember to declare the **picturesLibrary** capability."},{"content":"This example enumerates all of the files in the Pictures library, accessing a few of each file's top-level properties.","pos":[1842,1960]},{"content":"Getting a file's basic properties","pos":[2438,2471]},{"content":"Many basic file properties are obtained by first calling the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile.GetBasicPropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701737)</ept> method.","pos":[2473,2641],"source":"Many basic file properties are obtained by first calling the [**StorageFile.GetBasicPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh701737) method."},{"content":"This method returns a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BasicProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br212113)</ept> object, which defines properties for the size of the item (file or folder) as well as when the item was last modified.","pos":[2642,2862],"source":" This method returns a [**BasicProperties**](https://msdn.microsoft.com/library/windows/apps/br212113) object, which defines properties for the size of the item (file or folder) as well as when the item was last modified."},{"content":"This example enumerates all of the files in the Pictures library, accessing a few of each file's basic properties.","pos":[2864,2978]},{"content":"Getting a file's extended properties","pos":[3670,3706]},{"content":"Aside from the top-level and basic file properties, there are many properties associated with the file's contents.","pos":[3708,3822]},{"content":"These extended properties are accessed by calling the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BasicProperties.RetrievePropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br212124)</ept> method.","pos":[3823,3988],"source":" These extended properties are accessed by calling the [**BasicProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br212124) method."},{"content":"(A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BasicProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br212113)</ept> object is obtained by calling the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageFile.Properties<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br227225)</ept> property.) While top-level and basic file properties are accessible as properties of a class—<bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>StorageFile<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> and <bpt id=\"p7\">**</bpt>BasicProperties<ept id=\"p7\">**</ept>, respectively—extended properties are obtained by passing an <bpt id=\"p8\">[</bpt>IEnumerable<ept id=\"p8\">](http://go.microsoft.com/fwlink/p/?LinkID=313091)</ept> collection of <bpt id=\"p9\">[</bpt>String<ept id=\"p9\">](http://go.microsoft.com/fwlink/p/?LinkID=325032)</ept> objects representing the names of the properties that are to be retrieved to the <bpt id=\"p10\">**</bpt>BasicProperties.RetrievePropertiesAsync<ept id=\"p10\">**</ept> method.","pos":[3989,4714],"source":" (A [**BasicProperties**](https://msdn.microsoft.com/library/windows/apps/br212113) object is obtained by calling the [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225) property.) While top-level and basic file properties are accessible as properties of a class—[**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) and **BasicProperties**, respectively—extended properties are obtained by passing an [IEnumerable](http://go.microsoft.com/fwlink/p/?LinkID=313091) collection of [String](http://go.microsoft.com/fwlink/p/?LinkID=325032) objects representing the names of the properties that are to be retrieved to the **BasicProperties.RetrievePropertiesAsync** method."},{"content":"This method then returns an <bpt id=\"p1\">[</bpt>IDictionary<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=325238)</ept> collection.","pos":[4715,4817],"source":" This method then returns an [IDictionary](http://go.microsoft.com/fwlink/p/?LinkId=325238) collection."},{"content":"Each extended property is then retrieved from the collection by name or by index.","pos":[4818,4899]},{"pos":[4901,5459],"content":"This example enumerates all of the files in the Pictures library, specifies the names of desired properties (<bpt id=\"p1\">**</bpt>DataAccessed<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>FileOwner<ept id=\"p2\">**</ept>) in a <bpt id=\"p3\">[</bpt>List<ept id=\"p3\">](http://go.microsoft.com/fwlink/p/?LinkID=325246)</ept> object, passes that <bpt id=\"p4\">[</bpt>List<ept id=\"p4\">](http://go.microsoft.com/fwlink/p/?LinkID=325246)</ept> object to <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>BasicProperties.RetrievePropertiesAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br212124)</ept> to retrieve those properties, and then retrieves those properties by name from the returned <bpt id=\"p7\">[</bpt>IDictionary<ept id=\"p7\">](http://go.microsoft.com/fwlink/p/?LinkId=325238)</ept> object.","source":"This example enumerates all of the files in the Pictures library, specifies the names of desired properties (**DataAccessed** and **FileOwner**) in a [List](http://go.microsoft.com/fwlink/p/?LinkID=325246) object, passes that [List](http://go.microsoft.com/fwlink/p/?LinkID=325246) object to [**BasicProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br212124) to retrieve those properties, and then retrieves those properties by name from the returned [IDictionary](http://go.microsoft.com/fwlink/p/?LinkId=325238) object."}],"content":"# Get file properties\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n** Important APIs **\n\n-   [**StorageFile.GetBasicPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh701737)\n-   [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225)\n-   [**StorageItemContentProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh770652)\n\nGet properties—top-level, basic, and extended—for a file represented by a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object.\n\n**Note**  Also see the [File access sample](http://go.microsoft.com/fwlink/p/?linkid=619995).\n\n \n\n\n## Prerequisites\n\n-   **Understand async programming for Universal Windows Platform (UWP) apps**\n\n    You can learn how to write asynchronous apps in C\\# or Visual Basic, see [Call asynchronous APIs in C\\# or Visual Basic](https://msdn.microsoft.com/library/windows/apps/mt187337). To learn how to write asynchronous apps in C++, see [Asynchronous programming in C++](https://msdn.microsoft.com/library/windows/apps/mt187334).\n\n-   **Access permissions to the location**\n\n    For example, the code in these examples require the **picturesLibrary** capability, but your location may require a different capability or no capability at all. To learn more, see [File access permissions](file-access-permissions.md).\n\n## Getting a file's top-level properties\n\nMany top-level file properties are accessible as members of the [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) class. These properties include the files attributes, content type, creation date, display name, file type, and so on.\n\n**Note**  Remember to declare the **picturesLibrary** capability.\n\n \n\nThis example enumerates all of the files in the Pictures library, accessing a few of each file's top-level properties.\n\n```csharp\n// Enumerate all files in the Pictures library.\nvar folder = Windows.Storage.KnownFolders.PicturesLibrary;\nvar query = folder.CreateFileQuery();\nvar files = await query.GetFilesAsync();\n\nforeach (Windows.Storage.StorageFile file in files)\n{\n    StringBuilder fileProperties = new StringBuilder();\n\n    // Get top-level file properties.\n    fileProperties.AppendLine(\"File name: \" + file.Name);\n    fileProperties.AppendLine(\"File type: \" + file.FileType);\n}\n```\n\n## Getting a file's basic properties\n\nMany basic file properties are obtained by first calling the [**StorageFile.GetBasicPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh701737) method. This method returns a [**BasicProperties**](https://msdn.microsoft.com/library/windows/apps/br212113) object, which defines properties for the size of the item (file or folder) as well as when the item was last modified.\n\nThis example enumerates all of the files in the Pictures library, accessing a few of each file's basic properties.\n\n```csharp\n// Enumerate all files in the Pictures library.\nvar folder = Windows.Storage.KnownFolders.PicturesLibrary;\nvar query = folder.CreateFileQuery();\nvar files = await query.GetFilesAsync();\n\nforeach (Windows.Storage.StorageFile file in files)\n{\n    StringBuilder fileProperties = new StringBuilder();\n\n    // Get file's basic properties.\n    Windows.Storage.FileProperties.BasicProperties basicProperties = \n        await file.GetBasicPropertiesAsync();\n    string fileSize = string.Format(\"{0:n0}\", basicProperties.Size);\n    fileProperties.AppendLine(\"File size: \" + fileSize + \" bytes\");\n    fileProperties.AppendLine(\"Date modified: \" + basicProperties.DateModified);\n}\n ```\n \n## Getting a file's extended properties\n\nAside from the top-level and basic file properties, there are many properties associated with the file's contents. These extended properties are accessed by calling the [**BasicProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br212124) method. (A [**BasicProperties**](https://msdn.microsoft.com/library/windows/apps/br212113) object is obtained by calling the [**StorageFile.Properties**](https://msdn.microsoft.com/library/windows/apps/br227225) property.) While top-level and basic file properties are accessible as properties of a class—[**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) and **BasicProperties**, respectively—extended properties are obtained by passing an [IEnumerable](http://go.microsoft.com/fwlink/p/?LinkID=313091) collection of [String](http://go.microsoft.com/fwlink/p/?LinkID=325032) objects representing the names of the properties that are to be retrieved to the **BasicProperties.RetrievePropertiesAsync** method. This method then returns an [IDictionary](http://go.microsoft.com/fwlink/p/?LinkId=325238) collection. Each extended property is then retrieved from the collection by name or by index.\n\nThis example enumerates all of the files in the Pictures library, specifies the names of desired properties (**DataAccessed** and **FileOwner**) in a [List](http://go.microsoft.com/fwlink/p/?LinkID=325246) object, passes that [List](http://go.microsoft.com/fwlink/p/?LinkID=325246) object to [**BasicProperties.RetrievePropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/br212124) to retrieve those properties, and then retrieves those properties by name from the returned [IDictionary](http://go.microsoft.com/fwlink/p/?LinkId=325238) object.\n\n```csharp\nconst string dateAccessedProperty = \"System.DateAccessed\";\nconst string fileOwnerProperty = \"System.FileOwner\";\n\n// Enumerate all files in the Pictures library.\nvar folder = KnownFolders.PicturesLibrary;\nvar query = folder.CreateFileQuery();\nvar files = await query.GetFilesAsync();\n\nforeach (Windows.Storage.StorageFile file in files)\n{\n    StringBuilder fileProperties = new StringBuilder();\n\n    // Define property names to be retrieved.\n    var propertyNames = new List<string>();\n    propertyNames.Add(dateAccessedProperty);\n    propertyNames.Add(fileOwnerProperty);\n\n    // Get extended properties.\n    IDictionary<string, object> extraProperties = \n        await file.Properties.RetrievePropertiesAsync(propertyNames);\n\n    // Get date-accessed property.\n    var propValue = extraProperties[dateAccessedProperty];\n    if (propValue != null)\n    {\n        fileProperties.AppendLine(\"Date accessed: \" + propValue);\n    }\n\n    // Get file-owner property.\n    propValue = extraProperties[fileOwnerProperty];\n    if (propValue != null)\n    {\n        fileProperties.AppendLine(\"File owner: \" + propValue);\n    }\n}\n```\n\n \n\n \n\n\n\n"}