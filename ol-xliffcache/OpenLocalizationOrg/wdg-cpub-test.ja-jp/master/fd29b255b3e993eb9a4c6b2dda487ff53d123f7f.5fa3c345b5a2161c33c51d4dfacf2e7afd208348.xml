{"nodes":[{"content":"Creating a New Filter Driver","pos":[0,28]},{"content":"In this topic we explain how to use Visual Studio to start writing a new filter driver.","pos":[115,202]},{"content":"Filter drivers are different from device function drivers, software drivers, and file system drivers, which we cover in other topics.","pos":[203,336]},{"content":"To learn about filter drivers and how they differ from other types of drivers, see the following topics.","pos":[337,441]},{"content":"What is a Driver?","pos":[448,465]},{"content":"Choosing a Driver Model","pos":[540,563]},{"content":"Device Nodes and Device Stacks","pos":[638,668]},{"content":"Filter Drivers","pos":[743,757]},{"content":"Types of WDM Drivers","pos":[832,852]},{"content":"To begin, first determine which driver model is appropriate for your filter driver.","pos":[923,1006]},{"content":"For help determining which model is best for you, see <bpt id=\"p1\">[</bpt>Choosing a Driver Model<ept id=\"p1\">](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652)</ept>.","pos":[1007,1155],"source":" For help determining which model is best for you, see [Choosing a Driver Model](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652)."},{"content":"If you are writing a filter driver for a hardware device, determine where your device fits in the list of technologies described in <bpt id=\"p1\">[</bpt>Device and Driver Technologies<ept id=\"p1\">](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff557557)</ept>.","pos":[1156,1389],"source":" If you are writing a filter driver for a hardware device, determine where your device fits in the list of technologies described in [Device and Driver Technologies](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff557557)."},{"content":"See the documentation for that particular technology to see whether there is any guidance for choosing a filter driver model.","pos":[1390,1515]},{"content":"The recommended filter driver model varies from one technology to the next.","pos":[1516,1591]},{"content":"For some technologies, the documentation recommends using the User Mode Driver Framework (UMDF), the Kernel Mode Driver Framework (KMDF), or the Windows Driver Model (WDM).","pos":[1592,1764]},{"content":"For other technologies, the documentation gives explicit details on how to write a filter driver.","pos":[1765,1862]},{"content":"Some technologies have mini filter models.","pos":[1863,1905]},{"content":"For some technologies, there might not be any recommendation for a filter driver model.","pos":[1906,1993]},{"content":"Next, determine which of the following cases describes your driver model recommendation and follow the steps:","pos":[1995,2104]},{"pos":[2349,2411],"content":"Case 1: The documentation for your technology recommends UMDF."},{"pos":[2723,2788],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>New | Project<ept id=\"p2\">**</ept>.","source":"In Visual Studio, on the **File** menu, choose **New | Project**."},{"pos":[2793,2898],"content":"In the New Project dialog box, in the left pane, locate and select <bpt id=\"p1\">**</bpt>Visual C++ | Windows Driver | WDF<ept id=\"p1\">**</ept>.","source":"In the New Project dialog box, in the left pane, locate and select **Visual C++ | Windows Driver | WDF**."},{"pos":[2903,2958],"content":"In the middle pane, select <bpt id=\"p1\">**</bpt>User Mode Driver (UMDF)<ept id=\"p1\">**</ept>.","source":"In the middle pane, select **User Mode Driver (UMDF)**."},{"pos":[2963,3321],"content":"Fill in the **Name** and **Location** boxes, and click **OK**. For more information, see [Writing a UMDF Driver Based on a Template](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439659).\n**Note**  When you create a new UMDF driver, you must select a driver name that has 32 characters or less. This length limit is defined in wdfglobals.h.","leadings":["","    "],"nodes":[{"content":"Fill in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Location<ept id=\"p2\">**</ept> boxes, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[0,62],"source":"Fill in the **Name** and **Location** boxes, and click **OK**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Writing a UMDF Driver Based on a Template<ept id=\"p1\">](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439659)</ept>.","pos":[63,201],"source":" For more information, see [Writing a UMDF Driver Based on a Template](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439659)."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  When you create a new UMDF driver, you must select a driver name that has 32 characters or less.","pos":[202,308],"source":"**Note**  When you create a new UMDF driver, you must select a driver name that has 32 characters or less."},{"content":"This length limit is defined in wdfglobals.h.","pos":[309,354]}]},{"content":"At this point, you have a driver project that implements the general code required by most UMDF drivers.","pos":[3326,3430]},{"content":"Now you can supply the code that is specific to your filter.","pos":[3431,3491]},{"pos":[3736,3798],"content":"Case 2: The documentation for your technology recommends KMDF."},{"pos":[4110,4175],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>New | Project<ept id=\"p2\">**</ept>.","source":"In Visual Studio, on the **File** menu, choose **New | Project**."},{"pos":[4180,4255],"content":"In the New Project dialog box, in the left pane, locate and select <bpt id=\"p1\">**</bpt>WDF<ept id=\"p1\">**</ept>.","source":"In the New Project dialog box, in the left pane, locate and select **WDF**."},{"pos":[4260,4317],"content":"In the middle pane, select <bpt id=\"p1\">**</bpt>Kernel Mode Driver (KMDF)<ept id=\"p1\">**</ept>.","source":"In the middle pane, select **Kernel Mode Driver (KMDF)**."},{"pos":[4322,4680],"content":"Fill in the **Name** and **Location** boxes, and click **OK**. For more information, see [Writing a KMDF Driver Based on a Template](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439654).\n**Note**  When you create a new KMDF driver, you must select a driver name that has 32 characters or less. This length limit is defined in wdfglobals.h.","leadings":["","    "],"nodes":[{"content":"Fill in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Location<ept id=\"p2\">**</ept> boxes, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[0,62],"source":"Fill in the **Name** and **Location** boxes, and click **OK**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Writing a KMDF Driver Based on a Template<ept id=\"p1\">](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439654)</ept>.","pos":[63,201],"source":" For more information, see [Writing a KMDF Driver Based on a Template](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439654)."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  When you create a new KMDF driver, you must select a driver name that has 32 characters or less.","pos":[202,308],"source":"**Note**  When you create a new KMDF driver, you must select a driver name that has 32 characters or less."},{"content":"This length limit is defined in wdfglobals.h.","pos":[309,354]}]},{"content":"At this point, you have a driver project that implements the general code required by most KMDF drivers.","pos":[4685,4789]},{"content":"Now you can supply the code that is specific to your filter.","pos":[4790,4850]},{"pos":[5194,5289],"content":"Case 3: The documentation for your technology describes a specific filter or mini filter model."},{"content":"If your device technology has a specific filter or minifilter model, check to see if Visual Studio has a template for the model.","pos":[5729,5857]},{"pos":[5863,5928],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>New | Project<ept id=\"p2\">**</ept>.","source":"In Visual Studio, on the **File** menu, choose **New | Project**."},{"pos":[5933,6044],"content":"In the New Project dialog box, in the left pane, locate and select <bpt id=\"p1\">**</bpt>Templates | Visual C++ | Windows Driver<ept id=\"p1\">**</ept>.","source":"In the New Project dialog box, in the left pane, locate and select **Templates | Visual C++ | Windows Driver**."},{"content":"Browse the list of installed templates to see whether there is a template for the type of filter you need to write.","pos":[6049,6164]},{"content":"For example, you might choose the <bpt id=\"p1\">**</bpt>Filter Driver: NDIS<ept id=\"p1\">**</ept> template under <bpt id=\"p2\">**</bpt>Networking<ept id=\"p2\">**</ept>.","pos":[6165,6253],"source":" For example, you might choose the **Filter Driver: NDIS** template under **Networking**."},{"pos":[6258,6407],"content":"If there is no template for your type of filter driver under <bpt id=\"p1\">**</bpt>Windows Driver<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Online<ept id=\"p2\">**</ept> and browse the templates that are available online.","source":"If there is no template for your type of filter driver under **Windows Driver**, click **Online** and browse the templates that are available online."},{"pos":[6412,6550],"content":"If you find a template for your type of filter driver, select the template, fill in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Location<ept id=\"p2\">**</ept> boxes, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"If you find a template for your type of filter driver, select the template, fill in the **Name** and **Location** boxes, and click **OK**."},{"content":"At this point, you have a driver project that implements the general code required by your filter driver.","pos":[6555,6660]},{"content":"Now you can supply the code that is specific to your filter.","pos":[6661,6721]},{"content":"Refer to the documentation for your technology to learn about the functions that you need to implement.","pos":[6722,6825]},{"content":"If your device technology has a specific filter model or a minifilter model, and you can't find a template for your type of filter driver, refer to your technology-specific documentation for guidance to determine whether to use UMDF, KMDF, or WDM.","pos":[6827,7074]},{"pos":[7316,7377],"content":"Case 4: The documentation for your technology recommends WDM."},{"pos":[7685,7750],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>New | Project<ept id=\"p2\">**</ept>.","source":"In Visual Studio, on the **File** menu, choose **New | Project**."},{"pos":[7755,7845],"content":"In Visual Studio, in the New Project dialog box, under <bpt id=\"p1\">**</bpt>Windows Driver<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>WDM.<ept id=\"p2\">**</ept>","source":"In Visual Studio, in the New Project dialog box, under **Windows Driver**, select **WDM.**"},{"pos":[7850,7912],"content":"Fill in the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Location<ept id=\"p2\">**</ept> boxes, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"Fill in the **Name** and **Location** boxes, and click **OK**."},{"content":"At this point, you have an empty WDM driver project.","pos":[7917,7969]},{"content":"In the Solution Explorer window, right-click your driver project, and choose <bpt id=\"p1\">**</bpt>Add | New Item<ept id=\"p1\">**</ept>.","pos":[7970,8066],"source":" In the Solution Explorer window, right-click your driver project, and choose **Add | New Item**."},{"pos":[8071,8176],"content":"In the Add New Item dialog box, select <bpt id=\"p1\">**</bpt>C++ File (.cpp)<ept id=\"p1\">**</ept>, enter a name for your file, and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"In the Add New Item dialog box, select **C++ File (.cpp)**, enter a name for your file, and click **OK**."},{"pos":[8182,8291],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If you want to create a .c file instead of a .cpp file, enter a name that has the <bpt id=\"p2\">**</bpt>.c<ept id=\"p2\">**</ept> extension.","source":"**Note**  If you want to create a .c file instead of a .cpp file, enter a name that has the **.c** extension."},{"content":"Implement the functions required by your filter.","pos":[8296,8344]},{"content":"As you implement and organize your functions, you might decide to add additional .cpp or .c files.","pos":[8345,8443]},{"pos":[8811,8914],"content":"Case 5: The documentation for your technology does not have a recommendation for a filter driver model."},{"content":"Determine whether UMDF, KMDF, or WDM is the best model for your filter driver.","pos":[9390,9468]},{"content":"For help, see <bpt id=\"p1\">[</bpt>Choosing a Driver Model<ept id=\"p1\">](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652)</ept>.","pos":[9469,9577],"source":" For help, see [Choosing a Driver Model](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652)."},{"pos":[9582,9647],"content":"In Visual Studio, on the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, choose <bpt id=\"p2\">**</bpt>New | Project<ept id=\"p2\">**</ept>.","source":"In Visual Studio, on the **File** menu, choose **New | Project**."},{"pos":[9652,9765],"content":"In Visual Studio, in the New Project dialog box, under <bpt id=\"p1\">**</bpt>Windows Driver<ept id=\"p1\">**</ept>, select one of the following templates:","source":"In Visual Studio, in the New Project dialog box, under **Windows Driver**, select one of the following templates:"},{"content":"WDF | User Mode Driver (UMDF)","pos":[9777,9806]},{"content":"WDF | Kernel Mode Driver (KMDF)","pos":[9819,9850]},{"content":"WDM | Empty Kernel Driver","pos":[9863,9888]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  When you create a new KMDF or UMDF driver, you must select a driver name that has 32 characters or less.","pos":[9896,10010],"source":"**Note**  When you create a new KMDF or UMDF driver, you must select a driver name that has 32 characters or less."},{"content":"This length limit is defined in wdfglobals.h.","pos":[10011,10056]},{"content":"Implement the functions required by your filter.","pos":[10061,10109]},{"content":"Create new .c or .cpp files as needed.","pos":[10110,10148]},{"pos":[10150,10328],"content":"If you are not sure which template to use, consider reading or posting to the <bpt id=\"p1\">[</bpt>Windows Hardware WDK and Driver Development<ept id=\"p1\">](http://go.microsoft.com/fwlink/p?LinkID=252169)</ept> forum.","source":"If you are not sure which template to use, consider reading or posting to the [Windows Hardware WDK and Driver Development](http://go.microsoft.com/fwlink/p?LinkID=252169) forum."},{"pos":[10336,11286],"content":"<bpt id=\"p1\">[</bpt>Send comments about this topic to Microsoft<ept id=\"p1\">]</ept><bpt id=\"p2\">(mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[VsDriver\\vsdriver]:%20Creating%20a%20New%20Filter%20Driver%20%20RELEASE:%20%289/30/2015%29&amp;body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default.aspx. \"</bpt>Send comments about this topic to Microsoft<ept id=\"p2\">\")</ept>","source":"[Send comments about this topic to Microsoft](mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[VsDriver\\vsdriver]:%20Creating%20a%20New%20Filter%20Driver%20%20RELEASE:%20%289/30/2015%29&body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default.aspx. \"Send comments about this topic to Microsoft\")"}],"content":"Creating a New Filter Driver\n====================================================================================\n\nIn this topic we explain how to use Visual Studio to start writing a new filter driver. Filter drivers are different from device function drivers, software drivers, and file system drivers, which we cover in other topics. To learn about filter drivers and how they differ from other types of drivers, see the following topics.\n\n-   [What is a Driver?](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554678)\n-   [Choosing a Driver Model](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652)\n-   [Device Nodes and Device Stacks](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554721)\n-   [Filter Drivers](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff545890)\n-   [Types of WDM Drivers](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff564862)\n\nTo begin, first determine which driver model is appropriate for your filter driver. For help determining which model is best for you, see [Choosing a Driver Model](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652). If you are writing a filter driver for a hardware device, determine where your device fits in the list of technologies described in [Device and Driver Technologies](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff557557). See the documentation for that particular technology to see whether there is any guidance for choosing a filter driver model. The recommended filter driver model varies from one technology to the next. For some technologies, the documentation recommends using the User Mode Driver Framework (UMDF), the Kernel Mode Driver Framework (KMDF), or the Windows Driver Model (WDM). For other technologies, the documentation gives explicit details on how to write a filter driver. Some technologies have mini filter models. For some technologies, there might not be any recommendation for a filter driver model.\n\nNext, determine which of the following cases describes your driver model recommendation and follow the steps:\n\n<span id=\"Case_1__The_documentation_for_your_technology_recommends_UMDF.\"></span><span id=\"case_1__the_documentation_for_your_technology_recommends_umdf.\"></span><span id=\"CASE_1__THE_DOCUMENTATION_FOR_YOUR_TECHNOLOGY_RECOMMENDS_UMDF.\"></span>Case 1: The documentation for your technology recommends UMDF.\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n1.  In Visual Studio, on the **File** menu, choose **New | Project**.\n2.  In the New Project dialog box, in the left pane, locate and select **Visual C++ | Windows Driver | WDF**.\n3.  In the middle pane, select **User Mode Driver (UMDF)**.\n4.  Fill in the **Name** and **Location** boxes, and click **OK**. For more information, see [Writing a UMDF Driver Based on a Template](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439659).\n    **Note**  When you create a new UMDF driver, you must select a driver name that has 32 characters or less. This length limit is defined in wdfglobals.h.\n5.  At this point, you have a driver project that implements the general code required by most UMDF drivers. Now you can supply the code that is specific to your filter.\n\n<span id=\"Case_2__The_documentation_for_your_technology_recommends_KMDF.\"></span><span id=\"case_2__the_documentation_for_your_technology_recommends_kmdf.\"></span><span id=\"CASE_2__THE_DOCUMENTATION_FOR_YOUR_TECHNOLOGY_RECOMMENDS_KMDF.\"></span>Case 2: The documentation for your technology recommends KMDF.\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n1.  In Visual Studio, on the **File** menu, choose **New | Project**.\n2.  In the New Project dialog box, in the left pane, locate and select **WDF**.\n3.  In the middle pane, select **Kernel Mode Driver (KMDF)**.\n4.  Fill in the **Name** and **Location** boxes, and click **OK**. For more information, see [Writing a KMDF Driver Based on a Template](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Hh439654).\n    **Note**  When you create a new KMDF driver, you must select a driver name that has 32 characters or less. This length limit is defined in wdfglobals.h.\n5.  At this point, you have a driver project that implements the general code required by most KMDF drivers. Now you can supply the code that is specific to your filter.\n\n<span id=\"Case_3__The_documentation_for_your_technology_describes_a_specific_filter_or_mini_filter_model.\"></span><span id=\"case_3__the_documentation_for_your_technology_describes_a_specific_filter_or_mini_filter_model.\"></span><span id=\"CASE_3__THE_DOCUMENTATION_FOR_YOUR_TECHNOLOGY_DESCRIBES_A_SPECIFIC_FILTER_OR_MINI_FILTER_MODEL.\"></span>Case 3: The documentation for your technology describes a specific filter or mini filter model.\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nIf your device technology has a specific filter or minifilter model, check to see if Visual Studio has a template for the model.\n\n1.  In Visual Studio, on the **File** menu, choose **New | Project**.\n2.  In the New Project dialog box, in the left pane, locate and select **Templates | Visual C++ | Windows Driver**.\n3.  Browse the list of installed templates to see whether there is a template for the type of filter you need to write. For example, you might choose the **Filter Driver: NDIS** template under **Networking**.\n4.  If there is no template for your type of filter driver under **Windows Driver**, click **Online** and browse the templates that are available online.\n5.  If you find a template for your type of filter driver, select the template, fill in the **Name** and **Location** boxes, and click **OK**.\n6.  At this point, you have a driver project that implements the general code required by your filter driver. Now you can supply the code that is specific to your filter. Refer to the documentation for your technology to learn about the functions that you need to implement.\n\nIf your device technology has a specific filter model or a minifilter model, and you can't find a template for your type of filter driver, refer to your technology-specific documentation for guidance to determine whether to use UMDF, KMDF, or WDM.\n\n<span id=\"Case_4__The_documentation_for_your_technology_recommends_WDM.\"></span><span id=\"case_4__the_documentation_for_your_technology_recommends_wdm.\"></span><span id=\"CASE_4__THE_DOCUMENTATION_FOR_YOUR_TECHNOLOGY_RECOMMENDS_WDM.\"></span>Case 4: The documentation for your technology recommends WDM.\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n1.  In Visual Studio, on the **File** menu, choose **New | Project**.\n2.  In Visual Studio, in the New Project dialog box, under **Windows Driver**, select **WDM.**\n3.  Fill in the **Name** and **Location** boxes, and click **OK**.\n4.  At this point, you have an empty WDM driver project. In the Solution Explorer window, right-click your driver project, and choose **Add | New Item**.\n5.  In the Add New Item dialog box, select **C++ File (.cpp)**, enter a name for your file, and click **OK**.\n\n    **Note**  If you want to create a .c file instead of a .cpp file, enter a name that has the **.c** extension.\n6.  Implement the functions required by your filter. As you implement and organize your functions, you might decide to add additional .cpp or .c files.\n\n<span id=\"Case_5__The_documentation_for_your_technology_does_not_have_a_recommendation_for_a_filter_driver_model.\"></span><span id=\"case_5__the_documentation_for_your_technology_does_not_have_a_recommendation_for_a_filter_driver_model.\"></span><span id=\"CASE_5__THE_DOCUMENTATION_FOR_YOUR_TECHNOLOGY_DOES_NOT_HAVE_A_RECOMMENDATION_FOR_A_FILTER_DRIVER_MODEL.\"></span>Case 5: The documentation for your technology does not have a recommendation for a filter driver model.\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n1.  Determine whether UMDF, KMDF, or WDM is the best model for your filter driver. For help, see [Choosing a Driver Model](https://msdn.microsoft.com/en-us/Library/Windows/Hardware/Ff554652).\n2.  In Visual Studio, on the **File** menu, choose **New | Project**.\n3.  In Visual Studio, in the New Project dialog box, under **Windows Driver**, select one of the following templates:\n\n    -   **WDF | User Mode Driver (UMDF)**\n    -   **WDF | Kernel Mode Driver (KMDF)**\n    -   **WDM | Empty Kernel Driver**\n\n    **Note**  When you create a new KMDF or UMDF driver, you must select a driver name that has 32 characters or less. This length limit is defined in wdfglobals.h.\n4.  Implement the functions required by your filter. Create new .c or .cpp files as needed.\n\nIf you are not sure which template to use, consider reading or posting to the [Windows Hardware WDK and Driver Development](http://go.microsoft.com/fwlink/p?LinkID=252169) forum.\n\n \n\n \n\n[Send comments about this topic to Microsoft](mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20[VsDriver\\vsdriver]:%20Creating%20a%20New%20Filter%20Driver%20%20RELEASE:%20%289/30/2015%29&body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default.aspx. \"Send comments about this topic to Microsoft\")\n"}