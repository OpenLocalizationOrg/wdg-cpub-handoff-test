{"nodes":[{"pos":[11,49],"content":"Support your app with background tasks","needQuote":true,"needEscape":true,"nodes":[{"content":"Support your app with background tasks","pos":[0,38]}]},{"pos":[63,198],"content":"The topics in this section show how to run your own lightweight code in the background by responding to triggers with background tasks.","needQuote":true,"needEscape":true,"nodes":[{"content":"The topics in this section show how to run your own lightweight code in the background by responding to triggers with background tasks.","pos":[0,135]}]},{"content":"Support your app with background tasks","pos":[255,293]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[296,334]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[335,430],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"The topics in this section show how to run your own lightweight code in the background by responding to triggers with background tasks.","pos":[433,568]},{"content":"Background tasks are lightweight classes that the OS runs in the background.","pos":[569,645]},{"content":"You can use background tasks to provide functionality when your app is suspended or not running.","pos":[646,742]},{"content":"You can also use background tasks for real-time communication apps like VOIP, mail, and IM.","pos":[743,834]},{"content":"Background tasks are separate classes that implement the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IBackgroundTask<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224794)</ept> interface.","pos":[836,983],"source":"Background tasks are separate classes that implement the [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794) interface."},{"content":"You register a background task by using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BackgroundTaskBuilder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224768)</ept> class.","pos":[984,1120],"source":" You register a background task by using the [**BackgroundTaskBuilder**](https://msdn.microsoft.com/library/windows/apps/br224768) class."},{"content":"The class name is used to specify the entry point when you registering the background task.","pos":[1121,1212]},{"pos":[1214,1347],"content":"To get started quickly with a background task, see <bpt id=\"p1\">[</bpt>Create and register a background task<ept id=\"p1\">](create-and-register-a-background-task.md)</ept>.","source":"To get started quickly with a background task, see [Create and register a background task](create-and-register-a-background-task.md)."},{"pos":[1349,1476],"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept>  Starting with Windows 10, you no longer need to place an app on the lock screen in order to register background tasks.","source":"**Tip**  Starting with Windows 10, you no longer need to place an app on the lock screen in order to register background tasks."},{"content":"Background tasks for system events","pos":[1484,1518]},{"content":"Your app can respond to system-generated events by registering a background task with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224838)</ept> class.","pos":[1521,1695],"source":"Your app can respond to system-generated events by registering a background task with the [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224838) class."},{"content":"An app can use any of the following system event triggers (defined in <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTriggerType<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224839)</ept>)","pos":[1696,1848],"source":" An app can use any of the following system event triggers (defined in [**SystemTriggerType**](https://msdn.microsoft.com/library/windows/apps/br224839))"},{"content":"Trigger name","pos":[1852,1864]},{"content":"Description","pos":[1887,1898]},{"content":"InternetAvailable","pos":[2154,2171]},{"content":"The Internet becomes available.","pos":[2187,2218]},{"content":"NetworkStateChange","pos":[2304,2322]},{"content":"A network change such as a change in cost or connectivity occurs.","pos":[2337,2402]},{"content":"OnlineIdConnectedStateChange","pos":[2454,2482]},{"content":"Online ID associated with the account changes.","pos":[2487,2533]},{"content":"SmsReceived","pos":[2604,2615]},{"content":"A new SMS message is received by an installed mobile broadband device.","pos":[2637,2707]},{"content":"TimeZoneChange","pos":[2754,2768]},{"content":"The time zone changes on the device (for example, when the system adjusts the clock for daylight saving time).","pos":[2787,2897]},{"pos":[2904,3022],"content":"For more info see <bpt id=\"p1\">[</bpt>Respond to system events with background tasks<ept id=\"p1\">](respond-to-system-events-with-background-tasks.md)</ept>.","source":"For more info see [Respond to system events with background tasks](respond-to-system-events-with-background-tasks.md)."},{"content":"Conditions for background tasks","pos":[3027,3058]},{"content":"You can control when the background task runs, even after it is triggered, by adding a condition.","pos":[3061,3158]},{"content":"Once triggered, a background task will not run until all of its conditions are met.","pos":[3159,3242]},{"content":"The following conditions (represented by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemConditionType<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224835)</ept> enumeration) can be used.","pos":[3243,3397],"source":" The following conditions (represented by the [**SystemConditionType**](https://msdn.microsoft.com/library/windows/apps/br224835) enumeration) can be used."},{"content":"Condition name","pos":[3401,3415]},{"content":"Description","pos":[3428,3439]},{"content":"InternetAvailable","pos":[3533,3550]},{"content":"The Internet must be available.","pos":[3558,3589]},{"content":"InternetNotAvailable","pos":[3598,3618]},{"content":"The Internet must be unavailable.","pos":[3623,3656]},{"content":"SessionConnected","pos":[3663,3679]},{"content":"The session must be connected.","pos":[3688,3718]},{"content":"SessionDisconnected","pos":[3728,3747]},{"content":"The session must be disconnected.","pos":[3753,3786]},{"content":"UserNotPresent","pos":[3793,3807]},{"content":"The user must be away.","pos":[3818,3840]},{"content":"UserPresent","pos":[3858,3869]},{"content":"The user must be present.","pos":[3883,3908]},{"pos":[3923,4037],"content":"For more info see <bpt id=\"p1\">[</bpt>Set conditions for running a background task<ept id=\"p1\">](set-conditions-for-running-a-background-task.md)</ept>.","source":"For more info see [Set conditions for running a background task](set-conditions-for-running-a-background-task.md)."},{"content":"Application manifest requirements","pos":[4042,4075]},{"content":"Before your app can successfully register a background task, it must be declared in the application manifest.","pos":[4078,4187]},{"content":"For more info see <bpt id=\"p1\">[</bpt>Declare background tasks in the application manifest<ept id=\"p1\">](declare-background-tasks-in-the-application-manifest.md)</ept>.","pos":[4188,4318],"source":" For more info see [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md)."},{"content":"Background tasks","pos":[4323,4339]},{"content":"The following real-time triggers can be used to run lightweight custom code in the background:","pos":[4342,4436]},{"content":"<bpt id=\"p1\">**</bpt>Control Channel:  <ept id=\"p1\">**</ept>Background tasks can keep a connection alive, and receive messages on the control channel, by using the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>ControlChannelTrigger<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh701032)</ept>.","pos":[4438,4650],"source":"**Control Channel:  **Background tasks can keep a connection alive, and receive messages on the control channel, by using the [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032)."},{"content":"If your app is listening to a socket, you can use the Socket Broker instead of the <bpt id=\"p1\">**</bpt>ControlChannelTrigger<ept id=\"p1\">**</ept>.","pos":[4651,4760],"source":" If your app is listening to a socket, you can use the Socket Broker instead of the **ControlChannelTrigger**."},{"content":"For more details on using the Socket Broker, see <bpt id=\"p1\">[</bpt>SocketActivityTrigger<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn806009)</ept>.","pos":[4761,4892],"source":" For more details on using the Socket Broker, see [SocketActivityTrigger](https://msdn.microsoft.com/library/windows/apps/dn806009)."},{"content":"The <bpt id=\"p1\">**</bpt>ControlChannelTrigger<ept id=\"p1\">**</ept> is not supported on Windows Phone.","pos":[4893,4957],"source":" The **ControlChannelTrigger** is not supported on Windows Phone."},{"content":"<bpt id=\"p1\">**</bpt>Timer:  <ept id=\"p1\">**</ept>Background tasks can run as frequently as every 15 minutes, and they can be set to run at a certain time by using the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>TimeTrigger<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br224843)</ept>.","pos":[4959,5165],"source":"**Timer:  **Background tasks can run as frequently as every 15 minutes, and they can be set to run at a certain time by using the [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843)."},{"content":"For more info see <bpt id=\"p1\">[</bpt>Run a background task on a timer<ept id=\"p1\">](run-a-background-task-on-a-timer-.md)</ept>.","pos":[5166,5257],"source":" For more info see [Run a background task on a timer](run-a-background-task-on-a-timer-.md)."},{"pos":[5259,5437],"content":"<bpt id=\"p1\">**</bpt>Push Notification:  <ept id=\"p1\">**</ept>Background tasks respond to the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>PushNotificationTrigger<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept> to receive raw push notifications.","source":"**Push Notification:  **Background tasks respond to the [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543) to receive raw push notifications."},{"content":"Note","pos":[5441,5445]},{"pos":[5451,5622],"content":"Universal Windows apps must call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept> before registering any of the background trigger types.","source":"Universal Windows apps must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) before registering any of the background trigger types."},{"content":"To ensure that your Universal Windows app continues to run properly after you release an update, you must call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RemoveAccess<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700471)</ept> and then call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RequestAccessAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept> when your app launches after being updated.","pos":[5624,5952],"source":"To ensure that your Universal Windows app continues to run properly after you release an update, you must call [**RemoveAccess**](https://msdn.microsoft.com/library/windows/apps/hh700471) and then call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) when your app launches after being updated."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Guidelines for background tasks<ept id=\"p1\">](guidelines-for-background-tasks.md)</ept>.","pos":[5953,6049],"source":" For more information, see [Guidelines for background tasks](guidelines-for-background-tasks.md)."},{"content":"System event triggers","pos":[6054,6075]},{"pos":[6080,6233],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>SystemTriggerType<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br224839)</ept> enumeration includes the following system event triggers.","source":"**Note**  The [**SystemTriggerType**](https://msdn.microsoft.com/library/windows/apps/br224839) enumeration includes the following system event triggers."},{"content":"Trigger name","pos":[6237,6249]},{"content":"Description","pos":[6263,6274]},{"content":"UserPresent","pos":[6431,6442]},{"content":"The background task is triggered when the user becomes present.","pos":[6455,6518]},{"content":"UserAway","pos":[6527,6535]},{"content":"The background task is triggered when the user becomes absent.","pos":[6551,6613]},{"content":"ControlChannelReset","pos":[6623,6642]},{"content":"The background task is triggered when a control channel is reset.","pos":[6647,6712]},{"content":"SessionConnected","pos":[6719,6735]},{"content":"The background task is triggered when the session is connected.","pos":[6743,6806]},{"content":"The following system event triggers make it possible to recognize when the user has moved an app on or off the lock screen.","pos":[6815,6938]},{"content":"Trigger name","pos":[6942,6954]},{"content":"Description","pos":[6977,6988]},{"content":"LockScreenApplicationAdded","pos":[7112,7138]},{"content":"An app tile is added to the lock screen.","pos":[7145,7185]},{"content":"LockScreenApplicationRemoved","pos":[7196,7224]},{"content":"An app tile is removed from the lock screen.","pos":[7229,7273]},{"content":"Background task resource constraints","pos":[7282,7318]},{"content":"Background tasks are lightweight.","pos":[7321,7354]},{"content":"Keeping background execution to a minimum ensures the best user experience with foreground apps and battery life.","pos":[7355,7468]},{"content":"This is enforced by applying resource constraints to background tasks:","pos":[7469,7539]},{"content":"Background tasks are limited to 30 seconds of wall-clock usage.","pos":[7545,7608]},{"content":"Additional background task resource constraints","pos":[7613,7660]},{"content":"Memory constraints","pos":[7667,7685]},{"content":"Due to the resource constraints for low-memory devices, background tasks may have a memory limit that determines the maximum amount of memory the background task can use.","pos":[7687,7857]},{"content":"If your background task attempts an operation that would exceed this limit, the operation will fail and may generate an out-of-memory exception that the task can handle.","pos":[7858,8027]},{"content":"If the task does not handle the out-of-memory exception, or the nature of the attempted operation is such that an out-of-memory exception was not generated, then the task will be terminated immediately.","pos":[8028,8230]},{"content":"You can use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MemoryManager<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn633831)</ept> APIs to query your current memory usage and limit in order to discover your cap (if any), and to monitor your background task's ongoing memory usage.","pos":[8231,8474],"source":" You can use the [**MemoryManager**](https://msdn.microsoft.com/library/windows/apps/dn633831) APIs to query your current memory usage and limit in order to discover your cap (if any), and to monitor your background task's ongoing memory usage."},{"content":"Per-device limit for apps with background tasks for low-memory devices","pos":[8480,8550]},{"content":"On memory-constrained devices, there is a limit to the number of apps that can be installed on a device and use background tasks at any given time.","pos":[8552,8699]},{"content":"If this number is exceeded, the call to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept>, which is required to register all background tasks, will fail.","pos":[8700,8886],"source":" If this number is exceeded, the call to [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485), which is required to register all background tasks, will fail."},{"content":"Battery Saver","pos":[8892,8905]},{"content":"Unless you exempt your app so that it can still run background tasks and receive push notifications when Battery Saver is on, the Battery Saver feature, when enabled, will prevent background tasks from running when the device is not connected to external power and the battery goes below a specified amount of power remaining.","pos":[8907,9233]},{"content":"This will not prevent you from registering background tasks.","pos":[9234,9294]},{"content":"Background task resource guarantees for real-time communication","pos":[9299,9362]},{"content":"To prevent resource quotas from interfering with real-time communication functionality, background tasks using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ControlChannelTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701032)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PushNotificationTrigger<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept> receive guaranteed CPU resource quotas for every running task.","pos":[9365,9720],"source":"To prevent resource quotas from interfering with real-time communication functionality, background tasks using the [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032) and [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543) receive guaranteed CPU resource quotas for every running task."},{"content":"The resource quotas are as mentioned above, and remain constant for these background tasks.","pos":[9721,9812]},{"content":"Your app doesn't have to do anything differently to get the guaranteed resource quotas for <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ControlChannelTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701032)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PushNotificationTrigger<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept> background tasks.","pos":[9814,10100],"source":"Your app doesn't have to do anything differently to get the guaranteed resource quotas for [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032) and [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543) background tasks."},{"content":"The system always treats these as critical background tasks.","pos":[10101,10161]},{"content":"Maintenance trigger","pos":[10166,10185]},{"content":"Maintenance tasks only run when the device is plugged in to AC power.","pos":[10188,10257]},{"content":"For more info see <bpt id=\"p1\">[</bpt>Use a maintenance trigger<ept id=\"p1\">](use-a-maintenance-trigger.md)</ept>.","pos":[10258,10334],"source":" For more info see [Use a maintenance trigger](use-a-maintenance-trigger.md)."},{"content":"Background task for sensors and devices","pos":[10339,10378]},{"content":"Your app can access sensors and peripheral devices from a background task with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DeviceUseTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn297337)</ept> class.","pos":[10381,10551],"source":"Your app can access sensors and peripheral devices from a background task with the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) class."},{"content":"You can use this trigger for long-running operations such as data synchronization or monitoring.","pos":[10552,10648]},{"content":"Unlike tasks for system events, a <bpt id=\"p1\">**</bpt>DeviceUseTrigger<ept id=\"p1\">**</ept> task can only be triggered while your app is running in the foreground and no conditions can be set on it.","pos":[10649,10810],"source":" Unlike tasks for system events, a **DeviceUseTrigger** task can only be triggered while your app is running in the foreground and no conditions can be set on it."},{"content":"Some critical device operations, such as long running firmware updates, cannot be performed with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DeviceUseTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn297337)</ept>.","pos":[10812,10994],"source":"Some critical device operations, such as long running firmware updates, cannot be performed with the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337)."},{"content":"Such operations can be performed only on the PC, and only by a privileged app that uses the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DeviceServicingTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn297315)</ept>.","pos":[10995,11174],"source":" Such operations can be performed only on the PC, and only by a privileged app that uses the [**DeviceServicingTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297315)."},{"content":"A <bpt id=\"p1\">*</bpt>privileged app<ept id=\"p1\">*</ept> is an app that the device's manufacturer has authorized to perform those operations.","pos":[11175,11278],"source":" A *privileged app* is an app that the device's manufacturer has authorized to perform those operations."},{"content":"Device metadata is used to specify which app, if any, has been designated as the privileged app for a device.","pos":[11279,11388]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Device sync and update for Windows Store device apps<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=306619)</ept>","pos":[11389,11511],"source":" For more info, see [Device sync and update for Windows Store device apps](http://go.microsoft.com/fwlink/p/?LinkId=306619)"},{"content":"Managing background tasks","pos":[11516,11541]},{"content":"Background tasks can report progress, completion, and cancellation to your app using events and local storage.","pos":[11544,11654]},{"content":"Your app can also catch exceptions thrown by a background task, and manage background task registration during app updates.","pos":[11655,11778]},{"content":"For more info see:","pos":[11779,11797]},{"content":"Handle a cancelled background task","pos":[11800,11834]},{"content":"Monitor background task progress and completion","pos":[11877,11924]},{"content":"Note","pos":[11981,11985]},{"content":"This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps.","pos":[11990,12078]},{"content":"If you’re developing for Windows 8.x or Windows Phone 8.x, see the <bpt id=\"p1\">[</bpt>archived documentation<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>.","pos":[12079,12220],"source":" If you’re developing for Windows 8.x or Windows Phone 8.x, see the [archived documentation](http://go.microsoft.com/fwlink/p/?linkid=619132)."},{"content":"Related topics","pos":[12228,12242]},{"content":"Conceptual guidance for multitasking in Windows 10","pos":[12247,12297]},{"content":"Launching, resuming, and multitasking","pos":[12304,12341]},{"content":"Related background task guidance","pos":[12356,12388]},{"content":"Access sensors and devices from a background task","pos":[12395,12444]},{"content":"Guidelines for background tasks","pos":[12503,12534]},{"content":"Create and register a background task","pos":[12575,12612]},{"content":"Debug a background task","pos":[12659,12682]},{"content":"Declare background tasks in the application manifest","pos":[12715,12767]},{"content":"Handle a cancelled background task","pos":[12829,12863]},{"content":"Monitor background task progress and completion","pos":[12907,12954]},{"content":"Register a background task","pos":[13011,13037]},{"content":"Respond to system events with background tasks","pos":[13073,13119]},{"content":"Run a background task on a timer","pos":[13175,13207]},{"content":"Set conditions for running a background task","pos":[13250,13294]},{"content":"Update a live tile from a background task","pos":[13348,13389]},{"content":"Use a maintenance trigger","pos":[13440,13465]},{"content":"How to trigger suspend, resume, and background events in Windows Store apps (when debugging)","pos":[13500,13592]},{"content":"Device sync and update for Windows Store device apps","pos":[13646,13698]}],"content":"---\ntitle: Support your app with background tasks\ndescription: The topics in this section show how to run your own lightweight code in the background by responding to triggers with background tasks.\nms.assetid: EFF7CBFB-D309-4ACB-A2A5-28E19D447E32\n---\n\n# Support your app with background tasks\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nThe topics in this section show how to run your own lightweight code in the background by responding to triggers with background tasks. Background tasks are lightweight classes that the OS runs in the background. You can use background tasks to provide functionality when your app is suspended or not running. You can also use background tasks for real-time communication apps like VOIP, mail, and IM.\n\nBackground tasks are separate classes that implement the [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794) interface. You register a background task by using the [**BackgroundTaskBuilder**](https://msdn.microsoft.com/library/windows/apps/br224768) class. The class name is used to specify the entry point when you registering the background task.\n\nTo get started quickly with a background task, see [Create and register a background task](create-and-register-a-background-task.md).\n\n**Tip**  Starting with Windows 10, you no longer need to place an app on the lock screen in order to register background tasks.\n\n \n\n## Background tasks for system events\n\n\nYour app can respond to system-generated events by registering a background task with the [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224838) class. An app can use any of the following system event triggers (defined in [**SystemTriggerType**](https://msdn.microsoft.com/library/windows/apps/br224839))\n\n| Trigger name                     | Description                                                                                                    |\n|----------------------------------|----------------------------------------------------------------------------------------------------------------|\n| **InternetAvailable**            | The Internet becomes available.                                                                                |\n| **NetworkStateChange**           | A network change such as a change in cost or connectivity occurs.                                              |\n| **OnlineIdConnectedStateChange** | Online ID associated with the account changes.                                                                 |\n| **SmsReceived**                  | A new SMS message is received by an installed mobile broadband device.                                         |\n| **TimeZoneChange**               | The time zone changes on the device (for example, when the system adjusts the clock for daylight saving time). |\n\n \n\nFor more info see [Respond to system events with background tasks](respond-to-system-events-with-background-tasks.md).\n\n## Conditions for background tasks\n\n\nYou can control when the background task runs, even after it is triggered, by adding a condition. Once triggered, a background task will not run until all of its conditions are met. The following conditions (represented by the [**SystemConditionType**](https://msdn.microsoft.com/library/windows/apps/br224835) enumeration) can be used.\n\n| Condition name           | Description                       |\n|--------------------------|-----------------------------------|\n| **InternetAvailable**    | The Internet must be available.   |\n| **InternetNotAvailable** | The Internet must be unavailable. |\n| **SessionConnected**     | The session must be connected.    |\n| **SessionDisconnected**  | The session must be disconnected. |\n| **UserNotPresent**       | The user must be away.            |\n| **UserPresent**          | The user must be present.         |\n\n \n\nFor more info see [Set conditions for running a background task](set-conditions-for-running-a-background-task.md).\n\n## Application manifest requirements\n\n\nBefore your app can successfully register a background task, it must be declared in the application manifest. For more info see [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md).\n\n## Background tasks\n\n\nThe following real-time triggers can be used to run lightweight custom code in the background:\n\n**Control Channel:  **Background tasks can keep a connection alive, and receive messages on the control channel, by using the [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032). If your app is listening to a socket, you can use the Socket Broker instead of the **ControlChannelTrigger**. For more details on using the Socket Broker, see [SocketActivityTrigger](https://msdn.microsoft.com/library/windows/apps/dn806009). The **ControlChannelTrigger** is not supported on Windows Phone.\n\n**Timer:  **Background tasks can run as frequently as every 15 minutes, and they can be set to run at a certain time by using the [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843). For more info see [Run a background task on a timer](run-a-background-task-on-a-timer-.md).\n\n**Push Notification:  **Background tasks respond to the [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543) to receive raw push notifications.\n\n**Note**  \n\nUniversal Windows apps must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) before registering any of the background trigger types.\n\nTo ensure that your Universal Windows app continues to run properly after you release an update, you must call [**RemoveAccess**](https://msdn.microsoft.com/library/windows/apps/hh700471) and then call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) when your app launches after being updated. For more information, see [Guidelines for background tasks](guidelines-for-background-tasks.md).\n\n## System event triggers\n\n\n> **Note**  The [**SystemTriggerType**](https://msdn.microsoft.com/library/windows/apps/br224839) enumeration includes the following system event triggers.\n\n| Trigger name            | Description                                                       |\n|-------------------------|-------------------------------------------------------------------|\n| **UserPresent**         | The background task is triggered when the user becomes present.   |\n| **UserAway**            | The background task is triggered when the user becomes absent.    |\n| **ControlChannelReset** | The background task is triggered when a control channel is reset. |\n| **SessionConnected**    | The background task is triggered when the session is connected.   |\n\n \n\nThe following system event triggers make it possible to recognize when the user has moved an app on or off the lock screen.\n\n| Trigger name                     | Description                                  |\n|----------------------------------|----------------------------------------------|\n| **LockScreenApplicationAdded**   | An app tile is added to the lock screen.     |\n| **LockScreenApplicationRemoved** | An app tile is removed from the lock screen. |\n\n \n## Background task resource constraints\n\n\nBackground tasks are lightweight. Keeping background execution to a minimum ensures the best user experience with foreground apps and battery life. This is enforced by applying resource constraints to background tasks:\n\n-   Background tasks are limited to 30 seconds of wall-clock usage.\n\n## Additional background task resource constraints\n\n\n### Memory constraints\n\nDue to the resource constraints for low-memory devices, background tasks may have a memory limit that determines the maximum amount of memory the background task can use. If your background task attempts an operation that would exceed this limit, the operation will fail and may generate an out-of-memory exception that the task can handle. If the task does not handle the out-of-memory exception, or the nature of the attempted operation is such that an out-of-memory exception was not generated, then the task will be terminated immediately. You can use the [**MemoryManager**](https://msdn.microsoft.com/library/windows/apps/dn633831) APIs to query your current memory usage and limit in order to discover your cap (if any), and to monitor your background task's ongoing memory usage.\n\n### Per-device limit for apps with background tasks for low-memory devices\n\nOn memory-constrained devices, there is a limit to the number of apps that can be installed on a device and use background tasks at any given time. If this number is exceeded, the call to [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485), which is required to register all background tasks, will fail.\n\n### Battery Saver\n\nUnless you exempt your app so that it can still run background tasks and receive push notifications when Battery Saver is on, the Battery Saver feature, when enabled, will prevent background tasks from running when the device is not connected to external power and the battery goes below a specified amount of power remaining. This will not prevent you from registering background tasks.\n\n## Background task resource guarantees for real-time communication\n\n\nTo prevent resource quotas from interfering with real-time communication functionality, background tasks using the [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032) and [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543) receive guaranteed CPU resource quotas for every running task. The resource quotas are as mentioned above, and remain constant for these background tasks.\n\nYour app doesn't have to do anything differently to get the guaranteed resource quotas for [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032) and [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543) background tasks. The system always treats these as critical background tasks.\n\n## Maintenance trigger\n\n\nMaintenance tasks only run when the device is plugged in to AC power. For more info see [Use a maintenance trigger](use-a-maintenance-trigger.md).\n\n## Background task for sensors and devices\n\n\nYour app can access sensors and peripheral devices from a background task with the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) class. You can use this trigger for long-running operations such as data synchronization or monitoring. Unlike tasks for system events, a **DeviceUseTrigger** task can only be triggered while your app is running in the foreground and no conditions can be set on it.\n\nSome critical device operations, such as long running firmware updates, cannot be performed with the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337). Such operations can be performed only on the PC, and only by a privileged app that uses the [**DeviceServicingTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297315). A *privileged app* is an app that the device's manufacturer has authorized to perform those operations. Device metadata is used to specify which app, if any, has been designated as the privileged app for a device. For more info, see [Device sync and update for Windows Store device apps](http://go.microsoft.com/fwlink/p/?LinkId=306619)\n\n## Managing background tasks\n\n\nBackground tasks can report progress, completion, and cancellation to your app using events and local storage. Your app can also catch exceptions thrown by a background task, and manage background task registration during app updates. For more info see:\n\n[Handle a cancelled background task](handle-a-cancelled-background-task.md)\n\n[Monitor background task progress and completion](monitor-background-task-progress-and-completion.md)\n\n**Note**  \nThis article is for Windows 10 developers writing Universal Windows Platform (UWP) apps. If you’re developing for Windows 8.x or Windows Phone 8.x, see the [archived documentation](http://go.microsoft.com/fwlink/p/?linkid=619132).\n\n \n\n## Related topics\n\n\n**Conceptual guidance for multitasking in Windows 10**\n\n* [Launching, resuming, and multitasking](index.md)\n\n**Related background task guidance**\n\n* [Access sensors and devices from a background task](access-sensors-and-devices-from-a-background-task.md)\n* [Guidelines for background tasks](guidelines-for-background-tasks.md)\n* [Create and register a background task](create-and-register-a-background-task.md)\n* [Debug a background task](debug-a-background-task.md)\n* [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md)\n* [Handle a cancelled background task](handle-a-cancelled-background-task.md)\n* [Monitor background task progress and completion](monitor-background-task-progress-and-completion.md)\n* [Register a background task](register-a-background-task.md)\n* [Respond to system events with background tasks](respond-to-system-events-with-background-tasks.md)\n* [Run a background task on a timer](run-a-background-task-on-a-timer-.md)\n* [Set conditions for running a background task](set-conditions-for-running-a-background-task.md)\n* [Update a live tile from a background task](update-a-live-tile-from-a-background-task.md)\n* [Use a maintenance trigger](use-a-maintenance-trigger.md)\n* [How to trigger suspend, resume, and background events in Windows Store apps (when debugging)](http://go.microsoft.com/fwlink/p/?linkid=254345)\n* [Device sync and update for Windows Store device apps](http://go.microsoft.com/fwlink/p/?LinkId=306619)\n\n \n\n \n\n\n\n"}