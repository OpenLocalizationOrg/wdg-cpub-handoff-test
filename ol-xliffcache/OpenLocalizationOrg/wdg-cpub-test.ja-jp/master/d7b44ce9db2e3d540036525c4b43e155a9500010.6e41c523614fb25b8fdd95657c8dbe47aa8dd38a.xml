{"nodes":[{"pos":[85,254],"content":"This article shows you how to use the IMediaEncodingProperties interface to set the resolution and frame rate of the camera preview stream and captured photos and video.","needQuote":true,"needEscape":true,"nodes":[{"content":"This article shows you how to use the IMediaEncodingProperties interface to set the resolution and frame rate of the camera preview stream and captured photos and video.","pos":[0,169]}]},{"pos":[262,291],"content":"Set media encoding properties","needQuote":true,"needEscape":true,"nodes":[{"content":"Set media encoding properties","pos":[0,29]}]},{"content":"Set media encoding properties","pos":[299,328]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[330,368]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[369,464],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"This article shows you how to use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IMediaEncodingProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701011)</ept> interface to set the resolution and frame rate of the camera preview stream and captured photos and video.","pos":[467,700],"source":"This article shows you how to use the [**IMediaEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701011) interface to set the resolution and frame rate of the camera preview stream and captured photos and video."},{"content":"It also shows how to ensure that the aspect ratio of the preview stream matches that of the captured media.","pos":[701,808]},{"content":"Camera profiles offer a more advanced way of discovering and setting the stream properties of the camera, but they are not supported for all devices.","pos":[810,959]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Camera profiles<ept id=\"p1\">](camera-profiles.md)</ept>.","pos":[960,1024],"source":" For more information, see [Camera profiles](camera-profiles.md)."},{"content":"The code in this article was adapted from the <bpt id=\"p1\">[</bpt>CameraResolution sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=624252&amp;clcid=0x409)</ept>.","pos":[1026,1159],"source":"The code in this article was adapted from the [CameraResolution sample](http://go.microsoft.com/fwlink/p/?LinkId=624252&clcid=0x409)."},{"content":"You can download the sample to see the code used in context or to use the sample as a starting point for your own app.","pos":[1160,1278]},{"content":"Note","pos":[1282,1286]},{"content":"This article builds on concepts and code discussed in <bpt id=\"p1\">[</bpt>Capture Photos and Video with MediaCapture<ept id=\"p1\">](capture-photos-and-video-with-mediacapture.md)</ept>, which describes the steps for implementing basic photo and video capture.","pos":[1291,1511],"source":"This article builds on concepts and code discussed in [Capture Photos and Video with MediaCapture](capture-photos-and-video-with-mediacapture.md), which describes the steps for implementing basic photo and video capture."},{"content":"It is recommended that you familiarize yourself with the basic media capture pattern in that article before moving on to more advanced capture scenarios.","pos":[1512,1665]},{"content":"The code in this article assumes that your app already has an instance of MediaCapture that has been properly initialized.","pos":[1666,1788]},{"content":"A media encoding properties helper class","pos":[1793,1833]},{"content":"Creating a simple helper class to wrap the functionality of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IMediaEncodingProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701011)</ept> interface makes it easier to select a set of encoding properties that meet particular criteria.","pos":[1835,2083],"source":"Creating a simple helper class to wrap the functionality of the [**IMediaEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701011) interface makes it easier to select a set of encoding properties that meet particular criteria."},{"content":"This helper class is particularly useful due to the following behavior of the encoding properties feature:","pos":[2084,2190]},{"content":"Warning","pos":[2194,2201]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VideoDeviceController.GetAvailableMediaStreamProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br211994)</ept> method takes a member of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MediaStreamType<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br226640)</ept> enumeration, such as <bpt id=\"p5\">**</bpt>VideoRecord<ept id=\"p5\">**</ept> or <bpt id=\"p6\">**</bpt>Photo<ept id=\"p6\">**</ept>, and returns a list of either <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>ImageEncodingProperties<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/hh700993)</ept> or <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>VideoEncodingProperties<ept id=\"p10\">**</ept><ept id=\"p9\">](https://msdn.microsoft.com/library/windows/apps/hh701217)</ept> objects that convey the stream encoding settings, such as the resolution of the captured photo or video.","pos":[2206,2802],"source":"The [**VideoDeviceController.GetAvailableMediaStreamProperties**](https://msdn.microsoft.com/library/windows/apps/br211994) method takes a member of the [**MediaStreamType**](https://msdn.microsoft.com/library/windows/apps/br226640) enumeration, such as **VideoRecord** or **Photo**, and returns a list of either [**ImageEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh700993) or [**VideoEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701217) objects that convey the stream encoding settings, such as the resolution of the captured photo or video."},{"content":"The results of calling <bpt id=\"p1\">**</bpt>GetAvailableMediaStreamProperties<ept id=\"p1\">**</ept> may include <bpt id=\"p2\">**</bpt>ImageEncodingProperties<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>VideoEncodingProperties<ept id=\"p3\">**</ept> regardless of what <bpt id=\"p4\">**</bpt>MediaStreamType<ept id=\"p4\">**</ept> value is specified.","pos":[2803,2993],"source":" The results of calling **GetAvailableMediaStreamProperties** may include **ImageEncodingProperties** or **VideoEncodingProperties** regardless of what **MediaStreamType** value is specified."},{"content":"For this reason, you should always check the type of each returned value and cast it to the appropriate type before attempting to access any of the property values.","pos":[2994,3158]},{"content":"The helper class defined below handles the type checking and casting for <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ImageEncodingProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700993)</ept> or <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VideoEncodingProperties<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701217)</ept> so that your app code doesn't need to distinguish between the two types.","pos":[3160,3484],"source":"The helper class defined below handles the type checking and casting for [**ImageEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh700993) or [**VideoEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701217) so that your app code doesn't need to distinguish between the two types."},{"content":"In addition to this, the helper class exposes properties for the aspect ratio of the properties, the frame rate (for video encoding properties only), and a friendly name that makes it easier to display the encoding properties in the app's UI.","pos":[3485,3727]},{"pos":[3729,3894],"content":"You must include the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Media.MediaProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701296)</ept> namespace in the source file for the helper class.","source":"You must include the [**Windows.Media.MediaProperties**](https://msdn.microsoft.com/library/windows/apps/hh701296) namespace in the source file for the helper class."},{"pos":[3906,3934],"content":"MediaEncodingPropertiesUsing"},{"pos":[4035,4057],"content":"StreamPropertiesHelper"},{"content":"Determine if the preview and capture streams are independent","pos":[4154,4214]},{"content":"On some devices, the same hardware pin is used for both preview and capture streams.","pos":[4216,4300]},{"content":"On these devices, setting the encoding properties of one will also set the other.","pos":[4301,4382]},{"content":"On devices that use different hardware pins for capture and preview, the properties can be set for each stream independently.","pos":[4383,4508]},{"content":"Use the following code to determine if the preview and capture streams are independent.","pos":[4509,4596]},{"content":"You should adjust your UI to enable or disable the setting of the streams independently based on the result of this test.","pos":[4597,4718]},{"pos":[4730,4756],"content":"CheckIfStreamsAreIdentical"},{"content":"Get a list of available stream properties","pos":[4848,4889]},{"content":"Get a list of the available stream properties for a capture device by getting the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VideoDeviceController<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br226825)</ept> for your app's <bpt id=\"p3\">[</bpt>MediaCapture<ept id=\"p3\">](capture-photos-and-video-with-mediacapture.md)</ept> object and then calling <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>GetAvailableMediaStreamProperties<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br211994)</ept> and passing in one of the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>MediaStreamType<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/br226640)</ept> values, <bpt id=\"p8\">**</bpt>VideoPreview<ept id=\"p8\">**</ept>, <bpt id=\"p9\">**</bpt>VideoRecord<ept id=\"p9\">**</ept>, or <bpt id=\"p10\">**</bpt>Photo<ept id=\"p10\">**</ept>.","pos":[4891,5420],"source":"Get a list of the available stream properties for a capture device by getting the [**VideoDeviceController**](https://msdn.microsoft.com/library/windows/apps/br226825) for your app's [MediaCapture](capture-photos-and-video-with-mediacapture.md) object and then calling [**GetAvailableMediaStreamProperties**](https://msdn.microsoft.com/library/windows/apps/br211994) and passing in one of the [**MediaStreamType**](https://msdn.microsoft.com/library/windows/apps/br226640) values, **VideoPreview**, **VideoRecord**, or **Photo**."},{"content":"In this example, Linq syntax is used to create a list of <bpt id=\"p1\">**</bpt>StreamPropertiesHelper<ept id=\"p1\">**</ept> objects, defined previously in this article, for each of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>IMediaEncodingProperties<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh701011)</ept> values returned from <bpt id=\"p4\">**</bpt>GetAvailableMediaStreamProperties<ept id=\"p4\">**</ept>.","pos":[5421,5714],"source":" In this example, Linq syntax is used to create a list of **StreamPropertiesHelper** objects, defined previously in this article, for each of the [**IMediaEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701011) values returned from **GetAvailableMediaStreamProperties**."},{"content":"This example first uses Linq extension methods to order the returned properties based first on resolution and then on frame rate.","pos":[5715,5844]},{"content":"If your app has specific resolution or frame rate requirements, you can select a set of media encoding properties programmatically.","pos":[5846,5977]},{"content":"A typical camera app will instead expose the list of available properties in the UI and allow the user to select their desired settings.","pos":[5978,6114]},{"content":"A <bpt id=\"p1\">**</bpt>ComboBoxItem<ept id=\"p1\">**</ept> is created for each item in the list of <bpt id=\"p2\">**</bpt>StreamPropertiesHelper<ept id=\"p2\">**</ept> objects in the list.","pos":[6115,6221],"source":" A **ComboBoxItem** is created for each item in the list of **StreamPropertiesHelper** objects in the list."},{"content":"The content is set to the friendly name returned by the helper class and the tag is set to the helper class itself so it can be used later to retrieve the associated encoding properties.","pos":[6222,6408]},{"content":"Each <bpt id=\"p1\">**</bpt>ComboBoxItem<ept id=\"p1\">**</ept> is then added to the <bpt id=\"p2\">**</bpt>ComboBox<ept id=\"p2\">**</ept> passed into the method.","pos":[6409,6488],"source":" Each **ComboBoxItem** is then added to the **ComboBox** passed into the method."},{"pos":[6500,6526],"content":"PopulateStreamPropertiesUI"},{"content":"Set the desired stream properties","pos":[6618,6651]},{"content":"Tell the video device controller to use your desired encoding properties by calling <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetMediaStreamPropertiesAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700895)</ept>, passing in the <bpt id=\"p3\">**</bpt>MediaStreamType<ept id=\"p3\">**</ept> value indicating whether the photo, video, or preview properties should be set.","pos":[6653,6946],"source":"Tell the video device controller to use your desired encoding properties by calling [**SetMediaStreamPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh700895), passing in the **MediaStreamType** value indicating whether the photo, video, or preview properties should be set."},{"content":"This example sets the requested encoding properties when the user selects an item in one of the <bpt id=\"p1\">**</bpt>ComboBox<ept id=\"p1\">**</ept> objects populated with the <bpt id=\"p2\">**</bpt>PopulateStreamPropertiesUI<ept id=\"p2\">**</ept> helper method.","pos":[6947,7128],"source":" This example sets the requested encoding properties when the user selects an item in one of the **ComboBox** objects populated with the **PopulateStreamPropertiesUI** helper method."},{"pos":[7140,7162],"content":"PreviewSettingsChanged"},{"pos":[7257,7277],"content":"PhotoSettingsChanged"},{"pos":[7370,7390],"content":"VideoSettingsChanged"},{"content":"Match the aspect ratio of the preview and capture streams","pos":[7476,7533]},{"content":"A typical camera app will provide UI for the user to select the video or photo capture resolution but will programmatically set the preview resolution.","pos":[7535,7686]},{"content":"There are a few different strategies for selecting the best preview stream resolution for your app:","pos":[7687,7786]},{"content":"Select the highest available preview resolution, letting the UI framework perform any necessary scaling of the preview.","pos":[7792,7911]},{"content":"Select the preview resolution closest to the capture resolution so that the preview displays the closest representation to the final captured media.","pos":[7917,8065]},{"pos":[8071,8291],"content":"Select the preview resolution closest to the size of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CaptureElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209278)</ept> so that no more pixels than necessary are going through the preview stream pipeline.","source":"Select the preview resolution closest to the size of the [**CaptureElement**](https://msdn.microsoft.com/library/windows/apps/br209278) so that no more pixels than necessary are going through the preview stream pipeline."},{"content":"Important","pos":[8295,8304]},{"content":"It is possible, on some devices, to set a different aspect ratio for the camera's preview stream and capture stream.","pos":[8309,8425]},{"content":"Frame cropping caused by this mismatch can result in content being present in the captured media that was not visible in the preview which can result in a negative user experience.","pos":[8426,8606]},{"content":"It is strongly recommended that you use the same aspect ratio, within a small tolerance window, for the preview and capture streams.","pos":[8607,8739]},{"content":"It is fine to have entirely different resolutions enabled for capture and preview as long as the aspect ratio match closely.","pos":[8740,8864]},{"content":"To ensure that the photo or video capture streams match the aspect ratio of the preview stream, this example calls <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VideoDeviceController.GetMediaStreamProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br211995)</ept> and passes in the <bpt id=\"p3\">**</bpt>VideoPreview<ept id=\"p3\">**</ept> enum value to request the current stream properties for the preview stream.","pos":[8867,9203],"source":"To ensure that the photo or video capture streams match the aspect ratio of the preview stream, this example calls [**VideoDeviceController.GetMediaStreamProperties**](https://msdn.microsoft.com/library/windows/apps/br211995) and passes in the **VideoPreview** enum value to request the current stream properties for the preview stream."},{"content":"Next a small aspect ratio tolerance window is defined so that we can include aspect ratios that are not exactly the same as the preview stream, as long as they are close.","pos":[9204,9374]},{"content":"Next, a Linq extension method is used to select just the <bpt id=\"p1\">**</bpt>StreamPropertiesHelper<ept id=\"p1\">**</ept> objects where the aspect ratio is within the defined tolerance range of the preview stream.","pos":[9375,9550],"source":" Next, a Linq extension method is used to select just the **StreamPropertiesHelper** objects where the aspect ratio is within the defined tolerance range of the preview stream."},{"pos":[9562,9585],"content":"MatchPreviewAspectRatio"}],"content":"---\nauthor: drewbatgit\nms.assetid: 09BA9250-A476-4803-910E-52F0A51704B1\ndescription: This article shows you how to use the IMediaEncodingProperties interface to set the resolution and frame rate of the camera preview stream and captured photos and video.\ntitle: Set media encoding properties\n---\n\n# Set media encoding properties\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nThis article shows you how to use the [**IMediaEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701011) interface to set the resolution and frame rate of the camera preview stream and captured photos and video. It also shows how to ensure that the aspect ratio of the preview stream matches that of the captured media.\n\nCamera profiles offer a more advanced way of discovering and setting the stream properties of the camera, but they are not supported for all devices. For more information, see [Camera profiles](camera-profiles.md).\n\nThe code in this article was adapted from the [CameraResolution sample](http://go.microsoft.com/fwlink/p/?LinkId=624252&clcid=0x409). You can download the sample to see the code used in context or to use the sample as a starting point for your own app.\n\n**Note**  \nThis article builds on concepts and code discussed in [Capture Photos and Video with MediaCapture](capture-photos-and-video-with-mediacapture.md), which describes the steps for implementing basic photo and video capture. It is recommended that you familiarize yourself with the basic media capture pattern in that article before moving on to more advanced capture scenarios. The code in this article assumes that your app already has an instance of MediaCapture that has been properly initialized.\n\n## A media encoding properties helper class\n\nCreating a simple helper class to wrap the functionality of the [**IMediaEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701011) interface makes it easier to select a set of encoding properties that meet particular criteria. This helper class is particularly useful due to the following behavior of the encoding properties feature:\n\n**Warning**  \nThe [**VideoDeviceController.GetAvailableMediaStreamProperties**](https://msdn.microsoft.com/library/windows/apps/br211994) method takes a member of the [**MediaStreamType**](https://msdn.microsoft.com/library/windows/apps/br226640) enumeration, such as **VideoRecord** or **Photo**, and returns a list of either [**ImageEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh700993) or [**VideoEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701217) objects that convey the stream encoding settings, such as the resolution of the captured photo or video. The results of calling **GetAvailableMediaStreamProperties** may include **ImageEncodingProperties** or **VideoEncodingProperties** regardless of what **MediaStreamType** value is specified. For this reason, you should always check the type of each returned value and cast it to the appropriate type before attempting to access any of the property values.\n\nThe helper class defined below handles the type checking and casting for [**ImageEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh700993) or [**VideoEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701217) so that your app code doesn't need to distinguish between the two types. In addition to this, the helper class exposes properties for the aspect ratio of the properties, the frame rate (for video encoding properties only), and a friendly name that makes it easier to display the encoding properties in the app's UI.\n\nYou must include the [**Windows.Media.MediaProperties**](https://msdn.microsoft.com/library/windows/apps/hh701296) namespace in the source file for the helper class.\n\n[!code-cs[MediaEncodingPropertiesUsing](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetMediaEncodingPropertiesUsing)]\n\n[!code-cs[StreamPropertiesHelper](./code/BasicMediaCaptureWin10/cs/StreamPropertiesHelper.cs#SnippetStreamPropertiesHelper)]\n\n## Determine if the preview and capture streams are independent\n\nOn some devices, the same hardware pin is used for both preview and capture streams. On these devices, setting the encoding properties of one will also set the other. On devices that use different hardware pins for capture and preview, the properties can be set for each stream independently. Use the following code to determine if the preview and capture streams are independent. You should adjust your UI to enable or disable the setting of the streams independently based on the result of this test.\n\n[!code-cs[CheckIfStreamsAreIdentical](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetCheckIfStreamsAreIdentical)]\n\n## Get a list of available stream properties\n\nGet a list of the available stream properties for a capture device by getting the [**VideoDeviceController**](https://msdn.microsoft.com/library/windows/apps/br226825) for your app's [MediaCapture](capture-photos-and-video-with-mediacapture.md) object and then calling [**GetAvailableMediaStreamProperties**](https://msdn.microsoft.com/library/windows/apps/br211994) and passing in one of the [**MediaStreamType**](https://msdn.microsoft.com/library/windows/apps/br226640) values, **VideoPreview**, **VideoRecord**, or **Photo**. In this example, Linq syntax is used to create a list of **StreamPropertiesHelper** objects, defined previously in this article, for each of the [**IMediaEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh701011) values returned from **GetAvailableMediaStreamProperties**. This example first uses Linq extension methods to order the returned properties based first on resolution and then on frame rate.\n\nIf your app has specific resolution or frame rate requirements, you can select a set of media encoding properties programmatically. A typical camera app will instead expose the list of available properties in the UI and allow the user to select their desired settings. A **ComboBoxItem** is created for each item in the list of **StreamPropertiesHelper** objects in the list. The content is set to the friendly name returned by the helper class and the tag is set to the helper class itself so it can be used later to retrieve the associated encoding properties. Each **ComboBoxItem** is then added to the **ComboBox** passed into the method.\n\n[!code-cs[PopulateStreamPropertiesUI](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetPopulateStreamPropertiesUI)]\n\n## Set the desired stream properties\n\nTell the video device controller to use your desired encoding properties by calling [**SetMediaStreamPropertiesAsync**](https://msdn.microsoft.com/library/windows/apps/hh700895), passing in the **MediaStreamType** value indicating whether the photo, video, or preview properties should be set. This example sets the requested encoding properties when the user selects an item in one of the **ComboBox** objects populated with the **PopulateStreamPropertiesUI** helper method.\n\n[!code-cs[PreviewSettingsChanged](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetPreviewSettingsChanged)]\n\n[!code-cs[PhotoSettingsChanged](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetPhotoSettingsChanged)]\n\n[!code-cs[VideoSettingsChanged](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetVideoSettingsChanged)]\n\n## Match the aspect ratio of the preview and capture streams\n\nA typical camera app will provide UI for the user to select the video or photo capture resolution but will programmatically set the preview resolution. There are a few different strategies for selecting the best preview stream resolution for your app:\n\n-   Select the highest available preview resolution, letting the UI framework perform any necessary scaling of the preview.\n\n-   Select the preview resolution closest to the capture resolution so that the preview displays the closest representation to the final captured media.\n\n-   Select the preview resolution closest to the size of the [**CaptureElement**](https://msdn.microsoft.com/library/windows/apps/br209278) so that no more pixels than necessary are going through the preview stream pipeline.\n\n**Important**  \nIt is possible, on some devices, to set a different aspect ratio for the camera's preview stream and capture stream. Frame cropping caused by this mismatch can result in content being present in the captured media that was not visible in the preview which can result in a negative user experience. It is strongly recommended that you use the same aspect ratio, within a small tolerance window, for the preview and capture streams. It is fine to have entirely different resolutions enabled for capture and preview as long as the aspect ratio match closely.\n\n\nTo ensure that the photo or video capture streams match the aspect ratio of the preview stream, this example calls [**VideoDeviceController.GetMediaStreamProperties**](https://msdn.microsoft.com/library/windows/apps/br211995) and passes in the **VideoPreview** enum value to request the current stream properties for the preview stream. Next a small aspect ratio tolerance window is defined so that we can include aspect ratios that are not exactly the same as the preview stream, as long as they are close. Next, a Linq extension method is used to select just the **StreamPropertiesHelper** objects where the aspect ratio is within the defined tolerance range of the preview stream.\n\n[!code-cs[MatchPreviewAspectRatio](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetMatchPreviewAspectRatio)]\n\n \n\n \n\n\n\n\n"}