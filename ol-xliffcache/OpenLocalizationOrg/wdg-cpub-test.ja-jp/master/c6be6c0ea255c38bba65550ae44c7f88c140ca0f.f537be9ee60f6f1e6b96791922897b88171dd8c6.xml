{"nodes":[{"pos":[85,330],"content":"This article shows you how to capture a variable photo sequence, which allows you to capture multiple frames of images in rapid succession and configure each frame to use different focus, flash, ISO, exposure, and exposure compensation settings.","needQuote":true,"needEscape":true,"nodes":[{"content":"This article shows you how to capture a variable photo sequence, which allows you to capture multiple frames of images in rapid succession and configure each frame to use different focus, flash, ISO, exposure, and exposure compensation settings.","pos":[0,245]}]},{"pos":[338,361],"content":"Variable photo sequence","needQuote":true,"needEscape":true,"nodes":[{"content":"Variable photo sequence","pos":[0,23]}]},{"content":"Variable photo sequence","pos":[369,392]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[394,432]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[433,528],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"This article shows you how to capture a variable photo sequence, which allows you to capture multiple frames of images in rapid succession and configure each frame to use different focus, flash, ISO, exposure, and exposure compensation settings.","pos":[531,776]},{"content":"This feature enables scenarios like creating High Dynamic Range (HDR) images.","pos":[777,854]},{"content":"If you want to capture HDR images but don't want to implement your own processing algorithm, you can use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AdvancedPhotoCapture<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt181386)</ept> API to use the HDR capabilities built-in to Windows.","pos":[856,1102],"source":"If you want to capture HDR images but don't want to implement your own processing algorithm, you can use the [**AdvancedPhotoCapture**](https://msdn.microsoft.com/library/windows/apps/mt181386) API to use the HDR capabilities built-in to Windows."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>High Dynamic Range (HDR) photo capture<ept id=\"p1\">](high-dynamic-range-hdr-photo-capture.md)</ept>.","pos":[1103,1211],"source":" For more information, see [High Dynamic Range (HDR) photo capture](high-dynamic-range-hdr-photo-capture.md)."},{"content":"Note","pos":[1215,1219]},{"content":"This article builds on concepts and code discussed in <bpt id=\"p1\">[</bpt>Capture Photos and Video with MediaCapture<ept id=\"p1\">](capture-photos-and-video-with-mediacapture.md)</ept>, which describes the steps for implementing basic photo and video capture.","pos":[1224,1444],"source":"This article builds on concepts and code discussed in [Capture Photos and Video with MediaCapture](capture-photos-and-video-with-mediacapture.md), which describes the steps for implementing basic photo and video capture."},{"content":"It is recommended that you familiarize yourself with the basic media capture pattern in that article before moving on to more advanced capture scenarios.","pos":[1445,1598]},{"content":"The code in this article assumes that your app already has an instance of MediaCapture that has been properly initialized.","pos":[1599,1721]},{"content":"Set up your app to use variable photo sequence capture","pos":[1726,1780]},{"content":"In addition to the namespaces required for basic media capture, implementing a variable photo sequence capture requires the following namespaces.","pos":[1782,1927]},{"pos":[1939,1947],"content":"VPSUsing"},{"content":"Declare a member variable to store the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VariablePhotoSequenceCapture<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652564)</ept> object, which is used to initiate the photo sequence capture.","pos":[2018,2211],"source":"Declare a member variable to store the [**VariablePhotoSequenceCapture**](https://msdn.microsoft.com/library/windows/apps/dn652564) object, which is used to initiate the photo sequence capture."},{"content":"Declare an array of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SoftwareBitmap<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn887358)</ept> objects to store each captured image in the sequence.","pos":[2212,2364],"source":" Declare an array of [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) objects to store each captured image in the sequence."},{"content":"Also, declare an array to store the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CapturedFrameControlValues<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn608020)</ept> object for each frame.","pos":[2365,2514],"source":" Also, declare an array to store the [**CapturedFrameControlValues**](https://msdn.microsoft.com/library/windows/apps/dn608020) object for each frame."},{"content":"This can be used by your image processing algorithm to determine what settings were used to capture each frame.","pos":[2515,2626]},{"content":"Finally, declare an index that will be used to track which image in the sequence is currently being captured.","pos":[2627,2736]},{"pos":[2748,2766],"content":"VPSMemberVariables"},{"content":"Prepare the variable photo sequence capture","pos":[2850,2893]},{"pos":[2895,3403],"content":"After you have initialized your <bpt id=\"p1\">[</bpt>MediaCapture<ept id=\"p1\">](capture-photos-and-video-with-mediacapture.md)</ept>, make sure that variable photo sequences are supported on the current device by getting an instance of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VariablePhotoSequenceController<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn640573)</ept> from the media capture's <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>VideoDeviceController<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br226825)</ept> and checking the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>Supported<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn640580)</ept> property.","source":"After you have initialized your [MediaCapture](capture-photos-and-video-with-mediacapture.md), make sure that variable photo sequences are supported on the current device by getting an instance of the [**VariablePhotoSequenceController**](https://msdn.microsoft.com/library/windows/apps/dn640573) from the media capture's [**VideoDeviceController**](https://msdn.microsoft.com/library/windows/apps/br226825) and checking the [**Supported**](https://msdn.microsoft.com/library/windows/apps/dn640580) property."},{"pos":[3415,3429],"content":"IsVPSSupported"},{"content":"Get a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameControlCapabilities<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652548)</ept> object from the variable photo sequence controller.","pos":[3506,3652],"source":"Get a [**FrameControlCapabilities**](https://msdn.microsoft.com/library/windows/apps/dn652548) object from the variable photo sequence controller."},{"content":"This object has a property for every setting that can be configured per frame of a photo sequence.","pos":[3653,3751]},{"content":"These include:","pos":[3752,3766]},{"content":"Exposure","pos":[3775,3783]},{"content":"ExposureCompensation","pos":[3852,3872]},{"content":"Flash","pos":[3941,3946]},{"content":"Focus","pos":[4015,4020]},{"content":"IsoSpeed","pos":[4089,4097]},{"content":"PhotoConfirmation","pos":[4166,4183]},{"content":"This example will set a different exposure compensation value for each frame.","pos":[4246,4323]},{"content":"To verify that exposure compensation is supported for photo sequences on the current device, check the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Supported<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278905)</ept> property of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>FrameExposureCompensationCapabilities<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn652628)</ept> object accessed through the <bpt id=\"p5\">**</bpt>ExposureCompensation<ept id=\"p5\">**</ept> property.","pos":[4324,4681],"source":" To verify that exposure compensation is supported for photo sequences on the current device, check the [**Supported**](https://msdn.microsoft.com/library/windows/apps/dn278905) property of the [**FrameExposureCompensationCapabilities**](https://msdn.microsoft.com/library/windows/apps/dn652628) object accessed through the **ExposureCompensation** property."},{"pos":[4693,4724],"content":"IsExposureCompensationSupported"},{"content":"Create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameController<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652582)</ept> object for each frame you want to capture.","pos":[4818,4953],"source":"Create a new [**FrameController**](https://msdn.microsoft.com/library/windows/apps/dn652582) object for each frame you want to capture."},{"content":"This example captures three frames.","pos":[4954,4989]},{"content":"Set the values for the controls you want to vary for each frame.","pos":[4990,5054]},{"content":"Then, clear the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DesiredFrameControllers<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn640574)</ept> collection of the <bpt id=\"p3\">**</bpt>VariablePhotoSequenceController<ept id=\"p3\">**</ept> and add each frame controller to the collection.","pos":[5055,5261],"source":" Then, clear the [**DesiredFrameControllers**](https://msdn.microsoft.com/library/windows/apps/dn640574) collection of the **VariablePhotoSequenceController** and add each frame controller to the collection."},{"pos":[5273,5293],"content":"InitFrameControllers"},{"content":"Create an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ImageEncodingProperties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700993)</ept> object to set the encoding you want to use for the captured images.","pos":[5376,5541],"source":"Create an [**ImageEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh700993) object to set the encoding you want to use for the captured images."},{"content":"Call the static method <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MediaCapture.PrepareVariablePhotoSequenceCaptureAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn608097)</ept>, passing in the encoding properties.","pos":[5542,5719],"source":" Call the static method [**MediaCapture.PrepareVariablePhotoSequenceCaptureAsync**](https://msdn.microsoft.com/library/windows/apps/dn608097), passing in the encoding properties."},{"content":"This method returns a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VariablePhotoSequenceCapture<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652564)</ept> object.","pos":[5720,5842],"source":" This method returns a [**VariablePhotoSequenceCapture**](https://msdn.microsoft.com/library/windows/apps/dn652564) object."},{"content":"Finally, register event handlers for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PhotoCaptured<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652573)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Stopped<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn652585)</ept> events.","pos":[5843,6045],"source":" Finally, register event handlers for the [**PhotoCaptured**](https://msdn.microsoft.com/library/windows/apps/dn652573) and [**Stopped**](https://msdn.microsoft.com/library/windows/apps/dn652585) events."},{"pos":[6057,6067],"content":"PrepareVPS"},{"content":"Start the variable photo sequence capture","pos":[6143,6184]},{"content":"To start the capture of the variable photo sequence, call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VariablePhotoSequenceCapture.StartAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652577)</ept>.","pos":[6186,6348],"source":"To start the capture of the variable photo sequence, call [**VariablePhotoSequenceCapture.StartAsync**](https://msdn.microsoft.com/library/windows/apps/dn652577)."},{"content":"Be sure to initialize the arrays for storing the captured images and frame control values and set the current index to 0.","pos":[6349,6470]},{"content":"Set your app's recording state variable and update your UI to disable starting another capture while this capture is in progress.","pos":[6471,6600]},{"pos":[6612,6627],"content":"StartVPSCapture"},{"content":"Receive the captured frames","pos":[6708,6735]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PhotoCaptured<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652573)</ept> event is raised for each captured frame.","pos":[6737,6859],"source":"The [**PhotoCaptured**](https://msdn.microsoft.com/library/windows/apps/dn652573) event is raised for each captured frame."},{"content":"Save the frame control values and captured image for the frame and then increment the current frame index.","pos":[6860,6966]},{"content":"This example shows how to get a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SoftwareBitmap<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn887358)</ept> representation of each frame.","pos":[6967,7107],"source":" This example shows how to get a [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) representation of each frame."},{"content":"For more information on using <bpt id=\"p1\">**</bpt>SoftwareBitmap<ept id=\"p1\">**</ept>, see <bpt id=\"p2\">[</bpt>Imaging<ept id=\"p2\">](imaging.md)</ept>.","pos":[7108,7184],"source":" For more information on using **SoftwareBitmap**, see [Imaging](imaging.md)."},{"pos":[7196,7211],"content":"OnPhotoCaptured"},{"content":"Handle the completion of the variable photo sequence capture","pos":[7292,7352]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Stopped<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652585)</ept> event is raised when all of the frames in the sequence have been captured.","pos":[7354,7504],"source":"The [**Stopped**](https://msdn.microsoft.com/library/windows/apps/dn652585) event is raised when all of the frames in the sequence have been captured."},{"content":"Update the recording state of your app and update your UI to allow the user to initiate new captures.","pos":[7505,7606]},{"content":"At this point, you can pass the captured images and frame control values to your image processing code.","pos":[7607,7710]},{"pos":[7722,7731],"content":"OnStopped"},{"content":"Update frame controllers","pos":[7806,7830]},{"content":"If you want to perform another variable photo sequence capture with different per frame settings, you don't need to completely reinitialize the <bpt id=\"p1\">**</bpt>VariablePhotoSequenceCapture<ept id=\"p1\">**</ept>.","pos":[7832,8009],"source":"If you want to perform another variable photo sequence capture with different per frame settings, you don't need to completely reinitialize the **VariablePhotoSequenceCapture**."},{"content":"You can either clear the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DesiredFrameControllers<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn640574)</ept> collection and add new frame controllers or you can modify the existing frame controller values.","pos":[8010,8219],"source":" You can either clear the [**DesiredFrameControllers**](https://msdn.microsoft.com/library/windows/apps/dn640574) collection and add new frame controllers or you can modify the existing frame controller values."},{"content":"The following example checks the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameFlashCapabilities<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652657)</ept> object to verify that the current device supports flash and flash power for variable photo sequence frames.","pos":[8220,8447],"source":" The following example checks the [**FrameFlashCapabilities**](https://msdn.microsoft.com/library/windows/apps/dn652657) object to verify that the current device supports flash and flash power for variable photo sequence frames."},{"content":"If so, each frame is updated to enable the flash at 100% power.","pos":[8448,8511]},{"content":"The exposure compensation values that were previously set for each frame are still active.","pos":[8512,8602]},{"pos":[8614,8636],"content":"UpdateFrameControllers"},{"content":"Clean up the variable photo sequence capture","pos":[8724,8768]},{"content":"When you are done capturing variable photo sequences or your app is suspending, clean up the variable photo sequence object by calling <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FinishAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn652569)</ept>.","pos":[8770,8981],"source":"When you are done capturing variable photo sequences or your app is suspending, clean up the variable photo sequence object by calling [**FinishAsync**](https://msdn.microsoft.com/library/windows/apps/dn652569)."},{"content":"Unregister the object's event handlers and set it to null.","pos":[8982,9040]},{"pos":[9052,9062],"content":"CleanUpVPS"},{"content":"Related topics","pos":[9138,9152]},{"content":"Capture photos and video with MediaCapture","pos":[9157,9199]}],"content":"---\nauthor: drewbatgit\nms.assetid: 7DBEE5E2-C3EC-4305-823D-9095C761A1CD\ndescription: This article shows you how to capture a variable photo sequence, which allows you to capture multiple frames of images in rapid succession and configure each frame to use different focus, flash, ISO, exposure, and exposure compensation settings.\ntitle: Variable photo sequence\n---\n\n# Variable photo sequence\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nThis article shows you how to capture a variable photo sequence, which allows you to capture multiple frames of images in rapid succession and configure each frame to use different focus, flash, ISO, exposure, and exposure compensation settings. This feature enables scenarios like creating High Dynamic Range (HDR) images.\n\nIf you want to capture HDR images but don't want to implement your own processing algorithm, you can use the [**AdvancedPhotoCapture**](https://msdn.microsoft.com/library/windows/apps/mt181386) API to use the HDR capabilities built-in to Windows. For more information, see [High Dynamic Range (HDR) photo capture](high-dynamic-range-hdr-photo-capture.md).\n\n**Note**  \nThis article builds on concepts and code discussed in [Capture Photos and Video with MediaCapture](capture-photos-and-video-with-mediacapture.md), which describes the steps for implementing basic photo and video capture. It is recommended that you familiarize yourself with the basic media capture pattern in that article before moving on to more advanced capture scenarios. The code in this article assumes that your app already has an instance of MediaCapture that has been properly initialized.\n\n## Set up your app to use variable photo sequence capture\n\nIn addition to the namespaces required for basic media capture, implementing a variable photo sequence capture requires the following namespaces.\n\n[!code-cs[VPSUsing](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetVPSUsing)]\n\nDeclare a member variable to store the [**VariablePhotoSequenceCapture**](https://msdn.microsoft.com/library/windows/apps/dn652564) object, which is used to initiate the photo sequence capture. Declare an array of [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) objects to store each captured image in the sequence. Also, declare an array to store the [**CapturedFrameControlValues**](https://msdn.microsoft.com/library/windows/apps/dn608020) object for each frame. This can be used by your image processing algorithm to determine what settings were used to capture each frame. Finally, declare an index that will be used to track which image in the sequence is currently being captured.\n\n[!code-cs[VPSMemberVariables](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetVPSMemberVariables)]\n\n## Prepare the variable photo sequence capture\n\nAfter you have initialized your [MediaCapture](capture-photos-and-video-with-mediacapture.md), make sure that variable photo sequences are supported on the current device by getting an instance of the [**VariablePhotoSequenceController**](https://msdn.microsoft.com/library/windows/apps/dn640573) from the media capture's [**VideoDeviceController**](https://msdn.microsoft.com/library/windows/apps/br226825) and checking the [**Supported**](https://msdn.microsoft.com/library/windows/apps/dn640580) property.\n\n[!code-cs[IsVPSSupported](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetIsVPSSupported)]\n\nGet a [**FrameControlCapabilities**](https://msdn.microsoft.com/library/windows/apps/dn652548) object from the variable photo sequence controller. This object has a property for every setting that can be configured per frame of a photo sequence. These include:\n\n-   [**Exposure**](https://msdn.microsoft.com/library/windows/apps/dn652552)\n-   [**ExposureCompensation**](https://msdn.microsoft.com/library/windows/apps/dn652560)\n-   [**Flash**](https://msdn.microsoft.com/library/windows/apps/dn652566)\n-   [**Focus**](https://msdn.microsoft.com/library/windows/apps/dn652570)\n-   [**IsoSpeed**](https://msdn.microsoft.com/library/windows/apps/dn652574)\n-   [**PhotoConfirmation**](https://msdn.microsoft.com/library/windows/apps/dn652578)\n\nThis example will set a different exposure compensation value for each frame. To verify that exposure compensation is supported for photo sequences on the current device, check the [**Supported**](https://msdn.microsoft.com/library/windows/apps/dn278905) property of the [**FrameExposureCompensationCapabilities**](https://msdn.microsoft.com/library/windows/apps/dn652628) object accessed through the **ExposureCompensation** property.\n\n[!code-cs[IsExposureCompensationSupported](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetIsExposureCompensationSupported)]\n\nCreate a new [**FrameController**](https://msdn.microsoft.com/library/windows/apps/dn652582) object for each frame you want to capture. This example captures three frames. Set the values for the controls you want to vary for each frame. Then, clear the [**DesiredFrameControllers**](https://msdn.microsoft.com/library/windows/apps/dn640574) collection of the **VariablePhotoSequenceController** and add each frame controller to the collection.\n\n[!code-cs[InitFrameControllers](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetInitFrameControllers)]\n\nCreate an [**ImageEncodingProperties**](https://msdn.microsoft.com/library/windows/apps/hh700993) object to set the encoding you want to use for the captured images. Call the static method [**MediaCapture.PrepareVariablePhotoSequenceCaptureAsync**](https://msdn.microsoft.com/library/windows/apps/dn608097), passing in the encoding properties. This method returns a [**VariablePhotoSequenceCapture**](https://msdn.microsoft.com/library/windows/apps/dn652564) object. Finally, register event handlers for the [**PhotoCaptured**](https://msdn.microsoft.com/library/windows/apps/dn652573) and [**Stopped**](https://msdn.microsoft.com/library/windows/apps/dn652585) events.\n\n[!code-cs[PrepareVPS](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetPrepareVPS)]\n\n## Start the variable photo sequence capture\n\nTo start the capture of the variable photo sequence, call [**VariablePhotoSequenceCapture.StartAsync**](https://msdn.microsoft.com/library/windows/apps/dn652577). Be sure to initialize the arrays for storing the captured images and frame control values and set the current index to 0. Set your app's recording state variable and update your UI to disable starting another capture while this capture is in progress.\n\n[!code-cs[StartVPSCapture](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetStartVPSCapture)]\n\n## Receive the captured frames\n\nThe [**PhotoCaptured**](https://msdn.microsoft.com/library/windows/apps/dn652573) event is raised for each captured frame. Save the frame control values and captured image for the frame and then increment the current frame index. This example shows how to get a [**SoftwareBitmap**](https://msdn.microsoft.com/library/windows/apps/dn887358) representation of each frame. For more information on using **SoftwareBitmap**, see [Imaging](imaging.md).\n\n[!code-cs[OnPhotoCaptured](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetOnPhotoCaptured)]\n\n## Handle the completion of the variable photo sequence capture\n\nThe [**Stopped**](https://msdn.microsoft.com/library/windows/apps/dn652585) event is raised when all of the frames in the sequence have been captured. Update the recording state of your app and update your UI to allow the user to initiate new captures. At this point, you can pass the captured images and frame control values to your image processing code.\n\n[!code-cs[OnStopped](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetOnStopped)]\n\n## Update frame controllers\n\nIf you want to perform another variable photo sequence capture with different per frame settings, you don't need to completely reinitialize the **VariablePhotoSequenceCapture**. You can either clear the [**DesiredFrameControllers**](https://msdn.microsoft.com/library/windows/apps/dn640574) collection and add new frame controllers or you can modify the existing frame controller values. The following example checks the [**FrameFlashCapabilities**](https://msdn.microsoft.com/library/windows/apps/dn652657) object to verify that the current device supports flash and flash power for variable photo sequence frames. If so, each frame is updated to enable the flash at 100% power. The exposure compensation values that were previously set for each frame are still active.\n\n[!code-cs[UpdateFrameControllers](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetUpdateFrameControllers)]\n\n## Clean up the variable photo sequence capture\n\nWhen you are done capturing variable photo sequences or your app is suspending, clean up the variable photo sequence object by calling [**FinishAsync**](https://msdn.microsoft.com/library/windows/apps/dn652569). Unregister the object's event handlers and set it to null.\n\n[!code-cs[CleanUpVPS](./code/BasicMediaCaptureWin10/cs/MainPage.xaml.cs#SnippetCleanUpVPS)]\n\n## Related topics\n\n* [Capture photos and video with MediaCapture](capture-photos-and-video-with-mediacapture.md)\n \n\n \n\n\n\n\n"}